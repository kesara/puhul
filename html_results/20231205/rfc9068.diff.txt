16c16
< <meta content="xml2rfc 3.10.0" name="generator">
---
> <meta content="xml2rfc 3.18.2" name="generator">
23,40c23,36
<   xml2rfc 3.10.0
<     Python 3.6.13
<     appdirs 1.4.4
<     ConfigArgParse 1.4.1
<     google-i18n-address 2.4.0
<     html5lib 1.0.1
<     intervaltree 3.0.2
<     Jinja2 2.11.3
<     kitchen 1.2.6
<     lxml 4.4.2
<     pycairo 1.15.1
<     pycountry 19.8.18
<     pyflakes 2.1.1
<     PyYAML 5.4.1
<     requests 2.24.0
<     setuptools 40.5.0
<     six 1.14.0
<     WeasyPrint 52.5
---
>   xml2rfc 3.18.2
>     Python 3.11.6
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 4.9.3
>     platformdirs 4.1.0
>     pycountry 22.3.5
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.12
42c38
< <link href="rfc9068.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc9068.xml" rel="alternate" type="application/rfc+xml">
52c48
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
61a58,63
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
64d65
<   width: extend-to-zoom;
79c80
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
81a83
>   overflow-wrap: break-word;
167a170,178
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
182,185d192
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
186a194
>   border: none;
254c262,263
< a[href].selfRef {
---
> a[href].selfRef,
> .iref + a[href].internal {
264c273
< tt, code, pre, code {
---
> tt, code, pre {
266c275
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
305a315,317
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
503c515
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
643d654
< 
665a677,679
>   .breakable pre {
>     break-inside: auto;
>   }
733c747
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
833c847
< tt, code, pre, code {
---
> tt, code, pre {
838c852
< pre.sourcecode,
---
> .sourcecode pre,
874c888
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1055a1070
>   .artwork > pre,
1070c1085
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1076a1092,1094
> tr {
>   break-inside: avoid;
> }
1127c1145
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1152c1170
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1170c1188
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1184c1202
< li > p:last-of-type {
---
> li > p:last-of-type:only-child {
1188a1207
> <link href="https://datatracker.ietf.org/doc/draft-ietf-oauth-access-token-jwt-13" rel="prev">
1191c1210
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-oauth-access-token-jwt-13" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1193,1194c1212,1213
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1287c1306
<             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
---
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
1290c1309
<                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="xref">Requirements Notation and Conventions</a></p>
---
>                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-notation-and-c" class="internal xref">Requirements Notation and Conventions</a></p>
1293c1312
<                 <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
---
>                 <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
1298c1317
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-jwt-access-token-header-and" class="xref">JWT Access Token Header and Data Structure</a></p>
---
>             <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-jwt-access-token-header-and" class="internal xref">JWT Access Token Header and Data Structure</a></p>
1301c1320
<                 <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-header" class="xref">Header</a></p>
---
>                 <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-header" class="internal xref">Header</a></p>
1304c1323
<                 <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-data-structure" class="xref">Data Structure</a></p>
---
>                 <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-data-structure" class="internal xref">Data Structure</a></p>
1307c1326
<                     <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-authentication-information-" class="xref">Authentication Information Claims</a></p>
---
>                     <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-authentication-information-" class="internal xref">Authentication Information Claims</a></p>
1310c1329
<                     <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-identity-claims" class="xref">Identity Claims</a></p>
---
>                     <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-identity-claims" class="internal xref">Identity Claims</a></p>
1313c1332
<                     <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-authorization-claims" class="xref">Authorization Claims</a></p>
---
>                     <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="auto internal xref">2.2.3</a>.  <a href="#name-authorization-claims" class="internal xref">Authorization Claims</a></p>
1316c1335
<                         <p id="section-toc.1-1.2.2.2.2.3.2.1.1"><a href="#section-2.2.3.1" class="xref">2.2.3.1</a>.  <a href="#name-claims-for-authorization-ou" class="xref">Claims for Authorization Outside of Delegation Scenarios</a></p>
---
>                         <p id="section-toc.1-1.2.2.2.2.3.2.1.1"><a href="#section-2.2.3.1" class="auto internal xref">2.2.3.1</a>.  <a href="#name-claims-for-authorization-ou" class="internal xref">Claims for Authorization Outside of Delegation Scenarios</a></p>
1325c1344
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-requesting-a-jwt-access-tok" class="xref">Requesting a JWT Access Token</a></p>
---
>             <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-requesting-a-jwt-access-tok" class="internal xref">Requesting a JWT Access Token</a></p>
1328c1347
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-validating-jwt-access-token" class="xref">Validating JWT Access Tokens</a></p>
---
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-validating-jwt-access-token" class="internal xref">Validating JWT Access Tokens</a></p>
1331c1350
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
---
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1334c1353
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
---
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
1337c1356
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
---
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
1340c1359
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-media-type-registration" class="xref">Media Type Registration</a></p>
---
>                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-media-type-registration" class="internal xref">Media Type Registration</a></p>
1343c1362
<                     <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-registry-content" class="xref">Registry Content</a></p>
---
>                     <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-registry-content" class="internal xref">Registry Content</a></p>
1348c1367
<                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-claims-registration" class="xref">Claims Registration</a></p>
---
>                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-claims-registration" class="internal xref">Claims Registration</a></p>
1351c1370
<                     <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="xref">7.2.1</a>.  <a href="#name-registry-content-2" class="xref">Registry Content</a></p>
---
>                     <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-registry-content-2" class="internal xref">Registry Content</a></p>
1354c1373
<                         <p id="section-toc.1-1.7.2.2.2.1.2.1.1"><a href="#section-7.2.1.1" class="xref">7.2.1.1</a>.  <a href="#name-roles" class="xref">Roles</a></p>
---
>                         <p id="section-toc.1-1.7.2.2.2.1.2.1.1"><a href="#section-7.2.1.1" class="auto internal xref">7.2.1.1</a>.  <a href="#name-roles" class="internal xref">Roles</a></p>
1357c1376
<                         <p id="section-toc.1-1.7.2.2.2.1.2.2.1"><a href="#section-7.2.1.2" class="xref">7.2.1.2</a>.  <a href="#name-groups" class="xref">Groups</a></p>
---
>                         <p id="section-toc.1-1.7.2.2.2.1.2.2.1"><a href="#section-7.2.1.2" class="auto internal xref">7.2.1.2</a>.  <a href="#name-groups" class="internal xref">Groups</a></p>
1360c1379
<                         <p id="section-toc.1-1.7.2.2.2.1.2.3.1"><a href="#section-7.2.1.3" class="xref">7.2.1.3</a>.  <a href="#name-entitlements" class="xref">Entitlements</a></p>
---
>                         <p id="section-toc.1-1.7.2.2.2.1.2.3.1"><a href="#section-7.2.1.3" class="auto internal xref">7.2.1.3</a>.  <a href="#name-entitlements" class="internal xref">Entitlements</a></p>
1369c1388
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
---
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
1372c1391
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
---
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1375c1394
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
---
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1380c1399
<             <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
---
>             <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
1383c1402
<             <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
---
>             <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
1396c1415
<                 <span><a href="#RFC6749" class="xref">OAuth 2.0 Authorization Framework</a> [<a href="#RFC6749" class="xref">RFC6749</a>]</span> specification does not mandate any specific format for access tokens. 
---
>                 <span><a href="#RFC6749" class="internal xref">OAuth 2.0 Authorization Framework</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> specification does not mandate any specific format for access tokens. 
1401c1420
<                 <span><a href="#RFC7519" class="xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="xref">RFC7519</a>]</span> format.<a href="#section-1-1" class="pilcrow">¶</a></p>
---
>                 <span><a href="#RFC7519" class="internal xref">JSON Web Token (JWT)</a> [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> format.<a href="#section-1-1" class="pilcrow">¶</a></p>
1409,1410c1428,1429
<                 <span><a href="#RFC8707" class="xref">resource indicators</a> [<a href="#RFC8707" class="xref">RFC8707</a>]</span>, 
<                 <span><a href="#RFC6750" class="xref">OAuth 2.0 bearer token usage</a> [<a href="#RFC6750" class="xref">RFC6750</a>]</span>, and others) postulate the presence of scoping mechanisms, such as an audience, in access tokens. 
---
>                 <span><a href="#RFC8707" class="internal xref">resource indicators</a> [<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>, 
>                 <span><a href="#RFC6750" class="internal xref">OAuth 2.0 bearer token usage</a> [<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>, and others) postulate the presence of scoping mechanisms, such as an audience, in access tokens. 
1422c1441
<         Please note: Although both this document and <span>[<a href="#RFC7523" class="xref">RFC7523</a>]</span> use JSON Web Tokens in the context of the OAuth2 framework, the two specifications differ in both intent and mechanics. Whereas <span>[<a href="#RFC7523" class="xref">RFC7523</a>]</span> defines how a JWT Bearer Token can be used to request an access token, this document describes how to encode access tokens in JWT format.<a href="#section-1-6" class="pilcrow">¶</a></p>
---
>         Please note: Although both this document and <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> use JSON Web Tokens in the context of the OAuth2 framework, the two specifications differ in both intent and mechanics. Whereas <span>[<a href="#RFC7523" class="cite xref">RFC7523</a>]</span> defines how a JWT Bearer Token can be used to request an access token, this document describes how to encode access tokens in JWT format.<a href="#section-1-6" class="pilcrow">¶</a></p>
1431c1450
<     described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> 
---
>     described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
1462c1481
<                     <span><a href="#RFC6749" class="xref">The OAuth 2.0 Authorization Framework</a> [<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
---
>                     <span><a href="#RFC6749" class="internal xref">The OAuth 2.0 Authorization Framework</a> [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
1479,1480c1498,1499
<                     <a href="#JWTATLValidate" class="xref">Section 4</a>). JWT access tokens <span class="bcp14">MUST NOT</span> use "none" as the signing algorithm. See 
<                     <a href="#JWTATLValidate" class="xref">Section 4</a> for more details.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
---
>                     <a href="#JWTATLValidate" class="auto internal xref">Section 4</a>). JWT access tokens <span class="bcp14">MUST NOT</span> use "none" as the signing algorithm. See 
>                     <a href="#JWTATLValidate" class="auto internal xref">Section 4</a> for more details.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
1482c1501
<                 Authorization servers and resource servers conforming to this specification <span class="bcp14">MUST</span> include RS256 (as defined in <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>) among their supported signature algorithms.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
---
>                 Authorization servers and resource servers conforming to this specification <span class="bcp14">MUST</span> include RS256 (as defined in <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span>) among their supported signature algorithms.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
1487,1488c1506,1507
<    Per the definition of "typ" in <span><a href="https://www.rfc-editor.org/rfc/rfc7515#section-4.1.9" class="relref">Section 4.1.9</a> of [<a href="#RFC7515" class="xref">RFC7515</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the "application/" prefix be omitted.  Therefore, the "typ" value used <span class="bcp14">SHOULD</span> be "at+jwt".
<  See the <a href="#SecurityConsiderations" class="xref">Security Considerations</a> section for details on the importance of preventing OpenID Connect ID Tokens (as defined by Section 2 of <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>) from being accepted as access tokens by resource servers implementing this profile.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
---
>    Per the definition of "typ" in <span><a href="https://rfc-editor.org/rfc/rfc7515#section-4.1.9" class="relref">Section 4.1.9</a> of [<a href="#RFC7515" class="cite xref">RFC7515</a>]</span>, it is <span class="bcp14">RECOMMENDED</span> that the "application/" prefix be omitted.  Therefore, the "typ" value used <span class="bcp14">SHOULD</span> be "at+jwt".
>  See the <a href="#SecurityConsiderations" class="internal xref">Security Considerations</a> section for details on the importance of preventing OpenID Connect ID Tokens (as defined by Section 2 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) from being accepted as access tokens by resource servers implementing this profile.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
1501c1520
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.1" class="relref">Section 4.1.1</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
1506c1525
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.4" class="relref">Section 4.1.4</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.4" class="relref">Section 4.1.4</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
1511,1512c1530,1531
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>. See 
<                             <a href="#JWTATLRequest" class="xref">Section 3</a> for indications on how an authorization server should determine the value of "aud" depending on the request.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.3" class="relref">Section 4.1.3</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. See 
>                             <a href="#JWTATLRequest" class="auto internal xref">Section 3</a> for indications on how an authorization server should determine the value of "aud" depending on the request.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
1517c1536
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>. In cases of access tokens obtained through grants where a resource owner is involved, such as the authorization code grant, the value of "sub" <span class="bcp14">SHOULD</span> correspond to the subject identifier of the resource owner. In cases of access tokens obtained through grants where no resource owner is involved, such as the client credentials grant, the value of "sub" <span class="bcp14">SHOULD</span> correspond to an identifier the authorization server uses to indicate the client application. 
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>. In cases of access tokens obtained through grants where a resource owner is involved, such as the authorization code grant, the value of "sub" <span class="bcp14">SHOULD</span> correspond to the subject identifier of the resource owner. In cases of access tokens obtained through grants where no resource owner is involved, such as the client credentials grant, the value of "sub" <span class="bcp14">SHOULD</span> correspond to an identifier the authorization server uses to indicate the client application. 
1519,1520c1538,1539
<                             <a href="#SecurityConsiderations" class="xref">Section 5</a> for more details on this scenario. Also, see 
<                             <a href="#PrivacyConsiderations" class="xref">Section 6</a> for a discussion about how different choices in assigning "sub" values can impact privacy.<a href="#section-2.2-2.8" class="pilcrow">¶</a>
---
>                             <a href="#SecurityConsiderations" class="auto internal xref">Section 5</a> for more details on this scenario. Also, see 
>                             <a href="#PrivacyConsiderations" class="auto internal xref">Section 6</a> for a discussion about how different choices in assigning "sub" values can impact privacy.<a href="#section-2.2-2.8" class="pilcrow">¶</a>
1525c1544
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc8693#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8693" class="xref">RFC8693</a>]</span>.<a href="#section-2.2-2.10" class="pilcrow">¶</a>
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc8693#section-4.3" class="relref">Section 4.3</a> of [<a href="#RFC8693" class="cite xref">RFC8693</a>]</span>.<a href="#section-2.2-2.10" class="pilcrow">¶</a>
1530c1549
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.6" class="relref">Section 4.1.6</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>.
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.6" class="relref">Section 4.1.6</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.
1536c1555
<             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.1.7" class="relref">Section 4.1.7</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-2.2-2.14" class="pilcrow">¶</a>
---
>             <span class="bcp14">REQUIRED</span> - as defined in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-4.1.7" class="relref">Section 4.1.7</a> of [<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-2.2-2.14" class="pilcrow">¶</a>
1547c1566
<                         <span>[<a href="#RFC8693" class="xref">RFC8693</a>]</span> procedures).<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
---
>                         <span>[<a href="#RFC8693" class="cite xref">RFC8693</a>]</span> procedures).<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
1552c1571
<                                 <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.2" class="pilcrow">¶</a>
---
>                                 <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.2" class="pilcrow">¶</a>
1558c1577
<                                 <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.4" class="pilcrow">¶</a>
---
>                                 <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.4" class="pilcrow">¶</a>
1564c1583
<                                 <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.6" class="pilcrow">¶</a>
---
>                                 <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-2.2.1-2.6" class="pilcrow">¶</a>
1576c1595
<  In the context of authorization grants involving the resource owner, commercial authorization servers will often include resource owner attributes directly in access tokens so that resource servers can consume them directly for authorization or other purposes without any further round trips to introspection (<span>[<a href="#RFC7662" class="xref">RFC7662</a>]</span>) or UserInfo (<span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>) endpoints.
---
>  In the context of authorization grants involving the resource owner, commercial authorization servers will often include resource owner attributes directly in access tokens so that resource servers can consume them directly for authorization or other purposes without any further round trips to introspection (<span>[<a href="#RFC7662" class="cite xref">RFC7662</a>]</span>) or UserInfo (<span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>) endpoints.
1580,1581c1599,1600
<                     Any additional identity attribute whose semantic is well described by an entry in the "JSON Web Token (JWT)" IANA registry introduced in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> <span class="bcp14">SHOULD</span> be encoded using the corresponding claim name, if that attribute is to be included in the JWT access token. Note that the JWT IANA registry includes the claims found in Section 5.1 of <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>.<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
< <p id="section-2.2.2-4">Authorization servers <span class="bcp14">MAY</span> return arbitrary attributes not defined in any existing specification, as long as the corresponding claim names are collision resistant or the access tokens are meant to be used only within a private subsystem. Please refer to Sections <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.2" class="relref">4.2</a> and <a href="https://www.rfc-editor.org/rfc/rfc7519#section-4.3" class="relref">4.3</a> of <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> for details.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
---
>                     Any additional identity attribute whose semantic is well described by an entry in the "JSON Web Token (JWT)" IANA registry introduced in <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> <span class="bcp14">SHOULD</span> be encoded using the corresponding claim name, if that attribute is to be included in the JWT access token. Note that the JWT IANA registry includes the claims found in Section 5.1 of <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>.<a href="#section-2.2.2-3" class="pilcrow">¶</a></p>
> <p id="section-2.2.2-4">Authorization servers <span class="bcp14">MAY</span> return arbitrary attributes not defined in any existing specification, as long as the corresponding claim names are collision resistant or the access tokens are meant to be used only within a private subsystem. Please refer to Sections <a href="https://rfc-editor.org/rfc/rfc7519#section-4.2" class="relref">4.2</a> and <a href="https://rfc-editor.org/rfc/rfc7519#section-4.3" class="relref">4.3</a> of <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> for details.<a href="#section-2.2.2-4" class="pilcrow">¶</a></p>
1586c1605
<                         <a href="#PrivacyConsiderations" class="xref">Section 6</a>.<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
---
>                         <a href="#PrivacyConsiderations" class="auto internal xref">Section 6</a>.<a href="#section-2.2.2-5" class="pilcrow">¶</a></p>
1595c1614
<  If an authorization request includes a scope parameter, the corresponding issued JWT access token <span class="bcp14">SHOULD</span> include a "scope" claim as defined in  <span><a href="https://www.rfc-editor.org/rfc/rfc8693#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8693" class="xref">RFC8693</a>]</span>.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
---
>  If an authorization request includes a scope parameter, the corresponding issued JWT access token <span class="bcp14">SHOULD</span> include a "scope" claim as defined in  <span><a href="https://rfc-editor.org/rfc/rfc8693#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC8693" class="cite xref">RFC8693</a>]</span>.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
1598c1617
<                         <a href="#SecurityConsiderations" class="xref">Section 5</a> for more considerations about the relationship between scope strings and resources indicated by the "aud" claim.<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
---
>                         <a href="#SecurityConsiderations" class="auto internal xref">Section 5</a> for more considerations about the relationship between scope strings and resources indicated by the "aud" claim.<a href="#section-2.2.3-2" class="pilcrow">¶</a></p>
1606c1625
<                             <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> in the access tokens they issue. Typical examples include resource owner memberships in roles and groups that are relevant to the resource being accessed, entitlements assigned to the resource owner for the targeted resource that the authorization server knows about, and so on.<a href="#section-2.2.3.1-1" class="pilcrow">¶</a></p>
---
>                             <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span> in the access tokens they issue. Typical examples include resource owner memberships in roles and groups that are relevant to the resource being accessed, entitlements assigned to the resource owner for the targeted resource that the authorization server knows about, and so on.<a href="#section-2.2.3.1-1" class="pilcrow">¶</a></p>
1608c1627
< An authorization server wanting to include such attributes in a JWT access token <span class="bcp14">SHOULD</span> use the "groups", "roles", and "entitlements" attributes of the "User" resource schema defined by <span><a href="https://www.rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="xref">RFC7643</a>]</span>) as claim types.<a href="#section-2.2.3.1-2" class="pilcrow">¶</a></p>
---
> An authorization server wanting to include such attributes in a JWT access token <span class="bcp14">SHOULD</span> use the "groups", "roles", and "entitlements" attributes of the "User" resource schema defined by <span><a href="https://rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="cite xref">RFC7643</a>]</span>) as claim types.<a href="#section-2.2.3.1-2" class="pilcrow">¶</a></p>
1610c1629
< Authorization servers <span class="bcp14">SHOULD</span> encode the corresponding claim values according to the guidance defined in <span>[<a href="#RFC7643" class="xref">RFC7643</a>]</span>. In particular, a non-normative example of a "groups" attribute can be found in <span><a href="https://www.rfc-editor.org/rfc/rfc7643#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7643" class="xref">RFC7643</a>]</span>. No specific vocabulary is provided for "roles" and "entitlements".<a href="#section-2.2.3.1-3" class="pilcrow">¶</a></p>
---
> Authorization servers <span class="bcp14">SHOULD</span> encode the corresponding claim values according to the guidance defined in <span>[<a href="#RFC7643" class="cite xref">RFC7643</a>]</span>. In particular, a non-normative example of a "groups" attribute can be found in <span><a href="https://rfc-editor.org/rfc/rfc7643#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7643" class="cite xref">RFC7643</a>]</span>. No specific vocabulary is provided for "roles" and "entitlements".<a href="#section-2.2.3.1-3" class="pilcrow">¶</a></p>
1612,1613c1631,1632
<                             <a href="#IANAClaimsContent" class="xref">Section 7.2.1</a> of this document provides entries for registering "groups", "roles", and "entitlements" attributes from 
<                             <span>[<a href="#RFC7643" class="xref">RFC7643</a>]</span> as claim types to be used in this profile.<a href="#section-2.2.3.1-4" class="pilcrow">¶</a></p>
---
>                             <a href="#IANAClaimsContent" class="auto internal xref">Section 7.2.1</a> of this document provides entries for registering "groups", "roles", and "entitlements" attributes from 
>                             <span>[<a href="#RFC7643" class="cite xref">RFC7643</a>]</span> as claim types to be used in this profile.<a href="#section-2.2.3.1-4" class="pilcrow">¶</a></p>
1629c1648
<                 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> and subsequent extensions meant to result in an access token.<a href="#section-3-1" class="pilcrow">¶</a></p>
---
>                 <span>[<a href="#RFC6749" class="cite xref">RFC6749</a>]</span> and subsequent extensions meant to result in an access token.<a href="#section-3-1" class="pilcrow">¶</a></p>
1631c1650
<                 <span>[<a href="#RFC8707" class="xref">RFC8707</a>]</span>), the resulting JWT access token "aud" claim <span class="bcp14">SHOULD</span> have the same value as the "resource" parameter in the request.<a href="#section-3-2" class="pilcrow">¶</a></p>
---
>                 <span>[<a href="#RFC8707" class="cite xref">RFC8707</a>]</span>), the resulting JWT access token "aud" claim <span class="bcp14">SHOULD</span> have the same value as the "resource" parameter in the request.<a href="#section-3-2" class="pilcrow">¶</a></p>
1635,1636c1654,1655
<         <div id="section-3-4.1">
< <pre class="sourcecode">
---
>         <div class="sourcecode" id="section-3-4.1">
> <pre>
1654,1655c1673,1674
<         <div id="section-3-6.1">
< <pre class="lang-json sourcecode">
---
>         <div class="lang-json sourcecode" id="section-3-6.1">
> <pre>
1681c1700
<                 <a href="#SecurityConsiderations" class="xref">Section 5</a> for more details about common cases that might lead to ambiguity and strategies an authorization server can enact to prevent them.<a href="#section-3-7" class="pilcrow">¶</a></p>
---
>                 <a href="#SecurityConsiderations" class="auto internal xref">Section 5</a> for more details about common cases that might lead to ambiguity and strategies an authorization server can enact to prevent them.<a href="#section-3-7" class="pilcrow">¶</a></p>
1683c1702
<  If the request does not include a "resource" parameter, the authorization server <span class="bcp14">MUST</span> use a default resource indicator in the "aud" claim. If a "scope" parameter is present in the request, the authorization server <span class="bcp14">SHOULD</span> use it to infer the value of the default resource indicator to be used in the "aud" claim. The mechanism through which scopes are associated with default resource indicator values is outside the scope of this specification. If the values in the "scope" parameter refer to different default resource indicator values, the authorization server <span class="bcp14">SHOULD</span> reject the request with "invalid_scope" as described in <span><a href="https://www.rfc-editor.org/rfc/rfc6749#section-4.1.2.1" class="relref">Section 4.1.2.1</a> of [<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-3-8" class="pilcrow">¶</a></p>
---
>  If the request does not include a "resource" parameter, the authorization server <span class="bcp14">MUST</span> use a default resource indicator in the "aud" claim. If a "scope" parameter is present in the request, the authorization server <span class="bcp14">SHOULD</span> use it to infer the value of the default resource indicator to be used in the "aud" claim. The mechanism through which scopes are associated with default resource indicator values is outside the scope of this specification. If the values in the "scope" parameter refer to different default resource indicator values, the authorization server <span class="bcp14">SHOULD</span> reject the request with "invalid_scope" as described in <span><a href="https://rfc-editor.org/rfc/rfc6749#section-4.1.2.1" class="relref">Section 4.1.2.1</a> of [<a href="#RFC6749" class="cite xref">RFC6749</a>]</span>.<a href="#section-3-8" class="pilcrow">¶</a></p>
1695,1696c1714,1715
<                 <span><a href="#RFC8414" class="xref">OAuth 2.0 Authorization Server Metadata</a> [<a href="#RFC8414" class="xref">RFC8414</a>]</span> to advertise to resource servers their signing keys via "jwks_uri" and what "iss" claim value to expect 
<                 via the "issuer" metadata value. Alternatively, authorization servers implementing OpenID Connect <span class="bcp14">MAY</span> use the <span><a href="#OpenID.Discovery" class="xref">OpenID Connect discovery</a> [<a href="#OpenID.Discovery" class="xref">OpenID.Discovery</a>]</span> document for the same purpose. If an authorization server supports both OAuth 2.0 Authorization Server Metadata and OpenID Connect discovery, the values provided <span class="bcp14">MUST</span> be consistent across the two publication methods.<a href="#section-4-2" class="pilcrow">¶</a></p>
---
>                 <span><a href="#RFC8414" class="internal xref">OAuth 2.0 Authorization Server Metadata</a> [<a href="#RFC8414" class="cite xref">RFC8414</a>]</span> to advertise to resource servers their signing keys via "jwks_uri" and what "iss" claim value to expect 
>                 via the "issuer" metadata value. Alternatively, authorization servers implementing OpenID Connect <span class="bcp14">MAY</span> use the <span><a href="#OpenID.Discovery" class="internal xref">OpenID Connect discovery</a> [<a href="#OpenID.Discovery" class="cite xref">OpenID.Discovery</a>]</span> document for the same purpose. If an authorization server supports both OAuth 2.0 Authorization Server Metadata and OpenID Connect discovery, the values provided <span class="bcp14">MUST</span> be consistent across the two publication methods.<a href="#section-4-2" class="pilcrow">¶</a></p>
1699c1718
<                 <a href="#SecurityConsiderations" class="xref">Section 5</a> for further guidance on security implications.<a href="#section-4-3" class="pilcrow">¶</a></p>
---
>                 <a href="#SecurityConsiderations" class="auto internal xref">Section 5</a> for further guidance on security implications.<a href="#section-4-3" class="pilcrow">¶</a></p>
1720c1739
<                         <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> using the algorithm specified in the JWT "alg" Header Parameter. The resource server <span class="bcp14">MUST</span> reject any JWT in which the value of "alg" is "none". The resource server <span class="bcp14">MUST</span> use the keys provided by the authorization server.<a href="#section-4-5.5" class="pilcrow">¶</a>
---
>                         <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> using the algorithm specified in the JWT "alg" Header Parameter. The resource server <span class="bcp14">MUST</span> reject any JWT in which the value of "alg" is "none". The resource server <span class="bcp14">MUST</span> use the keys provided by the authorization server.<a href="#section-4-5.5" class="pilcrow">¶</a>
1727c1746
<             The resource server <span class="bcp14">MUST</span> handle errors as described in <span><a href="https://www.rfc-editor.org/rfc/rfc6750#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC6750" class="xref">RFC6750</a>]</span>. In particular, in case of any failure in the validation checks listed above, the authorization server response <span class="bcp14">MUST</span> include the error code "invalid_token".
---
>             The resource server <span class="bcp14">MUST</span> handle errors as described in <span><a href="https://rfc-editor.org/rfc/rfc6750#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC6750" class="cite xref">RFC6750</a>]</span>. In particular, in case of any failure in the validation checks listed above, the authorization server response <span class="bcp14">MUST</span> include the error code "invalid_token".
1732c1751
<                 <a href="#AuthorizationClaims" class="xref">Section 2.2.3</a>, the resource server <span class="bcp14">SHOULD</span> use them in combination with any other contextual information available to determine whether the current call should be authorized or rejected. Details about how a resource server performs those checks is beyond the scope of this profile specification.<a href="#section-4-7" class="pilcrow">¶</a></p>
---
>                 <a href="#AuthorizationClaims" class="auto internal xref">Section 2.2.3</a>, the resource server <span class="bcp14">SHOULD</span> use them in combination with any other contextual information available to determine whether the current call should be authorized or rejected. Details about how a resource server performs those checks is beyond the scope of this profile specification.<a href="#section-4-7" class="pilcrow">¶</a></p>
1742,1743c1761,1762
<                 <span>[<a href="#OpenID.Core" class="xref">OpenID.Core</a>]</span>. The explicit typing required in this profile, in line with the recommendations in 
<                 <span>[<a href="#RFC8725" class="xref">RFC8725</a>]</span>, helps the resource server to distinguish between JWT access tokens and OpenID Connect ID Tokens.<a href="#section-5-1" class="pilcrow">¶</a></p>
---
>                 <span>[<a href="#OpenID.Core" class="cite xref">OpenID.Core</a>]</span>. The explicit typing required in this profile, in line with the recommendations in 
>                 <span>[<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>, helps the resource server to distinguish between JWT access tokens and OpenID Connect ID Tokens.<a href="#section-5-1" class="pilcrow">¶</a></p>
1747c1766
<  For more details, please refer to <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-18#section-4.14" class="relref">Section 4.14</a> of [<a href="#I-D.ietf-oauth-security-topics" class="xref">OAuth2.Security.BestPractices</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
---
>  For more details, please refer to <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-oauth-security-topics-18#section-4.14" class="relref">Section 4.14</a> of [<a href="#I-D.ietf-oauth-security-topics" class="cite xref">OAuth2.Security.BestPractices</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
1749c1768
< To prevent cross-JWT confusion, authorization servers <span class="bcp14">MUST</span> use a distinct identifier as an "aud" claim value to uniquely identify access tokens issued by the same issuer for distinct resources. For more details on cross-JWT confusion, please refer to <span><a href="https://www.rfc-editor.org/rfc/rfc8725#section-2.8" class="relref">Section 2.8</a> of [<a href="#RFC8725" class="xref">RFC8725</a>]</span>.<a href="#section-5-3" class="pilcrow">¶</a></p>
---
> To prevent cross-JWT confusion, authorization servers <span class="bcp14">MUST</span> use a distinct identifier as an "aud" claim value to uniquely identify access tokens issued by the same issuer for distinct resources. For more details on cross-JWT confusion, please refer to <span><a href="https://rfc-editor.org/rfc/rfc8725#section-2.8" class="relref">Section 2.8</a> of [<a href="#RFC8725" class="cite xref">RFC8725</a>]</span>.<a href="#section-5-3" class="pilcrow">¶</a></p>
1776c1795
<             For example, a user might not wish to consent to granting given resource server information about any of the non-mandatory claims enumerated in <a href="#JWTATLayout" class="xref">Section 2</a> (and its subsections).<a href="#section-6-5" class="pilcrow">¶</a></p>
---
>             For example, a user might not wish to consent to granting given resource server information about any of the non-mandatory claims enumerated in <a href="#JWTATLayout" class="auto internal xref">Section 2</a> (and its subsections).<a href="#section-6-5" class="pilcrow">¶</a></p>
1801,1802c1820,1821
<      This section registers "application/at+jwt", a new media type <span>[<a href="#RFC2046" class="xref">RFC2046</a>]</span> in the "Media Types" registry <span>[<a href="#IANA.MediaTypes" class="xref">IANA.MediaTypes</a>]</span> in the
<    manner described in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>. It can be used to indicate that the
---
>      This section registers "application/at+jwt", a new media type <span>[<a href="#RFC2046" class="cite xref">RFC2046</a>]</span> in the "Media Types" registry <span>[<a href="#IANA.MediaTypes" class="cite xref">IANA.MediaTypes</a>]</span> in the
>    manner described in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>. It can be used to indicate that the
1903,1904c1922,1923
<                         <a href="#NDAuthorizationClaims" class="xref">Section 2.2.3.1</a> of this specification refers to the attributes "roles", "groups", "entitlements" defined in 
<                         <span>[<a href="#RFC7643" class="xref">RFC7643</a>]</span> to express authorization information in JWT access tokens.
---
>                         <a href="#NDAuthorizationClaims" class="auto internal xref">Section 2.2.3.1</a> of this specification refers to the attributes "roles", "groups", "entitlements" defined in 
>                         <span>[<a href="#RFC7643" class="cite xref">RFC7643</a>]</span> to express authorization information in JWT access tokens.
1906c1925
<                         <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
---
>                         <span>[<a href="#RFC7519" class="cite xref">RFC7519</a>]</span>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
1932c1951
<                 <span><a href="https://www.rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.1-1.8" class="pilcrow">¶</a>
---
>                 <span><a href="https://rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="cite xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="auto internal xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.1-1.8" class="pilcrow">¶</a>
1958c1977
<                 <span><a href="https://www.rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.2-1.8" class="pilcrow">¶</a>
---
>                 <span><a href="https://rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="cite xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="auto internal xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.2-1.8" class="pilcrow">¶</a>
1984c2003
<                 <span><a href="https://www.rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.3-1.8" class="pilcrow">¶</a>
---
>                 <span><a href="https://rfc-editor.org/rfc/rfc7643#section-4.1.2" class="relref">Section 4.1.2</a> of [<a href="#RFC7643" class="cite xref">RFC7643</a>]</span> and <a href="#NDAuthorizationClaims" class="auto internal xref">Section 2.2.3.1</a> of RFC 9068<a href="#section-7.2.1.3-1.8" class="pilcrow">¶</a>
