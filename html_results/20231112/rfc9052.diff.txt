15c15
< <meta content="xml2rfc 3.14.2" name="generator">
---
> <meta content="xml2rfc 3.18.2" name="generator">
21,26c21,24
<   xml2rfc 3.14.2
<     Python 3.9.13
<     appdirs 1.4.4
<     ConfigArgParse 1.5.3
<     google-i18n-address 2.5.1
<     html5lib 1.1
---
>   xml2rfc 3.18.2
>     Python 3.11.6
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
29,31c27,28
<     kitchen 1.2.6
<     lxml 4.9.0
<     MarkupSafe 2.1.1
---
>     lxml 4.9.3
>     platformdirs 4.0.0
33,35c30,32
<     PyYAML 6.0
<     requests 2.28.0
<     setuptools 44.1.1
---
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
37c34
<     weasyprint 56.1
---
>     wcwidth 0.2.9
39c36
< <link href="rfc9052.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc9052.xml" rel="alternate" type="application/rfc+xml">
49c46
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
58a56,61
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
61d63
<   width: extend-to-zoom;
76c78
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
78a81
>   overflow-wrap: break-word;
164a168,176
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
248c260,261
< a[href].selfRef {
---
> a[href].selfRef,
> .iref + a[href].internal {
258c271
< tt, code, pre, code {
---
> tt, code, pre {
260c273
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
299a313,315
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
497c513
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
637d652
< 
660c675
<   pre.breakable {
---
>   .breakable pre {
730c745
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
830c845
< tt, code, pre, code {
---
> tt, code, pre {
835c850
< pre.sourcecode,
---
> .sourcecode pre,
871c886
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1052a1068
>   .artwork > pre,
1067c1083
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1127c1143
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1152c1168
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1170c1186
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1184c1200
< li > p:last-of-type {
---
> li > p:last-of-type:only-child {
1188a1205
> <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-rfc8152bis-struct-15" rel="prev">
1191c1208
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-cose-rfc8152bis-struct-15" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1193,1194c1210,1211
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1291c1308
<             <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
---
>             <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
1294c1311
<                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-terminology" class="xref">Requirements Terminology</a></p>
---
>                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-requirements-terminology" class="internal xref">Requirements Terminology</a></p>
1297c1314
<                 <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-changes-from-rfc-8152" class="xref">Changes from RFC 8152</a></p>
---
>                 <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-changes-from-rfc-8152" class="internal xref">Changes from RFC 8152</a></p>
1300c1317
<                 <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-design-changes-from-jose" class="xref">Design Changes from JOSE</a></p>
---
>                 <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-design-changes-from-jose" class="internal xref">Design Changes from JOSE</a></p>
1303c1320
<                 <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-cddl-grammar-for-cbor-data-" class="xref">CDDL Grammar for CBOR Data Structures</a></p>
---
>                 <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-cddl-grammar-for-cbor-data-" class="internal xref">CDDL Grammar for CBOR Data Structures</a></p>
1306c1323
<                 <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-cbor-related-terminology" class="xref">CBOR-Related Terminology</a></p>
---
>                 <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-cbor-related-terminology" class="internal xref">CBOR-Related Terminology</a></p>
1309c1326
<                 <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="xref">1.6</a>.  <a href="#name-document-terminology" class="xref">Document Terminology</a></p>
---
>                 <p id="section-toc.1-1.1.2.6.1"><a href="#section-1.6" class="auto internal xref">1.6</a>.  <a href="#name-document-terminology" class="internal xref">Document Terminology</a></p>
1314c1331
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-basic-cose-structure" class="xref">Basic COSE Structure</a></p>
---
>             <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-basic-cose-structure" class="internal xref">Basic COSE Structure</a></p>
1317c1334
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-header-parameters" class="xref">Header Parameters</a></p>
---
>             <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-header-parameters" class="internal xref">Header Parameters</a></p>
1320c1337
<                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-common-cose-header-paramete" class="xref">Common COSE Header Parameters</a></p>
---
>                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-common-cose-header-paramete" class="internal xref">Common COSE Header Parameters</a></p>
1325c1342
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-signing-objects" class="xref">Signing Objects</a></p>
---
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-signing-objects" class="internal xref">Signing Objects</a></p>
1328c1345
<                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-signing-with-one-or-more-si" class="xref">Signing with One or More Signers</a></p>
---
>                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-signing-with-one-or-more-si" class="internal xref">Signing with One or More Signers</a></p>
1331c1348
<                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-signing-with-one-signer" class="xref">Signing with One Signer</a></p>
---
>                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-signing-with-one-signer" class="internal xref">Signing with One Signer</a></p>
1334c1351
<                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-externally-supplied-data" class="xref">Externally Supplied Data</a></p>
---
>                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-externally-supplied-data" class="internal xref">Externally Supplied Data</a></p>
1337c1354
<                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-signing-and-verification-pr" class="xref">Signing and Verification Process</a></p>
---
>                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-signing-and-verification-pr" class="internal xref">Signing and Verification Process</a></p>
1342c1359
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-encryption-objects" class="xref">Encryption Objects</a></p>
---
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-encryption-objects" class="internal xref">Encryption Objects</a></p>
1345c1362
<                 <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-enveloped-cose-structure" class="xref">Enveloped COSE Structure</a></p>
---
>                 <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-enveloped-cose-structure" class="internal xref">Enveloped COSE Structure</a></p>
1348c1365
<                     <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-content-key-distribution-me" class="xref">Content Key Distribution Methods</a></p>
---
>                     <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-content-key-distribution-me" class="internal xref">Content Key Distribution Methods</a></p>
1353c1370
<                 <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-single-recipient-encrypted" class="xref">Single Recipient Encrypted</a></p>
---
>                 <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-single-recipient-encrypted" class="internal xref">Single Recipient Encrypted</a></p>
1356c1373
<                 <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-how-to-encrypt-and-decrypt-" class="xref">How to Encrypt and Decrypt for AEAD Algorithms</a></p>
---
>                 <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-how-to-encrypt-and-decrypt-" class="internal xref">How to Encrypt and Decrypt for AEAD Algorithms</a></p>
1359c1376
<                 <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-how-to-encrypt-and-decrypt-f" class="xref">How to Encrypt and Decrypt for AE Algorithms</a></p>
---
>                 <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="auto internal xref">5.4</a>.  <a href="#name-how-to-encrypt-and-decrypt-f" class="internal xref">How to Encrypt and Decrypt for AE Algorithms</a></p>
1364c1381
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-mac-objects" class="xref">MAC Objects</a></p>
---
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-mac-objects" class="internal xref">MAC Objects</a></p>
1367c1384
<                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-maced-message-with-recipien" class="xref">MACed Message with Recipients</a></p>
---
>                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-maced-message-with-recipien" class="internal xref">MACed Message with Recipients</a></p>
1370c1387
<                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-maced-messages-with-implici" class="xref">MACed Messages with Implicit Key</a></p>
---
>                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-maced-messages-with-implici" class="internal xref">MACed Messages with Implicit Key</a></p>
1373c1390
<                 <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-how-to-compute-and-verify-a" class="xref">How to Compute and Verify a MAC</a></p>
---
>                 <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-how-to-compute-and-verify-a" class="internal xref">How to Compute and Verify a MAC</a></p>
1378c1395
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-key-objects" class="xref">Key Objects</a></p>
---
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-key-objects" class="internal xref">Key Objects</a></p>
1381c1398
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-cose-key-common-parameters" class="xref">COSE Key Common Parameters</a></p>
---
>                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-cose-key-common-parameters" class="internal xref">COSE Key Common Parameters</a></p>
1386c1403
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-taxonomy-of-algorithms-used" class="xref">Taxonomy of Algorithms Used by COSE</a></p>
---
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-taxonomy-of-algorithms-used" class="internal xref">Taxonomy of Algorithms Used by COSE</a></p>
1389c1406
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-signature-algorithms" class="xref">Signature Algorithms</a></p>
---
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-signature-algorithms" class="internal xref">Signature Algorithms</a></p>
1392c1409
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-message-authentication-code" class="xref">Message Authentication Code (MAC) Algorithms</a></p>
---
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-message-authentication-code" class="internal xref">Message Authentication Code (MAC) Algorithms</a></p>
1395c1412
<                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-content-encryption-algorith" class="xref">Content Encryption Algorithms</a></p>
---
>                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-content-encryption-algorith" class="internal xref">Content Encryption Algorithms</a></p>
1398c1415
<                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-key-derivation-functions-kd" class="xref">Key Derivation Functions (KDFs)</a></p>
---
>                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-key-derivation-functions-kd" class="internal xref">Key Derivation Functions (KDFs)</a></p>
1401c1418
<                 <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-content-key-distribution-met" class="xref">Content Key Distribution Methods</a></p>
---
>                 <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-content-key-distribution-met" class="internal xref">Content Key Distribution Methods</a></p>
1404c1421
<                     <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="xref">8.5.1</a>.  <a href="#name-direct-encryption" class="xref">Direct Encryption</a></p>
---
>                     <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-direct-encryption" class="internal xref">Direct Encryption</a></p>
1407c1424
<                     <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="xref">8.5.2</a>.  <a href="#name-key-wrap" class="xref">Key Wrap</a></p>
---
>                     <p id="section-toc.1-1.8.2.5.2.2.1"><a href="#section-8.5.2" class="auto internal xref">8.5.2</a>.  <a href="#name-key-wrap" class="internal xref">Key Wrap</a></p>
1410c1427
<                     <p id="section-toc.1-1.8.2.5.2.3.1"><a href="#section-8.5.3" class="xref">8.5.3</a>.  <a href="#name-key-transport" class="xref">Key Transport</a></p>
---
>                     <p id="section-toc.1-1.8.2.5.2.3.1"><a href="#section-8.5.3" class="auto internal xref">8.5.3</a>.  <a href="#name-key-transport" class="internal xref">Key Transport</a></p>
1413c1430
<                     <p id="section-toc.1-1.8.2.5.2.4.1"><a href="#section-8.5.4" class="xref">8.5.4</a>.  <a href="#name-direct-key-agreement" class="xref">Direct Key Agreement</a></p>
---
>                     <p id="section-toc.1-1.8.2.5.2.4.1"><a href="#section-8.5.4" class="auto internal xref">8.5.4</a>.  <a href="#name-direct-key-agreement" class="internal xref">Direct Key Agreement</a></p>
1416c1433
<                     <p id="section-toc.1-1.8.2.5.2.5.1"><a href="#section-8.5.5" class="xref">8.5.5</a>.  <a href="#name-key-agreement-with-key-wrap" class="xref">Key Agreement with Key Wrap</a></p>
---
>                     <p id="section-toc.1-1.8.2.5.2.5.1"><a href="#section-8.5.5" class="auto internal xref">8.5.5</a>.  <a href="#name-key-agreement-with-key-wrap" class="internal xref">Key Agreement with Key Wrap</a></p>
1423c1440
<             <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-cbor-encoding-restrictions" class="xref">CBOR Encoding Restrictions</a></p>
---
>             <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-cbor-encoding-restrictions" class="internal xref">CBOR Encoding Restrictions</a></p>
1426c1443
<             <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-application-profiling-consi" class="xref">Application Profiling Considerations</a></p>
---
>             <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-application-profiling-consi" class="internal xref">Application Profiling Considerations</a></p>
1429c1446
<             <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
---
>             <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
1432c1449
<                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-cose-header-parameters-regi" class="xref">COSE Header Parameters Registry</a></p>
---
>                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-cose-header-parameters-regi" class="internal xref">COSE Header Parameters Registry</a></p>
1435c1452
<                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-cose-key-common-parameters-" class="xref">COSE Key Common Parameters Registry</a></p>
---
>                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-cose-key-common-parameters-" class="internal xref">COSE Key Common Parameters Registry</a></p>
1438c1455
<                 <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-media-type-registrations" class="xref">Media Type Registrations</a></p>
---
>                 <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-media-type-registrations" class="internal xref">Media Type Registrations</a></p>
1441c1458
<                     <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="xref">11.3.1</a>.  <a href="#name-cose-security-message" class="xref">COSE Security Message</a></p>
---
>                     <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-cose-security-message" class="internal xref">COSE Security Message</a></p>
1444c1461
<                     <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-11.3.2" class="xref">11.3.2</a>.  <a href="#name-cose-key-media-type" class="xref">COSE Key Media Type</a></p>
---
>                     <p id="section-toc.1-1.11.2.3.2.2.1"><a href="#section-11.3.2" class="auto internal xref">11.3.2</a>.  <a href="#name-cose-key-media-type" class="internal xref">COSE Key Media Type</a></p>
1449c1466
<                 <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-coap-content-formats-regist" class="xref">CoAP Content-Formats Registry</a></p>
---
>                 <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="auto internal xref">11.4</a>.  <a href="#name-coap-content-formats-regist" class="internal xref">CoAP Content-Formats Registry</a></p>
1452c1469
<                 <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="xref">11.5</a>.  <a href="#name-cbor-tags-registry" class="xref">CBOR Tags Registry</a></p>
---
>                 <p id="section-toc.1-1.11.2.5.1"><a href="#section-11.5" class="auto internal xref">11.5</a>.  <a href="#name-cbor-tags-registry" class="internal xref">CBOR Tags Registry</a></p>
1455c1472
<                 <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="xref">11.6</a>.  <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a></p>
---
>                 <p id="section-toc.1-1.11.2.6.1"><a href="#section-11.6" class="auto internal xref">11.6</a>.  <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
1460c1477
<             <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
---
>             <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1463c1480
<             <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-references" class="xref">References</a></p>
---
>             <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
1466c1483
<                 <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
---
>                 <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1469c1486
<                 <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
---
>                 <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1474c1491
<             <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-guidelines-for-external-dat" class="xref">Guidelines for External Data Authentication of Algorithms</a></p>
---
>             <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-guidelines-for-external-dat" class="internal xref">Guidelines for External Data Authentication of Algorithms</a></p>
1477c1494
<             <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-two-layers-of-recipient-inf" class="xref">Two Layers of Recipient Information</a></p>
---
>             <p id="section-toc.1-1.15.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-two-layers-of-recipient-inf" class="internal xref">Two Layers of Recipient Information</a></p>
1480c1497
<             <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-examples" class="xref">Examples</a></p>
---
>             <p id="section-toc.1-1.16.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
1483c1500
<                 <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-examples-of-signed-messages" class="xref">Examples of Signed Messages</a></p>
---
>                 <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-examples-of-signed-messages" class="internal xref">Examples of Signed Messages</a></p>
1486c1503
<                     <p id="section-toc.1-1.16.2.1.2.1.1"><a href="#appendix-C.1.1" class="xref">C.1.1</a>.  <a href="#name-single-signature" class="xref">Single Signature</a></p>
---
>                     <p id="section-toc.1-1.16.2.1.2.1.1"><a href="#appendix-C.1.1" class="auto internal xref">C.1.1</a>.  <a href="#name-single-signature" class="internal xref">Single Signature</a></p>
1489c1506
<                     <p id="section-toc.1-1.16.2.1.2.2.1"><a href="#appendix-C.1.2" class="xref">C.1.2</a>.  <a href="#name-multiple-signers" class="xref">Multiple Signers</a></p>
---
>                     <p id="section-toc.1-1.16.2.1.2.2.1"><a href="#appendix-C.1.2" class="auto internal xref">C.1.2</a>.  <a href="#name-multiple-signers" class="internal xref">Multiple Signers</a></p>
1492c1509
<                     <p id="section-toc.1-1.16.2.1.2.3.1"><a href="#appendix-C.1.3" class="xref">C.1.3</a>.  <a href="#name-signature-with-criticality" class="xref">Signature with Criticality</a></p>
---
>                     <p id="section-toc.1-1.16.2.1.2.3.1"><a href="#appendix-C.1.3" class="auto internal xref">C.1.3</a>.  <a href="#name-signature-with-criticality" class="internal xref">Signature with Criticality</a></p>
1497c1514
<                 <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-single-signer-examples" class="xref">Single Signer Examples</a></p>
---
>                 <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-single-signer-examples" class="internal xref">Single Signer Examples</a></p>
1500c1517
<                     <p id="section-toc.1-1.16.2.2.2.1.1"><a href="#appendix-C.2.1" class="xref">C.2.1</a>.  <a href="#name-single-ecdsa-signature" class="xref">Single ECDSA Signature</a></p>
---
>                     <p id="section-toc.1-1.16.2.2.2.1.1"><a href="#appendix-C.2.1" class="auto internal xref">C.2.1</a>.  <a href="#name-single-ecdsa-signature" class="internal xref">Single ECDSA Signature</a></p>
1505c1522
<                 <p id="section-toc.1-1.16.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-examples-of-enveloped-messa" class="xref">Examples of Enveloped Messages</a></p>
---
>                 <p id="section-toc.1-1.16.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-examples-of-enveloped-messa" class="internal xref">Examples of Enveloped Messages</a></p>
1508c1525
<                     <p id="section-toc.1-1.16.2.3.2.1.1"><a href="#appendix-C.3.1" class="xref">C.3.1</a>.  <a href="#name-direct-ecdh" class="xref">Direct ECDH</a></p>
---
>                     <p id="section-toc.1-1.16.2.3.2.1.1"><a href="#appendix-C.3.1" class="auto internal xref">C.3.1</a>.  <a href="#name-direct-ecdh" class="internal xref">Direct ECDH</a></p>
1511c1528
<                     <p id="section-toc.1-1.16.2.3.2.2.1"><a href="#appendix-C.3.2" class="xref">C.3.2</a>.  <a href="#name-direct-plus-key-derivation" class="xref">Direct Plus Key Derivation</a></p>
---
>                     <p id="section-toc.1-1.16.2.3.2.2.1"><a href="#appendix-C.3.2" class="auto internal xref">C.3.2</a>.  <a href="#name-direct-plus-key-derivation" class="internal xref">Direct Plus Key Derivation</a></p>
1514c1531
<                     <p id="section-toc.1-1.16.2.3.2.3.1"><a href="#appendix-C.3.3" class="xref">C.3.3</a>.  <a href="#name-encrypted-content-with-exte" class="xref">Encrypted Content with External Data</a></p>
---
>                     <p id="section-toc.1-1.16.2.3.2.3.1"><a href="#appendix-C.3.3" class="auto internal xref">C.3.3</a>.  <a href="#name-encrypted-content-with-exte" class="internal xref">Encrypted Content with External Data</a></p>
1519c1536
<                 <p id="section-toc.1-1.16.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-examples-of-encrypted-messa" class="xref">Examples of Encrypted Messages</a></p>
---
>                 <p id="section-toc.1-1.16.2.4.1"><a href="#appendix-C.4" class="auto internal xref">C.4</a>.  <a href="#name-examples-of-encrypted-messa" class="internal xref">Examples of Encrypted Messages</a></p>
1522c1539
<                     <p id="section-toc.1-1.16.2.4.2.1.1"><a href="#appendix-C.4.1" class="xref">C.4.1</a>.  <a href="#name-simple-encrypted-message" class="xref">Simple Encrypted Message</a></p>
---
>                     <p id="section-toc.1-1.16.2.4.2.1.1"><a href="#appendix-C.4.1" class="auto internal xref">C.4.1</a>.  <a href="#name-simple-encrypted-message" class="internal xref">Simple Encrypted Message</a></p>
1525c1542
<                     <p id="section-toc.1-1.16.2.4.2.2.1"><a href="#appendix-C.4.2" class="xref">C.4.2</a>.  <a href="#name-encrypted-message-with-a-pa" class="xref">Encrypted Message with a Partial IV</a></p>
---
>                     <p id="section-toc.1-1.16.2.4.2.2.1"><a href="#appendix-C.4.2" class="auto internal xref">C.4.2</a>.  <a href="#name-encrypted-message-with-a-pa" class="internal xref">Encrypted Message with a Partial IV</a></p>
1530c1547
<                 <p id="section-toc.1-1.16.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-examples-of-maced-messages" class="xref">Examples of MACed Messages</a></p>
---
>                 <p id="section-toc.1-1.16.2.5.1"><a href="#appendix-C.5" class="auto internal xref">C.5</a>.  <a href="#name-examples-of-maced-messages" class="internal xref">Examples of MACed Messages</a></p>
1533c1550
<                     <p id="section-toc.1-1.16.2.5.2.1.1"><a href="#appendix-C.5.1" class="xref">C.5.1</a>.  <a href="#name-shared-secret-direct-mac" class="xref">Shared Secret Direct MAC</a></p>
---
>                     <p id="section-toc.1-1.16.2.5.2.1.1"><a href="#appendix-C.5.1" class="auto internal xref">C.5.1</a>.  <a href="#name-shared-secret-direct-mac" class="internal xref">Shared Secret Direct MAC</a></p>
1536c1553
<                     <p id="section-toc.1-1.16.2.5.2.2.1"><a href="#appendix-C.5.2" class="xref">C.5.2</a>.  <a href="#name-ecdh-direct-mac" class="xref">ECDH Direct MAC</a></p>
---
>                     <p id="section-toc.1-1.16.2.5.2.2.1"><a href="#appendix-C.5.2" class="auto internal xref">C.5.2</a>.  <a href="#name-ecdh-direct-mac" class="internal xref">ECDH Direct MAC</a></p>
1539c1556
<                     <p id="section-toc.1-1.16.2.5.2.3.1"><a href="#appendix-C.5.3" class="xref">C.5.3</a>.  <a href="#name-wrapped-mac" class="xref">Wrapped MAC</a></p>
---
>                     <p id="section-toc.1-1.16.2.5.2.3.1"><a href="#appendix-C.5.3" class="auto internal xref">C.5.3</a>.  <a href="#name-wrapped-mac" class="internal xref">Wrapped MAC</a></p>
1542c1559
<                     <p id="section-toc.1-1.16.2.5.2.4.1"><a href="#appendix-C.5.4" class="xref">C.5.4</a>.  <a href="#name-multi-recipient-maced-messa" class="xref">Multi-Recipient MACed Message</a></p>
---
>                     <p id="section-toc.1-1.16.2.5.2.4.1"><a href="#appendix-C.5.4" class="auto internal xref">C.5.4</a>.  <a href="#name-multi-recipient-maced-messa" class="internal xref">Multi-Recipient MACed Message</a></p>
1547c1564
<                 <p id="section-toc.1-1.16.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-examples-of-mac0-messages" class="xref">Examples of MAC0 Messages</a></p>
---
>                 <p id="section-toc.1-1.16.2.6.1"><a href="#appendix-C.6" class="auto internal xref">C.6</a>.  <a href="#name-examples-of-mac0-messages" class="internal xref">Examples of MAC0 Messages</a></p>
1550c1567
<                     <p id="section-toc.1-1.16.2.6.2.1.1"><a href="#appendix-C.6.1" class="xref">C.6.1</a>.  <a href="#name-shared-secret-direct-mac-2" class="xref">Shared-Secret Direct MAC</a></p>
---
>                     <p id="section-toc.1-1.16.2.6.2.1.1"><a href="#appendix-C.6.1" class="auto internal xref">C.6.1</a>.  <a href="#name-shared-secret-direct-mac-2" class="internal xref">Shared-Secret Direct MAC</a></p>
1555c1572
<                 <p id="section-toc.1-1.16.2.7.1"><a href="#appendix-C.7" class="xref">C.7</a>.  <a href="#name-cose-keys" class="xref">COSE Keys</a></p>
---
>                 <p id="section-toc.1-1.16.2.7.1"><a href="#appendix-C.7" class="auto internal xref">C.7</a>.  <a href="#name-cose-keys" class="internal xref">COSE Keys</a></p>
1558c1575
<                     <p id="section-toc.1-1.16.2.7.2.1.1"><a href="#appendix-C.7.1" class="xref">C.7.1</a>.  <a href="#name-public-keys" class="xref">Public Keys</a></p>
---
>                     <p id="section-toc.1-1.16.2.7.2.1.1"><a href="#appendix-C.7.1" class="auto internal xref">C.7.1</a>.  <a href="#name-public-keys" class="internal xref">Public Keys</a></p>
1561c1578
<                     <p id="section-toc.1-1.16.2.7.2.2.1"><a href="#appendix-C.7.2" class="xref">C.7.2</a>.  <a href="#name-private-keys" class="xref">Private Keys</a></p>
---
>                     <p id="section-toc.1-1.16.2.7.2.2.1"><a href="#appendix-C.7.2" class="auto internal xref">C.7.2</a>.  <a href="#name-private-keys" class="internal xref">Private Keys</a></p>
1568c1585
<             <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
---
>             <p id="section-toc.1-1.17.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
1571c1588
<             <p id="section-toc.1-1.18.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
---
>             <p id="section-toc.1-1.18.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
1582,1583c1599,1600
< <p id="section-1-1">There has been an increased focus on small, constrained devices that make up the Internet of Things (IoT).  One of the standards that has come out of this process is "Concise Binary Object Representation (CBOR)" <span>[<a href="#STD94" class="xref">STD94</a>]</span>.  CBOR extended the data model of JavaScript Object Notation (JSON) <span>[<a href="#STD90" class="xref">STD90</a>]</span> by allowing for binary data, among other changes.  CBOR has been adopted by several of the IETF working groups dealing with the IoT world as their method of encoding data structures.  CBOR was designed specifically to be small in terms of both messages transported and implementation size and to have a schema-free decoder.  A need exists to provide message security services for IoT, and using CBOR as the message-encoding format makes sense.<a href="#section-1-1" class="pilcrow">¶</a></p>
< <p id="section-1-2">The JOSE Working Group produced a set of documents <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span> <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span> <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span> that specified how to process encryption, signatures, and Message Authentication Code (MAC) operations and how to encode keys using JSON.  This document defines the CBOR Object Signing and Encryption (COSE) standard, which does the same thing for the CBOR encoding format. This document is combined with  <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>, which provides an initial set of algorithms.   While there is a strong attempt to keep the flavor of the original JSON Object Signing and Encryption (JOSE) documents, two considerations are taken into account:<a href="#section-1-2" class="pilcrow">¶</a></p>
---
> <p id="section-1-1">There has been an increased focus on small, constrained devices that make up the Internet of Things (IoT).  One of the standards that has come out of this process is "Concise Binary Object Representation (CBOR)" <span>[<a href="#STD94" class="cite xref">STD94</a>]</span>.  CBOR extended the data model of JavaScript Object Notation (JSON) <span>[<a href="#STD90" class="cite xref">STD90</a>]</span> by allowing for binary data, among other changes.  CBOR has been adopted by several of the IETF working groups dealing with the IoT world as their method of encoding data structures.  CBOR was designed specifically to be small in terms of both messages transported and implementation size and to have a schema-free decoder.  A need exists to provide message security services for IoT, and using CBOR as the message-encoding format makes sense.<a href="#section-1-1" class="pilcrow">¶</a></p>
> <p id="section-1-2">The JOSE Working Group produced a set of documents <span>[<a href="#RFC7515" class="cite xref">RFC7515</a>]</span> <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span> <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> <span>[<a href="#RFC7518" class="cite xref">RFC7518</a>]</span> that specified how to process encryption, signatures, and Message Authentication Code (MAC) operations and how to encode keys using JSON.  This document defines the CBOR Object Signing and Encryption (COSE) standard, which does the same thing for the CBOR encoding format. This document is combined with  <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, which provides an initial set of algorithms.   While there is a strong attempt to keep the flavor of the original JSON Object Signing and Encryption (JOSE) documents, two considerations are taken into account:<a href="#section-1-2" class="pilcrow">¶</a></p>
1607c1624
<         Details on specific algorithms can be found in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span> and <span>[<a href="#RFC8230" class="xref">RFC8230</a>]</span>.
---
>         Details on specific algorithms can be found in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> and <span>[<a href="#RFC8230" class="cite xref">RFC8230</a>]</span>.
1610,1611c1627,1628
<         COSE was initially designed as part of a solution to provide security to Constrained RESTful Environments (CoRE), and this is done using <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">CORE-GROUPCOMM</a>]</span>.
<         However, COSE is not restricted to just these cases and can be used in any place where one would consider either JOSE or Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span> for the purpose of providing security services.
---
>         COSE was initially designed as part of a solution to provide security to Constrained RESTful Environments (CoRE), and this is done using <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="cite xref">CORE-GROUPCOMM</a>]</span>.
>         However, COSE is not restricted to just these cases and can be used in any place where one would consider either JOSE or Cryptographic Message Syntax (CMS) <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> for the purpose of providing security services.
1614c1631
<         <a href="#app-considerations" class="xref">Section 10</a> provides additional information on what applications need to specify when using COSE.<a href="#section-1-7" class="pilcrow">¶</a></p>
---
>         <a href="#app-considerations" class="auto internal xref">Section 10</a> provides additional information on what applications need to specify when using COSE.<a href="#section-1-7" class="pilcrow">¶</a></p>
1622c1639
<         <span>[<a href="#RFC9054" class="xref">RFC9054</a>]</span> contains one such possible structure and defines a set of digest algorithms.<a href="#section-1-8" class="pilcrow">¶</a></p>
---
>         <span>[<a href="#RFC9054" class="cite xref">RFC9054</a>]</span> contains one such possible structure and defines a set of digest algorithms.<a href="#section-1-8" class="pilcrow">¶</a></p>
1625c1642
<         Since the security properties that were described -- those of a true countersignature -- were those that the working group desired, the decision was made to remove all of the countersignature text from this document and create a new document <span>[<a href="#I-D.ietf-cose-countersign" class="xref">COSE-COUNTERSIGN</a>]</span> to both deprecate the old countersignature algorithm and header parameters and define a new algorithm and header parameters with the desired security properties.<a href="#section-1-9" class="pilcrow">¶</a></p>
---
>         Since the security properties that were described -- those of a true countersignature -- were those that the working group desired, the decision was made to remove all of the countersignature text from this document and create a new document <span>[<a href="#I-D.ietf-cose-countersign" class="cite xref">COSE-COUNTERSIGN</a>]</span> to both deprecate the old countersignature algorithm and header parameters and define a new algorithm and header parameters with the desired security properties.<a href="#section-1-9" class="pilcrow">¶</a></p>
1635c1652
<     as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
---
>     as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all
1644c1661
< <li class="normal" id="section-1.2-1.1">Split the original document into this document and <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.<a href="#section-1.2-1.1" class="pilcrow">¶</a>
---
> <li class="normal" id="section-1.2-1.1">Split the original document into this document and <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-1.2-1.1" class="pilcrow">¶</a>
1650c1667
<           <li class="normal" id="section-1.2-1.4">Removed all of the details relating to countersignatures and placed them in <span>[<a href="#I-D.ietf-cose-countersign" class="xref">COSE-COUNTERSIGN</a>]</span>.<a href="#section-1.2-1.4" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-1.2-1.4">Removed all of the details relating to countersignatures and placed them in <span>[<a href="#I-D.ietf-cose-countersign" class="cite xref">COSE-COUNTERSIGN</a>]</span>.<a href="#section-1.2-1.4" class="pilcrow">¶</a>
1684c1701
<           Language (CDDL) <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> had not yet been published
---
>           Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span> had not yet been published
1694c1711
<           An artifact of this is that the prose was written using the primitive-type strings defined by Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.
---
>           An artifact of this is that the prose was written using the primitive-type strings defined by Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.
1761,1762c1778,1779
< <div id="section-1.4-10">
< <pre class="lang-xpath sourcecode">
---
> <div class="lang-xpath sourcecode" id="section-1.4-10">
> <pre>
1767,1768c1784,1785
< <div id="section-1.4-12">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-1.4-12">
> <pre>
1788,1789c1805,1806
< <div id="section-1.5-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-1.5-4">
> <pre>
1809c1826
<  in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-1.6-2.4" class="pilcrow">¶</a>
---
>  in <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>.<a href="#section-1.6-2.4" class="pilcrow">¶</a>
1812c1829
< <dt id="section-1.6-2.5">Authenticated Encryption (AE) algorithms <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>:
---
> <dt id="section-1.6-2.5">Authenticated Encryption (AE) algorithms <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>:
1816c1833
<           An example of an AE algorithm used in COSE is AES Key Wrap <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span>.
---
>           An example of an AE algorithm used in COSE is AES Key Wrap <span>[<a href="#RFC3394" class="cite xref">RFC3394</a>]</span>.
1822c1839
< <dt id="section-1.6-2.7">AEAD algorithms <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>:</dt>
---
> <dt id="section-1.6-2.7">AEAD algorithms <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>:</dt>
1827c1844
<  algorithm used in COSE is AES-GCM <span>[<a href="#RFC5116" class="xref">RFC5116</a>]</span>. These
---
>  algorithm used in COSE is AES-GCM <span>[<a href="#RFC5116" class="cite xref">RFC5116</a>]</span>. These
1837,1838c1854,1855
<           The context to use can be implicit, identified using the "kid context" header parameter defined in <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, or identified by a protocol-specific identifier.
<           Context should generally be included in the cryptographic construction; for more details, see <a href="#Extern_AAD" class="xref">Section 4.3</a>.<a href="#section-1.6-3" class="pilcrow">¶</a></p>
---
>           The context to use can be implicit, identified using the "kid context" header parameter defined in <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, or identified by a protocol-specific identifier.
>           Context should generally be included in the cryptographic construction; for more details, see <a href="#Extern_AAD" class="auto internal xref">Section 4.3</a>.<a href="#section-1.6-3" class="pilcrow">¶</a></p>
1867c1884
< <p id="section-2-4">COSE messages are built using the concept of layers to separate different types of cryptographic concepts.  As an example of how this works, consider the COSE_Encrypt message (<a href="#EnvelopedData" class="xref">Section 5.1</a>).  This message type is broken into two layers: the content layer and the recipient layer.  The content layer contains the encrypted plaintext and information about the encrypted message.  The recipient layer contains the encrypted content encryption key (CEK) and information about how it is encrypted, for each recipient.  A single-layer version of the encryption message COSE_Encrypt0 (<a href="#EnvelopedData0" class="xref">Section 5.2</a>) is provided for cases where the CEK is preshared.<a href="#section-2-4" class="pilcrow">¶</a></p>
---
> <p id="section-2-4">COSE messages are built using the concept of layers to separate different types of cryptographic concepts.  As an example of how this works, consider the COSE_Encrypt message (<a href="#EnvelopedData" class="auto internal xref">Section 5.1</a>).  This message type is broken into two layers: the content layer and the recipient layer.  The content layer contains the encrypted plaintext and information about the encrypted message.  The recipient layer contains the encrypted content encryption key (CEK) and information about how it is encrypted, for each recipient.  A single-layer version of the encryption message COSE_Encrypt0 (<a href="#EnvelopedData0" class="auto internal xref">Section 5.2</a>) is provided for cases where the CEK is preshared.<a href="#section-2-4" class="pilcrow">¶</a></p>
1872c1889
<         <li id="section-2-6.2">The message type is identified by a CBOR tag.  Messages with a CBOR tag are known in this specification as tagged messages, while those without the CBOR tag are known as untagged messages.  This document defines a CBOR tag for each of the message structures.  These tags can be found in <a href="#CBOR-Tags" class="xref">Table 1</a>.<a href="#section-2-6.2" class="pilcrow">¶</a>
---
>         <li id="section-2-6.2">The message type is identified by a CBOR tag.  Messages with a CBOR tag are known in this specification as tagged messages, while those without the CBOR tag are known as untagged messages.  This document defines a CBOR tag for each of the message structures.  These tags can be found in <a href="#CBOR-Tags" class="auto internal xref">Table 1</a>.<a href="#section-2-6.2" class="pilcrow">¶</a>
1878c1895
<           The value to use with the parameter for each of the structures can be found in <a href="#CBOR-Tags" class="xref">Table 1</a>.<a href="#section-2-6.3" class="pilcrow">¶</a>
---
>           The value to use with the parameter for each of the structures can be found in <a href="#CBOR-Tags" class="auto internal xref">Table 1</a>.<a href="#section-2-6.3" class="pilcrow">¶</a>
1880c1897
<         <li id="section-2-6.4">When a COSE object is carried as a CoAP payload, the CoAP Content-Format Option can be used to identify the message content.  The CoAP Content-Format values can be found in <a href="#CoAP_content_type" class="xref">Table 2</a>.  The CBOR tag for the message structure is not required, as each security message is uniquely identified.<a href="#section-2-6.4" class="pilcrow">¶</a>
---
>         <li id="section-2-6.4">When a COSE object is carried as a CoAP payload, the CoAP Content-Format Option can be used to identify the message content.  The CoAP Content-Format values can be found in <a href="#CoAP_content_type" class="auto internal xref">Table 2</a>.  The CBOR tag for the message structure is not required, as each security message is uniquely identified.<a href="#section-2-6.4" class="pilcrow">¶</a>
2004,2005c2021,2022
< <div id="section-2-10">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-2-10">
> <pre>
2025c2042
< <p id="section-3-2">Both buckets are implemented as CBOR maps.  The map key is a "label" (<a href="#label" class="xref">Section 1.5</a>).  The value portion is dependent on the definition for the label.  Both maps use the same set of label/value pairs.  The integer and text-string values for labels have been divided into several sections, including a standard range, a private use range, and a range that is dependent on the algorithm selected.  The defined labels can be found in the "COSE Header Parameters" IANA registry (<a href="#cose-header-key-table" class="xref">Section 11.1</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
---
> <p id="section-3-2">Both buckets are implemented as CBOR maps.  The map key is a "label" (<a href="#label" class="auto internal xref">Section 1.5</a>).  The value portion is dependent on the definition for the label.  Both maps use the same set of label/value pairs.  The integer and text-string values for labels have been divided into several sections, including a standard range, a private use range, and a range that is dependent on the algorithm selected.  The defined labels can be found in the "COSE Header Parameters" IANA registry (<a href="#cose-header-key-table" class="auto internal xref">Section 11.1</a>).<a href="#section-3-2" class="pilcrow">¶</a></p>
2053c2070
<         The buckets are present in all of the security objects defined in this document.  The fields, in order, are the "protected" bucket (as a CBOR "bstr" type) and then the "unprotected" bucket (as a CBOR "map" type).  The presence of both buckets is required.  The header parameters that go into the buckets come from the IANA "COSE Header Parameters" registry (<a href="#cose-header-key-table" class="xref">Section 11.1</a>).
---
>         The buckets are present in all of the security objects defined in this document.  The fields, in order, are the "protected" bucket (as a CBOR "bstr" type) and then the "unprotected" bucket (as a CBOR "map" type).  The presence of both buckets is required.  The header parameters that go into the buckets come from the IANA "COSE Header Parameters" registry (<a href="#cose-header-key-table" class="auto internal xref">Section 11.1</a>).
2060,2061c2077,2078
< <div id="section-3-9">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-3-9">
> <pre>
2081c2098
< <p id="section-3.1-1">This section defines a set of common header parameters.  A summary of these header parameters can be found in <a href="#Header-Table" class="xref">Table 3</a>.  This table should be consulted to determine the value of the label and the type of the value.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.1-1">This section defines a set of common header parameters.  A summary of these header parameters can be found in <a href="#Header-Table" class="auto internal xref">Table 3</a>.  This table should be consulted to determine the value of the label and the type of the value.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
2085c2102
<           <dd style="margin-left: 1.5em" id="section-3.1-3.2">This header parameter is used to indicate the algorithm used for the security processing.  This header parameter <span class="bcp14">MUST</span> be authenticated where the ability to do so exists.  This support is provided by AEAD algorithms or construction (e.g., COSE_Sign and COSE_Mac0).  This authentication can be done either by placing the header parameter in the protected-header-parameters bucket or as part of the externally supplied data (<a href="#Extern_AAD" class="xref">Section 4.3</a>).  The value is taken from the "COSE Algorithms" registry (see <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>).<a href="#section-3.1-3.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-3.1-3.2">This header parameter is used to indicate the algorithm used for the security processing.  This header parameter <span class="bcp14">MUST</span> be authenticated where the ability to do so exists.  This support is provided by AEAD algorithms or construction (e.g., COSE_Sign and COSE_Mac0).  This authentication can be done either by placing the header parameter in the protected-header-parameters bucket or as part of the externally supplied data (<a href="#Extern_AAD" class="auto internal xref">Section 4.3</a>).  The value is taken from the "COSE Algorithms" registry (see <span>[<a href="#COSE.Algorithms" class="cite xref">COSE.Algorithms</a>]</span>).<a href="#section-3.1-3.2" class="pilcrow">¶</a>
2096c2113
<             signature" (label 7) defined by <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> must be
---
>             signature" (label 7) defined by <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span> must be
2133c2150
<           <dd style="margin-left: 1.5em" id="section-3.1-3.6">This header parameter is used to indicate the content type of the data in the "payload" or "ciphertext" field.  Integers are from the "CoAP Content-Formats" IANA registry table <span>[<a href="#COAP.Formats" class="xref">COAP.Formats</a>]</span>.  Text values follow the syntax of "&lt;type-name&gt;/&lt;subtype-name&gt;", where &lt;type-name&gt; and &lt;subtype-name&gt; are defined in <span><a href="https://www.rfc-editor.org/rfc/rfc6838#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC6838" class="xref">RFC6838</a>]</span>.  Leading and trailing whitespace is not permitted.  Textual content type values, along with parameters and subparameters, can be located using the IANA "Media Types" registry.  Applications <span class="bcp14">SHOULD</span> provide this header parameter if the content structure is potentially ambiguous.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-3.1-3.6">This header parameter is used to indicate the content type of the data in the "payload" or "ciphertext" field.  Integers are from the "CoAP Content-Formats" IANA registry table <span>[<a href="#COAP.Formats" class="cite xref">COAP.Formats</a>]</span>.  Text values follow the syntax of "&lt;type-name&gt;/&lt;subtype-name&gt;", where &lt;type-name&gt; and &lt;subtype-name&gt; are defined in <span><a href="https://rfc-editor.org/rfc/rfc6838#section-4.2" class="relref">Section 4.2</a> of [<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.  Leading and trailing whitespace is not permitted.  Textual content type values, along with parameters and subparameters, can be located using the IANA "Media Types" registry.  Applications <span class="bcp14">SHOULD</span> provide this header parameter if the content structure is potentially ambiguous.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
2225,2226c2242,2243
< <div id="section-3.1-6">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-3.1-6">
> <pre>
2253c2270
< <p id="section-4.1-2"><span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span> indicates that:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
---
> <p id="section-4.1-2"><span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> indicates that:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
2258c2275
< For example, the COSE_Sign structure might include signatures generated with the Edwards-curve Digital Signature Algorithm (EdDSA) <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and the Elliptic Curve Digital Signature Algorithm (ECDSA) <span>[<a href="#DSS" class="xref">DSS</a>]</span>.  This allows recipients to verify the signature associated with one algorithm or the other. More detailed information on multiple signature evaluations can be found in <span>[<a href="#RFC5752" class="xref">RFC5752</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
---
> For example, the COSE_Sign structure might include signatures generated with the Edwards-curve Digital Signature Algorithm (EdDSA) <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> and the Elliptic Curve Digital Signature Algorithm (ECDSA) <span>[<a href="#DSS" class="cite xref">DSS</a>]</span>.  This allows recipients to verify the signature associated with one algorithm or the other. More detailed information on multiple signature evaluations can be found in <span>[<a href="#RFC5752" class="cite xref">RFC5752</a>]</span>.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
2260,2261c2277,2278
< <div id="section-4.1-6">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.1-6">
> <pre>
2265c2282
< <p id="section-4.1-7">A COSE Signed Message is defined in two parts.  The CBOR object that carries the body and information about the message is called the COSE_Sign structure.  The CBOR object that carries the signature and information about the signature is called the COSE_Signature structure.  Examples of COSE Signed Messages can be found in <a href="#SignedExamples" class="xref">Appendix C.1</a>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
---
> <p id="section-4.1-7">A COSE Signed Message is defined in two parts.  The CBOR object that carries the body and information about the message is called the COSE_Sign structure.  The CBOR object that carries the signature and information about the signature is called the COSE_Signature structure.  Examples of COSE Signed Messages can be found in <a href="#SignedExamples" class="auto internal xref">Appendix C.1</a>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
2269c2286
<           <dd style="margin-left: 1.5em" id="section-4.1-9.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.1-9.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.1-9.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.1-9.2" class="pilcrow">¶</a>
2273c2290
<           <dd style="margin-left: 1.5em" id="section-4.1-9.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.1-9.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.1-9.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.1-9.4" class="pilcrow">¶</a>
2284c2301
<               Note: When a signature with a message recovery algorithm is used (<a href="#SigAlgs" class="xref">Section 8.1</a>), the maximum number of bytes that can be recovered is the length of the original payload.
---
>               Note: When a signature with a message recovery algorithm is used (<a href="#SigAlgs" class="auto internal xref">Section 8.1</a>), the maximum number of bytes that can be recovered is the length of the original payload.
2295,2296c2312,2313
< <div id="section-4.1-11">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.1-11">
> <pre>
2307c2324
<           <dd style="margin-left: 1.5em" id="section-4.1-13.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.1-13.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.1-13.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.1-13.2" class="pilcrow">¶</a>
2311c2328
<           <dd style="margin-left: 1.5em" id="section-4.1-13.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.1-13.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.1-13.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.1-13.4" class="pilcrow">¶</a>
2320,2321c2337,2338
< <div id="section-4.1-15">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.1-15">
> <pre>
2336,2337c2353,2354
< <div id="section-4.2-3">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.2-3">
> <pre>
2341c2358
< <p id="section-4.2-4">The CBOR object that carries the body, the signature, and the information about the body and signature is called the COSE_Sign1 structure.  Examples of COSE_Sign1 messages can be found in <a href="#Sign1_Examples" class="xref">Appendix C.2</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
---
> <p id="section-4.2-4">The CBOR object that carries the body, the signature, and the information about the body and signature is called the COSE_Sign1 structure.  Examples of COSE_Sign1 messages can be found in <a href="#Sign1_Examples" class="auto internal xref">Appendix C.2</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
2345c2362
<           <dd style="margin-left: 1.5em" id="section-4.2-6.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.2-6.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.2-6.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.2-6.2" class="pilcrow">¶</a>
2349c2366
<           <dd style="margin-left: 1.5em" id="section-4.2-6.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-4.2-6.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.2-6.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-4.2-6.4" class="pilcrow">¶</a>
2353c2370
<           <dd style="margin-left: 1.5em" id="section-4.2-6.6">This is as described in <a href="#full-signature" class="xref">Section 4.1</a>.<a href="#section-4.2-6.6" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.2-6.6">This is as described in <a href="#full-signature" class="auto internal xref">Section 4.1</a>.<a href="#section-4.2-6.6" class="pilcrow">¶</a>
2362,2363c2379,2380
< <div id="section-4.2-8">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.2-8">
> <pre>
2379c2396
<           The primary reason for supporting this can be seen by looking at the CoAP message structure <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, where the facility exists for options to be carried before the payload. 
---
>           The primary reason for supporting this can be seen by looking at the CoAP message structure <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, where the facility exists for options to be carried before the payload. 
2396c2413
<               Using options from CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> as an example, these fields use a TLV structure so they can be concatenated without any problems.<a href="#section-4.3-3.1" class="pilcrow">¶</a>
---
>               Using options from CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> as an example, these fields use a TLV structure so they can be concatenated without any problems.<a href="#section-4.3-3.1" class="pilcrow">¶</a>
2435c2452
<           <li id="section-4.4-2.4">The externally supplied data from the application, encoded in a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-4.4-2.4" class="pilcrow">¶</a>
---
>           <li id="section-4.4-2.4">The externally supplied data from the application, encoded in a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="auto internal xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-4.4-2.4" class="pilcrow">¶</a>
2441,2442c2458,2459
< <div id="section-4.4-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-4.4-4">
> <pre>
2456c2473
<           <li id="section-4.4-6.2">Create the value ToBeSigned by encoding the Sig_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-4.4-6.2" class="pilcrow">¶</a>
---
>           <li id="section-4.4-6.2">Create the value ToBeSigned by encoding the Sig_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-4.4-6.2" class="pilcrow">¶</a>
2469c2486
<           <li id="section-4.4-8.2">Create the value ToBeSigned by encoding the Sig_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-4.4-8.2" class="pilcrow">¶</a>
---
>           <li id="section-4.4-8.2">Create the value ToBeSigned by encoding the Sig_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-4.4-8.2" class="pilcrow">¶</a>
2498c2515
<           This is different from the approach used by both "Cryptographic Message Syntax (CMS)" <span>[<a href="#RFC5652" class="xref">RFC5652</a>]</span> and "JSON Web Encryption (JWE)" <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span>, where different structures are used for the content layer and the recipient layer. 
---
>           This is different from the approach used by both "Cryptographic Message Syntax (CMS)" <span>[<a href="#RFC5652" class="cite xref">RFC5652</a>]</span> and "JSON Web Encryption (JWE)" <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, where different structures are used for the content layer and the recipient layer. 
2501c2518
<           Examples of enveloped messages can be found in <a href="#EnvelopedExamples" class="xref">Appendix C.3</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
---
>           Examples of enveloped messages can be found in <a href="#EnvelopedExamples" class="auto internal xref">Appendix C.3</a>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
2503,2504c2520,2521
< <div id="section-5.1-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.1-4">
> <pre>
2511c2528
<           <dd style="margin-left: 1.5em" id="section-5.1-6.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.1-6.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.1-6.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.1-6.2" class="pilcrow">¶</a>
2515c2532
<           <dd style="margin-left: 1.5em" id="section-5.1-6.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.1-6.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.1-6.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.1-6.4" class="pilcrow">¶</a>
2528,2529c2545,2546
< <div id="section-5.1-8">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.1-8">
> <pre>
2540c2557
<           <dd style="margin-left: 1.5em" id="section-5.1-10.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.1-10.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.1-10.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.1-10.2" class="pilcrow">¶</a>
2544c2561
<           <dd style="margin-left: 1.5em" id="section-5.1-10.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.1-10.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.1-10.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.1-10.4" class="pilcrow">¶</a>
2552c2569
<           <dd style="margin-left: 1.5em" id="section-5.1-10.8">This field contains an array of recipient information structures.  The type for the recipient information structure is a COSE_recipient (an example of this can be found in <a href="#three-layer" class="xref">Appendix B</a>). If there are no recipient information structures, this element is absent.<a href="#section-5.1-10.8" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.1-10.8">This field contains an array of recipient information structures.  The type for the recipient information structure is a COSE_recipient (an example of this can be found in <a href="#three-layer" class="auto internal xref">Appendix B</a>). If there are no recipient information structures, this element is absent.<a href="#section-5.1-10.8" class="pilcrow">¶</a>
2557,2558c2574,2575
< <div id="section-5.1-12">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.1-12">
> <pre>
2575c2592
<             Specific details on each of the classes can be found in <a href="#key-management-algs" class="xref">Section 8.5</a>. 
---
>             Specific details on each of the classes can be found in <a href="#key-management-algs" class="auto internal xref">Section 8.5</a>. 
2617c2634
< <p id="section-5.2-2">Examples of encrypted messages can be found in <a href="#EncryptExamples" class="xref">Appendix C.4</a>.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
---
> <p id="section-5.2-2">Examples of encrypted messages can be found in <a href="#EncryptExamples" class="auto internal xref">Appendix C.4</a>.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
2619,2620c2636,2637
< <div id="section-5.2-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.2-4">
> <pre>
2627c2644
<           <dd style="margin-left: 1.5em" id="section-5.2-6.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.2-6.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.2-6.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.2-6.2" class="pilcrow">¶</a>
2631c2648
<           <dd style="margin-left: 1.5em" id="section-5.2-6.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-5.2-6.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.2-6.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-5.2-6.4" class="pilcrow">¶</a>
2635c2652
<           <dd style="margin-left: 1.5em" id="section-5.2-6.6">This is as described in <a href="#EnvelopedData" class="xref">Section 5.1</a>.<a href="#section-5.2-6.6" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-5.2-6.6">This is as described in <a href="#EnvelopedData" class="auto internal xref">Section 5.1</a>.<a href="#section-5.2-6.6" class="pilcrow">¶</a>
2640,2641c2657,2658
< <div id="section-5.2-8">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.2-8">
> <pre>
2674c2691
<           <li id="section-5.3-2.3">The externally supplied data from the application encoded in a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-5.3-2.3" class="pilcrow">¶</a>
---
>           <li id="section-5.3-2.3">The externally supplied data from the application encoded in a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="auto internal xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-5.3-2.3" class="pilcrow">¶</a>
2678,2679c2695,2696
< <div id="section-5.3-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-5.3-4">
> <pre>
2692c2709
<           <li id="section-5.3-6.2">Encode the Enc_structure to a byte string (Additional Authenticated Data (AAD)), using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-5.3-6.2" class="pilcrow">¶</a>
---
>           <li id="section-5.3-6.2">Encode the Enc_structure to a byte string (Additional Authenticated Data (AAD)), using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-5.3-6.2" class="pilcrow">¶</a>
2698c2715
<               <dd style="margin-left: 1.5em" id="section-5.3-6.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.3-6.3.2.2" class="pilcrow">¶</a>
---
>               <dd style="margin-left: 1.5em" id="section-5.3-6.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="auto internal xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.3-6.3.2.2" class="pilcrow">¶</a>
2706c2723
<   Examples of these algorithms are found in Sections <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.<a href="#section-5.3-6.3.2.4" class="pilcrow">¶</a>
---
>   Examples of these algorithms are found in Sections <a href="https://rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-5.3-6.3.2.4" class="pilcrow">¶</a>
2724c2741
<           <li id="section-5.3-8.2">Encode the Enc_structure to a byte string (AAD), using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-5.3-8.2" class="pilcrow">¶</a>
---
>           <li id="section-5.3-8.2">Encode the Enc_structure to a byte string (AAD), using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-5.3-8.2" class="pilcrow">¶</a>
2730c2747
<               <dd style="margin-left: 1.5em" id="section-5.3-8.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.3-8.3.2.2" class="pilcrow">¶</a>
---
>               <dd style="margin-left: 1.5em" id="section-5.3-8.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="auto internal xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.3-8.3.2.2" class="pilcrow">¶</a>
2766c2783
<               <dd style="margin-left: 1.5em" id="section-5.4-2.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.4-2.3.2.2" class="pilcrow">¶</a>
---
>               <dd style="margin-left: 1.5em" id="section-5.4-2.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="auto internal xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.4-2.3.2.2" class="pilcrow">¶</a>
2771c2788
< Examples of these algorithms are found in Sections <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.<a href="#section-5.4-2.3.2.4" class="pilcrow">¶</a>
---
> Examples of these algorithms are found in Sections <a href="https://rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-5.4-2.3.2.4" class="pilcrow">¶</a>
2795c2812
<               <dd style="margin-left: 1.5em" id="section-5.4-4.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.4-4.3.2.2" class="pilcrow">¶</a>
---
>               <dd style="margin-left: 1.5em" id="section-5.4-4.3.2.2">The key to be used is determined by the algorithm and key at the current layer.  Examples are key wrap keys (<a href="#key_wrap_algs" class="auto internal xref">Section 8.5.2</a>) and preshared secrets.<a href="#section-5.4-4.3.2.2" class="pilcrow">¶</a>
2800c2817
< Examples of these algorithms are found in Sections <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://www.rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.<a href="#section-5.4-4.3.2.4" class="pilcrow">¶</a>
---
> Examples of these algorithms are found in Sections <a href="https://rfc-editor.org/rfc/rfc9053#section-6.1" class="relref">6.1</a> and <a href="https://rfc-editor.org/rfc/rfc9053#section-6.3" class="relref">6.3</a> of <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-5.4-4.3.2.4" class="pilcrow">¶</a>
2833c2850
< <p id="section-6.1-1">A multiple-recipient MACed message uses two structures: the COSE_Mac structure defined in this section for carrying the body and the COSE_recipient structure (<a href="#EnvelopedData" class="xref">Section 5.1</a>) to hold the key used for the MAC computation.  Examples of MACed messages can be found in <a href="#MacExamples" class="xref">Appendix C.5</a>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
---
> <p id="section-6.1-1">A multiple-recipient MACed message uses two structures: the COSE_Mac structure defined in this section for carrying the body and the COSE_recipient structure (<a href="#EnvelopedData" class="auto internal xref">Section 5.1</a>) to hold the key used for the MAC computation.  Examples of MACed messages can be found in <a href="#MacExamples" class="auto internal xref">Appendix C.5</a>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
2835,2836c2852,2853
< <div id="section-6.1-3">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-6.1-3">
> <pre>
2843c2860
<           <dd style="margin-left: 1.5em" id="section-6.1-5.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-6.1-5.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.1-5.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-6.1-5.2" class="pilcrow">¶</a>
2847c2864
<           <dd style="margin-left: 1.5em" id="section-6.1-5.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-6.1-5.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.1-5.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-6.1-5.4" class="pilcrow">¶</a>
2859c2876
<           <dd style="margin-left: 1.5em" id="section-6.1-5.10">This is as described in <a href="#EnvelopedData" class="xref">Section 5.1</a>.<a href="#section-6.1-5.10" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.1-5.10">This is as described in <a href="#EnvelopedData" class="auto internal xref">Section 5.1</a>.<a href="#section-6.1-5.10" class="pilcrow">¶</a>
2864,2865c2881,2882
< <div id="section-6.1-7">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-6.1-7">
> <pre>
2881c2898
< <p id="section-6.2-2">The MACed message uses the COSE_Mac0 structure defined in this section for carrying the body.  Examples of MACed messages with an implicit key can be found in <a href="#Mac0Examples" class="xref">Appendix C.6</a>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
---
> <p id="section-6.2-2">The MACed message uses the COSE_Mac0 structure defined in this section for carrying the body.  Examples of MACed messages with an implicit key can be found in <a href="#Mac0Examples" class="auto internal xref">Appendix C.6</a>.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
2883,2884c2900,2901
< <div id="section-6.2-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-6.2-4">
> <pre>
2891c2908
<           <dd style="margin-left: 1.5em" id="section-6.2-6.2">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-6.2-6.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.2-6.2">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-6.2-6.2" class="pilcrow">¶</a>
2895c2912
<           <dd style="margin-left: 1.5em" id="section-6.2-6.4">This is as described in <a href="#header-parameters" class="xref">Section 3</a>.<a href="#section-6.2-6.4" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.2-6.4">This is as described in <a href="#header-parameters" class="auto internal xref">Section 3</a>.<a href="#section-6.2-6.4" class="pilcrow">¶</a>
2899c2916
<           <dd style="margin-left: 1.5em" id="section-6.2-6.6">This is as described in <a href="#Mac_n" class="xref">Section 6.1</a>.<a href="#section-6.2-6.6" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-6.2-6.6">This is as described in <a href="#Mac_n" class="auto internal xref">Section 6.1</a>.<a href="#section-6.2-6.6" class="pilcrow">¶</a>
2908,2909c2925,2926
< <div id="section-6.2-8">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-6.2-8">
> <pre>
2928c2945
<           <li id="section-6.3-2.3">The externally supplied data from the application, encoded as a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-6.3-2.3" class="pilcrow">¶</a>
---
>           <li id="section-6.3-2.3">The externally supplied data from the application, encoded as a bstr type.  If this field is not supplied, it defaults to a zero-length byte string.  (See <a href="#Extern_AAD" class="auto internal xref">Section 4.3</a> for application guidance on constructing this field.)<a href="#section-6.3-2.3" class="pilcrow">¶</a>
2934,2935c2951,2952
< <div id="section-6.3-4">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-6.3-4">
> <pre>
2949c2966
<           <li id="section-6.3-6.2">Create the value ToBeMaced by encoding the MAC_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-6.3-6.2" class="pilcrow">¶</a>
---
>           <li id="section-6.3-6.2">Create the value ToBeMaced by encoding the MAC_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-6.3-6.2" class="pilcrow">¶</a>
2964c2981
<           <li id="section-6.3-8.2">Create the value ToBeMaced by encoding the MAC_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="xref">Section 9</a>.<a href="#section-6.3-8.2" class="pilcrow">¶</a>
---
>           <li id="section-6.3-8.2">Create the value ToBeMaced by encoding the MAC_structure to a byte string, using the encoding described in <a href="#CBOR-Canonical" class="auto internal xref">Section 9</a>.<a href="#section-6.3-8.2" class="pilcrow">¶</a>
2982,2983c2999,3000
< <p id="section-7-1">A COSE Key structure is built on a CBOR map.  The set of common parameters that can appear in a COSE Key can be found in the IANA "COSE Key Common Parameters" registry <span>[<a href="#COSE.KeyParameters" class="xref">COSE.KeyParameters</a>]</span> (see <a href="#cose-key-map-registry" class="xref">Section 11.2</a>).  Additional parameters defined for specific key types can be found in the IANA "COSE Key Type Parameters" registry <span>[<a href="#COSE.KeyTypes" class="xref">COSE.KeyTypes</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
< <p id="section-7-2">A COSE Key Set uses a CBOR array object as its underlying type.  The values of the array elements are COSE Keys.  A COSE Key Set <span class="bcp14">MUST</span> have at least one element in the array.  Examples of COSE Key Sets can be found in <a href="#COSE_KEYS" class="xref">Appendix C.7</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
---
> <p id="section-7-1">A COSE Key structure is built on a CBOR map.  The set of common parameters that can appear in a COSE Key can be found in the IANA "COSE Key Common Parameters" registry <span>[<a href="#COSE.KeyParameters" class="cite xref">COSE.KeyParameters</a>]</span> (see <a href="#cose-key-map-registry" class="auto internal xref">Section 11.2</a>).  Additional parameters defined for specific key types can be found in the IANA "COSE Key Type Parameters" registry <span>[<a href="#COSE.KeyTypes" class="cite xref">COSE.KeyTypes</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
> <p id="section-7-2">A COSE Key Set uses a CBOR array object as its underlying type.  The values of the array elements are COSE Keys.  A COSE Key Set <span class="bcp14">MUST</span> have at least one element in the array.  Examples of COSE Key Sets can be found in <a href="#COSE_KEYS" class="auto internal xref">Appendix C.7</a>.<a href="#section-7-2" class="pilcrow">¶</a></p>
2987,2988c3004,3005
< <div id="section-7-6">
< <pre class="lang-cddl sourcecode">
---
> <div class="lang-cddl sourcecode" id="section-7-6">
> <pre>
3006c3023
< <p id="section-7.1-1">This document defines a set of common parameters for a COSE Key object.  <a href="#x-table-key-labels" class="xref">Table 4</a> provides a summary of the parameters defined in this section.  There are also parameters that are defined for specific key types.  Key-type-specific parameters can be found in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
---
> <p id="section-7.1-1">This document defines a set of common parameters for a COSE Key object.  <a href="#x-table-key-labels" class="auto internal xref">Table 4</a> provides a summary of the parameters defined in this section.  There are also parameters that are defined for specific key types.  Key-type-specific parameters can be found in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
3063c3080
<           <dd style="margin-left: 1.5em" id="section-7.1-3.2">This parameter is used to identify the family of keys for this structure and, thus, the set of key-type-specific parameters to be found.  The set of values defined in this document can be found in <span>[<a href="#COSE.KeyTypes" class="xref">COSE.KeyTypes</a>]</span>.  This parameter <span class="bcp14">MUST</span> be present in a key object.  Implementations <span class="bcp14">MUST</span> verify that the key type is appropriate for the algorithm being processed.  The key type <span class="bcp14">MUST</span> be included as part of the trust-decision process.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-7.1-3.2">This parameter is used to identify the family of keys for this structure and, thus, the set of key-type-specific parameters to be found.  The set of values defined in this document can be found in <span>[<a href="#COSE.KeyTypes" class="cite xref">COSE.KeyTypes</a>]</span>.  This parameter <span class="bcp14">MUST</span> be present in a key object.  Implementations <span class="bcp14">MUST</span> verify that the key type is appropriate for the algorithm being processed.  The key type <span class="bcp14">MUST</span> be included as part of the trust-decision process.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
3076c3093
<           <dd style="margin-left: 1.5em" id="section-7.1-3.8">This parameter is defined to restrict the set of operations that a key is to be used for.  The value of the field is an array of values from <a href="#x-table-key-ops" class="xref">Table 5</a>.  Algorithms define the values of key ops that are permitted to appear and are required for specific operations.  The set of values matches that in <span>[<a href="#RFC7517" class="xref">RFC7517</a>]</span> and <span>[<a href="#W3C.WebCrypto" class="xref">W3C.WebCrypto</a>]</span>.<a href="#section-7.1-3.8" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-7.1-3.8">This parameter is defined to restrict the set of operations that a key is to be used for.  The value of the field is an array of values from <a href="#x-table-key-ops" class="auto internal xref">Table 5</a>.  Algorithms define the values of key ops that are permitted to appear and are required for specific operations.  The set of values matches that in <span>[<a href="#RFC7517" class="cite xref">RFC7517</a>]</span> and <span>[<a href="#W3C.WebCrypto" class="cite xref">W3C.WebCrypto</a>]</span>.<a href="#section-7.1-3.8" class="pilcrow">¶</a>
3081c3098
<             <p id="section-7.1-3.10.1">This parameter is defined to carry the base portion of an IV.  It is designed to be used with the Partial IV header parameter defined in <a href="#cose-headers" class="xref">Section 3.1</a>.  This field provides the ability to associate a Base IV with a key that is then modified on a per-message basis with the Partial IV.<a href="#section-7.1-3.10.1" class="pilcrow">¶</a></p>
---
>             <p id="section-7.1-3.10.1">This parameter is defined to carry the base portion of an IV.  It is designed to be used with the Partial IV header parameter defined in <a href="#cose-headers" class="auto internal xref">Section 3.1</a>.  This field provides the ability to associate a Base IV with a key that is then modified on a per-message basis with the Partial IV.<a href="#section-7.1-3.10.1" class="pilcrow">¶</a></p>
3186,3187c3203,3204
< <div id="section-8.1-4">
< <pre class="lang-pseudocode sourcecode">
---
> <div class="lang-pseudocode sourcecode" id="section-8.1-4">
> <pre>
3194c3211
<           The second scheme is signature with message recovery; an example of such an algorithm is <span>[<a href="#PVSig" class="xref">PVSig</a>]</span>. 
---
>           The second scheme is signature with message recovery; an example of such an algorithm is <span>[<a href="#PVSig" class="cite xref">PVSig</a>]</span>. 
3204,3205c3221,3222
< <div id="section-8.1-7">
< <pre class="lang-pseudocode sourcecode">
---
> <div class="lang-pseudocode sourcecode" id="section-8.1-7">
> <pre>
3262,3263c3279,3280
< <div id="section-8.2-4">
< <pre class="lang-pseudocode sourcecode">
---
> <div class="lang-pseudocode sourcecode" id="section-8.2-4">
> <pre>
3271c3288
<         <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span> defines a MAC algorithm using each of these constructions.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
---
>         <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> defines a MAC algorithm using each of these constructions.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
3280,3281c3297,3298
< <div id="section-8.3-3">
< <pre class="lang-pseudocode sourcecode">
---
> <div class="lang-pseudocode sourcecode" id="section-8.3-3">
> <pre>
3304c3321
<   General KDFs work well with the first type of secret, can do reasonably well with the second type of secret, and generally do poorly with the last type of secret. Functions like Argon2 <span>[<a href="#RFC9106" class="xref">RFC9106</a>]</span> need to be used for nonrandom secrets.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
---
>   General KDFs work well with the first type of secret, can do reasonably well with the second type of secret, and generally do poorly with the last type of secret. Functions like Argon2 <span>[<a href="#RFC9106" class="cite xref">RFC9106</a>]</span> need to be used for nonrandom secrets.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
3307c3324
<   The KDF defined in <span><a href="https://www.rfc-editor.org/rfc/rfc9053#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9053" class="xref">RFC9053</a>]</span> is such a function. 
---
>   The KDF defined in <span><a href="https://rfc-editor.org/rfc/rfc9053#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> is such a function. 
3319c3336
<         In this section, a number of classes are listed. For the recipient algorithm classes defined in <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span>, the same names are used. 
---
>         In this section, a number of classes are listed. For the recipient algorithm classes defined in <span>[<a href="#RFC7516" class="cite xref">RFC7516</a>]</span>, the same names are used. 
3369c3386
<         A set of key transport algorithms is defined in <span>[<a href="#RFC8230" class="xref">RFC8230</a>]</span>.<a href="#section-8.5.3-1" class="pilcrow">¶</a></p>
---
>         A set of key transport algorithms is defined in <span>[<a href="#RFC8230" class="cite xref">RFC8230</a>]</span>.<a href="#section-8.5.3-1" class="pilcrow">¶</a></p>
3385,3386c3402,3403
< <p id="section-8.5.4-1">The Direct Key Agreement class of recipient algorithms uses a key agreement method to create a shared secret.  A KDF is then applied to the shared secret to derive a key to be used in protecting the data.  This key is normally used as a CEK or MAC key but could be used for other purposes if more than two layers are in use (see <a href="#three-layer" class="xref">Appendix B</a>).<a href="#section-8.5.4-1" class="pilcrow">¶</a></p>
< <p id="section-8.5.4-2">The most commonly used key agreement algorithm is Diffie-Hellman, but other variants exist.  Since COSE is designed for a store-and-forward environment rather than an online environment, many of the DH variants cannot be used, as the receiver of the message cannot provide any dynamic key material.  One side effect of this is that forward secrecy (see <span>[<a href="#RFC4949" class="xref">RFC4949</a>]</span>) is not achievable.  A static key will always be used for the receiver of the COSE object.<a href="#section-8.5.4-2" class="pilcrow">¶</a></p>
---
> <p id="section-8.5.4-1">The Direct Key Agreement class of recipient algorithms uses a key agreement method to create a shared secret.  A KDF is then applied to the shared secret to derive a key to be used in protecting the data.  This key is normally used as a CEK or MAC key but could be used for other purposes if more than two layers are in use (see <a href="#three-layer" class="auto internal xref">Appendix B</a>).<a href="#section-8.5.4-1" class="pilcrow">¶</a></p>
> <p id="section-8.5.4-2">The most commonly used key agreement algorithm is Diffie-Hellman, but other variants exist.  Since COSE is designed for a store-and-forward environment rather than an online environment, many of the DH variants cannot be used, as the receiver of the message cannot provide any dynamic key material.  One side effect of this is that forward secrecy (see <span>[<a href="#RFC4949" class="cite xref">RFC4949</a>]</span>) is not achievable.  A static key will always be used for the receiver of the COSE object.<a href="#section-8.5.4-2" class="pilcrow">¶</a></p>
3414,3415c3431,3432
< <div id="section-8.5.5-2">
< <pre class="lang-pseudocode sourcecode">
---
> <div class="lang-pseudocode sourcecode" id="section-8.5.5-2">
> <pre>
3443c3460
<   the Core Deterministic Encoding Requirements specified in <span><a href="https://www.rfc-editor.org/rfc/rfc8949#section-4.2.1" class="relref">Section 4.2.1</a> of RFC 8949 [<a href="#STD94" class="xref">STD94</a>]</span>.
---
>   the Core Deterministic Encoding Requirements specified in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1" class="relref">Section 4.2.1</a> of RFC 8949 [<a href="#STD94" class="cite xref">STD94</a>]</span>.
3469c3486
<         An example of a profile can be found in <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, where one was developed for carrying content in combination with CoAP headers.<a href="#section-10-2" class="pilcrow">¶</a></p>
---
>         An example of a profile can be found in <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, where one was developed for carrying content in combination with CoAP headers.<a href="#section-10-2" class="pilcrow">¶</a></p>
3480c3497
<         <li class="normal" id="section-10-4.3">When applications use externally defined authenticated data, they need to define how that data is encoded.  This document assumes that the data will be provided as a byte string.  More information can be found in <a href="#Extern_AAD" class="xref">Section 4.3</a>.<a href="#section-10-4.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-10-4.3">When applications use externally defined authenticated data, they need to define how that data is encoded.  This document assumes that the data will be provided as a byte string.  More information can be found in <a href="#Extern_AAD" class="auto internal xref">Section 4.3</a>.<a href="#section-10-4.3" class="pilcrow">¶</a>
3484c3501
<                 Additional guidance can be found in <span>[<a href="#BCP201" class="xref">BCP201</a>]</span>.<a href="#section-10-4.4" class="pilcrow">¶</a>
---
>                 Additional guidance can be found in <span>[<a href="#BCP201" class="cite xref">BCP201</a>]</span>.<a href="#section-10-4.4" class="pilcrow">¶</a>
3490c3507
< <li class="normal" id="section-10-4.5.2.1">Advertising in the message (S/MIME capabilities) <span>[<a href="#RFC8551" class="xref">RFC8551</a>]</span>.<a href="#section-10-4.5.2.1" class="pilcrow">¶</a>
---
> <li class="normal" id="section-10-4.5.2.1">Advertising in the message (S/MIME capabilities) <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>.<a href="#section-10-4.5.2.1" class="pilcrow">¶</a>
3492c3509
<             <li class="normal" id="section-10-4.5.2.2">Advertising in the certificate (capabilities extension) <span>[<a href="#RFC4262" class="xref">RFC4262</a>]</span>.<a href="#section-10-4.5.2.2" class="pilcrow">¶</a>
---
>             <li class="normal" id="section-10-4.5.2.2">Advertising in the certificate (capabilities extension) <span>[<a href="#RFC4262" class="cite xref">RFC4262</a>]</span>.<a href="#section-10-4.5.2.2" class="pilcrow">¶</a>
3494c3511
<             <li class="normal" id="section-10-4.5.2.3">Minimum requirements for the S/MIME, which have been updated over time <span>[<a href="#RFC2633" class="xref">RFC2633</a>]</span> <span>[<a href="#RFC3851" class="xref">RFC3851</a>]</span> <span>[<a href="#RFC5751" class="xref">RFC5751</a>]</span> <span>[<a href="#RFC8551" class="xref">RFC8551</a>]</span>. (Note that <span>[<a href="#RFC2633" class="xref">RFC2633</a>]</span> was obsoleted by <span>[<a href="#RFC3851" class="xref">RFC3851</a>]</span>, which was obsoleted by <span>[<a href="#RFC5751" class="xref">RFC5751</a>]</span>, which was obsoleted by <span>[<a href="#RFC8551" class="xref">RFC8551</a>]</span>.)<a href="#section-10-4.5.2.3" class="pilcrow">¶</a>
---
>             <li class="normal" id="section-10-4.5.2.3">Minimum requirements for the S/MIME, which have been updated over time <span>[<a href="#RFC2633" class="cite xref">RFC2633</a>]</span> <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span> <span>[<a href="#RFC5751" class="cite xref">RFC5751</a>]</span> <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>. (Note that <span>[<a href="#RFC2633" class="cite xref">RFC2633</a>]</span> was obsoleted by <span>[<a href="#RFC3851" class="cite xref">RFC3851</a>]</span>, which was obsoleted by <span>[<a href="#RFC5751" class="cite xref">RFC5751</a>]</span>, which was obsoleted by <span>[<a href="#RFC8551" class="cite xref">RFC8551</a>]</span>.)<a href="#section-10-4.5.2.3" class="pilcrow">¶</a>
3507c3524
<         The registries and registrations listed below were defined by RFC 8152 <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.
---
>         The registries and registrations listed below were defined by RFC 8152 <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.
3511c3528
<         Note that while <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span> also updates the registries and registrations originally established by <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>, the requested updates are mutually exclusive.  The updates requested in this document do not conflict or overlap with the updates requested in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>, and vice versa.<a href="#section-11-2" class="pilcrow">¶</a></p>
---
>         Note that while <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> also updates the registries and registrations originally established by <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>, the requested updates are mutually exclusive.  The updates requested in this document do not conflict or overlap with the updates requested in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, and vice versa.<a href="#section-11-2" class="pilcrow">¶</a></p>
3518,3519c3535,3536
<           The "COSE Header Parameters" registry was defined by <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>. 
<           IANA has updated the reference for this registry to point to this document instead of <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>. IANA has also updated all entries that referenced <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>, except "counter signature" and "CounterSignature0", to refer to this document.  The references for "counter signature" and "CounterSignature0" continue to reference <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
---
>           The "COSE Header Parameters" registry was defined by <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>. 
>           IANA has updated the reference for this registry to point to this document instead of <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>. IANA has also updated all entries that referenced <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>, except "counter signature" and "CounterSignature0", to refer to this document.  The references for "counter signature" and "CounterSignature0" continue to reference <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
3528,3529c3545,3546
<           The "COSE Key Common Parameters" registry <span>[<a href="#COSE.KeyParameters" class="xref">COSE.KeyParameters</a>]</span> was defined in <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.
<           IANA has updated the reference for this registry to point to this document instead of <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.  IANA has also updated the entries that referenced <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> to refer to this document.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
---
>           The "COSE Key Common Parameters" registry <span>[<a href="#COSE.KeyParameters" class="cite xref">COSE.KeyParameters</a>]</span> was defined in <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.
>           IANA has updated the reference for this registry to point to this document instead of <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.  IANA has also updated the entries that referenced <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span> to refer to this document.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
3798c3815
<           IANA added entries to the "CoAP Content-Formats" registry as indicated in <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.  IANA has updated the reference to point to this document instead of <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
---
>           IANA added entries to the "CoAP Content-Formats" registry as indicated in <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.  IANA has updated the reference to point to this document instead of <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
3805c3822
<           IANA added entries to the "CBOR Tags" registry as indicated in <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.  IANA has updated the references to point to this document instead of  <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
---
>           IANA added entries to the "CBOR Tags" registry as indicated in <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.  IANA has updated the references to point to this document instead of  <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span>.<a href="#section-11.5-1" class="pilcrow">¶</a></p>
3813c3830
<           All of the IANA registries established by <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> are, at least in part, defined as Expert Review <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.  This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason, so they should be given substantial latitude.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
---
>           All of the IANA registries established by <span>[<a href="#RFC8152" class="cite xref">RFC8152</a>]</span> are, at least in part, defined as Expert Review <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason, so they should be given substantial latitude.<a href="#section-11.6-1" class="pilcrow">¶</a></p>
3844c3861
<         <li class="normal" id="section-12-3.2">Use of "direct" as a recipient algorithm combined with a second recipient algorithm exposes the direct key to the second recipient; <a href="#key-management-algs" class="xref">Section 8.5</a> forbids combining "direct" recipient algorithms with other modes.<a href="#section-12-3.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-12-3.2">Use of "direct" as a recipient algorithm combined with a second recipient algorithm exposes the direct key to the second recipient; <a href="#key-management-algs" class="auto internal xref">Section 8.5</a> forbids combining "direct" recipient algorithms with other modes.<a href="#section-12-3.2" class="pilcrow">¶</a>
3846c3863
<         <li class="normal" id="section-12-3.3">Several of the algorithms in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span> have limits on the number of times that a key can be used without leaking information about the key.<a href="#section-12-3.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-12-3.3">Several of the algorithms in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span> have limits on the number of times that a key can be used without leaking information about the key.<a href="#section-12-3.3" class="pilcrow">¶</a>
3869c3886
< <p id="section-12-8">One area that has been getting exposure is traffic analysis of encrypted messages based on the length of the message.  This specification does not provide a uniform method for providing padding as part of the message structure.  An observer can distinguish between two different messages (for example, "YES" and "NO") based on the length for all of the content encryption algorithms that are defined in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>.  This means that it is up to the applications to document how content padding is to be done in order to prevent or discourage such analysis.  (For example, the text strings could be defined as "YES" and "NO ".)<a href="#section-12-8" class="pilcrow">¶</a></p>
---
> <p id="section-12-8">One area that has been getting exposure is traffic analysis of encrypted messages based on the length of the message.  This specification does not provide a uniform method for providing padding as part of the message structure.  An observer can distinguish between two different messages (for example, "YES" and "NO") based on the length for all of the content encryption algorithms that are defined in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>.  This means that it is up to the applications to document how content padding is to be done in order to prevent or discourage such analysis.  (For example, the text strings could be defined as "YES" and "NO ".)<a href="#section-12-8" class="pilcrow">¶</a></p>
4068c4085
< <p id="appendix-A-4">The key words from BCP 14 (<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> and <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>) are deliberately not used here.  This specification can provide recommendations, but it cannot enforce them.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
---
> <p id="appendix-A-4">The key words from BCP 14 (<span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> and <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span>) are deliberately not used here.  This specification can provide recommendations, but it cannot enforce them.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
4074c4091
<         <li class="normal" id="appendix-A-7.2">Applications need to define the set of information that is to be considered to be part of a context when omitting algorithm identifiers.  At a minimum, this would be the key identifier (if needed), the key, the algorithm, and the COSE structure it is used with.  Applications should restrict the use of a single key to a single algorithm.  As noted for some of the algorithms in <span>[<a href="#RFC9053" class="xref">RFC9053</a>]</span>, the use of the same key in different, related algorithms can lead to leakage of information about the key, leakage about the data, or the ability to perform forgeries.<a href="#appendix-A-7.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-A-7.2">Applications need to define the set of information that is to be considered to be part of a context when omitting algorithm identifiers.  At a minimum, this would be the key identifier (if needed), the key, the algorithm, and the COSE structure it is used with.  Applications should restrict the use of a single key to a single algorithm.  As noted for some of the algorithms in <span>[<a href="#RFC9053" class="cite xref">RFC9053</a>]</span>, the use of the same key in different, related algorithms can lead to leakage of information about the key, leakage about the data, or the ability to perform forgeries.<a href="#appendix-A-7.2" class="pilcrow">¶</a>
4115c4132
<       However, if one uses a recipient algorithm such as the RSA Key Encapsulation Mechanism (RSA-KEM) (see Appendix A of RSA-KEM <span>[<a href="#RFC5990" class="xref">RFC5990</a>]</span>), then it makes sense to have two layers of the COSE_Recipient structure.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
---
>       However, if one uses a recipient algorithm such as the RSA Key Encapsulation Mechanism (RSA-KEM) (see Appendix A of RSA-KEM <span>[<a href="#RFC5990" class="cite xref">RFC5990</a>]</span>), then it makes sense to have two layers of the COSE_Recipient structure.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
4125c4142
< <p id="appendix-B-4">This is an example of what a triple-layer message would look like.  To make it easier to read, it is presented using the extended CBOR diagnostic notation (defined in <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>) rather than as a binary dump.  The message has the following layers:<a href="#appendix-B-4" class="pilcrow">¶</a></p>
---
> <p id="appendix-B-4">This is an example of what a triple-layer message would look like.  To make it easier to read, it is presented using the extended CBOR diagnostic notation (defined in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>) rather than as a binary dump.  The message has the following layers:<a href="#appendix-B-4" class="pilcrow">¶</a></p>
4136,4137c4153,4154
< <div id="appendix-B-8">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-B-8">
> <pre>
4187c4204
< <p id="appendix-C-1">This appendix includes a set of examples that show the different features and message types that have been defined in this document.  To make the examples easier to read, they are presented using the extended CBOR diagnostic notation (defined in <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>) rather than as a binary dump.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
---
> <p id="appendix-C-1">This appendix includes a set of examples that show the different features and message types that have been defined in this document.  To make the examples easier to read, they are presented using the extended CBOR diagnostic notation (defined in <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>) rather than as a binary dump.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
4189c4206
<         A GitHub project has been created at <span>[<a href="#GitHub-Examples" class="xref">GitHub-Examples</a>]</span> that contains not only the examples presented in this document, but a more complete set of testing examples as well.
---
>         A GitHub project has been created at <span>[<a href="#GitHub-Examples" class="cite xref">GitHub-Examples</a>]</span> that contains not only the examples presented in this document, but a more complete set of testing examples as well.
4194,4195c4211,4212
< <div id="appendix-C-4">
< <pre class="lang-shell sourcecode">gem install cbor-diag</pre><a href="#appendix-C-4" class="pilcrow">¶</a>
---
> <div class="lang-shell sourcecode" id="appendix-C-4">
> <pre>gem install cbor-diag</pre><a href="#appendix-C-4" class="pilcrow">¶</a>
4198,4199c4215,4216
< <div id="appendix-C-6">
< <pre class="lang-shell sourcecode">diag2cbor.rb &lt; inputfile &gt; outputfile
---
> <div class="lang-shell sourcecode" id="appendix-C-6">
> <pre>diag2cbor.rb &lt; inputfile &gt; outputfile
4203,4204c4220,4221
< <div id="appendix-C-8">
< <pre class="lang-xpath sourcecode">//sourcecode[@type='cbor-diag']/text()</pre><a href="#appendix-C-8" class="pilcrow">¶</a>
---
> <div class="lang-xpath sourcecode" id="appendix-C-8">
> <pre>//sourcecode[@type='cbor-diag']/text()</pre><a href="#appendix-C-8" class="pilcrow">¶</a>
4222,4223c4239,4240
< <div id="appendix-C.1.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.1.1-4">
> <pre>
4261,4262c4278,4279
< <div id="appendix-C.1.2-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.1.2-4">
> <pre>
4313,4314c4330,4331
< <div id="appendix-C.1.3-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.1.3-4">
> <pre>
4362,4363c4379,4380
< <div id="appendix-C.2.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.2.1-4">
> <pre>
4401,4402c4418,4419
< <div id="appendix-C.3.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.3.1-4">
> <pre>
4461,4462c4478,4479
< <div id="appendix-C.3.2-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.3.2-4">
> <pre>
4506,4507c4523,4524
< <div id="appendix-C.3.3-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.3.3-4">
> <pre>
4556,4557c4573,4574
< <div id="appendix-C.4.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.4.1-4">
> <pre>
4587,4588c4604,4605
< <div id="appendix-C.4.2-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.4.2-4">
> <pre>
4625,4626c4642,4643
< <div id="appendix-C.5.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.5.1-4">
> <pre>
4664,4665c4681,4682
< <div id="appendix-C.5.2-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.5.2-4">
> <pre>
4709,4710c4726,4727
< <div id="appendix-C.5.3-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.5.3-4">
> <pre>
4756,4757c4773,4774
< <div id="appendix-C.5.4-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.5.4-4">
> <pre>
4822,4823c4839,4840
< <div id="appendix-C.6.1-4">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.6.1-4">
> <pre>
4836c4853
< <p id="appendix-C.6.1-5">Note that this example uses the same inputs as <a href="#Appendix_B_5_1" class="xref">Appendix C.5.1</a>.<a href="#appendix-C.6.1-5" class="pilcrow">¶</a></p>
---
> <p id="appendix-C.6.1-5">Note that this example uses the same inputs as <a href="#Appendix_B_5_1" class="auto internal xref">Appendix C.5.1</a>.<a href="#appendix-C.6.1-5" class="pilcrow">¶</a></p>
4863,4864c4880,4881
< <div id="appendix-C.7.1-5">
< <pre class="lang-cbor-diag sourcecode">
---
> <div class="lang-cbor-diag sourcecode" id="appendix-C.7.1-5">
> <pre>
4931,4932c4948,4949
< <div id="appendix-C.7.2-5">
< <pre class="breakable lang-cbor-diag sourcecode">
---
> <div class="breakable lang-cbor-diag sourcecode" id="appendix-C.7.2-5">
> <pre>
