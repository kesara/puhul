12c12
< <meta content="xml2rfc 3.14.0" name="generator">
---
> <meta content="xml2rfc 3.19.1" name="generator">
19,24c19,22
<   xml2rfc 3.14.0
<     Python 3.9.13
<     appdirs 1.4.4
<     ConfigArgParse 1.5.3
<     google-i18n-address 2.5.1
<     html5lib 1.1
---
>   xml2rfc 3.19.1
>     Python 3.11.7
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
26,33c24,30
<     Jinja2 3.1.2
<     kitchen 1.2.6
<     lxml 4.9.0
<     MarkupSafe 2.1.1
<     pycountry 22.3.5
<     PyYAML 6.0
<     requests 2.28.0
<     setuptools 44.1.1
---
>     Jinja2 3.1.3
>     lxml 4.9.4
>     platformdirs 4.1.0
>     pycountry 23.12.11
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
35c32
<     weasyprint 56.1
---
>     wcwidth 0.2.13
37c34
< <link href="rfc9293.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc9293.xml" rel="alternate" type="application/rfc+xml">
47c44
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
56a54,59
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
59d61
<   width: extend-to-zoom;
74c76
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
76a79
>   overflow-wrap: break-word;
162a166,174
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
176a189
>   display: table;
255c268
< tt, code, pre, code {
---
> tt, code, pre {
257c270
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
296a310,312
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
494c510
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
634d649
< 
657c672
<   pre.breakable {
---
>   .breakable pre {
727c742
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
827c842
< tt, code, pre, code {
---
> tt, code, pre {
832c847
< pre.sourcecode,
---
> .sourcecode pre,
868c883
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1049a1065
>   .artwork > pre,
1064c1080
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1070a1087,1089
> tr {
>   break-inside: avoid;
> }
1121c1140
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1146c1165
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1164c1183
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1178c1197
< li > p:last-of-type {
---
> li > p:last-of-type:only-child {
1182a1202
> <link href="https://datatracker.ietf.org/doc/draft-ietf-tcpm-rfc793bis-28" rel="prev">
1185c1205
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-tcpm-rfc793bis-28" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1187,1188c1207,1208
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1299c1319
<             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-purpose-and-scope" class="xref">Purpose and Scope</a></p>
---
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-purpose-and-scope" class="internal xref">Purpose and Scope</a></p>
1302c1322
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
---
>             <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
1305c1325
<                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
---
>                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
1308c1328
<                 <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-key-tcp-concepts" class="xref">Key TCP Concepts</a></p>
---
>                 <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-key-tcp-concepts" class="internal xref">Key TCP Concepts</a></p>
1313c1333
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-functional-specification" class="xref">Functional Specification</a></p>
---
>             <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-functional-specification" class="internal xref">Functional Specification</a></p>
1316c1336
<                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-header-format" class="xref">Header Format</a></p>
---
>                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-header-format" class="internal xref">Header Format</a></p>
1319c1339
<                 <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-specific-option-definitions" class="xref">Specific Option Definitions</a></p>
---
>                 <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-specific-option-definitions" class="internal xref">Specific Option Definitions</a></p>
1322c1342
<                     <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-other-common-options" class="xref">Other Common Options</a></p>
---
>                     <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-other-common-options" class="internal xref">Other Common Options</a></p>
1325c1345
<                     <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-experimental-tcp-options" class="xref">Experimental TCP Options</a></p>
---
>                     <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-experimental-tcp-options" class="internal xref">Experimental TCP Options</a></p>
1330c1350
<                 <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-tcp-terminology-overview" class="xref">TCP Terminology Overview</a></p>
---
>                 <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-tcp-terminology-overview" class="internal xref">TCP Terminology Overview</a></p>
1333c1353
<                     <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-key-connection-state-variab" class="xref">Key Connection State Variables</a></p>
---
>                     <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-key-connection-state-variab" class="internal xref">Key Connection State Variables</a></p>
1336c1356
<                     <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-state-machine-overview" class="xref">State Machine Overview</a></p>
---
>                     <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-state-machine-overview" class="internal xref">State Machine Overview</a></p>
1341c1361
<                 <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-sequence-numbers" class="xref">Sequence Numbers</a></p>
---
>                 <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-sequence-numbers" class="internal xref">Sequence Numbers</a></p>
1344c1364
<                     <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-initial-sequence-number-sel" class="xref">Initial Sequence Number Selection</a></p>
---
>                     <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-initial-sequence-number-sel" class="internal xref">Initial Sequence Number Selection</a></p>
1347c1367
<                     <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-knowing-when-to-keep-quiet" class="xref">Knowing When to Keep Quiet</a></p>
---
>                     <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-knowing-when-to-keep-quiet" class="internal xref">Knowing When to Keep Quiet</a></p>
1350c1370
<                     <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-the-tcp-quiet-time-concept" class="xref">The TCP Quiet Time Concept</a></p>
---
>                     <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="auto internal xref">3.4.3</a>.  <a href="#name-the-tcp-quiet-time-concept" class="internal xref">The TCP Quiet Time Concept</a></p>
1355c1375
<                 <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-establishing-a-connection" class="xref">Establishing a Connection</a></p>
---
>                 <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-establishing-a-connection" class="internal xref">Establishing a Connection</a></p>
1358c1378
<                     <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-half-open-connections-and-o" class="xref">Half-Open Connections and Other Anomalies</a></p>
---
>                     <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-half-open-connections-and-o" class="internal xref">Half-Open Connections and Other Anomalies</a></p>
1361c1381
<                     <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-reset-generation" class="xref">Reset Generation</a></p>
---
>                     <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-reset-generation" class="internal xref">Reset Generation</a></p>
1364c1384
<                     <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="xref">3.5.3</a>.  <a href="#name-reset-processing" class="xref">Reset Processing</a></p>
---
>                     <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-reset-processing" class="internal xref">Reset Processing</a></p>
1369c1389
<                 <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-closing-a-connection" class="xref">Closing a Connection</a></p>
---
>                 <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-closing-a-connection" class="internal xref">Closing a Connection</a></p>
1372c1392
<                     <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="xref">3.6.1</a>.  <a href="#name-half-closed-connections" class="xref">Half-Closed Connections</a></p>
---
>                     <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-half-closed-connections" class="internal xref">Half-Closed Connections</a></p>
1377c1397
<                 <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-segmentation" class="xref">Segmentation</a></p>
---
>                 <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-segmentation" class="internal xref">Segmentation</a></p>
1380c1400
<                     <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-maximum-segment-size-option" class="xref">Maximum Segment Size Option</a></p>
---
>                     <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-maximum-segment-size-option" class="internal xref">Maximum Segment Size Option</a></p>
1383c1403
<                     <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="xref">3.7.2</a>.  <a href="#name-path-mtu-discovery" class="xref">Path MTU Discovery</a></p>
---
>                     <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="auto internal xref">3.7.2</a>.  <a href="#name-path-mtu-discovery" class="internal xref">Path MTU Discovery</a></p>
1386c1406
<                     <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="xref">3.7.3</a>.  <a href="#name-interfaces-with-variable-mt" class="xref">Interfaces with Variable MTU Values</a></p>
---
>                     <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="auto internal xref">3.7.3</a>.  <a href="#name-interfaces-with-variable-mt" class="internal xref">Interfaces with Variable MTU Values</a></p>
1389c1409
<                     <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="xref">3.7.4</a>.  <a href="#name-nagle-algorithm" class="xref">Nagle Algorithm</a></p>
---
>                     <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="auto internal xref">3.7.4</a>.  <a href="#name-nagle-algorithm" class="internal xref">Nagle Algorithm</a></p>
1392c1412
<                     <p id="section-toc.1-1.3.2.7.2.5.1"><a href="#section-3.7.5" class="xref">3.7.5</a>.  <a href="#name-ipv6-jumbograms" class="xref">IPv6 Jumbograms</a></p>
---
>                     <p id="section-toc.1-1.3.2.7.2.5.1"><a href="#section-3.7.5" class="auto internal xref">3.7.5</a>.  <a href="#name-ipv6-jumbograms" class="internal xref">IPv6 Jumbograms</a></p>
1397c1417
<                 <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-data-communication" class="xref">Data Communication</a></p>
---
>                 <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-data-communication" class="internal xref">Data Communication</a></p>
1400c1420
<                     <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="xref">3.8.1</a>.  <a href="#name-retransmission-timeout" class="xref">Retransmission Timeout</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.1.1"><a href="#section-3.8.1" class="auto internal xref">3.8.1</a>.  <a href="#name-retransmission-timeout" class="internal xref">Retransmission Timeout</a></p>
1403c1423
<                     <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="xref">3.8.2</a>.  <a href="#name-tcp-congestion-control" class="xref">TCP Congestion Control</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.2.1"><a href="#section-3.8.2" class="auto internal xref">3.8.2</a>.  <a href="#name-tcp-congestion-control" class="internal xref">TCP Congestion Control</a></p>
1406c1426
<                     <p id="section-toc.1-1.3.2.8.2.3.1"><a href="#section-3.8.3" class="xref">3.8.3</a>.  <a href="#name-tcp-connection-failures" class="xref">TCP Connection Failures</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.3.1"><a href="#section-3.8.3" class="auto internal xref">3.8.3</a>.  <a href="#name-tcp-connection-failures" class="internal xref">TCP Connection Failures</a></p>
1409c1429
<                     <p id="section-toc.1-1.3.2.8.2.4.1"><a href="#section-3.8.4" class="xref">3.8.4</a>.  <a href="#name-tcp-keep-alives" class="xref">TCP Keep-Alives</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.4.1"><a href="#section-3.8.4" class="auto internal xref">3.8.4</a>.  <a href="#name-tcp-keep-alives" class="internal xref">TCP Keep-Alives</a></p>
1412c1432
<                     <p id="section-toc.1-1.3.2.8.2.5.1"><a href="#section-3.8.5" class="xref">3.8.5</a>.  <a href="#name-the-communication-of-urgent" class="xref">The Communication of Urgent Information</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.5.1"><a href="#section-3.8.5" class="auto internal xref">3.8.5</a>.  <a href="#name-the-communication-of-urgent" class="internal xref">The Communication of Urgent Information</a></p>
1415c1435
<                     <p id="section-toc.1-1.3.2.8.2.6.1"><a href="#section-3.8.6" class="xref">3.8.6</a>.  <a href="#name-managing-the-window" class="xref">Managing the Window</a></p>
---
>                     <p id="section-toc.1-1.3.2.8.2.6.1"><a href="#section-3.8.6" class="auto internal xref">3.8.6</a>.  <a href="#name-managing-the-window" class="internal xref">Managing the Window</a></p>
1420c1440
<                 <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-interfaces" class="xref">Interfaces</a></p>
---
>                 <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-interfaces" class="internal xref">Interfaces</a></p>
1423c1443
<                     <p id="section-toc.1-1.3.2.9.2.1.1"><a href="#section-3.9.1" class="xref">3.9.1</a>.  <a href="#name-user-tcp-interface" class="xref">User/TCP Interface</a></p>
---
>                     <p id="section-toc.1-1.3.2.9.2.1.1"><a href="#section-3.9.1" class="auto internal xref">3.9.1</a>.  <a href="#name-user-tcp-interface" class="internal xref">User/TCP Interface</a></p>
1426c1446
<                     <p id="section-toc.1-1.3.2.9.2.2.1"><a href="#section-3.9.2" class="xref">3.9.2</a>.  <a href="#name-tcp-lower-level-interface" class="xref">TCP/Lower-Level Interface</a></p>
---
>                     <p id="section-toc.1-1.3.2.9.2.2.1"><a href="#section-3.9.2" class="auto internal xref">3.9.2</a>.  <a href="#name-tcp-lower-level-interface" class="internal xref">TCP/Lower-Level Interface</a></p>
1431c1451
<                 <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-event-processing" class="xref">Event Processing</a></p>
---
>                 <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="auto internal xref">3.10</a>. <a href="#name-event-processing" class="internal xref">Event Processing</a></p>
1434c1454
<                     <p id="section-toc.1-1.3.2.10.2.1.1"><a href="#section-3.10.1" class="xref">3.10.1</a>.  <a href="#name-open-call" class="xref">OPEN Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.1.1"><a href="#section-3.10.1" class="auto internal xref">3.10.1</a>.  <a href="#name-open-call" class="internal xref">OPEN Call</a></p>
1437c1457
<                     <p id="section-toc.1-1.3.2.10.2.2.1"><a href="#section-3.10.2" class="xref">3.10.2</a>.  <a href="#name-send-call" class="xref">SEND Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.2.1"><a href="#section-3.10.2" class="auto internal xref">3.10.2</a>.  <a href="#name-send-call" class="internal xref">SEND Call</a></p>
1440c1460
<                     <p id="section-toc.1-1.3.2.10.2.3.1"><a href="#section-3.10.3" class="xref">3.10.3</a>.  <a href="#name-receive-call" class="xref">RECEIVE Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.3.1"><a href="#section-3.10.3" class="auto internal xref">3.10.3</a>.  <a href="#name-receive-call" class="internal xref">RECEIVE Call</a></p>
1443c1463
<                     <p id="section-toc.1-1.3.2.10.2.4.1"><a href="#section-3.10.4" class="xref">3.10.4</a>.  <a href="#name-close-call" class="xref">CLOSE Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.4.1"><a href="#section-3.10.4" class="auto internal xref">3.10.4</a>.  <a href="#name-close-call" class="internal xref">CLOSE Call</a></p>
1446c1466
<                     <p id="section-toc.1-1.3.2.10.2.5.1"><a href="#section-3.10.5" class="xref">3.10.5</a>.  <a href="#name-abort-call" class="xref">ABORT Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.5.1"><a href="#section-3.10.5" class="auto internal xref">3.10.5</a>.  <a href="#name-abort-call" class="internal xref">ABORT Call</a></p>
1449c1469
<                     <p id="section-toc.1-1.3.2.10.2.6.1"><a href="#section-3.10.6" class="xref">3.10.6</a>.  <a href="#name-status-call" class="xref">STATUS Call</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.6.1"><a href="#section-3.10.6" class="auto internal xref">3.10.6</a>.  <a href="#name-status-call" class="internal xref">STATUS Call</a></p>
1452c1472
<                     <p id="section-toc.1-1.3.2.10.2.7.1"><a href="#section-3.10.7" class="xref">3.10.7</a>.  <a href="#name-segment-arrives" class="xref">SEGMENT ARRIVES</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.7.1"><a href="#section-3.10.7" class="auto internal xref">3.10.7</a>.  <a href="#name-segment-arrives" class="internal xref">SEGMENT ARRIVES</a></p>
1455c1475
<                     <p id="section-toc.1-1.3.2.10.2.8.1"><a href="#section-3.10.8" class="xref">3.10.8</a>.  <a href="#name-timeouts" class="xref">Timeouts</a></p>
---
>                     <p id="section-toc.1-1.3.2.10.2.8.1"><a href="#section-3.10.8" class="auto internal xref">3.10.8</a>.  <a href="#name-timeouts" class="internal xref">Timeouts</a></p>
1462c1482
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-glossary" class="xref">Glossary</a></p>
---
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-glossary" class="internal xref">Glossary</a></p>
1465c1485
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-changes-from-rfc-793" class="xref">Changes from RFC 793</a></p>
---
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-changes-from-rfc-793" class="internal xref">Changes from RFC 793</a></p>
1468c1488
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
---
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
1471c1491
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-and-privacy-consid" class="xref">Security and Privacy Considerations</a></p>
---
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-and-privacy-consid" class="internal xref">Security and Privacy Considerations</a></p>
1474c1494
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
---
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
1477c1497
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
---
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1480c1500
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
---
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1485c1505
<             <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-other-implementation-notes" class="xref">Other Implementation Notes</a></p>
---
>             <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-other-implementation-notes" class="internal xref">Other Implementation Notes</a></p>
1488c1508
<                 <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-ip-security-compartment-and" class="xref">IP Security Compartment and Precedence</a></p>
---
>                 <p id="section-toc.1-1.9.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-ip-security-compartment-and" class="internal xref">IP Security Compartment and Precedence</a></p>
1491c1511
<                     <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#appendix-A.1.1" class="xref">A.1.1</a>.  <a href="#name-precedence" class="xref">Precedence</a></p>
---
>                     <p id="section-toc.1-1.9.2.1.2.1.1"><a href="#appendix-A.1.1" class="auto internal xref">A.1.1</a>.  <a href="#name-precedence" class="internal xref">Precedence</a></p>
1494c1514
<                     <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#appendix-A.1.2" class="xref">A.1.2</a>.  <a href="#name-mls-systems" class="xref">MLS Systems</a></p>
---
>                     <p id="section-toc.1-1.9.2.1.2.2.1"><a href="#appendix-A.1.2" class="auto internal xref">A.1.2</a>.  <a href="#name-mls-systems" class="internal xref">MLS Systems</a></p>
1499c1519
<                 <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-sequence-number-validation" class="xref">Sequence Number Validation</a></p>
---
>                 <p id="section-toc.1-1.9.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-sequence-number-validation" class="internal xref">Sequence Number Validation</a></p>
1502c1522
<                 <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-nagle-modification" class="xref">Nagle Modification</a></p>
---
>                 <p id="section-toc.1-1.9.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-nagle-modification" class="internal xref">Nagle Modification</a></p>
1505c1525
<                 <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-low-watermark-settings" class="xref">Low Watermark Settings</a></p>
---
>                 <p id="section-toc.1-1.9.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-low-watermark-settings" class="internal xref">Low Watermark Settings</a></p>
1510c1530
<             <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-tcp-requirement-summary" class="xref">TCP Requirement Summary</a></p>
---
>             <p id="section-toc.1-1.10.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-tcp-requirement-summary" class="internal xref">TCP Requirement Summary</a></p>
1513c1533
<             <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
---
>             <p id="section-toc.1-1.11.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
1516c1536
<             <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
---
>             <p id="section-toc.1-1.12.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
1527c1547
<         In 1981, <span><a href="#RFC0793" class="xref">RFC 793</a> [<a href="#RFC0793" class="xref">16</a>]</span> was released, documenting the Transmission Control Protocol (TCP) and replacing earlier published specifications for TCP.<a href="#section-1-1" class="pilcrow">¶</a></p>
---
>         In 1981, <span><a href="#RFC0793" class="internal xref">RFC 793</a> [<a href="#RFC0793" class="cite xref">16</a>]</span> was released, documenting the Transmission Control Protocol (TCP) and replacing earlier published specifications for TCP.<a href="#section-1-1" class="pilcrow">¶</a></p>
1531c1551
<         For several decades, RFC 793 plus a number of other documents have combined to serve as the core specification for TCP <span>[<a href="#RFC7414" class="xref">49</a>]</span>.  Over time, a number of errata have been filed against RFC 793.  There have also been deficiencies found and resolved in security, performance, and many other aspects.  The number of enhancements has grown over time across many separate documents.  These were never accumulated together into a comprehensive update to the base specification.<a href="#section-1-3" class="pilcrow">¶</a></p>
---
>         For several decades, RFC 793 plus a number of other documents have combined to serve as the core specification for TCP <span>[<a href="#RFC7414" class="cite xref">49</a>]</span>.  Over time, a number of errata have been filed against RFC 793.  There have also been deficiencies found and resolved in security, performance, and many other aspects.  The number of enhancements has grown over time across many separate documents.  These were never accumulated together into a comprehensive update to the base specification.<a href="#section-1-3" class="pilcrow">¶</a></p>
1549c1569
<  The "TCP Roadmap" <span>[<a href="#RFC7414" class="xref">49</a>]</span> provides a more extensive guide to the RFCs that define TCP and describe various important algorithms. The TCP Roadmap contains sections on strongly encouraged enhancements that improve performance and other aspects of TCP beyond the basic operation specified in this document.  As one example, implementing congestion control (e.g., <span>[<a href="#RFC5681" class="xref">8</a>]</span>) is a TCP requirement, but it is a complex topic on its own and not described in detail in this document, as there are many options and possibilities that do not impact basic interoperability.  Similarly, most TCP implementations today include the high-performance extensions in <span>[<a href="#RFC7323" class="xref">47</a>]</span>, but these are not strictly required or discussed in this document.  Multipath considerations for TCP are also specified separately in <span>[<a href="#RFC8684" class="xref">59</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
---
>  The "TCP Roadmap" <span>[<a href="#RFC7414" class="cite xref">49</a>]</span> provides a more extensive guide to the RFCs that define TCP and describe various important algorithms. The TCP Roadmap contains sections on strongly encouraged enhancements that improve performance and other aspects of TCP beyond the basic operation specified in this document.  As one example, implementing congestion control (e.g., <span>[<a href="#RFC5681" class="cite xref">8</a>]</span>) is a TCP requirement, but it is a complex topic on its own and not described in detail in this document, as there are many options and possibilities that do not impact basic interoperability.  Similarly, most TCP implementations today include the high-performance extensions in <span>[<a href="#RFC7323" class="cite xref">47</a>]</span>, but these are not strictly required or discussed in this document.  Multipath considerations for TCP are also specified separately in <span>[<a href="#RFC8684" class="cite xref">59</a>]</span>.<a href="#section-2-3" class="pilcrow">¶</a></p>
1551c1571
<         A list of changes from RFC 793 is contained in <a href="#changes" class="xref">Section 5</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
---
>         A list of changes from RFC 793 is contained in <a href="#changes" class="auto internal xref">Section 5</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
1561c1581
< interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">3</a>]</span> <span>[<a href="#RFC8174" class="xref">12</a>]</span> when, and only when, they appear in all capitals, as shown 
---
> interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">3</a>]</span> <span>[<a href="#RFC8174" class="cite xref">12</a>]</span> when, and only when, they appear in all capitals, as shown 
1566c1586
< referenced in <a href="#reqs" class="xref">Appendix B</a>, which summarizes implementation
---
> referenced in <a href="#reqs" class="auto internal xref">Appendix B</a>, which summarizes implementation
1572c1592
< referenced from <a href="#reqs" class="xref">Appendix B</a>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
---
> referenced from <a href="#reqs" class="auto internal xref">Appendix B</a>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
1595c1615
< instability due to changes of lower-layer forwarding behavior <span>[<a href="#RFC7094" class="xref">46</a>]</span>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
---
> instability due to changes of lower-layer forwarding behavior <span>[<a href="#RFC7094" class="cite xref">46</a>]</span>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
1604c1624
< protocols can be found in <span><a href="https://www.rfc-editor.org/rfc/rfc8095#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8095" class="xref">52</a>]</span>.  Further
---
> protocols can be found in <span><a href="https://rfc-editor.org/rfc/rfc8095#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8095" class="cite xref">52</a>]</span>.  Further
1606c1626
< protocol stack can be found in <span><a href="https://www.rfc-editor.org/rfc/rfc793#section-2" class="relref">Section 2</a> of [<a href="#RFC0793" class="xref">16</a>]</span> and earlier versions
---
> protocol stack can be found in <span><a href="https://rfc-editor.org/rfc/rfc793#section-2" class="relref">Section 2</a> of [<a href="#RFC0793" class="cite xref">16</a>]</span> and earlier versions
1621c1641
<   destination host addresses <span>[<a href="#RFC0791" class="xref">1</a>]</span> <span>[<a href="#RFC8200" class="xref">13</a>]</span>.  A TCP header follows the IP
---
>   destination host addresses <span>[<a href="#RFC0791" class="cite xref">1</a>]</span> <span>[<a href="#RFC8200" class="cite xref">13</a>]</span>.  A TCP header follows the IP
1627c1647
< <p id="section-3.1-3">A TCP header, followed by any user data in the segment, is formatted as follows, using the style from <span>[<a href="#I-D.mcquistin-augmented-ascii-diagrams" class="xref">66</a>]</span>:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
---
> <p id="section-3.1-3">A TCP header, followed by any user data in the segment, is formatted as follows, using the style from <span>[<a href="#I-D.mcquistin-augmented-ascii-diagrams" class="cite xref">66</a>]</span>:<a href="#section-3.1-3" class="pilcrow">¶</a></p>
1721c1741
<    The control bits are also known as "flags".  Assignment is managed by IANA from the "TCP Header Flags" registry <span>[<a href="#TCP-parameters-registry" class="xref">62</a>]</span>.  The currently assigned control bits are CWR, ECE, URG, ACK, PSH, RST, SYN, and FIN.<a href="#section-3.1-6.14.1" class="pilcrow">¶</a></p>
---
>    The control bits are also known as "flags".  Assignment is managed by IANA from the "TCP Header Flags" registry <span>[<a href="#TCP-parameters-registry" class="cite xref">62</a>]</span>.  The currently assigned control bits are CWR, ECE, URG, ACK, PSH, RST, SYN, and FIN.<a href="#section-3.1-6.14.1" class="pilcrow">¶</a></p>
1728c1748
<     Congestion Window Reduced (see <span>[<a href="#RFC3168" class="xref">6</a>]</span>).<a href="#section-3.1-6.14.2.2.2" class="pilcrow">¶</a></p>
---
>     Congestion Window Reduced (see <span>[<a href="#RFC3168" class="cite xref">6</a>]</span>).<a href="#section-3.1-6.14.2.2.2" class="pilcrow">¶</a></p>
1736c1756
<     ECN-Echo (see <span>[<a href="#RFC3168" class="xref">6</a>]</span>).<a href="#section-3.1-6.14.2.4.2" class="pilcrow">¶</a></p>
---
>     ECN-Echo (see <span>[<a href="#RFC3168" class="cite xref">6</a>]</span>).<a href="#section-3.1-6.14.2.4.2" class="pilcrow">¶</a></p>
1760c1780
<     Push function (see the Send Call description in <a href="#user-api" class="xref">Section 3.9.1</a>).<a href="#section-3.1-6.14.2.10.2" class="pilcrow">¶</a></p>
---
>     Push function (see the Send Call description in <a href="#user-api" class="auto internal xref">Section 3.9.1</a>).<a href="#section-3.1-6.14.2.10.2" class="pilcrow">¶</a></p>
1798c1818
<     <span>[<a href="#RFC7323" class="xref">47</a>]</span>.<a href="#section-3.1-6.16.2" class="pilcrow">¶</a></p>
---
>     <span>[<a href="#RFC7323" class="cite xref">47</a>]</span>.<a href="#section-3.1-6.16.2" class="pilcrow">¶</a></p>
1820c1840
<     The checksum also covers a pseudo-header (<a href="#v4pseudo" class="xref">Figure 2</a>) conceptually prefixed to the TCP
---
>     The checksum also covers a pseudo-header (<a href="#v4pseudo" class="auto internal xref">Figure 2</a>) conceptually prefixed to the TCP
1875c1895
<        For IPv6, the pseudo-header is defined in Section <a href="https://www.rfc-editor.org/rfc/rfc8200#section-8.1" class="relref">8.1</a> of RFC 8200 <span>[<a href="#RFC8200" class="xref">13</a>]</span> and contains the IPv6 Source Address and Destination Address, an Upper-Layer Packet Length (a 32-bit value otherwise equivalent to TCP Length in the IPv4 pseudo-header), three bytes of zero padding, and a Next Header value, which differs from the IPv6 header value if there are extension headers present between IPv6 and TCP.<a href="#section-3.1-6.18.6" class="pilcrow">¶</a></p>
---
>        For IPv6, the pseudo-header is defined in Section <a href="https://rfc-editor.org/rfc/rfc8200#section-8.1" class="relref">8.1</a> of RFC 8200 <span>[<a href="#RFC8200" class="cite xref">13</a>]</span> and contains the IPv6 Source Address and Destination Address, an Upper-Layer Packet Length (a 32-bit value otherwise equivalent to TCP Length in the IPv4 pseudo-header), three bytes of zero padding, and a Next Header value, which differs from the IPv6 header value if there are extension headers present between IPv6 and TCP.<a href="#section-3.1-6.18.6" class="pilcrow">¶</a></p>
1921c1941
<     The list of all currently defined options is managed by IANA <span>[<a href="#TCP-parameters-registry" class="xref">62</a>]</span>, and each option is defined in other RFCs, as indicated there.  That set includes experimental options that can be extended to support multiple concurrent usages <span>[<a href="#RFC6994" class="xref">45</a>]</span>.<a href="#section-3.1-6.22.6" class="pilcrow">¶</a></p>
---
>     The list of all currently defined options is managed by IANA <span>[<a href="#TCP-parameters-registry" class="cite xref">62</a>]</span>, and each option is defined in other RFCs, as indicated there.  That set includes experimental options that can be extended to support multiple concurrent usages <span>[<a href="#RFC6994" class="cite xref">45</a>]</span>.<a href="#section-3.1-6.22.6" class="pilcrow">¶</a></p>
1923c1943
<    A given TCP implementation can support any currently defined options, but the following options <span class="bcp14">MUST</span> be supported (MUST-4 -- note Maximum Segment Size Option support is also part of MUST-14 in <a href="#mss" class="xref">Section 3.7.1</a>):<a href="#section-3.1-6.22.7" class="pilcrow">¶</a></p>
---
>    A given TCP implementation can support any currently defined options, but the following options <span class="bcp14">MUST</span> be supported (MUST-4 -- note Maximum Segment Size Option support is also part of MUST-14 in <a href="#mss" class="auto internal xref">Section 3.7.1</a>):<a href="#section-3.1-6.22.7" class="pilcrow">¶</a></p>
1955c1975
<     These options are specified in detail in <a href="#Option-Definitions" class="xref">Section 3.2</a>.<a href="#section-3.1-6.22.9" class="pilcrow">¶</a></p>
---
>     These options are specified in detail in <a href="#Option-Definitions" class="auto internal xref">Section 3.2</a>.<a href="#section-3.1-6.22.9" class="pilcrow">¶</a></p>
1965c1985
< <p id="section-3.1-6.22.12">Note: There is ongoing work to extend the space available for TCP Options, such as <span>[<a href="#I-D.ietf-tcpm-tcp-edo" class="xref">65</a>]</span>.<a href="#section-3.1-6.22.12" class="pilcrow">¶</a></p>
---
> <p id="section-3.1-6.22.12">Note: There is ongoing work to extend the space available for TCP Options, such as <span>[<a href="#I-D.ietf-tcpm-tcp-edo" class="cite xref">65</a>]</span>.<a href="#section-3.1-6.22.12" class="pilcrow">¶</a></p>
2060c2080
<         A more complete description of this option is provided in <a href="#mss" class="xref">Section 3.7.1</a>.<a href="#section-3.2-13.2.2" class="pilcrow">¶</a></p>
---
>         A more complete description of this option is provided in <a href="#mss" class="auto internal xref">Section 3.7.1</a>.<a href="#section-3.2-13.2.2" class="pilcrow">¶</a></p>
2085c2105
< Additional RFCs define some other commonly used options that are recommended to implement for high performance but are not necessary for basic TCP interoperability.  These are the TCP Selective Acknowledgment (SACK) Option <span>[<a href="#RFC2018" class="xref">22</a>]</span> <span>[<a href="#RFC2883" class="xref">26</a>]</span>, TCP Timestamp (TS) Option <span>[<a href="#RFC7323" class="xref">47</a>]</span>, and TCP Window Scale (WS) Option <span>[<a href="#RFC7323" class="xref">47</a>]</span>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
---
> Additional RFCs define some other commonly used options that are recommended to implement for high performance but are not necessary for basic TCP interoperability.  These are the TCP Selective Acknowledgment (SACK) Option <span>[<a href="#RFC2018" class="cite xref">22</a>]</span> <span>[<a href="#RFC2883" class="cite xref">26</a>]</span>, TCP Timestamp (TS) Option <span>[<a href="#RFC7323" class="cite xref">47</a>]</span>, and TCP Window Scale (WS) Option <span>[<a href="#RFC7323" class="cite xref">47</a>]</span>.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
2092c2112
< Experimental TCP Option values are defined in <span>[<a href="#RFC4727" class="xref">30</a>]</span>, and <span>[<a href="#RFC6994" class="xref">45</a>]</span> describes the current recommended usage for these experimental values.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
---
> Experimental TCP Option values are defined in <span>[<a href="#RFC4727" class="cite xref">30</a>]</span>, and <span>[<a href="#RFC6994" class="cite xref">45</a>]</span> describes the current recommended usage for these experimental values.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
2101c2121
< This section includes an overview of key terms needed to understand the detailed protocol operation in the rest of the document.  There is a glossary of terms in <a href="#glossary" class="xref">Section 4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
---
> This section includes an overview of key terms needed to understand the detailed protocol operation in the rest of the document.  There is a glossary of terms in <a href="#glossary" class="auto internal xref">Section 4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
2113c2133
<   of the connection (see <a href="#seccomp" class="xref">Appendix A.1</a>), pointers to the user's send and receive
---
>   of the connection (see <a href="#seccomp" class="auto internal xref">Appendix A.1</a>), pointers to the user's send and receive
2213c2233
<   <a href="#send_seq_space" class="xref">Figure 3</a>.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
---
>   <a href="#send_seq_space" class="auto internal xref">Figure 3</a>.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
2234c2254
<   <a href="#recv_seq_space" class="xref">Figure 4</a>.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
---
>   <a href="#recv_seq_space" class="auto internal xref">Figure 4</a>.<a href="#section-3.3.1-8" class="pilcrow">¶</a></p>
2359c2379
<   The state diagram in <a href="#conn_states" class="xref">Figure 5</a> illustrates only state changes, together
---
>   The state diagram in <a href="#conn_states" class="auto internal xref">Figure 5</a> illustrates only state changes, together
2426c2446
< <p id="section-3.3.2-9">The following notes apply to <a href="#conn_states" class="xref">Figure 5</a>:<a href="#section-3.3.2-9" class="pilcrow">¶</a></p>
---
> <p id="section-3.3.2-9">The following notes apply to <a href="#conn_states" class="auto internal xref">Figure 5</a>:<a href="#section-3.3.2-9" class="pilcrow">¶</a></p>
2442c2462
<             <dd style="margin-left: 1.5em" id="section-3.3.2-10.6">A RST can be sent from any state with a corresponding transition to TIME-WAIT (see <span>[<a href="#FTY99" class="xref">70</a>]</span> for rationale).  These transitions are not explicitly shown; otherwise, the diagram would become very difficult to read.  Similarly, receipt of a RST from any state results in a transition to LISTEN or CLOSED, though this is also omitted from the diagram for legibility.<a href="#section-3.3.2-10.6" class="pilcrow">¶</a>
---
>             <dd style="margin-left: 1.5em" id="section-3.3.2-10.6">A RST can be sent from any state with a corresponding transition to TIME-WAIT (see <span>[<a href="#FTY99" class="cite xref">70</a>]</span> for rationale).  These transitions are not explicitly shown; otherwise, the diagram would become very difficult to read.  Similarly, receipt of a RST from any state results in a transition to LISTEN or CLOSED, though this is also omitted from the diagram for legibility.<a href="#section-3.3.2-10.6" class="pilcrow">¶</a>
2638c2658
<   attacker is able to predict or guess ISN values <span>[<a href="#RFC6528" class="xref">42</a>]</span>.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
---
>   attacker is able to predict or guess ISN values <span>[<a href="#RFC6528" class="cite xref">42</a>]</span>.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
2651c2671
< mentioned later in <a href="#tcp_quiet_time_concept" class="xref">Section 3.4.3</a>.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
---
> mentioned later in <a href="#tcp_quiet_time_concept" class="auto internal xref">Section 3.4.3</a>.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
2659c2679
<    function (PRF) of the connection's identifying parameters ("localip, localport, remoteip, remoteport") and a secret key ("secretkey") (SHLD-1).  F() <span class="bcp14">MUST NOT</span> be computable from the outside (MUST-9), or an attacker could still guess at sequence numbers from the ISN used for some other connection.  The PRF could be implemented as a cryptographic hash of the concatenation of the TCP connection parameters and some secret data.  For discussion of the selection of a specific hash algorithm and management of the secret key data, please see <span><a href="https://www.rfc-editor.org/rfc/rfc6528#section-3" class="relref">Section 3</a> of [<a href="#RFC6528" class="xref">42</a>]</span>.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
---
>    function (PRF) of the connection's identifying parameters ("localip, localport, remoteip, remoteport") and a secret key ("secretkey") (SHLD-1).  F() <span class="bcp14">MUST NOT</span> be computable from the outside (MUST-9), or an attacker could still guess at sequence numbers from the ISN used for some other connection.  The PRF could be implemented as a cryptographic hash of the concatenation of the TCP connection parameters and some secret data.  For discussion of the selection of a specific hash algorithm and management of the secret key data, please see <span><a href="https://rfc-editor.org/rfc/rfc6528#section-3" class="relref">Section 3</a> of [<a href="#RFC6528" class="cite xref">42</a>]</span>.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
2698c2718
<   clock-driven scheme for ISN selection are discussed in <span>[<a href="#DS78" class="xref">69</a>]</span>.<a href="#section-3.4.1-12" class="pilcrow">¶</a></p>
---
>   clock-driven scheme for ISN selection are discussed in <span>[<a href="#DS78" class="cite xref">69</a>]</span>.<a href="#section-3.4.1-12" class="pilcrow">¶</a></p>
2836c2856
<     TCP Timestamp Options and Protection Against Wrapped Sequences (PAWS) <span>[<a href="#RFC7323" class="xref">47</a>]</span> provide the needed capability to detect and discard old
---
>     TCP Timestamp Options and Protection Against Wrapped Sequences (PAWS) <span>[<a href="#RFC7323" class="cite xref">47</a>]</span> provide the needed capability to detect and discard old
2867c2887
<   The simplest 3WHS is shown in <a href="#handshake" class="xref">Figure 6</a>.  The
---
>   The simplest 3WHS is shown in <a href="#handshake" class="auto internal xref">Figure 6</a>.  The
2902c2922
<   In line 2 of <a href="#handshake" class="xref">Figure 6</a>, TCP Peer A begins by sending a SYN segment
---
>   In line 2 of <a href="#handshake" class="auto internal xref">Figure 6</a>, TCP Peer A begins by sending a SYN segment
2916c2936
<   <a href="#simul_connect" class="xref">Figure 7</a>.  Each TCP peer's connection state cycles from CLOSED to SYN-SENT to SYN-RECEIVED to ESTABLISHED.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
---
>   <a href="#simul_connect" class="auto internal xref">Figure 7</a>.  Each TCP peer's connection state cycles from CLOSED to SYN-SENT to SYN-RECEIVED to ESTABLISHED.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
2987c3007
<   <a href="#dup_syn" class="xref">Figure 8</a>.  At line 3, an old duplicate SYN arrives at TCP Peer B.  TCP Peer B
---
>   <a href="#dup_syn" class="auto internal xref">Figure 8</a>.  At line 3, an old duplicate SYN arrives at TCP Peer B.  TCP Peer B
3025c3045
<   example shown in <a href="#half_open" class="xref">Figure 9</a>.  After TCP Peer A reboots, the user attempts to
---
>   example shown in <a href="#half_open" class="auto internal xref">Figure 9</a>.  After TCP Peer A reboots, the user attempts to
3061c3081
<   reduced to the basic three-way handshake of <a href="#handshake" class="xref">Figure 6</a>.<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
---
>   reduced to the basic three-way handshake of <a href="#handshake" class="auto internal xref">Figure 6</a>.<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
3065c3085
<   This is illustrated in <a href="#crash" class="xref">Figure 10</a>.  In this case, the data arriving at
---
>   This is illustrated in <a href="#crash" class="auto internal xref">Figure 10</a>.  In this case, the data arriving at
3087c3107
<   In <a href="#passive_reset" class="xref">Figure 11</a>, two TCP Peers A and B with passive connections
---
>   In <a href="#passive_reset" class="auto internal xref">Figure 11</a>, two TCP Peers A and B with passive connections
3122c3142
<   A TCP user or application can issue a reset on a connection at any time, though reset events are also generated by the protocol itself when various error conditions occur, as described below.  The side of a connection issuing a reset should enter the TIME-WAIT state, as this generally helps to reduce the load on busy servers for reasons described in <span>[<a href="#FTY99" class="xref">70</a>]</span>.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
---
>   A TCP user or application can issue a reset on a connection at any time, though reset events are also generated by the protocol itself when various error conditions occur, as described below.  The side of a connection issuing a reset should enter the TIME-WAIT state, as this generally helps to reduce the load on busy servers for reasons described in <span>[<a href="#FTY99" class="cite xref">70</a>]</span>.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
3148c3168
<     if an incoming segment has a security level or compartment (<a href="#seccomp" class="xref">Appendix A.1</a>) that
---
>     if an incoming segment has a security level or compartment (<a href="#seccomp" class="auto internal xref">Appendix A.1</a>) that
3226c3246
<     The user initiates by telling the TCP implementation to CLOSE the connection (TCP Peer A in <a href="#normal_close" class="xref">Figure 12</a>).<a href="#section-3.6-3.1" class="pilcrow">¶</a>
---
>     The user initiates by telling the TCP implementation to CLOSE the connection (TCP Peer A in <a href="#normal_close" class="auto internal xref">Figure 12</a>).<a href="#section-3.6-3.1" class="pilcrow">¶</a>
3231c3251
<     The remote TCP endpoint initiates by sending a FIN control signal (TCP Peer B in <a href="#normal_close" class="xref">Figure 12</a>).<a href="#section-3.6-3.2" class="pilcrow">¶</a>
---
>     The remote TCP endpoint initiates by sending a FIN control signal (TCP Peer B in <a href="#normal_close" class="auto internal xref">Figure 12</a>).<a href="#section-3.6-3.2" class="pilcrow">¶</a>
3236c3256
<     Both users CLOSE simultaneously (<a href="#simul_close" class="xref">Figure 13</a>).<a href="#section-3.6-3.3" class="pilcrow">¶</a>
---
>     Both users CLOSE simultaneously (<a href="#simul_close" class="auto internal xref">Figure 13</a>).<a href="#section-3.6-3.3" class="pilcrow">¶</a>
3276c3296
<     FIN segments to be exchanged (<a href="#simul_close" class="xref">Figure 13</a>).  When all segments preceding the FINs
---
>     FIN segments to be exchanged (<a href="#simul_close" class="auto internal xref">Figure 13</a>).  When all segments preceding the FINs
3337c3357
<             TCP close sequence using a FIN handshake (<a href="#normal_close" class="xref">Figure 12</a>), and (2) an "abort"
---
>             TCP close sequence using a FIN handshake (<a href="#normal_close" class="auto internal xref">Figure 12</a>), and (2) an "abort"
3362c3382
<      <span class="bcp14">SHOULD</span> send a RST to show that data was lost (SHLD-3).  See <span>[<a href="#RFC2525" class="xref">23</a>], <a href="https://www.rfc-editor.org/rfc/rfc2525#section-2.17" class="relref">Section 2.17</a></span> for discussion.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
---
>      <span class="bcp14">SHOULD</span> send a RST to show that data was lost (SHLD-3).  See <span>[<a href="#RFC2525" class="cite xref">23</a>], <a href="https://rfc-editor.org/rfc/rfc2525#section-2.17" class="relref">Section 2.17</a></span> for discussion.<a href="#section-3.6.1-2" class="pilcrow">¶</a></p>
3387c3407
< described in <span>[<a href="#RFC6191" class="xref">40</a>]</span> in order to support higher connection
---
> described in <span>[<a href="#RFC6191" class="cite xref">40</a>]</span> in order to support higher connection
3397c3417
< <p id="section-3.7-1"> The term "segmentation" refers to the activity TCP performs when ingesting a stream of bytes from a sending application and packetizing that stream of bytes into TCP segments.  Individual TCP segments often do not correspond one-for-one to individual send (or socket write) calls from the application.  Applications may perform writes at the granularity of messages in the upper-layer protocol, but TCP guarantees no correlation between the boundaries of TCP segments sent and received and the boundaries of the read or write buffers of user application data.  In some specific protocols, such as Remote Direct Memory Access (RDMA) using Direct Data Placement (DDP) and Marker PDU Aligned Framing (MPA) <span>[<a href="#RFC5044" class="xref">34</a>]</span>, there are performance optimizations possible when the relation between TCP segments and application data units can be controlled, and MPA includes a specific mechanism for detecting and verifying this relationship between TCP segments and application message data structures, but this is specific to applications like RDMA.  In general, multiple goals influence the sizing of TCP segments created by a TCP implementation.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.7-1"> The term "segmentation" refers to the activity TCP performs when ingesting a stream of bytes from a sending application and packetizing that stream of bytes into TCP segments.  Individual TCP segments often do not correspond one-for-one to individual send (or socket write) calls from the application.  Applications may perform writes at the granularity of messages in the upper-layer protocol, but TCP guarantees no correlation between the boundaries of TCP segments sent and received and the boundaries of the read or write buffers of user application data.  In some specific protocols, such as Remote Direct Memory Access (RDMA) using Direct Data Placement (DDP) and Marker PDU Aligned Framing (MPA) <span>[<a href="#RFC5044" class="cite xref">34</a>]</span>, there are performance optimizations possible when the relation between TCP segments and application data units can be controlled, and MPA includes a specific mechanism for detecting and verifying this relationship between TCP segments and application message data structures, but this is specific to applications like RDMA.  In general, multiple goals influence the sizing of TCP segments created by a TCP implementation.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
3436c3456
<     remote host, the EMTU_R <span>[<a href="#RFC1122" class="xref">19</a>]</span>) and the largest transmission size permitted by the IP layer (EMTU_S <span>[<a href="#RFC1122" class="xref">19</a>]</span>):<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
---
>     remote host, the EMTU_R <span>[<a href="#RFC1122" class="cite xref">19</a>]</span>) and the largest transmission size permitted by the IP layer (EMTU_S <span>[<a href="#RFC1122" class="cite xref">19</a>]</span>):<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
3462c3482
<    sender must decrease the size of the TCP data accordingly.  RFC 6691 <span>[<a href="#RFC6691" class="xref">43</a>]</span>
---
>    sender must decrease the size of the TCP data accordingly.  RFC 6691 <span>[<a href="#RFC6691" class="cite xref">43</a>]</span>
3473c3493
<     GET_MAXSIZES in Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.4" class="relref">3.4</a> of RFC 1122.  These are defined in terms of their IP MTU equivalents, EMTU_R and EMTU_S <span>[<a href="#RFC1122" class="xref">19</a>]</span>.<a href="#section-3.7.1-11" class="pilcrow">¶</a></p>
---
>     GET_MAXSIZES in Section <a href="https://rfc-editor.org/rfc/rfc1122#section-3.4" class="relref">3.4</a> of RFC 1122.  These are defined in terms of their IP MTU equivalents, EMTU_R and EMTU_S <span>[<a href="#RFC1122" class="cite xref">19</a>]</span>.<a href="#section-3.7.1-11" class="pilcrow">¶</a></p>
3478c3498
<     options.  This has been a point of confusion historically, as explained in RFC 6691, Section <a href="https://www.rfc-editor.org/rfc/rfc6691#section-3.1" class="relref">3.1</a>.<a href="#section-3.7.1-12" class="pilcrow">¶</a></p>
---
>     options.  This has been a point of confusion historically, as explained in RFC 6691, Section <a href="https://rfc-editor.org/rfc/rfc6691#section-3.1" class="relref">3.1</a>.<a href="#section-3.7.1-12" class="pilcrow">¶</a></p>
3487c3507
< <p id="section-3.7.2-2">PMTUD for IPv4 <span>[<a href="#RFC1191" class="xref">2</a>]</span> or IPv6 <span>[<a href="#RFC8201" class="xref">14</a>]</span> is implemented in conjunction between TCP, IP, and ICMP.  It relies both on avoiding source fragmentation and setting the IPv4 DF (don't fragment) flag, the latter to inhibit on-path fragmentation.  It relies on ICMP errors from routers along the path whenever a segment is too large to traverse a link.  Several adjustments to a TCP implementation with PMTUD are described in RFC 2923 in order to deal with problems experienced in practice <span>[<a href="#RFC2923" class="xref">27</a>]</span>.  PLPMTUD <span>[<a href="#RFC4821" class="xref">31</a>]</span> is a Standards Track improvement to PMTUD that relaxes the requirement for ICMP support across a path, and improves performance in cases where ICMP is not consistently conveyed, but still tries to avoid source fragmentation.  The mechanisms in all four of these RFCs are recommended to be included in TCP implementations.<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
---
> <p id="section-3.7.2-2">PMTUD for IPv4 <span>[<a href="#RFC1191" class="cite xref">2</a>]</span> or IPv6 <span>[<a href="#RFC8201" class="cite xref">14</a>]</span> is implemented in conjunction between TCP, IP, and ICMP.  It relies both on avoiding source fragmentation and setting the IPv4 DF (don't fragment) flag, the latter to inhibit on-path fragmentation.  It relies on ICMP errors from routers along the path whenever a segment is too large to traverse a link.  Several adjustments to a TCP implementation with PMTUD are described in RFC 2923 in order to deal with problems experienced in practice <span>[<a href="#RFC2923" class="cite xref">27</a>]</span>.  PLPMTUD <span>[<a href="#RFC4821" class="cite xref">31</a>]</span> is a Standards Track improvement to PMTUD that relaxes the requirement for ICMP support across a path, and improves performance in cases where ICMP is not consistently conveyed, but still tries to avoid source fragmentation.  The mechanisms in all four of these RFCs are recommended to be included in TCP implementations.<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
3490c3510
<    that can be received (see <span>[<a href="#RFC6691" class="xref">43</a>]</span>).  Hence, setting the value in the MSS Option too
---
>    that can be received (see <span>[<a href="#RFC6691" class="cite xref">43</a>]</span>).  Hence, setting the value in the MSS Option too
3501c3521
<    compression, e.g., RObust Header Compression (ROHC) <span>[<a href="#RFC5795" class="xref">37</a>]</span>.  It is
---
>    compression, e.g., RObust Header Compression (ROHC) <span>[<a href="#RFC5795" class="cite xref">37</a>]</span>.  It is
3519c3539
< <p id="section-3.7.4-1">The "Nagle algorithm" was described in RFC 896 <span>[<a href="#RFC0896" class="xref">17</a>]</span> and was recommended in RFC 1122 <span>[<a href="#RFC1122" class="xref">19</a>]</span> for mitigation of an early problem of too many small packets being generated.  It has been implemented in most current TCP code bases, sometimes with minor variations (see <a href="#minshall" class="xref">Appendix A.3</a>).<a href="#section-3.7.4-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.7.4-1">The "Nagle algorithm" was described in RFC 896 <span>[<a href="#RFC0896" class="cite xref">17</a>]</span> and was recommended in RFC 1122 <span>[<a href="#RFC1122" class="cite xref">19</a>]</span> for mitigation of an early problem of too many small packets being generated.  It has been implemented in most current TCP code bases, sometimes with minor variations (see <a href="#minshall" class="auto internal xref">Appendix A.3</a>).<a href="#section-3.7.4-1" class="pilcrow">¶</a></p>
3521c3541
< <p id="section-3.7.4-3">A TCP implementation <span class="bcp14">SHOULD</span> implement the Nagle algorithm to coalesce short segments (SHLD-7).  However, there <span class="bcp14">MUST</span> be a way for an application to disable the Nagle algorithm on an individual connection (MUST-17).  In all cases, sending data is also subject to the limitation imposed by the slow start algorithm <span>[<a href="#RFC5681" class="xref">8</a>]</span>.<a href="#section-3.7.4-3" class="pilcrow">¶</a></p>
---
> <p id="section-3.7.4-3">A TCP implementation <span class="bcp14">SHOULD</span> implement the Nagle algorithm to coalesce short segments (SHLD-7).  However, there <span class="bcp14">MUST</span> be a way for an application to disable the Nagle algorithm on an individual connection (MUST-17).  In all cases, sending data is also subject to the limitation imposed by the slow start algorithm <span>[<a href="#RFC5681" class="cite xref">8</a>]</span>.<a href="#section-3.7.4-3" class="pilcrow">¶</a></p>
3523c3543
<     Since there can be problematic interactions between the Nagle algorithm and delayed acknowledgments, some implementations use minor variations of the Nagle algorithm, such as the one described in <a href="#minshall" class="xref">Appendix A.3</a>.<a href="#section-3.7.4-4" class="pilcrow">¶</a></p>
---
>     Since there can be problematic interactions between the Nagle algorithm and delayed acknowledgments, some implementations use minor variations of the Nagle algorithm, such as the one described in <a href="#minshall" class="auto internal xref">Appendix A.3</a>.<a href="#section-3.7.4-4" class="pilcrow">¶</a></p>
3532c3552
<    be able to send TCP segments larger than the 64-KB limit that the MSS Option can convey.  RFC 2675 <span>[<a href="#RFC2675" class="xref">24</a>]</span>
---
>    be able to send TCP segments larger than the 64-KB limit that the MSS Option can convey.  RFC 2675 <span>[<a href="#RFC2675" class="cite xref">24</a>]</span>
3534c3554
<    MTU Discovery <span>[<a href="#RFC8201" class="xref">14</a>]</span> is used to determine the actual MSS.<a href="#section-3.7.5-1" class="pilcrow">¶</a></p>
---
>    MTU Discovery <span>[<a href="#RFC8201" class="cite xref">14</a>]</span> is used to determine the actual MSS.<a href="#section-3.7.5-1" class="pilcrow">¶</a></p>
3536c3556
<    The Jumbo Payload Option need not be implemented or understood by IPv6 nodes that do not support attachment to links with an MTU greater than 65,575 <span>[<a href="#RFC2675" class="xref">24</a>]</span>, and the present IPv6 Node Requirements does not include support for Jumbograms <span>[<a href="#RFC8504" class="xref">55</a>]</span>.<a href="#section-3.7.5-2" class="pilcrow">¶</a></p>
---
>    The Jumbo Payload Option need not be implemented or understood by IPv6 nodes that do not support attachment to links with an MTU greater than 65,575 <span>[<a href="#RFC2675" class="cite xref">24</a>]</span>, and the present IPv6 Node Requirements does not include support for Jumbograms <span>[<a href="#RFC8504" class="cite xref">55</a>]</span>.<a href="#section-3.7.5-2" class="pilcrow">¶</a></p>
3550c3570
<   As discussed in the section on sequence numbers (<a href="#sequence-numbers" class="xref">Section 3.4</a>), the TCP implementation performs
---
>   As discussed in the section on sequence numbers (<a href="#sequence-numbers" class="auto internal xref">Section 3.4</a>), the TCP implementation performs
3570c3590
<   The CLOSE user call implies a push function (see <a href="#user-api" class="xref">Section 3.9.1</a>), as does the FIN control
---
>   The CLOSE user call implies a push function (see <a href="#user-api" class="auto internal xref">Section 3.9.1</a>), as does the FIN control
3583c3603
<       algorithm in <span>[<a href="#RFC6298" class="xref">10</a>]</span>, including Karn's algorithm for taking RTT samples (MUST-18).<a href="#section-3.8.1-2" class="pilcrow">¶</a></p>
---
>       algorithm in <span>[<a href="#RFC6298" class="cite xref">10</a>]</span>, including Karn's algorithm for taking RTT samples (MUST-18).<a href="#section-3.8.1-2" class="pilcrow">¶</a></p>
3585c3605
<       RFC 793 contains an early example procedure for computing the RTO, based on work mentioned in IEN 177 <span>[<a href="#IEN177" class="xref">71</a>]</span>.  This was then replaced by the algorithm described in RFC 1122, which was subsequently updated in RFC 2988 and then again in RFC 6298.<a href="#section-3.8.1-3" class="pilcrow">¶</a></p>
---
>       RFC 793 contains an early example procedure for computing the RTO, based on work mentioned in IEN 177 <span>[<a href="#IEN177" class="cite xref">71</a>]</span>.  This was then replaced by the algorithm described in RFC 1122, which was subsequently updated in RFC 2988 and then again in RFC 6298.<a href="#section-3.8.1-3" class="pilcrow">¶</a></p>
3590c3610
< field <span class="bcp14">MAY</span> be used (see Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.2.1.5" class="relref">3.2.1.5</a> of RFC 1122) (MAY-4).  The same IP
---
> field <span class="bcp14">MAY</span> be used (see Section <a href="https://rfc-editor.org/rfc/rfc1122#section-3.2.1.5" class="relref">3.2.1.5</a> of RFC 1122) (MAY-4).  The same IP
3592c3612
< datagram is fragmented <span>[<a href="#RFC6864" class="xref">44</a>]</span>.  TCP implementations should not rely on or typically
---
> datagram is fragmented <span>[<a href="#RFC6864" class="cite xref">44</a>]</span>.  TCP implementations should not rely on or typically
3602c3622
< <p id="section-3.8.2-1">RFC 2914 <span>[<a href="#RFC2914" class="xref">5</a>]</span> explains the importance of congestion control for the Internet.<a href="#section-3.8.2-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.8.2-1">RFC 2914 <span>[<a href="#RFC2914" class="cite xref">5</a>]</span> explains the importance of congestion control for the Internet.<a href="#section-3.8.2-1" class="pilcrow">¶</a></p>
3604,3605c3624,3625
< <p id="section-3.8.2-3">A TCP endpoint <span class="bcp14">MUST</span> implement the basic congestion control algorithms slow start, congestion avoidance, and exponential backoff of RTO to avoid creating congestion collapse conditions (MUST-19).  RFC 5681 and RFC 6298 describe the basic algorithms on the IETF Standards Track that are broadly applicable.  Multiple other suitable algorithms exist and have been widely used.  Many TCP implementations support a set of alternative algorithms that can be configured for use on the endpoint.  An endpoint <span class="bcp14">MAY</span> implement such alternative algorithms provided that the algorithms are conformant with the TCP specifications from the IETF Standards Track as described in RFC 2914, RFC 5033 <span>[<a href="#RFC5033" class="xref">7</a>]</span>, and RFC 8961 <span>[<a href="#RFC8961" class="xref">15</a>]</span> (MAY-18).<a href="#section-3.8.2-3" class="pilcrow">¶</a></p>
< <p id="section-3.8.2-4">Explicit Congestion Notification (ECN) was defined in RFC 3168 and is an IETF Standards Track enhancement that has many benefits <span>[<a href="#RFC8087" class="xref">51</a>]</span>.<a href="#section-3.8.2-4" class="pilcrow">¶</a></p>
---
> <p id="section-3.8.2-3">A TCP endpoint <span class="bcp14">MUST</span> implement the basic congestion control algorithms slow start, congestion avoidance, and exponential backoff of RTO to avoid creating congestion collapse conditions (MUST-19).  RFC 5681 and RFC 6298 describe the basic algorithms on the IETF Standards Track that are broadly applicable.  Multiple other suitable algorithms exist and have been widely used.  Many TCP implementations support a set of alternative algorithms that can be configured for use on the endpoint.  An endpoint <span class="bcp14">MAY</span> implement such alternative algorithms provided that the algorithms are conformant with the TCP specifications from the IETF Standards Track as described in RFC 2914, RFC 5033 <span>[<a href="#RFC5033" class="cite xref">7</a>]</span>, and RFC 8961 <span>[<a href="#RFC8961" class="cite xref">15</a>]</span> (MAY-18).<a href="#section-3.8.2-3" class="pilcrow">¶</a></p>
> <p id="section-3.8.2-4">Explicit Congestion Notification (ECN) was defined in RFC 3168 and is an IETF Standards Track enhancement that has many benefits <span>[<a href="#RFC8087" class="cite xref">51</a>]</span>.<a href="#section-3.8.2-4" class="pilcrow">¶</a></p>
3633c3653
<                  (see <span><a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.3.1.4" class="relref">Section 3.3.1.4</a> of [<a href="#RFC1122" class="xref">19</a>]</span>) to the IP layer, to trigger
---
>                  (see <span><a href="https://rfc-editor.org/rfc/rfc1122#section-3.3.1.4" class="relref">Section 3.3.1.4</a> of [<a href="#RFC1122" class="cite xref">19</a>]</span>) to the IP layer, to trigger
3656c3676
<                  the application; see the "Asynchronous Reports" section (<a href="#asynchronous-reports" class="xref">Section 3.9.1.8</a>)), when R1 is
---
>                  the application; see the "Asynchronous Reports" section (<a href="#asynchronous-reports" class="auto internal xref">Section 3.9.1.8</a>)), when R1 is
3727c3747
<   As a result of implementation differences and middlebox interactions, new applications <span class="bcp14">SHOULD NOT</span> employ the TCP urgent mechanism (SHLD-13).  However, TCP implementations <span class="bcp14">MUST</span> still include support for the urgent mechanism (MUST-30).  Information on how some TCP implementations interpret the urgent pointer can be found in RFC 6093 <span>[<a href="#RFC6093" class="xref">39</a>]</span>.<a href="#section-3.8.5-1" class="pilcrow">¶</a></p>
---
>   As a result of implementation differences and middlebox interactions, new applications <span class="bcp14">SHOULD NOT</span> employ the TCP urgent mechanism (SHLD-13).  However, TCP implementations <span class="bcp14">MUST</span> still include support for the urgent mechanism (MUST-30).  Information on how some TCP implementations interpret the urgent pointer can be found in RFC 6093 <span>[<a href="#RFC6093" class="cite xref">39</a>]</span>.<a href="#section-3.8.5-1" class="pilcrow">¶</a></p>
3752c3772
<   A TCP implementation <span class="bcp14">MUST</span> support a sequence of urgent data of any length (MUST-31) <span>[<a href="#RFC1122" class="xref">19</a>]</span>.<a href="#section-3.8.5-6" class="pilcrow">¶</a></p>
---
>   A TCP implementation <span class="bcp14">MUST</span> support a sequence of urgent data of any length (MUST-31) <span>[<a href="#RFC1122" class="cite xref">19</a>]</span>.<a href="#section-3.8.5-6" class="pilcrow">¶</a></p>
3756c3776
<   A TCP implementation <span class="bcp14">MUST</span> (MUST-32) inform the application layer asynchronously whenever it receives an urgent pointer and there was previously no pending urgent data, or whenever the urgent pointer advances in the data stream.  The TCP implementation <span class="bcp14">MUST</span> (MUST-33) provide a way for the application to learn how much urgent data remains to be read from the connection, or at least to determine whether more urgent data remains to be read <span>[<a href="#RFC1122" class="xref">19</a>]</span>.<a href="#section-3.8.5-8" class="pilcrow">¶</a></p>
---
>   A TCP implementation <span class="bcp14">MUST</span> (MUST-32) inform the application layer asynchronously whenever it receives an urgent pointer and there was previously no pending urgent data, or whenever the urgent pointer advances in the data stream.  The TCP implementation <span class="bcp14">MUST</span> (MUST-33) provide a way for the application to learn how much urgent data remains to be read from the connection, or at least to determine whether more urgent data remains to be read <span>[<a href="#RFC1122" class="cite xref">19</a>]</span>.<a href="#section-3.8.5-8" class="pilcrow">¶</a></p>
3795c3815
<   discouraged.  The robustness principle <span>[<a href="#RFC1122" class="xref">19</a>]</span> dictates that TCP peers will not
---
>   discouraged.  The robustness principle <span>[<a href="#RFC1122" class="cite xref">19</a>]</span> dictates that TCP peers will not
3802c3822
<   "usable window" (see <a href="#SWSsender" class="xref">Section 3.8.6.2.1</a>) to become negative (MUST-34).<a href="#section-3.8.6-6" class="pilcrow">¶</a></p>
---
>   "usable window" (see <a href="#SWSsender" class="auto internal xref">Section 3.8.6.2.1</a>) to become negative (MUST-34).<a href="#section-3.8.6-6" class="pilcrow">¶</a></p>
3833,3834c3853,3854
<   <span><a href="https://www.rfc-editor.org/rfc/rfc1122#section-4.2.2.17" class="relref">Section 4.2.2.17</a> of [<a href="#RFC1122" class="xref">19</a>]</span>.  The behavior is subject to the implementation's resource
<   management concerns, as noted in <span>[<a href="#RFC6429" class="xref">41</a>]</span>.<a href="#section-3.8.6.1-3" class="pilcrow">¶</a></p>
---
>   <span><a href="https://rfc-editor.org/rfc/rfc1122#section-4.2.2.17" class="relref">Section 4.2.2.17</a> of [<a href="#RFC1122" class="cite xref">19</a>]</span>.  The behavior is subject to the implementation's resource
>   management concerns, as noted in <span>[<a href="#RFC6429" class="cite xref">41</a>]</span>.<a href="#section-3.8.6.1-3" class="pilcrow">¶</a></p>
3842c3862
< window has existed for the retransmission timeout period (SHLD-29) (<a href="#RTO" class="xref">Section 3.8.1</a>), and <span class="bcp14">SHOULD</span> increase exponentially the interval between
---
> window has existed for the retransmission timeout period (SHLD-29) (<a href="#RTO" class="auto internal xref">Section 3.8.1</a>), and <span class="bcp14">SHOULD</span> increase exponentially the interval between
3859c3879
< The Nagle algorithm from <a href="#nagle" class="xref">Section 3.7.4</a> additionally describes how to coalesce short segments.<a href="#section-3.8.6.2.1-2" class="pilcrow">¶</a></p>
---
> The Nagle algorithm from <a href="#nagle" class="auto internal xref">Section 3.7.4</a> additionally describes how to coalesce short segments.<a href="#section-3.8.6.2.1-2" class="pilcrow">¶</a></p>
3933c3953
<             (<a href="#zwp" class="xref">Section 3.8.6.1</a>).<a href="#section-3.8.6.2.1-9" class="pilcrow">¶</a></p>
---
>             (<a href="#zwp" class="auto internal xref">Section 3.8.6.1</a>).<a href="#section-3.8.6.2.1-9" class="pilcrow">¶</a></p>
3947c3967
<             (<a href="#delACK" class="xref">Section 3.8.6.3</a>) to determine when an ACK segment
---
>             (<a href="#delACK" class="auto internal xref">Section 3.8.6.3</a>) to determine when an ACK segment
3997c4017
<             connection (see <a href="#mss" class="xref">Section 3.7.1</a>).  When the inequality
---
>             connection (see <a href="#mss" class="auto internal xref">Section 3.7.1</a>).  When the inequality
4026,4027c4046,4047
<      discussion of delayed ACK behavior is in Section <a href="https://www.rfc-editor.org/rfc/rfc5681#section-4.2" class="relref">4.2</a> of RFC 5681
<      <span>[<a href="#RFC5681" class="xref">8</a>]</span>, including recommendations to immediately
---
>      discussion of delayed ACK behavior is in Section <a href="https://rfc-editor.org/rfc/rfc5681#section-4.2" class="relref">4.2</a> of RFC 5681
>      <span>[<a href="#RFC5681" class="cite xref">8</a>]</span>, including recommendations to immediately
4034,4035c4054,4055
<      generic receive offload (GRO) <span>[<a href="#offload" class="xref">72</a>]</span>, ACK compression, and ACK decimation
<      <span>[<a href="#RFC3449" class="xref">28</a>]</span>.<a href="#section-3.8.6.3-3" class="pilcrow">¶</a></p>
---
>      generic receive offload (GRO) <span>[<a href="#offload" class="cite xref">72</a>]</span>, ACK compression, and ACK decimation
>      <span>[<a href="#RFC3449" class="cite xref">28</a>]</span>.<a href="#section-3.8.6.3-3" class="pilcrow">¶</a></p>
4068c4088
< <span><a href="https://www.rfc-editor.org/rfc/rfc8303#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8303" class="xref">53</a>]</span> also identifies primitives provided by TCP and could be used as an additional reference for implementers.<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
---
> <span><a href="https://rfc-editor.org/rfc/rfc8303#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8303" class="cite xref">53</a>]</span> also identifies primitives provided by TCP and could be used as an additional reference for implementers.<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
4171c4191
< host will choose an appropriate local IP address (see RFC 1122, Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.3.4.2" class="relref">3.3.4.2</a>).<a href="#section-3.9.1.1-14" class="pilcrow">¶</a></p>
---
> host will choose an appropriate local IP address (see RFC 1122, Section <a href="https://rfc-editor.org/rfc/rfc1122#section-3.3.4.2" class="relref">3.3.4.2</a>).<a href="#section-3.9.1.1-14" class="pilcrow">¶</a></p>
4177c4197
<         GET_SRCADDR() in Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.4" class="relref">3.4</a> of RFC 1122.<a href="#section-3.9.1.1-15" class="pilcrow">¶</a></p>
---
>         GET_SRCADDR() in Section <a href="https://rfc-editor.org/rfc/rfc1122#section-3.4" class="relref">3.4</a> of RFC 1122.<a href="#section-3.9.1.1-15" class="pilcrow">¶</a></p>
4229c4249
< the PUSH flag (see <a href="#nagle" class="xref">Section 3.7.4</a>).<a href="#section-3.9.1.2-6" class="pilcrow">¶</a></p>
---
> the PUSH flag (see <a href="#nagle" class="auto internal xref">Section 3.7.4</a>).<a href="#section-3.9.1.2-6" class="pilcrow">¶</a></p>
4235c4255
< possible (SHLD-28) to improve performance (see <a href="#SWSsender" class="xref">Section 3.8.6.2.1</a>).<a href="#section-3.9.1.2-7" class="pilcrow">¶</a></p>
---
> possible (SHLD-28) to improve performance (see <a href="#SWSsender" class="auto internal xref">Section 3.8.6.2.1</a>).<a href="#section-3.9.1.2-7" class="pilcrow">¶</a></p>
4237c4257
<         New applications <span class="bcp14">SHOULD NOT</span> set the URGENT flag <span>[<a href="#RFC6093" class="xref">39</a>]</span> due to implementation differences and middlebox issues (SHLD-13).<a href="#section-3.9.1.2-8" class="pilcrow">¶</a></p>
---
>         New applications <span class="bcp14">SHOULD NOT</span> set the URGENT flag <span>[<a href="#RFC6093" class="cite xref">39</a>]</span> due to implementation differences and middlebox issues (SHLD-13).<a href="#section-3.9.1.2-8" class="pilcrow">¶</a></p>
4325c4345
< 1122, Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-4.2.2.2" class="relref">4.2.2.2</a>).  The remainder of text describing the RECEIVE call below
---
> 1122, Section <a href="https://rfc-editor.org/rfc/rfc1122#section-4.2.2.2" class="relref">4.2.2.2</a>).  The remainder of text describing the RECEIVE call below
4495c4515
<                  ICMP error message arrived (see <a href="#icmp" class="xref">Section 3.9.2.2</a> for description of handling each ICMP message type since some message types need to be suppressed from generating reports to the application)<a href="#section-3.9.1.8-4.1" class="pilcrow">¶</a>
---
>                  ICMP error message arrived (see <a href="#icmp" class="auto internal xref">Section 3.9.2.2</a> for description of handling each ICMP message type since some message types need to be suppressed from generating reports to the application)<a href="#section-3.9.1.8-4.1" class="pilcrow">¶</a>
4498c4518
<                 Excessive retransmissions (see <a href="#connfail" class="xref">Section 3.8.3</a>)<a href="#section-3.9.1.8-4.2" class="pilcrow">¶</a>
---
>                 Excessive retransmissions (see <a href="#connfail" class="auto internal xref">Section 3.8.3</a>)<a href="#section-3.9.1.8-4.2" class="pilcrow">¶</a>
4501c4521
<                  Urgent pointer advance (see <a href="#urgent" class="xref">Section 3.8.5</a>)<a href="#section-3.9.1.8-4.3" class="pilcrow">¶</a>
---
>                  Urgent pointer advance (see <a href="#urgent" class="auto internal xref">Section 3.8.5</a>)<a href="#section-3.9.1.8-4.3" class="pilcrow">¶</a>
4537c4557
<     receive information over a network.  The two current standard Internet Protocol (IP) versions layered below TCP are IPv4 <span>[<a href="#RFC0791" class="xref">1</a>]</span> and IPv6 <span>[<a href="#RFC8200" class="xref">13</a>]</span>.<a href="#section-3.9.2-1" class="pilcrow">¶</a></p>
---
>     receive information over a network.  The two current standard Internet Protocol (IP) versions layered below TCP are IPv4 <span>[<a href="#RFC0791" class="cite xref">1</a>]</span> and IPv6 <span>[<a href="#RFC8200" class="cite xref">13</a>]</span>.<a href="#section-3.9.2-1" class="pilcrow">¶</a></p>
4561c4581
<        (Section <a href="https://www.rfc-editor.org/rfc/rfc1122#section-4.2.4.2" class="relref">4.2.4.2</a> of RFC 1122).  However, the application interface might
---
>        (Section <a href="https://rfc-editor.org/rfc/rfc1122#section-4.2.4.2" class="relref">4.2.4.2</a> of RFC 1122).  However, the application interface might
4565c4585
<        (Sections <a href="https://www.rfc-editor.org/rfc/rfc7657#section-5.1" class="relref">5.1</a>, <a href="https://www.rfc-editor.org/rfc/rfc7657#section-5.3" class="relref">5.3</a>, and <a href="https://www.rfc-editor.org/rfc/rfc7657#section-6" class="relref">6</a>) <span>[<a href="#RFC7657" class="xref">50</a>]</span>.   Generally, an
---
>        (Sections <a href="https://rfc-editor.org/rfc/rfc7657#section-5.1" class="relref">5.1</a>, <a href="https://rfc-editor.org/rfc/rfc7657#section-5.3" class="relref">5.3</a>, and <a href="https://rfc-editor.org/rfc/rfc7657#section-6" class="relref">6</a>) <span>[<a href="#RFC7657" class="cite xref">50</a>]</span>.   Generally, an
4620c4640
<             <span>[<a href="#RFC5461" class="xref">35</a>]</span> contains discussion of specific ICMP and ICMPv6 messages classified as either "soft" or "hard" errors that may bear different responses.  Treatment for classes of ICMP messages is described below:<a href="#section-3.9.2.2-3" class="pilcrow">¶</a></p>
---
>             <span>[<a href="#RFC5461" class="cite xref">35</a>]</span> contains discussion of specific ICMP and ICMPv6 messages classified as either "soft" or "hard" errors that may bear different responses.  Treatment for classes of ICMP messages is described below:<a href="#section-3.9.2.2-3" class="pilcrow">¶</a></p>
4625c4645
<                  TCP implementations <span class="bcp14">MUST</span> silently discard any received ICMP Source Quench messages (MUST-55).  See <span>[<a href="#RFC6633" class="xref">11</a>]</span> for discussion.<a href="#section-3.9.2.2-4.2" class="pilcrow">¶</a>
---
>                  TCP implementations <span class="bcp14">MUST</span> silently discard any received ICMP Source Quench messages (MUST-55).  See <span>[<a href="#RFC6633" class="cite xref">11</a>]</span> for discussion.<a href="#section-3.9.2.2-4.2" class="pilcrow">¶</a>
4649c4669
<                  the connection (SHLD-26).  <span>[<a href="#RFC5461" class="xref">35</a>]</span> notes that
---
>                  the connection (SHLD-26).  <span>[<a href="#RFC5461" class="cite xref">35</a>]</span> notes that
4657c4677
< Note that <span>[<a href="#RFC5461" class="xref">35</a>], <a href="https://www.rfc-editor.org/rfc/rfc5461#section-4" class="relref">Section 4</a></span> describes widespread implementation behavior that treats soft errors as hard errors during connection establishment.<a href="#section-3.9.2.2-5" class="pilcrow">¶</a></p>
---
> Note that <span>[<a href="#RFC5461" class="cite xref">35</a>], <a href="https://rfc-editor.org/rfc/rfc5461#section-4" class="relref">Section 4</a></span> describes widespread implementation behavior that treats soft errors as hard errors during connection establishment.<a href="#section-3.9.2.2-5" class="pilcrow">¶</a></p>
4670c4690
<             <a href="https://www.rfc-editor.org/rfc/rfc1122#section-3.2.1.3" class="relref">3.2.1.3</a>).<a href="#section-3.9.2.3-2.1" class="pilcrow">¶</a></p>
---
>             <a href="https://rfc-editor.org/rfc/rfc1122#section-3.2.1.3" class="relref">3.2.1.3</a>).<a href="#section-3.9.2.3-2.1" class="pilcrow">¶</a></p>
5396c5416
<           A potential blind reset attack is described in RFC 5961 <span>[<a href="#RFC5961" class="xref">9</a>]</span>.  The mitigation described in that document has specific applicability explained therein, and is not a substitute for cryptographic protection (e.g., IPsec or TCP-AO).  A TCP implementation that supports the mitigation described in RFC 5961 <span class="bcp14">SHOULD</span> first check that the sequence number exactly matches RCV.NXT prior to executing the action in the next paragraph.<a href="#section-3.10.7.3-2.2.2.1.2.1" class="pilcrow">¶</a>
---
>           A potential blind reset attack is described in RFC 5961 <span>[<a href="#RFC5961" class="cite xref">9</a>]</span>.  The mitigation described in that document has specific applicability explained therein, and is not a substitute for cryptographic protection (e.g., IPsec or TCP-AO).  A TCP implementation that supports the mitigation described in RFC 5961 <span class="bcp14">SHOULD</span> first check that the sequence number exactly matches RCV.NXT prior to executing the action in the next paragraph.<a href="#section-3.10.7.3-2.2.2.1.2.1" class="pilcrow">¶</a>
5474c5494
<  the <a href="#check-urg-bit" class="xref">sixth step</a> under <a href="#other-states" class="xref">Section 3.10.7.4</a> where the URG
---
>  the <a href="#check-urg-bit" class="internal xref">sixth step</a> under <a href="#other-states" class="auto internal xref">Section 3.10.7.4</a> where the URG
5505c5525
<  Note that it is legal to send and receive application data on SYN segments (this is the "text in the segment" mentioned above).  There has been significant misinformation and misunderstanding of this topic historically.  Some firewalls and security devices consider this suspicious.  However, the capability was used in T/TCP <span>[<a href="#RFC1644" class="xref">21</a>]</span> and is used in TCP Fast Open (TFO) <span>[<a href="#RFC7413" class="xref">48</a>]</span>, so is important for implementations and network devices to permit.<a href="#section-3.10.7.3-2.4.2.7" class="pilcrow">¶</a>
---
>  Note that it is legal to send and receive application data on SYN segments (this is the "text in the segment" mentioned above).  There has been significant misinformation and misunderstanding of this topic historically.  Some firewalls and security devices consider this suspicious.  However, the capability was used in T/TCP <span>[<a href="#RFC1644" class="cite xref">21</a>]</span> and is used in TCP Fast Open (TFO) <span>[<a href="#RFC7413" class="cite xref">48</a>]</span>, so is important for implementations and network devices to permit.<a href="#section-3.10.7.3-2.4.2.7" class="pilcrow">¶</a>
5611c5631
<  In implementing sequence number validation as described here, please note <a href="#seqval" class="xref">Appendix A.2</a>.<a href="#section-3.10.7.4-2.1.2.8.2.4" class="pilcrow">¶</a>
---
>  In implementing sequence number validation as described here, please note <a href="#seqval" class="auto internal xref">Appendix A.2</a>.<a href="#section-3.10.7.4-2.1.2.8.2.4" class="pilcrow">¶</a>
5632c5652
<  described in <span>[<a href="#RFC6191" class="xref">40</a>]</span> for handling incoming SYN
---
>  described in <span>[<a href="#RFC6191" class="cite xref">40</a>]</span> for handling incoming SYN
5658c5678
< RFC 5961 <span>[<a href="#RFC5961" class="xref">9</a>]</span>, Section <a href="https://www.rfc-editor.org/rfc/rfc5961#section-3" class="relref">3</a>  describes a potential blind reset attack and optional mitigation approach.  This does not provide a cryptographic protection (e.g., as in IPsec or TCP-AO) but can be applicable in situations described in RFC 5961.  For stacks implementing the protection described in RFC 5961, the three checks below apply; otherwise, processing for these states is indicated further below.<a href="#section-3.10.7.4-2.2.2.1.1" class="pilcrow">¶</a></p>
---
> RFC 5961 <span>[<a href="#RFC5961" class="cite xref">9</a>]</span>, Section <a href="https://rfc-editor.org/rfc/rfc5961#section-3" class="relref">3</a>  describes a potential blind reset attack and optional mitigation approach.  This does not provide a cryptographic protection (e.g., as in IPsec or TCP-AO) but can be applicable in situations described in RFC 5961.  For stacks implementing the protection described in RFC 5961, the three checks below apply; otherwise, processing for these states is indicated further below.<a href="#section-3.10.7.4-2.2.2.1.1" class="pilcrow">¶</a></p>
5674c5694
< After sending the challenge ACK, TCP endpoints <span class="bcp14">MUST</span> drop the unacceptable segment and stop processing the incoming packet further.  Note that RFC 5961 and Errata ID 4772 <span>[<a href="#Err4772" class="xref">99</a>]</span> contain additional considerations for ACK throttling in an implementation.<a href="#section-3.10.7.4-2.2.2.1.2.3.3" class="pilcrow">¶</a></p>
---
> After sending the challenge ACK, TCP endpoints <span class="bcp14">MUST</span> drop the unacceptable segment and stop processing the incoming packet further.  Note that RFC 5961 and Errata ID 4772 <span>[<a href="#Err4772" class="cite xref">99</a>]</span> contain additional considerations for ACK throttling in an implementation.<a href="#section-3.10.7.4-2.2.2.1.2.3.3" class="pilcrow">¶</a></p>
5834c5854
< If the SYN bit is set in these synchronized states, it may be either a legitimate new connection attempt (e.g., in the case of TIME-WAIT), an error where the connection should be reset, or the result of an attack attempt, as described in RFC 5961 <span>[<a href="#RFC5961" class="xref">9</a>]</span>.  For the TIME-WAIT state, new connections can be accepted if the Timestamp Option is used and meets expectations (per <span>[<a href="#RFC6191" class="xref">40</a>]</span>).  For all other cases, RFC 5961 provides a mitigation with applicability to some situations, though there are also alternatives that offer cryptographic protection (see <a href="#Security" class="xref">Section 7</a>).  RFC 5961 recommends that in these synchronized states, if the SYN bit is set, irrespective of the sequence number, TCP endpoints <span class="bcp14">MUST</span> send a "challenge ACK" to the remote peer:<a href="#section-3.10.7.4-2.4.2.8.2.1.1" class="pilcrow">¶</a></p>
---
> If the SYN bit is set in these synchronized states, it may be either a legitimate new connection attempt (e.g., in the case of TIME-WAIT), an error where the connection should be reset, or the result of an attack attempt, as described in RFC 5961 <span>[<a href="#RFC5961" class="cite xref">9</a>]</span>.  For the TIME-WAIT state, new connections can be accepted if the Timestamp Option is used and meets expectations (per <span>[<a href="#RFC6191" class="cite xref">40</a>]</span>).  For all other cases, RFC 5961 provides a mitigation with applicability to some situations, though there are also alternatives that offer cryptographic protection (see <a href="#Security" class="auto internal xref">Section 7</a>).  RFC 5961 recommends that in these synchronized states, if the SYN bit is set, irrespective of the sequence number, TCP endpoints <span class="bcp14">MUST</span> send a "challenge ACK" to the remote peer:<a href="#section-3.10.7.4-2.4.2.8.2.1.1" class="pilcrow">¶</a></p>
5839c5859
< After sending the acknowledgment, TCP implementations <span class="bcp14">MUST</span> drop the unacceptable segment and stop processing further.  Note that RFC 5961 and Errata ID 4772 <span>[<a href="#Err4772" class="xref">99</a>]</span> contain additional ACK throttling notes for an implementation.<a href="#section-3.10.7.4-2.4.2.8.2.2" class="pilcrow">¶</a>
---
> After sending the acknowledgment, TCP implementations <span class="bcp14">MUST</span> drop the unacceptable segment and stop processing further.  Note that RFC 5961 and Errata ID 4772 <span>[<a href="#Err4772" class="cite xref">99</a>]</span> contain additional ACK throttling notes for an implementation.<a href="#section-3.10.7.4-2.4.2.8.2.2" class="pilcrow">¶</a>
5869c5889
< RFC 5961 <span>[<a href="#RFC5961" class="xref">9</a>], <a href="https://www.rfc-editor.org/rfc/rfc5961#section-5" class="relref">Section 5</a></span> describes a potential blind data injection attack, and mitigation that implementations <span class="bcp14">MAY</span> choose to include (MAY-12).  TCP stacks that implement RFC 5961 <span class="bcp14">MUST</span> add an input check that the ACK value is acceptable only if it is in the range of ((SND.UNA - MAX.SND.WND) =&lt; SEG.ACK =&lt; SND.NXT).  All incoming segments whose ACK value doesn't satisfy the above condition <span class="bcp14">MUST</span> be discarded and an ACK sent back.  The new state variable MAX.SND.WND is defined as the largest window that the local sender has ever received from its peer (subject to window scaling) or may be hard-coded to a maximum permissible window value.  When the ACK value is acceptable, the per-state processing below applies:<a href="#section-3.10.7.4-2.5.2.2.2.1" class="pilcrow">¶</a>
---
> RFC 5961 <span>[<a href="#RFC5961" class="cite xref">9</a>], <a href="https://rfc-editor.org/rfc/rfc5961#section-5" class="relref">Section 5</a></span> describes a potential blind data injection attack, and mitigation that implementations <span class="bcp14">MAY</span> choose to include (MAY-12).  TCP stacks that implement RFC 5961 <span class="bcp14">MUST</span> add an input check that the ACK value is acceptable only if it is in the range of ((SND.UNA - MAX.SND.WND) =&lt; SEG.ACK =&lt; SND.NXT).  All incoming segments whose ACK value doesn't satisfy the above condition <span class="bcp14">MUST</span> be discarded and an ACK sent back.  The new state variable MAX.SND.WND is defined as the largest window that the local sender has ever received from its peer (subject to window scaling) or may be hard-coded to a maximum permissible window value.  When the ACK value is acceptable, the per-state processing below applies:<a href="#section-3.10.7.4-2.5.2.2.2.1" class="pilcrow">¶</a>
6089c6109
<         Please note the window management suggestions in <a href="#datacomm" class="xref">Section 3.8</a>.<a href="#section-3.10.7.4-2.7.2.3.2.5" class="pilcrow">¶</a>
---
>         Please note the window management suggestions in <a href="#datacomm" class="auto internal xref">Section 3.8</a>.<a href="#section-3.10.7.4-2.7.2.3.2.5" class="pilcrow">¶</a>
6343c6363
<           Internet Protocol. See <span>[<a href="#RFC0791" class="xref">1</a>]</span> and <span>[<a href="#RFC8200" class="xref">13</a>]</span>.<a href="#section-4-1.28" class="pilcrow">¶</a>
---
>           Internet Protocol. See <span>[<a href="#RFC0791" class="cite xref">1</a>]</span> and <span>[<a href="#RFC8200" class="cite xref">13</a>]</span>.<a href="#section-4-1.28" class="pilcrow">¶</a>
6592c6612
<           Type of Service, an obsoleted IPv4 field.  The same header bits currently are used for the Differentiated Services field <span>[<a href="#RFC2474" class="xref">4</a>]</span> containing the Differentiated Services Codepoint (DSCP) value and the 2-bit ECN codepoint <span>[<a href="#RFC3168" class="xref">6</a>]</span>.<a href="#section-4-1.110" class="pilcrow">¶</a>
---
>           Type of Service, an obsoleted IPv4 field.  The same header bits currently are used for the Differentiated Services field <span>[<a href="#RFC2474" class="cite xref">4</a>]</span> containing the Differentiated Services Codepoint (DSCP) value and the 2-bit ECN codepoint <span>[<a href="#RFC3168" class="cite xref">6</a>]</span>.<a href="#section-4-1.110" class="pilcrow">¶</a>
6628c6648
<             The main body of this document was adapted from RFC 793's Section <a href="https://www.rfc-editor.org/rfc/rfc793#section-3" class="relref">3</a>, titled "FUNCTIONAL SPECIFICATION", with an attempt to keep formatting and layout as close as possible.<a href="#section-5-2" class="pilcrow">¶</a></p>
---
>             The main body of this document was adapted from RFC 793's Section <a href="https://rfc-editor.org/rfc/rfc793#section-3" class="relref">3</a>, titled "FUNCTIONAL SPECIFICATION", with an attempt to keep formatting and layout as close as possible.<a href="#section-5-2" class="pilcrow">¶</a></p>
6630c6650
<             The collection of applicable RFC errata that have been reported and either accepted or held for an update to RFC 793 were incorporated (Errata IDs: 573 <span>[<a href="#Err573" class="xref">73</a>]</span>, 574 <span>[<a href="#Err574" class="xref">74</a>]</span>, 700 <span>[<a href="#Err700" class="xref">75</a>]</span>, 701 <span>[<a href="#Err701" class="xref">76</a>]</span>, 1283 <span>[<a href="#Err1283" class="xref">77</a>]</span>, 1561 <span>[<a href="#Err1561" class="xref">78</a>]</span>, 1562 <span>[<a href="#Err1562" class="xref">79</a>]</span>, 1564 <span>[<a href="#Err1564" class="xref">80</a>]</span>, 1571 <span>[<a href="#Err1571" class="xref">81</a>]</span>, 1572 <span>[<a href="#Err1572" class="xref">82</a>]</span>, 2297 <span>[<a href="#Err2297" class="xref">83</a>]</span>, 2298 <span>[<a href="#Err2298" class="xref">84</a>]</span>, 2748 <span>[<a href="#Err2748" class="xref">85</a>]</span>, 2749 <span>[<a href="#Err2749" class="xref">86</a>]</span>, 2934 <span>[<a href="#Err2934" class="xref">87</a>]</span>, 3213 <span>[<a href="#Err3213" class="xref">88</a>]</span>, 3300 <span>[<a href="#Err3300" class="xref">89</a>]</span>, 3301 <span>[<a href="#Err3301" class="xref">90</a>]</span>, 6222 <span>[<a href="#Err6222" class="xref">91</a>]</span>).  Some errata were not applicable due to other changes (Errata IDs: 572 <span>[<a href="#Err572" class="xref">92</a>]</span>, 575 <span>[<a href="#Err575" class="xref">93</a>]</span>, 1565 <span>[<a href="#Err1565" class="xref">94</a>]</span>, 1569 <span>[<a href="#Err1569" class="xref">95</a>]</span>, 2296 <span>[<a href="#Err2296" class="xref">96</a>]</span>, 3305 <span>[<a href="#Err3305" class="xref">97</a>]</span>, 3602 <span>[<a href="#Err3602" class="xref">98</a>]</span>).<a href="#section-5-3" class="pilcrow">¶</a></p>
---
>             The collection of applicable RFC errata that have been reported and either accepted or held for an update to RFC 793 were incorporated (Errata IDs: 573 <span>[<a href="#Err573" class="cite xref">73</a>]</span>, 574 <span>[<a href="#Err574" class="cite xref">74</a>]</span>, 700 <span>[<a href="#Err700" class="cite xref">75</a>]</span>, 701 <span>[<a href="#Err701" class="cite xref">76</a>]</span>, 1283 <span>[<a href="#Err1283" class="cite xref">77</a>]</span>, 1561 <span>[<a href="#Err1561" class="cite xref">78</a>]</span>, 1562 <span>[<a href="#Err1562" class="cite xref">79</a>]</span>, 1564 <span>[<a href="#Err1564" class="cite xref">80</a>]</span>, 1571 <span>[<a href="#Err1571" class="cite xref">81</a>]</span>, 1572 <span>[<a href="#Err1572" class="cite xref">82</a>]</span>, 2297 <span>[<a href="#Err2297" class="cite xref">83</a>]</span>, 2298 <span>[<a href="#Err2298" class="cite xref">84</a>]</span>, 2748 <span>[<a href="#Err2748" class="cite xref">85</a>]</span>, 2749 <span>[<a href="#Err2749" class="cite xref">86</a>]</span>, 2934 <span>[<a href="#Err2934" class="cite xref">87</a>]</span>, 3213 <span>[<a href="#Err3213" class="cite xref">88</a>]</span>, 3300 <span>[<a href="#Err3300" class="cite xref">89</a>]</span>, 3301 <span>[<a href="#Err3301" class="cite xref">90</a>]</span>, 6222 <span>[<a href="#Err6222" class="cite xref">91</a>]</span>).  Some errata were not applicable due to other changes (Errata IDs: 572 <span>[<a href="#Err572" class="cite xref">92</a>]</span>, 575 <span>[<a href="#Err575" class="cite xref">93</a>]</span>, 1565 <span>[<a href="#Err1565" class="cite xref">94</a>]</span>, 1569 <span>[<a href="#Err1569" class="cite xref">95</a>]</span>, 2296 <span>[<a href="#Err2296" class="cite xref">96</a>]</span>, 3305 <span>[<a href="#Err3305" class="cite xref">97</a>]</span>, 3602 <span>[<a href="#Err3602" class="cite xref">98</a>]</span>).<a href="#section-5-3" class="pilcrow">¶</a></p>
6636c6656
< RFC 1011 <span>[<a href="#RFC1011" class="xref">18</a>]</span> contains a number of comments about RFC 793, including some needed changes to the TCP specification.  These are expanded in RFC 1122, which contains a collection of other changes and clarifications to RFC 793.  The normative items impacting the protocol have been incorporated here, though some historically useful implementation advice and informative discussion from RFC 1122 is not included here.  The present document, which is now the TCP specification rather than RFC 793, updates RFC 1011, and the comments noted in RFC 1011 have been incorporated.<a href="#section-5-6" class="pilcrow">¶</a></p>
---
> RFC 1011 <span>[<a href="#RFC1011" class="cite xref">18</a>]</span> contains a number of comments about RFC 793, including some needed changes to the TCP specification.  These are expanded in RFC 1122, which contains a collection of other changes and clarifications to RFC 793.  The normative items impacting the protocol have been incorporated here, though some historically useful implementation advice and informative discussion from RFC 1122 is not included here.  The present document, which is now the TCP specification rather than RFC 793, updates RFC 1011, and the comments noted in RFC 1011 have been incorporated.<a href="#section-5-6" class="pilcrow">¶</a></p>
6654,6655c6674,6675
< <p id="section-6-2">RFC 3168 originally created this registry but only populated it with the new bits defined in RFC 3168, neglecting the other bits that had previously been described in RFC 793 and other documents.  Bit 7 has since also been updated by RFC 8311 <span>[<a href="#RFC8311" class="xref">54</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
< <p id="section-6-3">The "Bit" column has been renamed below as the "Bit Offset" column because it references each header flag's offset within the 16-bit aligned view of the TCP header in <a href="#header_format" class="xref">Figure 1</a>.  The bits in offsets 0 through 3 are the TCP segment Data Offset field, and not header flags.<a href="#section-6-3" class="pilcrow">¶</a></p>
---
> <p id="section-6-2">RFC 3168 originally created this registry but only populated it with the new bits defined in RFC 3168, neglecting the other bits that had previously been described in RFC 793 and other documents.  Bit 7 has since also been updated by RFC 8311 <span>[<a href="#RFC8311" class="cite xref">54</a>]</span>.<a href="#section-6-2" class="pilcrow">¶</a></p>
> <p id="section-6-3">The "Bit" column has been renamed below as the "Bit Offset" column because it references each header flag's offset within the 16-bit aligned view of the TCP header in <a href="#header_format" class="auto internal xref">Figure 1</a>.  The bits in offsets 0 through 3 are the TCP segment Data Offset field, and not header flags.<a href="#section-6-3" class="pilcrow">¶</a></p>
6756c6776
< The TCP design includes only rudimentary security features that improve the robustness and reliability of connections and application data transfer, but there are no built-in cryptographic capabilities to support any form of confidentiality, authentication, or other typical security functions.  Non-cryptographic enhancements (e.g., <span>[<a href="#RFC5961" class="xref">9</a>]</span>) have been developed to improve robustness of TCP connections to particular types of attacks, but the applicability and protections of non-cryptographic enhancements are limited (e.g., see <span><a href="https://www.rfc-editor.org/rfc/rfc5961#section-1.1" class="relref">Section 1.1</a> of [<a href="#RFC5961" class="xref">9</a>]</span>).
---
> The TCP design includes only rudimentary security features that improve the robustness and reliability of connections and application data transfer, but there are no built-in cryptographic capabilities to support any form of confidentiality, authentication, or other typical security functions.  Non-cryptographic enhancements (e.g., <span>[<a href="#RFC5961" class="cite xref">9</a>]</span>) have been developed to improve robustness of TCP connections to particular types of attacks, but the applicability and protections of non-cryptographic enhancements are limited (e.g., see <span><a href="https://rfc-editor.org/rfc/rfc5961#section-1.1" class="relref">Section 1.1</a> of [<a href="#RFC5961" class="cite xref">9</a>]</span>).
6759c6779
< In order to fully provide confidentiality, integrity protection, and authentication for TCP connections (including their control flags), IPsec is the only current effective method.  For integrity protection and authentication, the TCP Authentication Option (TCP-AO) <span>[<a href="#RFC5925" class="xref">38</a>]</span> is available, with a proposed extension to also provide confidentiality for the segment payload.
---
> In order to fully provide confidentiality, integrity protection, and authentication for TCP connections (including their control flags), IPsec is the only current effective method.  For integrity protection and authentication, the TCP Authentication Option (TCP-AO) <span>[<a href="#RFC5925" class="cite xref">38</a>]</span> is available, with a proposed extension to also provide confidentiality for the segment payload.
6761c6781
< the payload, but for the TCP header only cover either a subset of the fields (e.g., tcpcrypt <span>[<a href="#RFC8548" class="xref">57</a>]</span>) or none at
---
> the payload, but for the TCP header only cover either a subset of the fields (e.g., tcpcrypt <span>[<a href="#RFC8548" class="cite xref">57</a>]</span>) or none at
6766c6786
< Applications using long-lived TCP flows have been vulnerable to attacks that exploit the processing of control flags described in earlier TCP specifications <span>[<a href="#RFC4953" class="xref">33</a>]</span>.  TCP-MD5 was a commonly implemented TCP Option to support authentication for some of these connections, but had flaws and is now deprecated.  TCP-AO provides a capability to protect long-lived TCP connections from attacks and has superior properties to TCP-MD5.  It does not provide any privacy for application data or for the TCP headers.<a href="#section-7-3" class="pilcrow">¶</a></p>
---
> Applications using long-lived TCP flows have been vulnerable to attacks that exploit the processing of control flags described in earlier TCP specifications <span>[<a href="#RFC4953" class="cite xref">33</a>]</span>.  TCP-MD5 was a commonly implemented TCP Option to support authentication for some of these connections, but had flaws and is now deprecated.  TCP-AO provides a capability to protect long-lived TCP connections from attacks and has superior properties to TCP-MD5.  It does not provide any privacy for application data or for the TCP headers.<a href="#section-7-3" class="pilcrow">¶</a></p>
6768c6788
< The "tcpcrypt" <span>[<a href="#RFC8548" class="xref">57</a>]</span> experimental extension to TCP provides the ability to cryptographically protect connection data.  Metadata aspects of the TCP flow are still visible, but the application stream is well protected.  Within the TCP header, only the urgent pointer and FIN flag are protected through tcpcrypt.<a href="#section-7-4" class="pilcrow">¶</a></p>
---
> The "tcpcrypt" <span>[<a href="#RFC8548" class="cite xref">57</a>]</span> experimental extension to TCP provides the ability to cryptographically protect connection data.  Metadata aspects of the TCP flow are still visible, but the application stream is well protected.  Within the TCP header, only the urgent pointer and FIN flag are protected through tcpcrypt.<a href="#section-7-4" class="pilcrow">¶</a></p>
6770c6790
< The TCP Roadmap <span>[<a href="#RFC7414" class="xref">49</a>]</span> includes notes about several RFCs related to TCP security.  Many of the enhancements provided by these RFCs have been integrated into the present document, including ISN generation, mitigating blind in-window attacks, and improving handling of soft errors and ICMP packets.  These are all discussed in greater detail in the referenced RFCs that originally described the changes needed to earlier TCP specifications.  Additionally, see RFC 6093 <span>[<a href="#RFC6093" class="xref">39</a>]</span> for discussion of security considerations related to the urgent pointer field, which also discourages new applications from using the urgent pointer.<a href="#section-7-5" class="pilcrow">¶</a></p>
---
> The TCP Roadmap <span>[<a href="#RFC7414" class="cite xref">49</a>]</span> includes notes about several RFCs related to TCP security.  Many of the enhancements provided by these RFCs have been integrated into the present document, including ISN generation, mitigating blind in-window attacks, and improving handling of soft errors and ICMP packets.  These are all discussed in greater detail in the referenced RFCs that originally described the changes needed to earlier TCP specifications.  Additionally, see RFC 6093 <span>[<a href="#RFC6093" class="cite xref">39</a>]</span> for discussion of security considerations related to the urgent pointer field, which also discourages new applications from using the urgent pointer.<a href="#section-7-5" class="pilcrow">¶</a></p>
6772c6792
< Since TCP is often used for bulk transfer flows, some attacks are possible that abuse the TCP congestion control logic.  An example is "ACK-division" attacks. Updates that have been made to the TCP congestion control specifications include mechanisms like Appropriate Byte Counting (ABC) <span>[<a href="#RFC3465" class="xref">29</a>]</span> that act as mitigations to these attacks.<a href="#section-7-6" class="pilcrow">¶</a></p>
---
> Since TCP is often used for bulk transfer flows, some attacks are possible that abuse the TCP congestion control logic.  An example is "ACK-division" attacks. Updates that have been made to the TCP congestion control specifications include mechanisms like Appropriate Byte Counting (ABC) <span>[<a href="#RFC3465" class="cite xref">29</a>]</span> that act as mitigations to these attacks.<a href="#section-7-6" class="pilcrow">¶</a></p>
6774c6794
< Other attacks are focused on exhausting the resources of a TCP server.  Examples include SYN flooding <span>[<a href="#RFC4987" class="xref">32</a>]</span> or wasting resources on non-progressing connections <span>[<a href="#RFC6429" class="xref">41</a>]</span>.  Operating systems commonly implement mitigations for these attacks.  Some common defenses also utilize proxies, stateful firewalls, and other technologies outside the end-host TCP implementation.<a href="#section-7-7" class="pilcrow">¶</a></p>
---
> Other attacks are focused on exhausting the resources of a TCP server.  Examples include SYN flooding <span>[<a href="#RFC4987" class="cite xref">32</a>]</span> or wasting resources on non-progressing connections <span>[<a href="#RFC6429" class="cite xref">41</a>]</span>.  Operating systems commonly implement mitigations for these attacks.  Some common defenses also utilize proxies, stateful firewalls, and other technologies outside the end-host TCP implementation.<a href="#section-7-7" class="pilcrow">¶</a></p>
6776c6796
< The concept of a protocol's "wire image" is described in RFC 8546 <span>[<a href="#RFC8546" class="xref">56</a>]</span>, which describes how TCP's cleartext headers expose more metadata to nodes on the path than is strictly required to route the packets to their destination.  On-path adversaries may be able to leverage this metadata.  Lessons learned in this respect from TCP have been applied in the design of newer transports like QUIC <span>[<a href="#RFC9000" class="xref">60</a>]</span>.  Additionally, based partly on experiences with TCP and its extensions, there are considerations that might be applicable for future TCP extensions and other transports that the IETF has documented in RFC 9065 <span>[<a href="#RFC9065" class="xref">61</a>]</span>, along with IAB recommendations in RFC 8558 <span>[<a href="#RFC8558" class="xref">58</a>]</span> and <span>[<a href="#RFC9170" class="xref">67</a>]</span>.<a href="#section-7-8" class="pilcrow">¶</a></p>
---
> The concept of a protocol's "wire image" is described in RFC 8546 <span>[<a href="#RFC8546" class="cite xref">56</a>]</span>, which describes how TCP's cleartext headers expose more metadata to nodes on the path than is strictly required to route the packets to their destination.  On-path adversaries may be able to leverage this metadata.  Lessons learned in this respect from TCP have been applied in the design of newer transports like QUIC <span>[<a href="#RFC9000" class="cite xref">60</a>]</span>.  Additionally, based partly on experiences with TCP and its extensions, there are considerations that might be applicable for future TCP extensions and other transports that the IETF has documented in RFC 9065 <span>[<a href="#RFC9065" class="cite xref">61</a>]</span>, along with IAB recommendations in RFC 8558 <span>[<a href="#RFC8558" class="cite xref">58</a>]</span> and <span>[<a href="#RFC9170" class="cite xref">67</a>]</span>.<a href="#section-7-8" class="pilcrow">¶</a></p>
6780c6800
< Since ICMP message processing also can interact with TCP connections, there is potential for ICMP-based attacks against TCP connections.  These are discussed in RFC 5927 <span>[<a href="#RFC5927" class="xref">100</a>]</span>, along with mitigations that have been implemented.<a href="#section-7-10" class="pilcrow">¶</a></p>
---
> Since ICMP message processing also can interact with TCP connections, there is potential for ICMP-based attacks against TCP connections.  These are discussed in RFC 5927 <span>[<a href="#RFC5927" class="cite xref">100</a>]</span>, along with mitigations that have been implemented.<a href="#section-7-10" class="pilcrow">¶</a></p>
7215c7235
< The IPv4 specification <span>[<a href="#RFC0791" class="xref">1</a>]</span> includes a precedence value in
---
> The IPv4 specification <span>[<a href="#RFC0791" class="cite xref">1</a>]</span> includes a precedence value in
7217,7218c7237,7238
< <span>[<a href="#RFC1349" class="xref">20</a>]</span> and then obsoleted by the definition of
< Differentiated Services (Diffserv) <span>[<a href="#RFC2474" class="xref">4</a>]</span>.  Setting and
---
> <span>[<a href="#RFC1349" class="cite xref">20</a>]</span> and then obsoleted by the definition of
> Differentiated Services (Diffserv) <span>[<a href="#RFC2474" class="cite xref">4</a>]</span>.  Setting and
7227c7247
< fixed by <span>[<a href="#RFC2873" class="xref">25</a>]</span>, which is Standards Track, and so this
---
> fixed by <span>[<a href="#RFC2873" class="cite xref">25</a>]</span>, which is Standards Track, and so this
7235c7255
< attack vector <span>[<a href="#I-D.gont-tcpm-tcp-seccomp-prec" class="xref">63</a>]</span>, and there has
---
> attack vector <span>[<a href="#I-D.gont-tcpm-tcp-seccomp-prec" class="cite xref">63</a>]</span>, and there has
7252c7272
< within a connection are discouraged.  For discussion of this, see RFC 7657 (Sections <a href="https://www.rfc-editor.org/rfc/rfc7657#section-5.1" class="relref">5.1</a>, <a href="https://www.rfc-editor.org/rfc/rfc7657#section-5.3" class="relref">5.3</a>, and <a href="https://www.rfc-editor.org/rfc/rfc7657#section-6" class="relref">6</a>) <span>[<a href="#RFC7657" class="xref">50</a>]</span>.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
---
> within a connection are discouraged.  For discussion of this, see RFC 7657 (Sections <a href="https://rfc-editor.org/rfc/rfc7657#section-5.1" class="relref">5.1</a>, <a href="https://rfc-editor.org/rfc/rfc7657#section-5.3" class="relref">5.3</a>, and <a href="https://rfc-editor.org/rfc/rfc7657#section-6" class="relref">6</a>) <span>[<a href="#RFC7657" class="cite xref">50</a>]</span>.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
7257c7277
< Problems with the old TCP logic in this regard were described in <span>[<a href="#RFC2873" class="xref">25</a>]</span>, and the solution described is to ignore IP precedence in
---
> Problems with the old TCP logic in this regard were described in <span>[<a href="#RFC2873" class="cite xref">25</a>]</span>, and the solution described is to ignore IP precedence in
7270c7290
<   The IP Security Option (IPSO) and compartment defined in <span>[<a href="#RFC0791" class="xref">1</a>]</span> was refined in RFC 1038, which was later obsoleted by RFC
---
>   The IP Security Option (IPSO) and compartment defined in <span>[<a href="#RFC0791" class="cite xref">1</a>]</span> was refined in RFC 1038, which was later obsoleted by RFC
7274c7294
<   Security Option.  For IPv6, a similar option (Common Architecture Label IPv6 Security Option (CALIPSO)) has been defined <span>[<a href="#RFC5570" class="xref">36</a>]</span>.  RFC 793 includes logic that includes the IP
---
>   Security Option.  For IPv6, a similar option (Common Architecture Label IPv6 Security Option (CALIPSO)) has been defined <span>[<a href="#RFC5570" class="cite xref">36</a>]</span>.  RFC 793 includes logic that includes the IP
7278c7298
<   implementations, consistent with running code on the Internet.  See <a href="#seccomp" class="xref">Appendix A.1</a> for further discussion.  Note that RFC 5570 describes some
---
>   implementations, consistent with running code on the Internet.  See <a href="#seccomp" class="auto internal xref">Appendix A.1</a> for further discussion.  Note that RFC 5570 describes some
7280c7300
<   special cases, TCP implementers should see Section <a href="https://www.rfc-editor.org/rfc/rfc5570#section-7.3.1" class="relref">7.3.1</a> of RFC 5570 and
---
>   special cases, TCP implementers should see Section <a href="https://rfc-editor.org/rfc/rfc5570#section-7.3.1" class="relref">7.3.1</a> of RFC 5570 and
7292c7312
<      <span>[<a href="#I-D.gont-tcpm-tcp-seq-validation" class="xref">64</a>]</span>, which includes descriptions of potential problems in conditions of simultaneous open, self-connects, simultaneous close, and simultaneous window probes.  The document also describes potential changes to the TCP specification to mitigate the issue by expanding the acceptable sequence numbers.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
---
>      <span>[<a href="#I-D.gont-tcpm-tcp-seq-validation" class="cite xref">64</a>]</span>, which includes descriptions of potential problems in conditions of simultaneous open, self-connects, simultaneous close, and simultaneous window probes.  The document also describes potential changes to the TCP specification to mitigate the issue by expanding the acceptable sequence numbers.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
7294c7314
< In Internet usage of TCP, these conditions rarely occur.  Common operating systems include different alternative mitigations, and the standard has not been updated yet to codify one of them, but implementers should consider the problems described in <span>[<a href="#I-D.gont-tcpm-tcp-seq-validation" class="xref">64</a>]</span>.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
---
> In Internet usage of TCP, these conditions rarely occur.  Common operating systems include different alternative mitigations, and the standard has not been updated yet to codify one of them, but implementers should consider the problems described in <span>[<a href="#I-D.gont-tcpm-tcp-seq-validation" class="cite xref">64</a>]</span>.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
7302c7322
< <p id="appendix-A.3-1">In common operating systems, both the Nagle algorithm and delayed acknowledgments are implemented and enabled by default.  TCP is used by many applications that have a request-response style of communication, where the combination of the Nagle algorithm and delayed acknowledgments can result in poor application performance.  A modification to the Nagle algorithm is described in <span>[<a href="#I-D.minshall-nagle" class="xref">68</a>]</span> that improves the situation for these applications.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
---
> <p id="appendix-A.3-1">In common operating systems, both the Nagle algorithm and delayed acknowledgments are implemented and enabled by default.  TCP is used by many applications that have a request-response style of communication, where the combination of the Nagle algorithm and delayed acknowledgments can result in poor application performance.  A modification to the Nagle algorithm is described in <span>[<a href="#I-D.minshall-nagle" class="cite xref">68</a>]</span> that improves the situation for these applications.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
