18c18
< <meta content="xml2rfc 3.12.0" name="generator">
---
> <meta content="xml2rfc 3.19.0" name="generator">
25,42c25,38
<   xml2rfc 3.12.0
<     Python 3.6.15
<     appdirs 1.4.4
<     ConfigArgParse 1.4.1
<     google-i18n-address 2.4.0
<     html5lib 1.0.1
<     intervaltree 3.0.2
<     Jinja2 2.11.3
<     kitchen 1.2.6
<     lxml 4.4.2
<     pycairo 1.15.1
<     pycountry 19.8.18
<     pyflakes 2.1.1
<     PyYAML 5.4.1
<     requests 2.24.0
<     setuptools 40.5.0
<     six 1.14.0
<     WeasyPrint 52.5
---
>   xml2rfc 3.19.0
>     Python 3.11.7
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 5.0.0
>     platformdirs 4.1.0
>     pycountry 23.12.11
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.12
44c40
< <link href="rfc9174.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc9174.xml" rel="alternate" type="application/rfc+xml">
54c50
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
63a60,65
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
66d67
<   width: extend-to-zoom;
81c82
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
83a85
>   overflow-wrap: break-word;
169a172,180
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
184,187d194
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
188a196
>   border: none;
266c274
< tt, code, pre, code {
---
> tt, code, pre {
268c276
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
307a316,318
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
505c516
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
645d655
< 
667a678,680
>   .breakable pre {
>     break-inside: auto;
>   }
735c748
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
835c848
< tt, code, pre, code {
---
> tt, code, pre {
840c853
< pre.sourcecode,
---
> .sourcecode pre,
876c889
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1057a1071
>   .artwork > pre,
1072c1086
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1078a1093,1095
> tr {
>   break-inside: avoid;
> }
1129c1146
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1154c1171
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1172c1189
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1186c1203
< li > p:last-of-type {
---
> li > p:last-of-type:only-child {
1190a1208
> <link href="https://datatracker.ietf.org/doc/draft-ietf-dtn-tcpclv4-26" rel="prev">
1193c1211
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-dtn-tcpclv4-26" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1195,1196c1213,1214
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1299c1317
<             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
---
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
1302c1320
<                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-scope" class="xref">Scope</a></p>
---
>                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-scope" class="internal xref">Scope</a></p>
1307c1325
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
---
>             <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
1310c1328
<                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-definitions-specific-to-the" class="xref">Definitions Specific to the TCPCL Protocol</a></p>
---
>                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-definitions-specific-to-the" class="internal xref">Definitions Specific to the TCPCL Protocol</a></p>
1315c1333
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-general-protocol-descriptio" class="xref">General Protocol Description</a></p>
---
>             <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-general-protocol-descriptio" class="internal xref">General Protocol Description</a></p>
1318c1336
<                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-convergence-layer-services" class="xref">Convergence-Layer Services</a></p>
---
>                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-convergence-layer-services" class="internal xref">Convergence-Layer Services</a></p>
1321c1339
<                 <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-tcpcl-session-overview" class="xref">TCPCL Session Overview</a></p>
---
>                 <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-tcpcl-session-overview" class="internal xref">TCPCL Session Overview</a></p>
1324c1342
<                 <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-tcpcl-states-and-transition" class="xref">TCPCL States and Transitions</a></p>
---
>                 <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-tcpcl-states-and-transition" class="internal xref">TCPCL States and Transitions</a></p>
1327c1345
<                 <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-pkix-environments-and-ca-po" class="xref">PKIX Environments and CA Policy</a></p>
---
>                 <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-pkix-environments-and-ca-po" class="internal xref">PKIX Environments and CA Policy</a></p>
1330c1348
<                 <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-session-keeping-policies" class="xref">Session-Keeping Policies</a></p>
---
>                 <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-session-keeping-policies" class="internal xref">Session-Keeping Policies</a></p>
1333c1351
<                 <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-transfer-segmentation-polic" class="xref">Transfer Segmentation Policies</a></p>
---
>                 <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-transfer-segmentation-polic" class="internal xref">Transfer Segmentation Policies</a></p>
1336c1354
<                 <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-example-message-exchange" class="xref">Example Message Exchange</a></p>
---
>                 <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-example-message-exchange" class="internal xref">Example Message Exchange</a></p>
1341c1359
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-session-establishment" class="xref">Session Establishment</a></p>
---
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-session-establishment" class="internal xref">Session Establishment</a></p>
1344c1362
<                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-tcp-connection" class="xref">TCP Connection</a></p>
---
>                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-tcp-connection" class="internal xref">TCP Connection</a></p>
1347c1365
<                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-contact-header" class="xref">Contact Header</a></p>
---
>                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-contact-header" class="internal xref">Contact Header</a></p>
1350c1368
<                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-contact-validation-and-nego" class="xref">Contact Validation and Negotiation</a></p>
---
>                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-contact-validation-and-nego" class="internal xref">Contact Validation and Negotiation</a></p>
1353c1371
<                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-session-security" class="xref">Session Security</a></p>
---
>                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-session-security" class="internal xref">Session Security</a></p>
1356c1374
<                     <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-entity-identification" class="xref">Entity Identification</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="auto internal xref">4.4.1</a>.  <a href="#name-entity-identification" class="internal xref">Entity Identification</a></p>
1359c1377
<                     <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-certificate-profile-for-the" class="xref">Certificate Profile for the TCPCL</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="auto internal xref">4.4.2</a>.  <a href="#name-certificate-profile-for-the" class="internal xref">Certificate Profile for the TCPCL</a></p>
1362c1380
<                     <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="xref">4.4.3</a>.  <a href="#name-tls-handshake" class="xref">TLS Handshake</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="auto internal xref">4.4.3</a>.  <a href="#name-tls-handshake" class="internal xref">TLS Handshake</a></p>
1365c1383
<                     <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="xref">4.4.4</a>.  <a href="#name-tls-authentication" class="xref">TLS Authentication</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.4.1"><a href="#section-4.4.4" class="auto internal xref">4.4.4</a>.  <a href="#name-tls-authentication" class="internal xref">TLS Authentication</a></p>
1368c1386
<                     <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="xref">4.4.5</a>.  <a href="#name-policy-recommendations" class="xref">Policy Recommendations</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.5.1"><a href="#section-4.4.5" class="auto internal xref">4.4.5</a>.  <a href="#name-policy-recommendations" class="internal xref">Policy Recommendations</a></p>
1371c1389
<                     <p id="section-toc.1-1.4.2.4.2.6.1"><a href="#section-4.4.6" class="xref">4.4.6</a>.  <a href="#name-example-tls-initiation" class="xref">Example TLS Initiation</a></p>
---
>                     <p id="section-toc.1-1.4.2.4.2.6.1"><a href="#section-4.4.6" class="auto internal xref">4.4.6</a>.  <a href="#name-example-tls-initiation" class="internal xref">Example TLS Initiation</a></p>
1376c1394
<                 <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-message-header" class="xref">Message Header</a></p>
---
>                 <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-message-header" class="internal xref">Message Header</a></p>
1379c1397
<                 <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-session-initialization-mess" class="xref">Session Initialization Message (SESS_INIT)</a></p>
---
>                 <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="auto internal xref">4.6</a>.  <a href="#name-session-initialization-mess" class="internal xref">Session Initialization Message (SESS_INIT)</a></p>
1382c1400
<                 <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-session-parameter-negotiati" class="xref">Session Parameter Negotiation</a></p>
---
>                 <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="auto internal xref">4.7</a>.  <a href="#name-session-parameter-negotiati" class="internal xref">Session Parameter Negotiation</a></p>
1385c1403
<                 <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="xref">4.8</a>.  <a href="#name-session-extension-items" class="xref">Session Extension Items</a></p>
---
>                 <p id="section-toc.1-1.4.2.8.1"><a href="#section-4.8" class="auto internal xref">4.8</a>.  <a href="#name-session-extension-items" class="internal xref">Session Extension Items</a></p>
1390c1408
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-established-session-operati" class="xref">Established Session Operation</a></p>
---
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-established-session-operati" class="internal xref">Established Session Operation</a></p>
1393c1411
<                 <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-upkeep-and-status-messages" class="xref">Upkeep and Status Messages</a></p>
---
>                 <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-upkeep-and-status-messages" class="internal xref">Upkeep and Status Messages</a></p>
1396c1414
<                     <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-session-upkeep-keepalive" class="xref">Session Upkeep (KEEPALIVE)</a></p>
---
>                     <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-session-upkeep-keepalive" class="internal xref">Session Upkeep (KEEPALIVE)</a></p>
1399c1417
<                     <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-message-rejection-msg_rejec" class="xref">Message Rejection (MSG_REJECT)</a></p>
---
>                     <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="auto internal xref">5.1.2</a>.  <a href="#name-message-rejection-msg_rejec" class="internal xref">Message Rejection (MSG_REJECT)</a></p>
1404c1422
<                 <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-bundle-transfer" class="xref">Bundle Transfer</a></p>
---
>                 <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-bundle-transfer" class="internal xref">Bundle Transfer</a></p>
1407c1425
<                     <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-bundle-transfer-id" class="xref">Bundle Transfer ID</a></p>
---
>                     <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-bundle-transfer-id" class="internal xref">Bundle Transfer ID</a></p>
1410c1428
<                     <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-data-transmission-xfer_segm" class="xref">Data Transmission (XFER_SEGMENT)</a></p>
---
>                     <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="auto internal xref">5.2.2</a>.  <a href="#name-data-transmission-xfer_segm" class="internal xref">Data Transmission (XFER_SEGMENT)</a></p>
1413c1431
<                     <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-data-acknowledgments-xfer_a" class="xref">Data Acknowledgments (XFER_ACK)</a></p>
---
>                     <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="auto internal xref">5.2.3</a>.  <a href="#name-data-acknowledgments-xfer_a" class="internal xref">Data Acknowledgments (XFER_ACK)</a></p>
1416c1434
<                     <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-transfer-refusal-xfer_refus" class="xref">Transfer Refusal (XFER_REFUSE)</a></p>
---
>                     <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="auto internal xref">5.2.4</a>.  <a href="#name-transfer-refusal-xfer_refus" class="internal xref">Transfer Refusal (XFER_REFUSE)</a></p>
1419c1437
<                     <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="xref">5.2.5</a>.  <a href="#name-transfer-extension-items" class="xref">Transfer Extension Items</a></p>
---
>                     <p id="section-toc.1-1.5.2.2.2.5.1"><a href="#section-5.2.5" class="auto internal xref">5.2.5</a>.  <a href="#name-transfer-extension-items" class="internal xref">Transfer Extension Items</a></p>
1426c1444
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-session-termination" class="xref">Session Termination</a></p>
---
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-session-termination" class="internal xref">Session Termination</a></p>
1429c1447
<                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-session-termination-message" class="xref">Session Termination Message (SESS_TERM)</a></p>
---
>                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-session-termination-message" class="internal xref">Session Termination Message (SESS_TERM)</a></p>
1432c1450
<                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-idle-session-termination" class="xref">Idle Session Termination</a></p>
---
>                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-idle-session-termination" class="internal xref">Idle Session Termination</a></p>
1437c1455
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
---
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1440c1458
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-threat-passive-leak-of-node" class="xref">Threat: Passive Leak of Node Data</a></p>
---
>                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-threat-passive-leak-of-node" class="internal xref">Threat: Passive Leak of Node Data</a></p>
1443c1461
<                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-threat-passive-leak-of-bund" class="xref">Threat: Passive Leak of Bundle Data</a></p>
---
>                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-threat-passive-leak-of-bund" class="internal xref">Threat: Passive Leak of Bundle Data</a></p>
1446c1464
<                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-threat-tcpcl-version-downgr" class="xref">Threat: TCPCL Version Downgrade</a></p>
---
>                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-threat-tcpcl-version-downgr" class="internal xref">Threat: TCPCL Version Downgrade</a></p>
1449c1467
<                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-threat-transport-security-s" class="xref">Threat: Transport Security Stripping</a></p>
---
>                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-threat-transport-security-s" class="internal xref">Threat: Transport Security Stripping</a></p>
1452c1470
<                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-threat-weak-tls-configurati" class="xref">Threat: Weak TLS Configurations</a></p>
---
>                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-threat-weak-tls-configurati" class="internal xref">Threat: Weak TLS Configurations</a></p>
1455c1473
<                 <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-threat-untrusted-end-entity" class="xref">Threat: Untrusted End-Entity Certificate</a></p>
---
>                 <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-threat-untrusted-end-entity" class="internal xref">Threat: Untrusted End-Entity Certificate</a></p>
1458c1476
<                 <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-threat-certificate-validati" class="xref">Threat: Certificate Validation Vulnerabilities</a></p>
---
>                 <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-threat-certificate-validati" class="internal xref">Threat: Certificate Validation Vulnerabilities</a></p>
1461c1479
<                 <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-threat-symmetric-key-limits" class="xref">Threat: Symmetric Key Limits</a></p>
---
>                 <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-threat-symmetric-key-limits" class="internal xref">Threat: Symmetric Key Limits</a></p>
1464c1482
<                 <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-threat-bp-node-impersonatio" class="xref">Threat: BP Node Impersonation</a></p>
---
>                 <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-threat-bp-node-impersonatio" class="internal xref">Threat: BP Node Impersonation</a></p>
1467c1485
<                 <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="xref">7.10</a>. <a href="#name-threat-denial-of-service" class="xref">Threat: Denial of Service</a></p>
---
>                 <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="auto internal xref">7.10</a>. <a href="#name-threat-denial-of-service" class="internal xref">Threat: Denial of Service</a></p>
1470c1488
<                 <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="xref">7.11</a>. <a href="#name-mandatory-to-implement-tls" class="xref">Mandatory-to-Implement TLS</a></p>
---
>                 <p id="section-toc.1-1.7.2.11.1"><a href="#section-7.11" class="auto internal xref">7.11</a>. <a href="#name-mandatory-to-implement-tls" class="internal xref">Mandatory-to-Implement TLS</a></p>
1473c1491
<                 <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="xref">7.12</a>. <a href="#name-alternate-uses-of-tls" class="xref">Alternate Uses of TLS</a></p>
---
>                 <p id="section-toc.1-1.7.2.12.1"><a href="#section-7.12" class="auto internal xref">7.12</a>. <a href="#name-alternate-uses-of-tls" class="internal xref">Alternate Uses of TLS</a></p>
1476c1494
<                     <p id="section-toc.1-1.7.2.12.2.1.1"><a href="#section-7.12.1" class="xref">7.12.1</a>.  <a href="#name-tls-without-authentication" class="xref">TLS without Authentication</a></p>
---
>                     <p id="section-toc.1-1.7.2.12.2.1.1"><a href="#section-7.12.1" class="auto internal xref">7.12.1</a>.  <a href="#name-tls-without-authentication" class="internal xref">TLS without Authentication</a></p>
1479c1497
<                     <p id="section-toc.1-1.7.2.12.2.2.1"><a href="#section-7.12.2" class="xref">7.12.2</a>.  <a href="#name-non-certificate-tls-use" class="xref">Non-certificate TLS Use</a></p>
---
>                     <p id="section-toc.1-1.7.2.12.2.2.1"><a href="#section-7.12.2" class="auto internal xref">7.12.2</a>.  <a href="#name-non-certificate-tls-use" class="internal xref">Non-certificate TLS Use</a></p>
1484c1502
<                 <p id="section-toc.1-1.7.2.13.1"><a href="#section-7.13" class="xref">7.13</a>. <a href="#name-predictability-of-transfer-" class="xref">Predictability of Transfer IDs</a></p>
---
>                 <p id="section-toc.1-1.7.2.13.1"><a href="#section-7.13" class="auto internal xref">7.13</a>. <a href="#name-predictability-of-transfer-" class="internal xref">Predictability of Transfer IDs</a></p>
1489c1507
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
---
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
1492c1510
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-port-number" class="xref">Port Number</a></p>
---
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-port-number" class="internal xref">Port Number</a></p>
1495c1513
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-protocol-versions" class="xref">Protocol Versions</a></p>
---
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-protocol-versions" class="internal xref">Protocol Versions</a></p>
1498c1516
<                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-session-extension-types" class="xref">Session Extension Types</a></p>
---
>                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-session-extension-types" class="internal xref">Session Extension Types</a></p>
1501c1519
<                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-transfer-extension-types" class="xref">Transfer Extension Types</a></p>
---
>                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-transfer-extension-types" class="internal xref">Transfer Extension Types</a></p>
1504c1522
<                 <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="xref">8.5</a>.  <a href="#name-message-types" class="xref">Message Types</a></p>
---
>                 <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-message-types" class="internal xref">Message Types</a></p>
1507c1525
<                 <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="xref">8.6</a>.  <a href="#name-xfer_refuse-reason-codes-2" class="xref">XFER_REFUSE Reason Codes</a></p>
---
>                 <p id="section-toc.1-1.8.2.6.1"><a href="#section-8.6" class="auto internal xref">8.6</a>.  <a href="#name-xfer_refuse-reason-codes-2" class="internal xref">XFER_REFUSE Reason Codes</a></p>
1510c1528
<                 <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="xref">8.7</a>.  <a href="#name-sess_term-reason-codes-2" class="xref">SESS_TERM Reason Codes</a></p>
---
>                 <p id="section-toc.1-1.8.2.7.1"><a href="#section-8.7" class="auto internal xref">8.7</a>.  <a href="#name-sess_term-reason-codes-2" class="internal xref">SESS_TERM Reason Codes</a></p>
1513c1531
<                 <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="xref">8.8</a>.  <a href="#name-msg_reject-reason-codes-2" class="xref">MSG_REJECT Reason Codes</a></p>
---
>                 <p id="section-toc.1-1.8.2.8.1"><a href="#section-8.8" class="auto internal xref">8.8</a>.  <a href="#name-msg_reject-reason-codes-2" class="internal xref">MSG_REJECT Reason Codes</a></p>
1516c1534
<                 <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="xref">8.9</a>.  <a href="#name-object-identifier-for-pkix-" class="xref">Object Identifier for PKIX Module Identifier</a></p>
---
>                 <p id="section-toc.1-1.8.2.9.1"><a href="#section-8.9" class="auto internal xref">8.9</a>.  <a href="#name-object-identifier-for-pkix-" class="internal xref">Object Identifier for PKIX Module Identifier</a></p>
1519c1537
<                 <p id="section-toc.1-1.8.2.10.1"><a href="#section-8.10" class="xref">8.10</a>. <a href="#name-object-identifier-for-pkix-o" class="xref">Object Identifier for PKIX Other Name Forms</a></p>
---
>                 <p id="section-toc.1-1.8.2.10.1"><a href="#section-8.10" class="auto internal xref">8.10</a>. <a href="#name-object-identifier-for-pkix-o" class="internal xref">Object Identifier for PKIX Other Name Forms</a></p>
1522c1540
<                 <p id="section-toc.1-1.8.2.11.1"><a href="#section-8.11" class="xref">8.11</a>. <a href="#name-object-identifier-for-pkix-e" class="xref">Object Identifier for PKIX Extended Key Usage</a></p>
---
>                 <p id="section-toc.1-1.8.2.11.1"><a href="#section-8.11" class="auto internal xref">8.11</a>. <a href="#name-object-identifier-for-pkix-e" class="internal xref">Object Identifier for PKIX Extended Key Usage</a></p>
1527c1545
<             <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
---
>             <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
1530c1548
<                 <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
---
>                 <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1533c1551
<                 <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
---
>                 <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1538c1556
<             <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-significant-changes-from-rf" class="xref">Significant Changes from RFC 7242</a></p>
---
>             <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-significant-changes-from-rf" class="internal xref">Significant Changes from RFC 7242</a></p>
1541c1559
<             <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-asn1-module" class="xref">ASN.1 Module</a></p>
---
>             <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-asn1-module" class="internal xref">ASN.1 Module</a></p>
1544c1562
<             <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-example-of-the-bundleeid-ot" class="xref">Example of the BundleEID Other Name Form</a></p>
---
>             <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-example-of-the-bundleeid-ot" class="internal xref">Example of the BundleEID Other Name Form</a></p>
1547c1565
<             <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
---
>             <p id="section-toc.1-1.13.1"><a href="#appendix-D" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
1550c1568
<             <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
---
>             <p id="section-toc.1-1.14.1"><a href="#appendix-E" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
1564c1582
< More detailed descriptions of the rationale and capabilities of these networks can be found in "<a href="#RFC4838" class="xref">Delay-Tolerant Networking Architecture</a>" <span>[<a href="#RFC4838" class="xref">RFC4838</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
---
> More detailed descriptions of the rationale and capabilities of these networks can be found in "<a href="#RFC4838" class="internal xref">Delay-Tolerant Networking Architecture</a>" <span>[<a href="#RFC4838" class="cite xref">RFC4838</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
1567c1585
< The protocol used for DTN communications is the Bundle Protocol version 7 (BPv7) <span>[<a href="#RFC9171" class="xref">RFC9171</a>]</span>, an application-layer protocol that is used to construct a store-and-forward overlay network.
---
> The protocol used for DTN communications is the Bundle Protocol version 7 (BPv7) <span>[<a href="#RFC9171" class="cite xref">RFC9171</a>]</span>, an application-layer protocol that is used to construct a store-and-forward overlay network.
1579c1597
< The locations of the TCPCL and the Bundle Protocol in the Internet model protocol stack (described in <span>[<a href="#RFC1122" class="xref">RFC1122</a>]</span>) are shown in <a href="#fig-tcpcl-ip-stack" class="xref">Figure 1</a>.
---
> The locations of the TCPCL and the Bundle Protocol in the Internet model protocol stack (described in <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span>) are shown in <a href="#fig-tcpcl-ip-stack" class="auto internal xref">Figure 1</a>.
1615c1633
< The format of protocol data units of the Bundle Protocol, as those are defined elsewhere in <span>[<a href="#RFC9171" class="xref">RFC9171</a>]</span>.
---
> The format of protocol data units of the Bundle Protocol, as those are defined elsewhere in <span>[<a href="#RFC9171" class="cite xref">RFC9171</a>]</span>.
1631c1649
< Uses of TLS that are not based on PKIX certificate authentication (see <a href="#sec-security-tlsnopki" class="xref">Section 7.12.2</a>) or in which authentication of both entities is not possible (see <a href="#sec-security-tlsnoauth" class="xref">Section 7.12.1</a>).<a href="#section-1.1-2.5" class="pilcrow">¶</a>
---
> Uses of TLS that are not based on PKIX certificate authentication (see <a href="#sec-security-tlsnopki" class="auto internal xref">Section 7.12.2</a>) or in which authentication of both entities is not possible (see <a href="#sec-security-tlsnoauth" class="auto internal xref">Section 7.12.1</a>).<a href="#section-1.1-2.5" class="pilcrow">¶</a>
1650c1668
<        <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only
---
>        <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only
1685c1703
< These relationships are illustrated in <a href="#fig-entity-session-relations" class="xref">Figure 2</a>.
---
> These relationships are illustrated in <a href="#fig-entity-session-relations" class="auto internal xref">Figure 2</a>.
1701c1719
< Within a single TCPCL session, there are two possible transfer streams: one in each direction, with one stream from each entity being the outbound stream and the other being the inbound stream (see <a href="#fig-session-stream" class="xref">Figure 3</a>).
---
> Within a single TCPCL session, there are two possible transfer streams: one in each direction, with one stream from each entity being the outbound stream and the other being the inbound stream (see <a href="#fig-session-stream" class="auto internal xref">Figure 3</a>).
1711c1729
< However, the mechanism by which two entities exchange and negotiate the values to be used for a given session is described in <a href="#sec-contact-negotiate" class="xref">Section 4.3</a>.<a href="#section-2.1-2.10" class="pilcrow">¶</a>
---
> However, the mechanism by which two entities exchange and negotiate the values to be used for a given session is described in <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a>.<a href="#section-2.1-2.10" class="pilcrow">¶</a>
1751c1769
< The relationship between connections, sessions, and streams is shown in <a href="#fig-session-stream" class="xref">Figure 3</a>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
---
> The relationship between connections, sessions, and streams is shown in <a href="#fig-session-stream" class="auto internal xref">Figure 3</a>.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
1874c1892
< When the session is established, the peer node ID (along with an indication of whether or not it was authenticated) and the negotiated session parameters (see <a href="#sec-session-negotiate" class="xref">Section 4.7</a>) are also communicated to the BPA.<a href="#section-3.1-2.6.2.8" class="pilcrow">¶</a>
---
> When the session is established, the peer node ID (along with an indication of whether or not it was authenticated) and the negotiated session parameters (see <a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>) are also communicated to the BPA.<a href="#section-3.1-2.6.2.8" class="pilcrow">¶</a>
1963,1964c1981,1982
< First, one entity establishes a TCPCL session to the other by initiating a TCP connection in accordance with <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>.
< After setup of the TCP connection is complete, an initial Contact Header is exchanged in both directions to establish a shared TCPCL version and negotiate the use of TLS security (as described in <a href="#sec-session-establishment" class="xref">Section 4</a>).
---
> First, one entity establishes a TCPCL session to the other by initiating a TCP connection in accordance with <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span>.
> After setup of the TCP connection is complete, an initial Contact Header is exchanged in both directions to establish a shared TCPCL version and negotiate the use of TLS security (as described in <a href="#sec-session-establishment" class="auto internal xref">Section 4</a>).
1993c2011
< A SESS_TERM message is used to initiate the ending of a TCPCL session (see <a href="#sec-SESS_TERM" class="xref">Section 6.1</a>).
---
> A SESS_TERM message is used to initiate the ending of a TCPCL session (see <a href="#sec-SESS_TERM" class="auto internal xref">Section 6.1</a>).
1995,1996c2013,2014
< A SESS_TERM message can also be used to refuse a session setup by a peer (see <a href="#sec-contact-negotiate" class="xref">Section 4.3</a>).
< Regardless of the reason, session termination is initiated by one of the entities and  the other entity responds to it, as illustrated by Figures <a href="#fig-sessterm-init" class="xref">13</a> and <a href="#fig-sessterm-respond" class="xref">14</a> in the next subsection.
---
> A SESS_TERM message can also be used to refuse a session setup by a peer (see <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a>).
> Regardless of the reason, session termination is initiated by one of the entities and  the other entity responds to it, as illustrated by Figures <a href="#fig-sessterm-init" class="auto internal xref">13</a> and <a href="#fig-sessterm-respond" class="auto internal xref">14</a> in the next subsection.
2011c2029
< The states of a normal TCPCL session (i.e., without session failures) are indicated in <a href="#fig-session-states" class="xref">Figure 4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
---
> The states of a normal TCPCL session (i.e., without session failures) are indicated in <a href="#fig-session-states" class="auto internal xref">Figure 4</a>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
2069,2070c2087,2088
< Contact negotiation involves exchanging a Contact Header ("CH" in Figures <a href="#fig-contact-init-active" class="xref">5</a>, <a href="#fig-contact-init-passive" class="xref">6</a>, and <a href="#fig-contact-init-process" class="xref">7</a>) in both directions and deriving a negotiated state from the two headers.
< The contact negotiation sequencing is performed as either the active or passive entity and is illustrated in Figures <a href="#fig-contact-init-active" class="xref">5</a> and <a href="#fig-contact-init-passive" class="xref">6</a>, respectively, which both share the data validation and negotiation of the Processing of Contact Header ("[PCH]") activity (<a href="#fig-contact-init-process" class="xref">Figure 7</a>) and the "[TCPCLOSE]" activity, which indicates TCP connection close.
---
> Contact negotiation involves exchanging a Contact Header ("CH" in Figures <a href="#fig-contact-init-active" class="auto internal xref">5</a>, <a href="#fig-contact-init-passive" class="auto internal xref">6</a>, and <a href="#fig-contact-init-process" class="auto internal xref">7</a>) in both directions and deriving a negotiated state from the two headers.
> The contact negotiation sequencing is performed as either the active or passive entity and is illustrated in Figures <a href="#fig-contact-init-active" class="auto internal xref">5</a> and <a href="#fig-contact-init-passive" class="auto internal xref">6</a>, respectively, which both share the data validation and negotiation of the Processing of Contact Header ("[PCH]") activity (<a href="#fig-contact-init-process" class="auto internal xref">Figure 7</a>) and the "[TCPCLOSE]" activity, which indicates TCP connection close.
2148c2166
< The session negotiation sequencing is performed as either the active or passive entity and is illustrated in Figures <a href="#fig-sess-init-active" class="xref">8</a> and <a href="#fig-sess-init-passive" class="xref">9</a>, respectively (where "[PSI]" means "Processing of Session Initiation"), which both share the data validation and negotiation shown in <a href="#fig-sess-init-process" class="xref">Figure 10</a>.
---
> The session negotiation sequencing is performed as either the active or passive entity and is illustrated in Figures <a href="#fig-sess-init-active" class="auto internal xref">8</a> and <a href="#fig-sess-init-passive" class="auto internal xref">9</a>, respectively (where "[PSI]" means "Processing of Session Initiation"), which both share the data validation and negotiation shown in <a href="#fig-sess-init-process" class="auto internal xref">Figure 10</a>.
2219c2237
< Each transfer occurs within a single logical transfer stream between a sender and a receiver, as illustrated in Figures <a href="#fig-transfer-tx-states" class="xref">11</a> and <a href="#fig-transfer-rx-states" class="xref">12</a>, respectively.<a href="#section-3.3-13" class="pilcrow">¶</a></p>
---
> Each transfer occurs within a single logical transfer stream between a sender and a receiver, as illustrated in Figures <a href="#fig-transfer-tx-states" class="auto internal xref">11</a> and <a href="#fig-transfer-rx-states" class="auto internal xref">12</a>, respectively.<a href="#section-3.3-13" class="pilcrow">¶</a></p>
2327c2345
< There are large infrastructures already in place for managing network-level authentication and protocols to manage identity verification in those environments <span>[<a href="#RFC8555" class="xref">RFC8555</a>]</span>.
---
> There are large infrastructures already in place for managing network-level authentication and protocols to manage identity verification in those environments <span>[<a href="#RFC8555" class="cite xref">RFC8555</a>]</span>.
2329c2347
< This situation is not ideal, as it allows the vulnerabilities described in <a href="#sec-threat-node-impersonation" class="xref">Section 7.9</a>, but it still provides some amount of mutual authentication to take place for a TCPCL session.<a href="#section-3.4-2.4" class="pilcrow">¶</a>
---
> This situation is not ideal, as it allows the vulnerabilities described in <a href="#sec-threat-node-impersonation" class="auto internal xref">Section 7.9</a>, but it still provides some amount of mutual authentication to take place for a TCPCL session.<a href="#section-3.4-2.4" class="pilcrow">¶</a>
2335c2353
< The requirements related to identifiers in a PKIX certificate are provided in <a href="#sec-tls-identification" class="xref">Section 4.4.1</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
---
> The requirements related to identifiers in a PKIX certificate are provided in <a href="#sec-tls-identification" class="auto internal xref">Section 4.4.1</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
2338c2356
< Some security policy recommendations are given in <a href="#sec-tls-auth-policy-rec" class="xref">Section 4.4.5</a>, but these are meant as a starting point for tailoring.
---
> Some security policy recommendations are given in <a href="#sec-tls-auth-policy-rec" class="auto internal xref">Section 4.4.5</a>, but these are meant as a starting point for tailoring.
2340c2358
< Operation on the Internet (such as inter-site BP gateways) could trade more lax TCPCL security with the use of encrypted bundle encapsulation <span>[<a href="#I-D.ietf-dtn-bibect" class="xref">DTN-BIBECT</a>]</span> to ensure strong bundle security.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
---
> Operation on the Internet (such as inter-site BP gateways) could trade more lax TCPCL security with the use of encrypted bundle encapsulation <span>[<a href="#I-D.ietf-dtn-bibect" class="cite xref">DTN-BIBECT</a>]</span> to ensure strong bundle security.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
2342c2360
< By using the Server Name Indication (SNI) DNS name (see <a href="#sec-tls-handshake" class="xref">Section 4.4.3</a>), a single passive entity can act as a convergence layer for multiple BPAs with distinct node IDs.
---
> By using the Server Name Indication (SNI) DNS name (see <a href="#sec-tls-handshake" class="auto internal xref">Section 4.4.3</a>), a single passive entity can act as a convergence layer for multiple BPAs with distinct node IDs.
2430c2448
< <a href="#fig-contact-example" class="xref">Figure 15</a> depicts the protocol exchange for a simple session, showing the session establishment and the transmission of a single bundle split into three data segments (of lengths "L1", "L2", and "L3") from Entity A to Entity B.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
---
> <a href="#fig-contact-example" class="auto internal xref">Figure 15</a> depicts the protocol exchange for a simple session, showing the session establishment and the transmission of a single bundle split into three data segments (of lengths "L1", "L2", and "L3") from Entity A to Entity B.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
2515c2533
< Destination port number 4556 has been assigned by IANA as the registered port number for the TCPCL; see <a href="#sec-iana-port" class="xref">Section 8.1</a>.
---
> Destination port number 4556 has been assigned by IANA as the registered port number for the TCPCL; see <a href="#sec-iana-port" class="auto internal xref">Section 8.1</a>.
2533,2534c2551,2552
< The format of the Contact Header is described in <a href="#sec-contact-header" class="xref">Section 4.2</a>.
< Because the TCPCL protocol version in use is part of the initial Contact Header, entities using TCPCL version 4 can coexist on a network with entities using earlier TCPCL versions (with some negotiation needed for interoperation, as described in <a href="#sec-contact-negotiate" class="xref">Section 4.3</a>).<a href="#section-4.1-4" class="pilcrow">¶</a></p>
---
> The format of the Contact Header is described in <a href="#sec-contact-header" class="auto internal xref">Section 4.2</a>.
> Because the TCPCL protocol version in use is part of the initial Contact Header, entities using TCPCL version 4 can coexist on a network with entities using earlier TCPCL versions (with some negotiation needed for interoperation, as described in <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a>).<a href="#section-4.1-4" class="pilcrow">¶</a></p>
2548c2566
< If the entity is configured to enable the exchange of messages according to TLS 1.3 <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or any successors that are compatible with that TLS ClientHello, the <code>CAN_TLS</code> flag within its Contact Header <span class="bcp14">SHALL</span> be set to 1.
---
> If the entity is configured to enable the exchange of messages according to TLS 1.3 <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> or any successors that are compatible with that TLS ClientHello, the <code>CAN_TLS</code> flag within its Contact Header <span class="bcp14">SHALL</span> be set to 1.
2550c2568
< This follows the "opportunistic security" model specified in <span>[<a href="#RFC7435" class="xref">RFC7435</a>]</span>, though an active attacker could interfere with the exchange in such cases (see <a href="#sec-threat-tls-strip" class="xref">Section 7.4</a>).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
---
> This follows the "opportunistic security" model specified in <span>[<a href="#RFC7435" class="cite xref">RFC7435</a>]</span>, though an active attacker could interfere with the exchange in such cases (see <a href="#sec-threat-tls-strip" class="auto internal xref">Section 7.4</a>).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
2552c2570
< Upon receipt of the Contact Header, both entities perform the validation and negotiation procedures defined in <a href="#sec-contact-negotiate" class="xref">Section 4.3</a>.
---
> Upon receipt of the Contact Header, both entities perform the validation and negotiation procedures defined in <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a>.
2574c2592
< See <a href="#sec-contact-negotiate" class="xref">Section 4.3</a> for details on the use of each of these Contact Header fields.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
---
> See <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a> for details on the use of each of these Contact Header fields.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
2590c2608
< A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-contact-header-flags" class="xref">Table 1</a>.
---
> A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-contact-header-flags" class="auto internal xref">Table 1</a>.
2665c2683
< Because this state is negotiated over an unsecured medium, there is a risk of TLS Stripping as described in <a href="#sec-threat-tls-strip" class="xref">Section 7.4</a>.<a href="#section-4.3-6.4.1" class="pilcrow">¶</a></p>
---
> Because this state is negotiated over an unsecured medium, there is a risk of TLS Stripping as described in <a href="#sec-threat-tls-strip" class="auto internal xref">Section 7.4</a>.<a href="#section-4.3-6.4.1" class="pilcrow">¶</a></p>
2669c2687
< If the negotiated Enable TLS value is "true" and acceptable, then the TLS negotiation feature described in <a href="#sec-session-security" class="xref">Section 4.4</a> begins immediately following the Contact Header exchange.<a href="#section-4.3-6.4.2" class="pilcrow">¶</a></p>
---
> If the negotiated Enable TLS value is "true" and acceptable, then the TLS negotiation feature described in <a href="#sec-session-security" class="auto internal xref">Section 4.4</a> begins immediately following the Contact Header exchange.<a href="#section-4.3-6.4.2" class="pilcrow">¶</a></p>
2686c2704
< Immediately prior to actively ending a TLS connection after TCPCL session termination, the peer that sent the original (non-reply) SESS_TERM message <span class="bcp14">SHOULD</span> follow the closure alert procedure provided in <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> to cleanly terminate the TLS connection.
---
> Immediately prior to actively ending a TLS connection after TCPCL session termination, the peer that sent the original (non-reply) SESS_TERM message <span class="bcp14">SHOULD</span> follow the closure alert procedure provided in <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span> to cleanly terminate the TLS connection.
2700c2718
< Because the PKIX environment of each TCPCL entity is likely not controlled by the certificate end users (see <a href="#sec-pkix-env" class="xref">Section 3.4</a>), the TCPCL defines a prioritized list of what a certificate can identify regarding a TCPCL entity:<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
---
> Because the PKIX environment of each TCPCL entity is likely not controlled by the certificate end users (see <a href="#sec-pkix-env" class="auto internal xref">Section 3.4</a>), the TCPCL defines a prioritized list of what a certificate can identify regarding a TCPCL entity:<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
2711c2729
< The use of wildcard DNS-IDs is discouraged due to the complex rules for matching and dependence on implementation support for wildcard matching (see <span><a href="https://www.rfc-editor.org/rfc/rfc6125#section-6.4.3" class="relref">Section 6.4.3</a> of [<a href="#RFC6125" class="xref">RFC6125</a>]</span>).<a href="#section-4.4.1-3.4" class="pilcrow">¶</a>
---
> The use of wildcard DNS-IDs is discouraged due to the complex rules for matching and dependence on implementation support for wildcard matching (see <span><a href="https://rfc-editor.org/rfc/rfc6125#section-6.4.3" class="relref">Section 6.4.3</a> of [<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>).<a href="#section-4.4.1-3.4" class="pilcrow">¶</a>
2721c2739
< This specification defines a NODE-ID of a certificate as being the subjectAltName entry of type otherName with a name form of <code>BundleEID</code> (see <a href="#sec-pkix-oids" class="xref">Section 4.4.2.1</a>) and a value limited to a node ID.
---
> This specification defines a NODE-ID of a certificate as being the subjectAltName entry of type otherName with a name form of <code>BundleEID</code> (see <a href="#sec-pkix-oids" class="auto internal xref">Section 4.4.2.1</a>) and a value limited to a node ID.
2723,2724c2741,2742
< The NODE-ID is similar to the URI-ID as defined in <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span> but is restricted to a node ID rather than a URI with a qualified-name authority part.
< Unless specified otherwise by the definition of the URI scheme being authenticated, URI matching of a NODE-ID <span class="bcp14">SHALL</span> use the URI comparison logic provided in <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> and scheme-based normalization of those schemes specified in <span>[<a href="#RFC9171" class="xref">RFC9171</a>]</span>.
---
> The NODE-ID is similar to the URI-ID as defined in <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span> but is restricted to a node ID rather than a URI with a qualified-name authority part.
> Unless specified otherwise by the definition of the URI scheme being authenticated, URI matching of a NODE-ID <span class="bcp14">SHALL</span> use the URI comparison logic provided in <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> and scheme-based normalization of those schemes specified in <span>[<a href="#RFC9171" class="cite xref">RFC9171</a>]</span>.
2727c2745
< This specification reuses the DNS-ID definition in <span><a href="https://www.rfc-editor.org/rfc/rfc6125#section-1.8" class="relref">Section 1.8</a> of [<a href="#RFC6125" class="xref">RFC6125</a>]</span>, which is the subjectAltName entry of type dNSName whose value is encoded according to <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
---
> This specification reuses the DNS-ID definition in <span><a href="https://rfc-editor.org/rfc/rfc6125#section-1.8" class="relref">Section 1.8</a> of [<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>, which is the subjectAltName entry of type dNSName whose value is encoded according to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.4.1-5" class="pilcrow">¶</a></p>
2729c2747
< This specification defines an IPADDR-ID of a certificate as being the subjectAltName entry of type iPAddress whose value is encoded according to <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
---
> This specification defines an IPADDR-ID of a certificate as being the subjectAltName entry of type iPAddress whose value is encoded according to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.4.1-6" class="pilcrow">¶</a></p>
2738c2756
< All end-entity certificates used by a TCPCL entity <span class="bcp14">SHALL</span> conform to <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>, or any updates or successors to that profile.
---
> All end-entity certificates used by a TCPCL entity <span class="bcp14">SHALL</span> conform to <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, or any updates or successors to that profile.
2746c2764
< Identity information in end-entity certificates is contained entirely in the subjectAltName extension as defined in <a href="#sec-tls-identification" class="xref">Section 4.4.1</a> and discussed in the paragraphs below.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
---
> Identity information in end-entity certificates is contained entirely in the subjectAltName extension as defined in <a href="#sec-tls-identification" class="auto internal xref">Section 4.4.1</a> and discussed in the paragraphs below.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
2748c2766
< All end-entity and CA certificates used for the TCPCL <span class="bcp14">SHOULD</span> contain both a subject key identifier and an authority key identifier extension in accordance with <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>.
---
> All end-entity and CA certificates used for the TCPCL <span class="bcp14">SHOULD</span> contain both a subject key identifier and an authority key identifier extension in accordance with <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
2755,2756c2773,2774
< When allowed by CA policy, a Bundle Protocol Security (BPSec; see <span>[<a href="#RFC9172" class="xref">RFC9172</a>]</span>) end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX Extended Key Usage (EKU) extension in accordance with <span><a href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12" class="relref">Section 4.2.1.12</a> of [<a href="#RFC5280" class="xref">RFC5280</a>]</span>.
< When the PKIX EKU extension is present, it <span class="bcp14">SHOULD</span> contain the key purpose <code>id-kp-bundleSecurity</code> (see <a href="#sec-pkix-oids" class="xref">Section 4.4.2.1</a>). 
---
> When allowed by CA policy, a Bundle Protocol Security (BPSec; see <span>[<a href="#RFC9172" class="cite xref">RFC9172</a>]</span>) end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX Extended Key Usage (EKU) extension in accordance with <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.12" class="relref">Section 4.2.1.12</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
> When the PKIX EKU extension is present, it <span class="bcp14">SHOULD</span> contain the key purpose <code>id-kp-bundleSecurity</code> (see <a href="#sec-pkix-oids" class="auto internal xref">Section 4.4.2.1</a>). 
2760c2778
< When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX key usage extension in accordance with <span><a href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3" class="relref">Section 4.2.1.3</a> of [<a href="#RFC5280" class="xref">RFC5280</a>]</span>.
---
> When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain a PKIX key usage extension in accordance with <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.3" class="relref">Section 4.2.1.3</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.
2765c2783
< When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain an Online Certificate Status Protocol (OCSP) URI within an authority information access extension in accordance with <span><a href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.2.1" class="relref">Section 4.2.2.1</a> of [<a href="#RFC5280" class="xref">RFC5280</a>]</span>.<a href="#section-4.4.2-8" class="pilcrow">¶</a></p>
---
> When allowed by CA policy, a TCPCL end-entity certificate <span class="bcp14">SHOULD</span> contain an Online Certificate Status Protocol (OCSP) URI within an authority information access extension in accordance with <span><a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.2.1" class="relref">Section 4.2.2.1</a> of [<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>.<a href="#section-4.4.2-8" class="pilcrow">¶</a></p>
2772,2774c2790,2792
< This document defines a PKIX Other Name Form identifier, <code>id-on-bundleEID</code>, in <a href="#sec-asn1-mod" class="xref">Appendix B</a>; this identifier can be used as the <code>type-id</code> in a subjectAltName entry of type otherName.
< The <code>BundleEID</code> value associated with the otherName type-id <code>id-on-bundleEID</code> <span class="bcp14">SHALL</span> be a URI, encoded as an IA5String, with a scheme that is present in the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>.
< Although this Other Name Form allows any endpoint ID to be present, the NODE-ID defined in <a href="#sec-tls-identification" class="xref">Section 4.4.1</a> limits its use to contain only a node ID.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
---
> This document defines a PKIX Other Name Form identifier, <code>id-on-bundleEID</code>, in <a href="#sec-asn1-mod" class="auto internal xref">Appendix B</a>; this identifier can be used as the <code>type-id</code> in a subjectAltName entry of type otherName.
> The <code>BundleEID</code> value associated with the otherName type-id <code>id-on-bundleEID</code> <span class="bcp14">SHALL</span> be a URI, encoded as an IA5String, with a scheme that is present in the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>.
> Although this Other Name Form allows any endpoint ID to be present, the NODE-ID defined in <a href="#sec-tls-identification" class="auto internal xref">Section 4.4.1</a> limits its use to contain only a node ID.<a href="#section-4.4.2.1-1" class="pilcrow">¶</a></p>
2776c2794
< This document defines a PKIX EKU key purpose, <code>id-kp-bundleSecurity</code>, in <a href="#sec-asn1-mod" class="xref">Appendix B</a>; this purpose  can be used to restrict a certificate's use.
---
> This document defines a PKIX EKU key purpose, <code>id-kp-bundleSecurity</code>, in <a href="#sec-asn1-mod" class="auto internal xref">Appendix B</a>; this purpose  can be used to restrict a certificate's use.
2788,2789c2806,2807
< The use of TLS is negotiated via the Contact Header, as described in <a href="#sec-contact-negotiate" class="xref">Section 4.3</a>.
< After negotiating an Enable TLS parameter of "true", and before any other TCPCL messages are sent within the session, the session entities <span class="bcp14">SHALL</span> begin a TLS handshake in accordance with <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>.
---
> The use of TLS is negotiated via the Contact Header, as described in <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a>.
> After negotiating an Enable TLS parameter of "true", and before any other TCPCL messages are sent within the session, the session entities <span class="bcp14">SHALL</span> begin a TLS handshake in accordance with <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.
2793c2811
< Specifics regarding exposure of sensitive data are discussed in <a href="#sec-security" class="xref">Section 7</a>.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
---
> Specifics regarding exposure of sensitive data are discussed in <a href="#sec-security" class="auto internal xref">Section 7</a>.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
2795c2813
< The parameters within each TLS negotiation are implementation dependent but any TCPCL entity <span class="bcp14">SHALL</span> follow all recommended practices specified in <span><a href="#RFC7525" class="xref">BCP 195</a> [<a href="#RFC7525" class="xref">RFC7525</a>]</span>, or any updates or successors that become part of BCP 195.
---
> The parameters within each TLS negotiation are implementation dependent but any TCPCL entity <span class="bcp14">SHALL</span> follow all recommended practices specified in <span><a href="#RFC7525" class="internal xref">BCP 195</a> [<a href="#RFC7525" class="cite xref">RFC7525</a>]</span>, or any updates or successors that become part of BCP 195.
2801c2819
< When a resolved DNS name was used to establish the TCP connection, the TLS ClientHello <span class="bcp14">SHOULD</span> include a "server_name" extension in accordance with <span>[<a href="#RFC6066" class="xref">RFC6066</a>]</span>.
---
> When a resolved DNS name was used to establish the TCP connection, the TLS ClientHello <span class="bcp14">SHOULD</span> include a "server_name" extension in accordance with <span>[<a href="#RFC6066" class="cite xref">RFC6066</a>]</span>.
2812c2830
< The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a href="#sec-tcpcl-cert-profile" class="xref">Section 4.4.2</a>.
---
> The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a href="#sec-tcpcl-cert-profile" class="auto internal xref">Section 4.4.2</a>.
2824c2842
< The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a href="#sec-tcpcl-cert-profile" class="xref">Section 4.4.2</a>.<a href="#section-4.4.3-4.8" class="pilcrow">¶</a>
---
> The supplied end-entity certificate <span class="bcp14">SHALL</span> conform to the profile described in <a href="#sec-tcpcl-cert-profile" class="auto internal xref">Section 4.4.2</a>.<a href="#section-4.4.3-4.8" class="pilcrow">¶</a>
2855c2873
< The result of validating a peer identity (see <a href="#sec-tls-identification" class="xref">Section 4.4.1</a>) against one or more types of certificate claims is one of the following:<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
---
> The result of validating a peer identity (see <a href="#sec-tls-identification" class="auto internal xref">Section 4.4.1</a>) against one or more types of certificate claims is one of the following:<a href="#section-4.4.4-3" class="pilcrow">¶</a></p>
2879,2880c2897,2898
< For any peer end-entity certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> perform the certification path validation described in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> up to one of the entity's trusted CA certificates.
< If enabled by local policy, the entity <span class="bcp14">SHALL</span> perform an OCSP check of each certificate providing OCSP authority information in accordance with <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span>.
---
> For any peer end-entity certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> perform the certification path validation described in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> up to one of the entity's trusted CA certificates.
> If enabled by local policy, the entity <span class="bcp14">SHALL</span> perform an OCSP check of each certificate providing OCSP authority information in accordance with <span>[<a href="#RFC6960" class="cite xref">RFC6960</a>]</span>.
2882c2900
< Leaving out part of the certification chain can cause the entity to fail to validate a certificate if the certificates that were left out are unknown to the entity (see <a href="#sec-threat-untrust-cert" class="xref">Section 7.6</a>).<a href="#section-4.4.4.1-1" class="pilcrow">¶</a></p>
---
> Leaving out part of the certification chain can cause the entity to fail to validate a certificate if the certificates that were left out are unknown to the entity (see <a href="#sec-threat-untrust-cert" class="auto internal xref">Section 7.6</a>).<a href="#section-4.4.4.1-1" class="pilcrow">¶</a></p>
2884c2902
< For the end-entity peer certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> apply security policy to the key usage extension (if present) and EKU extension (if present) in accordance with Sections <a href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.12" class="relref">4.2.1.12</a> and <a href="https://www.rfc-editor.org/rfc/rfc5280#section-4.2.1.3" class="relref">4.2.1.3</a> of <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span>, respectively, and with the profile discussed in <a href="#sec-tcpcl-cert-profile" class="xref">Section 4.4.2</a> of this document.<a href="#section-4.4.4.1-2" class="pilcrow">¶</a></p>
---
> For the end-entity peer certificate received during the TLS handshake, the entity <span class="bcp14">SHALL</span> apply security policy to the key usage extension (if present) and EKU extension (if present) in accordance with Sections <a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.12" class="relref">4.2.1.12</a> and <a href="https://rfc-editor.org/rfc/rfc5280#section-4.2.1.3" class="relref">4.2.1.3</a> of <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>, respectively, and with the profile discussed in <a href="#sec-tcpcl-cert-profile" class="auto internal xref">Section 4.4.2</a> of this document.<a href="#section-4.4.4.1-2" class="pilcrow">¶</a></p>
2893c2911
< Either during or immediately after the TLS handshake, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the following certificate identifiers together in accordance with <span><a href="https://www.rfc-editor.org/rfc/rfc6125#section-6" class="relref">Section 6</a> of [<a href="#RFC6125" class="xref">RFC6125</a>]</span>:<a href="#section-4.4.4.2-1" class="pilcrow">¶</a></p>
---
> Either during or immediately after the TLS handshake, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the following certificate identifiers together in accordance with <span><a href="https://rfc-editor.org/rfc/rfc6125#section-6" class="relref">Section 6</a> of [<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>:<a href="#section-4.4.4.2-1" class="pilcrow">¶</a></p>
2912c2930
< Immediately before session parameter negotiation, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the certificate NODE-ID in accordance with <span><a href="https://www.rfc-editor.org/rfc/rfc6125#section-6" class="relref">Section 6</a> of [<a href="#RFC6125" class="xref">RFC6125</a>]</span> using the node ID of the peer's SESS_INIT message as the NODE-ID reference identifier.
---
> Immediately before session parameter negotiation, each entity, if required by security policy, <span class="bcp14">SHALL</span> validate the certificate NODE-ID in accordance with <span><a href="https://rfc-editor.org/rfc/rfc6125#section-6" class="relref">Section 6</a> of [<a href="#RFC6125" class="cite xref">RFC6125</a>]</span> using the node ID of the peer's SESS_INIT message as the NODE-ID reference identifier.
2928c2946
<             <li class="normal" id="section-4.4.5-2.2">instructing that, if an EKU extension is present, the extension needs to contain <code>id-kp-bundleSecurity</code> (<a href="#sec-pkix-oids" class="xref">Section 4.4.2.1</a>) to be usable with TCPCL security.<a href="#section-4.4.5-2.2" class="pilcrow">¶</a>
---
>             <li class="normal" id="section-4.4.5-2.2">instructing that, if an EKU extension is present, the extension needs to contain <code>id-kp-bundleSecurity</code> (<a href="#sec-pkix-oids" class="auto internal xref">Section 4.4.2.1</a>) to be usable with TCPCL security.<a href="#section-4.4.5-2.2" class="pilcrow">¶</a>
2930c2948
<             <li class="normal" id="section-4.4.5-2.3">requiring a validated node ID (<a href="#sec-tls-auth-valid-nodeid" class="xref">Section 4.4.4.3</a>) and  ignoring any network-level identifier (<a href="#sec-tls-auth-valid-netid" class="xref">Section 4.4.4.2</a>).<a href="#section-4.4.5-2.3" class="pilcrow">¶</a>
---
>             <li class="normal" id="section-4.4.5-2.3">requiring a validated node ID (<a href="#sec-tls-auth-valid-nodeid" class="auto internal xref">Section 4.4.4.3</a>) and  ignoring any network-level identifier (<a href="#sec-tls-auth-valid-netid" class="auto internal xref">Section 4.4.4.2</a>).<a href="#section-4.4.5-2.3" class="pilcrow">¶</a>
2934,2935c2952,2953
< This policy relies on and informs the certificate requirements provided in <a href="#sec-tls-handshake" class="xref">Section 4.4.3</a>.
< This policy assumes that a DTN-aware CA (see <a href="#sec-pkix-env" class="xref">Section 3.4</a>) will only issue a certificate for a node ID when it has verified that the private key holder actually controls the bundle node; this is needed to avoid the threat identified in <a href="#sec-threat-node-impersonation" class="xref">Section 7.9</a>.
---
> This policy relies on and informs the certificate requirements provided in <a href="#sec-tls-handshake" class="auto internal xref">Section 4.4.3</a>.
> This policy assumes that a DTN-aware CA (see <a href="#sec-pkix-env" class="auto internal xref">Section 3.4</a>) will only issue a certificate for a node ID when it has verified that the private key holder actually controls the bundle node; this is needed to avoid the threat identified in <a href="#sec-threat-node-impersonation" class="auto internal xref">Section 7.9</a>.
2945c2963
< A summary of a typical TLS initiation is shown in the sequence in <a href="#fig-tls-example" class="xref">Figure 17</a> below.
---
> A summary of a typical TLS initiation is shown in the sequence in <a href="#fig-tls-example" class="auto internal xref">Figure 17</a> below.
3023,3024c3041,3042
<           <dd style="margin-left: 1.5em" id="section-4.5-4.2">Indicates the type of the message as per <a href="#tab-msg-types" class="xref">Table 2</a> below.
< Encoded values are listed in <a href="#sec-iana-message-types" class="xref">Section 8.5</a>.<a href="#section-4.5-4.2" class="pilcrow">¶</a>
---
>           <dd style="margin-left: 1.5em" id="section-4.5-4.2">Indicates the type of the message as per <a href="#tab-msg-types" class="auto internal xref">Table 2</a> below.
> Encoded values are listed in <a href="#sec-iana-message-types" class="auto internal xref">Section 8.5</a>.<a href="#section-4.5-4.2" class="pilcrow">¶</a>
3046c3064
< Contains the session parameter inputs from one of the entities, as described in <a href="#sec-SESS_INIT" class="xref">Section 4.6</a>.
---
> Contains the session parameter inputs from one of the entities, as described in <a href="#sec-SESS_INIT" class="auto internal xref">Section 4.6</a>.
3053c3071
< Indicates that one of the entities participating in the session wishes to cleanly terminate the session, as described in <a href="#sec-SESS_TERM" class="xref">Section 6.1</a>.
---
> Indicates that one of the entities participating in the session wishes to cleanly terminate the session, as described in <a href="#sec-SESS_TERM" class="auto internal xref">Section 6.1</a>.
3060c3078
< Indicates the transmission of a segment of bundle data, as described in <a href="#sec-XFER_SEGMENT" class="xref">Section 5.2.2</a>.
---
> Indicates the transmission of a segment of bundle data, as described in <a href="#sec-XFER_SEGMENT" class="auto internal xref">Section 5.2.2</a>.
3067c3085
< Acknowledges reception of a data segment, as described in <a href="#sec-XFER_ACK" class="xref">Section 5.2.3</a>.
---
> Acknowledges reception of a data segment, as described in <a href="#sec-XFER_ACK" class="auto internal xref">Section 5.2.3</a>.
3074c3092
< Indicates that the transmission of the current bundle <span class="bcp14">SHALL</span> be stopped, as described in <a href="#sec-XFER_REFUSE" class="xref">Section 5.2.4</a>.
---
> Indicates that the transmission of the current bundle <span class="bcp14">SHALL</span> be stopped, as described in <a href="#sec-XFER_REFUSE" class="auto internal xref">Section 5.2.4</a>.
3081c3099
< Used to keep the TCPCL session active, as described in <a href="#sec-KEEPALIVE" class="xref">Section 5.1.1</a>.
---
> Used to keep the TCPCL session active, as described in <a href="#sec-KEEPALIVE" class="auto internal xref">Section 5.1.1</a>.
3088c3106
< Contains a TCPCL message rejection, as described in <a href="#sec-MSG_REJECT" class="xref">Section 5.1.2</a>.
---
> Contains a TCPCL message rejection, as described in <a href="#sec-MSG_REJECT" class="auto internal xref">Section 5.1.2</a>.
3103c3121
< The SESS_INIT message is used to convey the per-entity parameters, which are used together to negotiate the per-session parameters as described in <a href="#sec-session-negotiate" class="xref">Section 4.7</a>.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
---
> The SESS_INIT message is used to convey the per-entity parameters, which are used together to negotiate the per-session parameters as described in <a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
3105c3123
< The format of a SESS_INIT message is shown in <a href="#fig-msg-SESS_INIT-fields" class="xref">Figure 19</a>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
---
> The format of a SESS_INIT message is shown in <a href="#fig-msg-SESS_INIT-fields" class="auto internal xref">Figure 19</a>.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
3140c3158
< A 16-bit unsigned integer indicating the minimum interval, in seconds, to negotiate as the Session Keepalive using the method described in <a href="#sec-session-negotiate" class="xref">Section 4.7</a>.<a href="#section-4.6-5.2" class="pilcrow">¶</a>
---
> A 16-bit unsigned integer indicating the minimum interval, in seconds, to negotiate as the Session Keepalive using the method described in <a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>.<a href="#section-4.6-5.2" class="pilcrow">¶</a>
3165,3166c3183,3184
< Every node ID <span class="bcp14">SHALL</span> be a URI consistent with the requirements in <span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> and the URI schemes of the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>.
< The node ID itself can be authenticated as described in <a href="#sec-tls-authentication" class="xref">Section 4.4.4</a>.<a href="#section-4.6-5.8" class="pilcrow">¶</a>
---
> Every node ID <span class="bcp14">SHALL</span> be a URI consistent with the requirements in <span>[<a href="#RFC3986" class="cite xref">RFC3986</a>]</span> and the URI schemes of the IANA "Bundle Protocol URI Scheme Types" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>.
> The node ID itself can be authenticated as described in <a href="#sec-tls-authentication" class="auto internal xref">Section 4.4.4</a>.<a href="#section-4.6-5.8" class="pilcrow">¶</a>
3171c3189
< The Session Extension Items Length is the total number of octets to follow that are used to encode the Session Extension Items list. The encoding of each Session Extension Item is within a consistent data container as described in <a href="#sec-session-extension" class="xref">Section 4.8</a>.
---
> The Session Extension Items Length is the total number of octets to follow that are used to encode the Session Extension Items list. The encoding of each Session Extension Item is within a consistent data container as described in <a href="#sec-session-extension" class="auto internal xref">Section 4.8</a>.
3179,3180c3197,3198
< If an entity receives a peer node ID that is not authenticated (by the procedure described in <a href="#sec-tls-auth-valid-nodeid" class="xref">Section 4.4.4.3</a>), that node ID <span class="bcp14">SHOULD NOT</span> be used by a BPA for any discovery or routing functions.
< Trusting an unauthenticated node ID can lead to the threat described in <a href="#sec-threat-node-impersonation" class="xref">Section 7.9</a>.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
---
> If an entity receives a peer node ID that is not authenticated (by the procedure described in <a href="#sec-tls-auth-valid-nodeid" class="auto internal xref">Section 4.4.4.3</a>), that node ID <span class="bcp14">SHOULD NOT</span> be used by a BPA for any discovery or routing functions.
> Trusting an unauthenticated node ID can lead to the threat described in <a href="#sec-threat-node-impersonation" class="auto internal xref">Section 7.9</a>.<a href="#section-4.6-6" class="pilcrow">¶</a></p>
3207c3225
< The Session Keepalive Interval is a parameter for the behavior described in <a href="#sec-KEEPALIVE" class="xref">Section 5.1.1</a>.
---
> The Session Keepalive Interval is a parameter for the behavior described in <a href="#sec-KEEPALIVE" class="auto internal xref">Section 5.1.1</a>.
3226c3244
< Each of the Session Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a href="#fig-session-extension" class="xref">Figure 20</a>.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
---
> Each of the Session Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a href="#fig-session-extension" class="auto internal xref">Figure 20</a>.<a href="#section-4.8-1" class="pilcrow">¶</a></p>
3232c3250
< A one-octet field containing generic bit flags related to the Item, which are listed in <a href="#tab-session-extension-flags" class="xref">Table 3</a>.
---
> A one-octet field containing generic bit flags related to the Item, which are listed in <a href="#tab-session-extension-flags" class="auto internal xref">Table 3</a>.
3242c3260
< This specification does not define any extension types directly but does create an IANA registry for such codes (see <a href="#sec-iana-session-extension-type" class="xref">Section 8.3</a>).<a href="#section-4.8-3.4" class="pilcrow">¶</a>
---
> This specification does not define any extension types directly but does create an IANA registry for such codes (see <a href="#sec-iana-session-extension-type" class="auto internal xref">Section 8.3</a>).<a href="#section-4.8-3.4" class="pilcrow">¶</a>
3328c3346
< As described in <a href="#sec-session-negotiate" class="xref">Section 4.7</a>, a negotiated parameter of each session is the Session Keepalive Interval. If the negotiated Session Keepalive is zero (i.e., one or both SESS_INIT messages contain a zero Keepalive Interval), then the keepalive feature is disabled.
---
> As described in <a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>, a negotiated parameter of each session is the Session Keepalive Interval. If the negotiated Session Keepalive is zero (i.e., one or both SESS_INIT messages contain a zero Keepalive Interval), then the keepalive feature is disabled.
3337c3355
< The format of a KEEPALIVE message is a one-octet Message Type code of KEEPALIVE (as described in <a href="#tab-msg-types" class="xref">Table 2</a>) with no additional data.
---
> The format of a KEEPALIVE message is a one-octet Message Type code of KEEPALIVE (as described in <a href="#tab-msg-types" class="auto internal xref">Table 2</a>) with no additional data.
3340c3358
< If no message (KEEPALIVE or other) has been received in a session after some implementation-defined time duration, then the entity <span class="bcp14">SHALL</span> terminate the session by transmitting a SESS_TERM message (as described in <a href="#sec-SESS_TERM" class="xref">Section 6.1</a>) with a reason code of "Idle timeout".
---
> If no message (KEEPALIVE or other) has been received in a session after some implementation-defined time duration, then the entity <span class="bcp14">SHALL</span> terminate the session by transmitting a SESS_TERM message (as described in <a href="#sec-SESS_TERM" class="auto internal xref">Section 6.1</a>) with a reason code of "Idle timeout".
3358c3376
< The format of a MSG_REJECT message is shown in <a href="#fig-MSG_REJECT-fields" class="xref">Figure 21</a>.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
---
> The format of a MSG_REJECT message is shown in <a href="#fig-MSG_REJECT-fields" class="auto internal xref">Figure 21</a>.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
3381c3399
< A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-MSG_REJECT-reasons" class="xref">Table 4</a>.<a href="#section-5.1.2-6.2" class="pilcrow">¶</a>
---
> A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-MSG_REJECT-reasons" class="auto internal xref">Table 4</a>.<a href="#section-5.1.2-6.2" class="pilcrow">¶</a>
3435c3453
< In the TCPCL, a transfer is accomplished by dividing a single bundle up into "segments" based on the receiving-side Segment MRU, which is defined in <a href="#sec-SESS_INIT" class="xref">Section 4.6</a>.
---
> In the TCPCL, a transfer is accomplished by dividing a single bundle up into "segments" based on the receiving-side Segment MRU, which is defined in <a href="#sec-SESS_INIT" class="auto internal xref">Section 4.6</a>.
3459c3477
< Although there is not a strict requirement for initial Transfer ID values or the ordering of Transfer IDs (see <a href="#sec-security-xferid" class="xref">Section 7.13</a>), in the absence of any other mechanism for generating Transfer IDs, an entity <span class="bcp14">SHALL</span> use the following algorithm: the initial Transfer ID from each entity is zero, and subsequent Transfer ID values are incremented from the prior Transfer ID value by one.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
---
> Although there is not a strict requirement for initial Transfer ID values or the ordering of Transfer IDs (see <a href="#sec-security-xferid" class="auto internal xref">Section 7.13</a>), in the absence of any other mechanism for generating Transfer IDs, an entity <span class="bcp14">SHALL</span> use the following algorithm: the initial Transfer ID from each entity is zero, and subsequent Transfer ID values are incremented from the prior Transfer ID value by one.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
3469c3487
< The format of a XFER_SEGMENT message is shown in <a href="#fig-XFER_SEGMENT-fields" class="xref">Figure 22</a>.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
---
> The format of a XFER_SEGMENT message is shown in <a href="#fig-XFER_SEGMENT-fields" class="auto internal xref">Figure 22</a>.<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
3504c3522
< A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-XFER_SEGMENT-flags" class="xref">Table 5</a>.
---
> A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-XFER_SEGMENT-flags" class="auto internal xref">Table 5</a>.
3518c3536
< The encoding of each Transfer Extension Item is within a consistent data container, as described in <a href="#sec-transfer-extension" class="xref">Section 5.2.5</a>.
---
> The encoding of each Transfer Extension Item is within a consistent data container, as described in <a href="#sec-transfer-extension" class="auto internal xref">Section 5.2.5</a>.
3572c3590
< The flags portion of the message contains two flag values in the two low-order bits, denoted <code>START</code> and <code>END</code> in <a href="#tab-XFER_SEGMENT-flags" class="xref">Table 5</a>.
---
> The flags portion of the message contains two flag values in the two low-order bits, denoted <code>START</code> and <code>END</code> in <a href="#tab-XFER_SEGMENT-flags" class="auto internal xref">Table 5</a>.
3592c3610
< The format of a XFER_ACK message is shown in <a href="#fig-XFER_ACK-fields" class="xref">Figure 23</a>.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
---
> The format of a XFER_ACK message is shown in <a href="#fig-XFER_ACK-fields" class="auto internal xref">Figure 23</a>.<a href="#section-5.2.3-2" class="pilcrow">¶</a></p>
3617c3635
< A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-XFER_SEGMENT-flags" class="xref">Table 5</a>.
---
> A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-XFER_SEGMENT-flags" class="auto internal xref">Table 5</a>.
3667c3685
< The format of the XFER_REFUSE message is shown in <a href="#fig-msg-XFER_REFUSE" class="xref">Figure 24</a>.<a href="#section-5.2.4-5" class="pilcrow">¶</a></p>
---
> The format of the XFER_REFUSE message is shown in <a href="#fig-msg-XFER_REFUSE" class="auto internal xref">Figure 24</a>.<a href="#section-5.2.4-5" class="pilcrow">¶</a></p>
3690c3708
< A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-XFER_REFUSE-reasons" class="xref">Table 6</a>.<a href="#section-5.2.4-8.2" class="pilcrow">¶</a>
---
> A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-XFER_REFUSE-reasons" class="auto internal xref">Table 6</a>.<a href="#section-5.2.4-8.2" class="pilcrow">¶</a>
3772c3790
< Each of the Transfer Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a href="#fig-transfer-extension" class="xref">Figure 25</a>.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
---
> Each of the Transfer Extension Items <span class="bcp14">SHALL</span> be encoded in an identical Type-Length-Value (TLV) container form as indicated in <a href="#fig-transfer-extension" class="auto internal xref">Figure 25</a>.<a href="#section-5.2.5-1" class="pilcrow">¶</a></p>
3778c3796
< A one-octet field containing generic bit flags related to the Item, which are listed in <a href="#tab-transfer-extension-flags" class="xref">Table 7</a>.
---
> A one-octet field containing generic bit flags related to the Item, which are listed in <a href="#tab-transfer-extension-flags" class="auto internal xref">Table 7</a>.
3788c3806
< This specification creates an IANA registry for such codes (see <a href="#sec-iana-transfer-extension-type" class="xref">Section 8.4</a>).<a href="#section-5.2.5-3.4" class="pilcrow">¶</a>
---
> This specification creates an IANA registry for such codes (see <a href="#sec-iana-transfer-extension-type" class="auto internal xref">Section 8.4</a>).<a href="#section-5.2.5-3.4" class="pilcrow">¶</a>
3860c3878
< The Transfer Length Extension <span class="bcp14">SHALL</span> use the IANA-assigned code point from <a href="#sec-iana-transfer-extension-type" class="xref">Section 8.4</a>.<a href="#section-5.2.5.1-2" class="pilcrow">¶</a></p>
---
> The Transfer Length Extension <span class="bcp14">SHALL</span> use the IANA-assigned code point from <a href="#sec-iana-transfer-extension-type" class="auto internal xref">Section 8.4</a>.<a href="#section-5.2.5.1-2" class="pilcrow">¶</a></p>
3865c3883
< The format of the Transfer Length Extension data is shown in <a href="#fig-Transfer-Length-fields" class="xref">Figure 26</a>.<a href="#section-5.2.5.1-4" class="pilcrow">¶</a></p>
---
> The format of the Transfer Length Extension data is shown in <a href="#fig-Transfer-Length-fields" class="auto internal xref">Figure 26</a>.<a href="#section-5.2.5.1-4" class="pilcrow">¶</a></p>
3936c3954
< If the underlying TCP connection is closed during a transmission (in either transfer stream), the transfer <span class="bcp14">SHALL</span> be indicated to the BPA as failed (see the transmission failure and reception failure indications defined in <a href="#sec-cl-services" class="xref">Section 3.1</a>).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
---
> If the underlying TCP connection is closed during a transmission (in either transfer stream), the transfer <span class="bcp14">SHALL</span> be indicated to the BPA as failed (see the transmission failure and reception failure indications defined in <a href="#sec-cl-services" class="auto internal xref">Section 3.1</a>).<a href="#section-6.1-5" class="pilcrow">¶</a></p>
3941c3959
< The format of the SESS_TERM message is shown in <a href="#fig-msg-SESS_TERM-fields" class="xref">Figure 27</a>.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
---
> The format of the SESS_TERM message is shown in <a href="#fig-msg-SESS_TERM-fields" class="auto internal xref">Figure 27</a>.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
3964c3982
< A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-SESS_TERM-flags" class="xref">Table 8</a>.
---
> A one-octet field of single-bit flags, interpreted according to the descriptions in <a href="#tab-SESS_TERM-flags" class="auto internal xref">Table 8</a>.
3971c3989
< A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-SESS_TERM-reasons" class="xref">Table 9</a>.<a href="#section-6.1-10.4" class="pilcrow">¶</a>
---
> A one-octet refusal reason code interpreted according to the descriptions in <a href="#tab-SESS_TERM-reasons" class="auto internal xref">Table 9</a>.<a href="#section-6.1-10.4" class="pilcrow">¶</a>
4056c4074
< Termination of the TCP connection <span class="bcp14">MAY</span> occur prior to receiving the Contact Header as discussed in <a href="#sec-tcp-connection" class="xref">Section 4.1</a>.
---
> Termination of the TCP connection <span class="bcp14">MAY</span> occur prior to receiving the Contact Header as discussed in <a href="#sec-tcp-connection" class="auto internal xref">Section 4.1</a>.
4073c4091
< If there is a configured time to terminate idle sessions and if no TCPCL messages (other than KEEPALIVE messages) have been received for at least that amount of time, then either entity <span class="bcp14">MAY</span> terminate the session by transmitting a SESS_TERM message with a reason code of "Idle timeout" (as described in <a href="#tab-SESS_TERM-reasons" class="xref">Table 9</a>).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
---
> If there is a configured time to terminate idle sessions and if no TCPCL messages (other than KEEPALIVE messages) have been received for at least that amount of time, then either entity <span class="bcp14">MAY</span> terminate the session by transmitting a SESS_TERM message with a reason code of "Idle timeout" (as described in <a href="#tab-SESS_TERM-reasons" class="auto internal xref">Table 9</a>).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
4084c4102
< This section separates security considerations into threat categories based on guidance provided in <span><a href="#RFC3552" class="xref">BCP 72</a> [<a href="#RFC3552" class="xref">RFC3552</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
---
> This section separates security considerations into threat categories based on guidance provided in <span><a href="#RFC3552" class="internal xref">BCP 72</a> [<a href="#RFC3552" class="cite xref">RFC3552</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
4092c4110
< This can be avoided by always using TLS, even if authentication is not available (see <a href="#sec-security-tlsalt" class="xref">Section 7.12</a>).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
---
> This can be avoided by always using TLS, even if authentication is not available (see <a href="#sec-security-tlsalt" class="auto internal xref">Section 7.12</a>).<a href="#section-7.1-1" class="pilcrow">¶</a></p>
4100c4118
< The bundle security mechanisms defined in <span>[<a href="#RFC9172" class="xref">RFC9172</a>]</span> are to be used instead.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
---
> The bundle security mechanisms defined in <span>[<a href="#RFC9172" class="cite xref">RFC9172</a>]</span> are to be used instead.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
4103c4121
< This can be avoided by always using TLS, even if authentication is not available (see <a href="#sec-security-tlsalt" class="xref">Section 7.12</a>).<a href="#section-7.2-2" class="pilcrow">¶</a></p>
---
> This can be avoided by always using TLS, even if authentication is not available (see <a href="#sec-security-tlsalt" class="auto internal xref">Section 7.12</a>).<a href="#section-7.2-2" class="pilcrow">¶</a></p>
4122,4123c4140,4141
< It is possible for an on-path attacker to set the <code>CAN_TLS</code> flag to 0 on either side of the Contact Header exchange, which will cause the negotiation discussed in <a href="#sec-contact-negotiate" class="xref">Section 4.3</a> to disable TLS.
< This leads to the "SSL Stripping" attack described in <span>[<a href="#RFC7457" class="xref">RFC7457</a>]</span>.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
---
> It is possible for an on-path attacker to set the <code>CAN_TLS</code> flag to 0 on either side of the Contact Header exchange, which will cause the negotiation discussed in <a href="#sec-contact-negotiate" class="auto internal xref">Section 4.3</a> to disable TLS.
> This leads to the "SSL Stripping" attack described in <span>[<a href="#RFC7457" class="cite xref">RFC7457</a>]</span>.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
4129c4147
< One mechanism to mitigate the possibility of TLS Stripping is the use of DNS-based Authentication of Named Entities (DANE) <span>[<a href="#RFC6698" class="xref">RFC6698</a>]</span> toward the passive peer.
---
> One mechanism to mitigate the possibility of TLS Stripping is the use of DNS-based Authentication of Named Entities (DANE) <span>[<a href="#RFC6698" class="cite xref">RFC6698</a>]</span> toward the passive peer.
4133c4151
< The negotiated use of TLS is identical in behavior to the use of STARTTLS as described in <span>[<a href="#RFC2595" class="xref">RFC2595</a>]</span>, <span>[<a href="#RFC4511" class="xref">RFC4511</a>]</span>, and others.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
---
> The negotiated use of TLS is identical in behavior to the use of STARTTLS as described in <span>[<a href="#RFC2595" class="cite xref">RFC2595</a>]</span>, <span>[<a href="#RFC4511" class="cite xref">RFC4511</a>]</span>, and others.<a href="#section-7.4-4" class="pilcrow">¶</a></p>
4142c4160
< Recommendations for using cipher suites are included in <span><a href="#RFC7525" class="xref">BCP 195</a> [<a href="#RFC7525" class="xref">RFC7525</a>]</span>.
---
> Recommendations for using cipher suites are included in <span><a href="#RFC7525" class="internal xref">BCP 195</a> [<a href="#RFC7525" class="cite xref">RFC7525</a>]</span>.
4151c4169
< The authentication method discussed in <a href="#sec-tls-authentication" class="xref">Section 4.4.4</a> uses end-entity certificates chained to a trusted root CA. During a TLS handshake, either entity can send a certificate set that does not contain the full chain, possibly excluding intermediate or root CAs.
---
> The authentication method discussed in <a href="#sec-tls-authentication" class="auto internal xref">Section 4.4.4</a> uses end-entity certificates chained to a trusted root CA. During a TLS handshake, either entity can send a certificate set that does not contain the full chain, possibly excluding intermediate or root CAs.
4163,4164c4181,4182
< There are many reasons, as described in <span>[<a href="#RFC5280" class="xref">RFC5280</a>]</span> and <span>[<a href="#RFC6125" class="xref">RFC6125</a>]</span>, why a certificate can fail to validate, including using the certificate outside of its valid time interval, using purposes for which it was not authorized, or using it after it has been revoked by its CA.
< Validating a certificate is a complex task and can require network connectivity outside of the primary TCPCL network path(s) if a mechanism such as OCSP <span>[<a href="#RFC6960" class="xref">RFC6960</a>]</span> is used by the CA.
---
> There are many reasons, as described in <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span> and <span>[<a href="#RFC6125" class="cite xref">RFC6125</a>]</span>, why a certificate can fail to validate, including using the certificate outside of its valid time interval, using purposes for which it was not authorized, or using it after it has been revoked by its CA.
> Validating a certificate is a complex task and can require network connectivity outside of the primary TCPCL network path(s) if a mechanism such as OCSP <span>[<a href="#RFC6960" class="cite xref">RFC6960</a>]</span> is used by the CA.
4171,4172c4189,4190
< <p id="section-7.8-1">Even with a secure block cipher and securely established session keys, there are limits to the amount of plaintext that can be safely encrypted with a given set of keys, as described in <span>[<a href="#AEAD-LIMITS" class="xref">AEAD-LIMITS</a>]</span>.
< When permitted by the negotiated TLS version (see <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>), it is advisable to take advantage of session key updates to avoid those limits.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
---
> <p id="section-7.8-1">Even with a secure block cipher and securely established session keys, there are limits to the amount of plaintext that can be safely encrypted with a given set of keys, as described in <span>[<a href="#AEAD-LIMITS" class="cite xref">AEAD-LIMITS</a>]</span>.
> When permitted by the negotiated TLS version (see <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>), it is advisable to take advantage of session key updates to avoid those limits.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
4180,4181c4198,4199
< The certificates exchanged by TLS enable authentication of the peer DNS name and node ID, but it is possible that either a peer does not provide a valid certificate or the certificate does not validate either the DNS-ID/IPADDR-ID or NODE-ID of the peer (see <a href="#sec-pkix-env" class="xref">Section 3.4</a>).
< Having a CA-validated certificate does not alone guarantee the identity of the network host or BP node from which the certificate is provided; additional validation procedures as provided in <a href="#sec-tls-authentication" class="xref">Section 4.4.4</a> bind the DNS-ID/IPADDR-ID or NODE-ID based on the contents of the certificate.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
---
> The certificates exchanged by TLS enable authentication of the peer DNS name and node ID, but it is possible that either a peer does not provide a valid certificate or the certificate does not validate either the DNS-ID/IPADDR-ID or NODE-ID of the peer (see <a href="#sec-pkix-env" class="auto internal xref">Section 3.4</a>).
> Having a CA-validated certificate does not alone guarantee the identity of the network host or BP node from which the certificate is provided; additional validation procedures as provided in <a href="#sec-tls-authentication" class="auto internal xref">Section 4.4.4</a> bind the DNS-ID/IPADDR-ID or NODE-ID based on the contents of the certificate.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
4190c4208
< One mitigation regarding arbitrary entities with valid PKIX certificates impersonating arbitrary node IDs is the use of the PKIX EKU key purpose <code>id-kp-bundleSecurity</code> (<a href="#sec-pkix-oids" class="xref">Section 4.4.2.1</a>).
---
> One mitigation regarding arbitrary entities with valid PKIX certificates impersonating arbitrary node IDs is the use of the PKIX EKU key purpose <code>id-kp-bundleSecurity</code> (<a href="#sec-pkix-oids" class="auto internal xref">Section 4.4.2.1</a>).
4210c4228
< The victim entity can terminate the session during parameter negotiation (<a href="#sec-session-negotiate" class="xref">Section 4.7</a>) if the MRUs are unacceptable.<a href="#section-7.10-4" class="pilcrow">¶</a></p>
---
> The victim entity can terminate the session during parameter negotiation (<a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>) if the MRUs are unacceptable.<a href="#section-7.10-4" class="pilcrow">¶</a></p>
4214c4232
< The victim entity can terminate the session during parameter negotiation (<a href="#sec-session-negotiate" class="xref">Section 4.7</a>) if the Keepalive Interval is unacceptable.<a href="#section-7.10-5" class="pilcrow">¶</a></p>
---
> The victim entity can terminate the session during parameter negotiation (<a href="#sec-session-negotiate" class="auto internal xref">Section 4.7</a>) if the Keepalive Interval is unacceptable.<a href="#section-7.10-5" class="pilcrow">¶</a></p>
4225,4226c4243,4244
< The policy recommendations in Sections <a href="#sec-contact-header" class="xref">4.2</a> and <a href="#sec-contact-negotiate" class="xref">4.3</a> both enable TLS and require TLS, but entities are permitted to disable and not require TLS based on local configuration. The configuration to enable or require TLS for an entity or a session is outside of the scope of this document.
< The configuration to disable TLS is different from the threat of TLS Stripping as  described in <a href="#sec-threat-tls-strip" class="xref">Section 7.4</a>.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
---
> The policy recommendations in Sections <a href="#sec-contact-header" class="auto internal xref">4.2</a> and <a href="#sec-contact-negotiate" class="auto internal xref">4.3</a> both enable TLS and require TLS, but entities are permitted to disable and not require TLS based on local configuration. The configuration to enable or require TLS for an entity or a session is outside of the scope of this document.
> The configuration to disable TLS is different from the threat of TLS Stripping as  described in <a href="#sec-threat-tls-strip" class="auto internal xref">Section 7.4</a>.<a href="#section-7.11-1" class="pilcrow">¶</a></p>
4244c4262
< Using TLS in a way that does not successfully authenticate some claim of both peer entities of a TCPCL session is outside of the scope of this document but does have  properties similar to the opportunistic security model <span>[<a href="#RFC7435" class="xref">RFC7435</a>]</span>.<a href="#section-7.12.1-1" class="pilcrow">¶</a></p>
---
> Using TLS in a way that does not successfully authenticate some claim of both peer entities of a TCPCL session is outside of the scope of this document but does have  properties similar to the opportunistic security model <span>[<a href="#RFC7435" class="cite xref">RFC7435</a>]</span>.<a href="#section-7.12.1-1" class="pilcrow">¶</a></p>
4253c4271
< In environments where PKI is unavailable, alternate uses of TLS that do not require certificates such as pre-shared key (PSK) authentication <span>[<a href="#RFC5489" class="xref">RFC5489</a>]</span> and the use of raw public keys <span>[<a href="#RFC7250" class="xref">RFC7250</a>]</span> are available and can be used to ensure confidentiality within the TCPCL.
---
> In environments where PKI is unavailable, alternate uses of TLS that do not require certificates such as pre-shared key (PSK) authentication <span>[<a href="#RFC5489" class="cite xref">RFC5489</a>]</span> and the use of raw public keys <span>[<a href="#RFC7250" class="cite xref">RFC7250</a>]</span> are available and can be used to ensure confidentiality within the TCPCL.
4278c4296
< Registration procedures referred to in this section (e.g., the RFC Required policy) are defined in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
---
> Registration procedures referred to in this section (e.g., the RFC Required policy) are defined in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
4287c4305
< Within the "Service Name and Transport Protocol Port Number Registry" <span>[<a href="#IANA-PORTS" class="xref">IANA-PORTS</a>]</span>, TCP port number 4556 had previously been assigned as the default port for the TCPCL; see <span>[<a href="#RFC7242" class="xref">RFC7242</a>]</span>.
---
> Within the "Service Name and Transport Protocol Port Number Registry" <span>[<a href="#IANA-PORTS" class="cite xref">IANA-PORTS</a>]</span>, TCP port number 4556 had previously been assigned as the default port for the TCPCL; see <span>[<a href="#RFC7242" class="cite xref">RFC7242</a>]</span>.
4289,4290c4307,4308
< Each TCPCL entity identifies its TCPCL protocol version in its initial contact (see Sections <a href="#sec-protocol-session" class="xref">3.2</a> and <a href="#sec-iana-protonum" class="xref">8.2</a>), so there is no ambiguity regarding what protocol is being used.
< The related assignments for UDP and DCCP port 4556 (both registered by <span>[<a href="#RFC7122" class="xref">RFC7122</a>]</span>) are unchanged.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
---
> Each TCPCL entity identifies its TCPCL protocol version in its initial contact (see Sections <a href="#sec-protocol-session" class="auto internal xref">3.2</a> and <a href="#sec-iana-protonum" class="auto internal xref">8.2</a>), so there is no ambiguity regarding what protocol is being used.
> The related assignments for UDP and DCCP port 4556 (both registered by <span>[<a href="#RFC7122" class="cite xref">RFC7122</a>]</span>) are unchanged.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
4341c4359
< IANA has registered the following value in the "Bundle Protocol TCP Convergence-Layer Version Numbers" registry <span>[<a href="#RFC7242" class="xref">RFC7242</a>]</span>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
---
> IANA has registered the following value in the "Bundle Protocol TCP Convergence-Layer Version Numbers" registry <span>[<a href="#RFC7242" class="cite xref">RFC7242</a>]</span>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
4370c4388
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Session Extension Types" registry and populated it with the contents of <a href="#tab-iana-session-extension-type" class="xref">Table 12</a>.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Session Extension Types" registry and populated it with the contents of <a href="#tab-iana-session-extension-type" class="auto internal xref">Table 12</a>.
4414c4432
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Transfer Extension Types" registry and populated it with the contents of <a href="#tab-iana-transfer-extension-type" class="xref">Table 13</a>. The registration procedure is Expert Review within the lower range 0x0001-0x7FFF.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Transfer Extension Types" registry and populated it with the contents of <a href="#tab-iana-transfer-extension-type" class="auto internal xref">Table 13</a>. The registration procedure is Expert Review within the lower range 0x0001-0x7FFF.
4462c4480
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Message Types" registry and populated it with the contents of <a href="#tab-iana-message-types" class="xref">Table 14</a>.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 Message Types" registry and populated it with the contents of <a href="#tab-iana-message-types" class="auto internal xref">Table 14</a>.
4537c4555
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 XFER_REFUSE Reason Codes" registry and populated it with the contents of <a href="#tab-iana-XFER_REFUSE-codes" class="xref">Table 15</a>.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 XFER_REFUSE Reason Codes" registry and populated it with the contents of <a href="#tab-iana-XFER_REFUSE-codes" class="auto internal xref">Table 15</a>.
4605c4623
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 SESS_TERM Reason Codes" registry and populated it with the contents of <a href="#tab-iana-SESS_TERM-codes" class="xref">Table 16</a>.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 SESS_TERM Reason Codes" registry and populated it with the contents of <a href="#tab-iana-SESS_TERM-codes" class="auto internal xref">Table 16</a>.
4670c4688
< Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 MSG_REJECT Reason Codes" registry and populated it with the contents of <a href="#tab-iana-MSG_REJECT-codes" class="xref">Table 17</a>.
---
> Under the "Bundle Protocol" registry <span>[<a href="#IANA-BUNDLE" class="cite xref">IANA-BUNDLE</a>]</span>, IANA has created the "Bundle Protocol TCP Convergence-Layer Version 4 MSG_REJECT Reason Codes" registry and populated it with the contents of <a href="#tab-iana-MSG_REJECT-codes" class="auto internal xref">Table 17</a>.
4727c4745
< IANA has registered the following in the "SMI Security for PKIX Module Identifier" registry <span>[<a href="#IANA-SMI" class="xref">IANA-SMI</a>]</span> for identifying the module described in <a href="#sec-asn1-mod" class="xref">Appendix B</a>.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
---
> IANA has registered the following in the "SMI Security for PKIX Module Identifier" registry <span>[<a href="#IANA-SMI" class="cite xref">IANA-SMI</a>]</span> for identifying the module described in <a href="#sec-asn1-mod" class="auto internal xref">Appendix B</a>.<a href="#section-8.9-1" class="pilcrow">¶</a></p>
4758c4776
< IANA has registered the following in the "SMI Security for PKIX Other Name Forms" registry <span>[<a href="#IANA-SMI" class="xref">IANA-SMI</a>]</span> for 
---
> IANA has registered the following in the "SMI Security for PKIX Other Name Forms" registry <span>[<a href="#IANA-SMI" class="cite xref">IANA-SMI</a>]</span> for 
4782c4800
< <p id="section-8.10-3">The formal structure of the associated Other Name Form is provided in <a href="#sec-asn1-mod" class="xref">Appendix B</a>. The use of this OID is defined in Sections <a href="#sec-tls-identification" class="xref">4.4.1</a> and <a href="#sec-tcpcl-cert-profile" class="xref">4.4.2</a>.<a href="#section-8.10-3" class="pilcrow">¶</a></p>
---
> <p id="section-8.10-3">The formal structure of the associated Other Name Form is provided in <a href="#sec-asn1-mod" class="auto internal xref">Appendix B</a>. The use of this OID is defined in Sections <a href="#sec-tls-identification" class="auto internal xref">4.4.1</a> and <a href="#sec-tcpcl-cert-profile" class="auto internal xref">4.4.2</a>.<a href="#section-8.10-3" class="pilcrow">¶</a></p>
4791c4809
< IANA has registered the following in the "SMI Security for PKIX Extended Key Purpose" registry <span>[<a href="#IANA-SMI" class="xref">IANA-SMI</a>]</span> for securing BP bundles.<a href="#section-8.11-1" class="pilcrow">¶</a></p>
---
> IANA has registered the following in the "SMI Security for PKIX Extended Key Purpose" registry <span>[<a href="#IANA-SMI" class="cite xref">IANA-SMI</a>]</span> for securing BP bundles.<a href="#section-8.11-1" class="pilcrow">¶</a></p>
4814c4832
< <p id="section-8.11-3">The formal definition of this EKU is provided in <a href="#sec-asn1-mod" class="xref">Appendix B</a>. The use of this OID is defined in <a href="#sec-tcpcl-cert-profile" class="xref">Section 4.4.2</a>.<a href="#section-8.11-3" class="pilcrow">¶</a></p>
---
> <p id="section-8.11-3">The formal definition of this EKU is provided in <a href="#sec-asn1-mod" class="auto internal xref">Appendix B</a>. The use of this OID is defined in <a href="#sec-tcpcl-cert-profile" class="auto internal xref">Section 4.4.2</a>.<a href="#section-8.11-3" class="pilcrow">¶</a></p>
4975c4993
< The areas in which changes from <span>[<a href="#RFC7242" class="xref">RFC7242</a>]</span> have been made to existing headers and messages are as follows:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
---
> The areas in which changes from <span>[<a href="#RFC7242" class="cite xref">RFC7242</a>]</span> have been made to existing headers and messages are as follows:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
5007c5025
< The areas in which extensions from <span>[<a href="#RFC7242" class="xref">RFC7242</a>]</span> have been made as new messages and codes are as follows:<a href="#appendix-A-3" class="pilcrow">¶</a></p>
---
> The areas in which extensions from <span>[<a href="#RFC7242" class="cite xref">RFC7242</a>]</span> have been made as new messages and codes are as follows:<a href="#appendix-A-3" class="pilcrow">¶</a></p>
5025,5028c5043,5046
< The following ASN.1 module formally specifies the <code>BundleEID</code> structure, its Other Name Form, and the <code>bundleSecurity</code> EKU, using ASN.1 syntax per <span>[<a href="#X.680" class="xref">X.680</a>]</span>.
< This specification uses the ASN.1 definitions from <span>[<a href="#RFC5912" class="xref">RFC5912</a>]</span> with the 2002 ASN.1 notation used in that document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
< <div id="appendix-B-2">
< <pre class="lang-asn.1 sourcecode">&lt;CODE BEGINS&gt;
---
> The following ASN.1 module formally specifies the <code>BundleEID</code> structure, its Other Name Form, and the <code>bundleSecurity</code> EKU, using ASN.1 syntax per <span>[<a href="#X.680" class="cite xref">X.680</a>]</span>.
> This specification uses the ASN.1 definitions from <span>[<a href="#RFC5912" class="cite xref">RFC5912</a>]</span> with the 2002 ASN.1 notation used in that document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
> <div class="lang-asn.1 sourcecode" id="appendix-B-2">
> <pre>&lt;CODE BEGINS&gt;
5083,5084c5101,5102
< <div id="appendix-C-3">
< <pre class="lang-hex sourcecode">
---
> <div class="lang-hex sourcecode" id="appendix-C-3">
> <pre>
5089c5107
< And the text decoding in <a href="#fig-example-dtneid" class="xref">Figure 28</a> is an output of Peter Gutmann's "dumpasn1" program.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
---
> And the text decoding in <a href="#fig-example-dtneid" class="auto internal xref">Figure 28</a> is an output of Peter Gutmann's "dumpasn1" program.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
5113c5131
< This specification is based on comments regarding the implementation of <span>[<a href="#RFC7242" class="xref">RFC7242</a>]</span> as provided by <span class="contact-name">Scott Burleigh</span>.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
---
> This specification is based on comments regarding the implementation of <span>[<a href="#RFC7242" class="cite xref">RFC7242</a>]</span> as provided by <span class="contact-name">Scott Burleigh</span>.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
