31c31
< <meta content="xml2rfc 3.5.0" name="generator">
---
> <meta content="xml2rfc 3.19.0" name="generator">
34,51c34,47
<   xml2rfc 3.5.0
<     Python 3.6.10
<     appdirs 1.4.4
<     ConfigArgParse 1.2.3
<     google-i18n-address 2.3.5
<     html5lib 1.0.1
<     intervaltree 3.0.2
<     Jinja2 2.11.2
<     kitchen 1.2.6
<     lxml 4.4.2
<     pycairo 1.19.0
<     pycountry 19.8.18
<     pyflakes 2.1.1
<     PyYAML 5.3.1
<     requests 2.22.0
<     setuptools 40.6.2
<     six 1.14.0
<     WeasyPrint 51
---
>   xml2rfc 3.19.0
>     Python 3.11.7
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 5.0.0
>     platformdirs 4.1.0
>     pycountry 23.12.11
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.12
53c49
< <link href="rfc8928.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc8928.xml" rel="alternate" type="application/rfc+xml">
63c59
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
72a69,74
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
75d76
<   width: extend-to-zoom;
90c91
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
92a94
>   overflow-wrap: break-word;
178a181,189
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
193,196d203
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
197a205
>   border: none;
220a229,231
> ul.ulBare, li.ulBare {
>   margin-left: 0em !important;
> }
272c283
< tt, code, pre, code {
---
> tt, code, pre {
274c285
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
313a325,327
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
403a418,423
> /* Fix PDF info block run off issue */
> @media print {
>   #identifiers dd {
>     float: none;
>   }
> }
505c525
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
645d664
< 
667a687,689
>   .breakable pre {
>     break-inside: auto;
>   }
735c757
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
835c857
< tt, code, pre, code {
---
> tt, code, pre {
840c862
< pre.sourcecode,
---
> .sourcecode pre,
876c898
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1057a1080
>   .artwork > pre,
1072c1095
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1078a1102,1104
> tr {
>   break-inside: avoid;
> }
1098c1124
<   break-before: avoid-page;
---
>   break-before: auto;
1129c1155
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1154c1180
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1172c1198
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1180a1207,1214
> /* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
> li > p {
>   margin-bottom: 0.5em
> }
> /* Don't let p margin spill out from inside list items */
> li > p:last-of-type:only-child {
>   margin-bottom: 0;
> }
1182a1217
> <link href="https://datatracker.ietf.org/doc/draft-ietf-6lo-ap-nd-23" rel="prev">
1185c1220
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-6lo-ap-nd-23" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1187,1188c1222,1223
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1306,1314c1341,1349
< <nav class="toc"><ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.1">
<             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
< </li>
<           <li class="ulEmpty toc compact" id="section-toc.1-1.2">
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
<                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
---
> <nav class="toc"><ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
>             <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
>                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
1316,1317c1351,1352
<               <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
<                 <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
>                 <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-background" class="internal xref">Background</a></p>
1319,1320c1354,1355
<               <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
<                 <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-abbreviations" class="xref">Abbreviations</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
>                 <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-abbreviations" class="internal xref">Abbreviations</a></p>
1324,1325c1359,1360
<           <li class="ulEmpty toc compact" id="section-toc.1-1.3">
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-updating-rfc-8505" class="xref">Updating RFC 8505</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
>             <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-updating-rfc-8505" class="internal xref">Updating RFC 8505</a></p>
1327,1334c1362,1369
<           <li class="ulEmpty toc compact" id="section-toc.1-1.4">
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-new-fields-and-options" class="xref">New Fields and Options</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
<                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-new-crypto-id" class="xref">New Crypto-ID</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
< </li>
<               <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
<                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-updated-earo" class="xref">Updated EARO</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-new-fields-and-options" class="internal xref">New Fields and Options</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
>                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-new-crypto-id" class="internal xref">New Crypto-ID</a></p>
> </li>
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
>                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-updated-earo" class="internal xref">Updated EARO</a></p>
1336,1337c1371,1372
<               <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.3">
<                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-crypto-id-parameters-option" class="xref">Crypto-ID Parameters Option</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
>                 <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-crypto-id-parameters-option" class="internal xref">Crypto-ID Parameters Option</a></p>
1339,1340c1374,1375
<               <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.4">
<                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-ndp-signature-option" class="xref">NDP Signature Option</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
>                 <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-ndp-signature-option" class="internal xref">NDP Signature Option</a></p>
1342,1343c1377,1378
<               <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.5">
<                 <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-extensions-to-the-capabilit" class="xref">Extensions to the Capability Indication Option</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
>                 <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="auto internal xref">4.5</a>.  <a href="#name-extensions-to-the-capabilit" class="internal xref">Extensions to the Capability Indication Option</a></p>
1347,1348c1382,1383
<           <li class="ulEmpty toc compact" id="section-toc.1-1.5">
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-protocol-scope" class="xref">Protocol Scope</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-protocol-scope" class="internal xref">Protocol Scope</a></p>
1350,1354c1385,1389
<           <li class="ulEmpty toc compact" id="section-toc.1-1.6">
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-protocol-flows" class="xref">Protocol Flows</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
<                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-first-exchange-with-a-6lr" class="xref">First Exchange with a 6LR</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-protocol-flows" class="internal xref">Protocol Flows</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
>                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-first-exchange-with-a-6lr" class="internal xref">First Exchange with a 6LR</a></p>
1356,1357c1391,1392
<               <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
<                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ndpso-generation-and-verifi" class="xref">NDPSO Generation and Verification</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
>                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-ndpso-generation-and-verifi" class="internal xref">NDPSO Generation and Verification</a></p>
1359,1360c1394,1395
<               <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
<                 <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-multi-hop-operation" class="xref">Multi-Hop Operation</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
>                 <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-multi-hop-operation" class="internal xref">Multi-Hop Operation</a></p>
1364,1368c1399,1403
<           <li class="ulEmpty toc compact" id="section-toc.1-1.7">
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-brown-field" class="xref">Brown Field</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
>                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-brown-field" class="internal xref">Brown Field</a></p>
1370,1371c1405,1406
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
<                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-threats-identified-in-rfc-3" class="xref">Threats Identified in RFC 3971</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
>                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-threats-identified-in-rfc-3" class="internal xref">Threats Identified in RFC 3971</a></p>
1373,1374c1408,1409
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.3">
<                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-related-to-6lowpan-nd" class="xref">Related to 6LoWPAN ND</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
>                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-related-to-6lowpan-nd" class="internal xref">Related to 6LoWPAN ND</a></p>
1376,1377c1411,1412
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.4">
<                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-compromised-6lr" class="xref">Compromised 6LR</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
>                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-compromised-6lr" class="internal xref">Compromised 6LR</a></p>
1379,1380c1414,1415
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.5">
<                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-rovr-collisions" class="xref">ROVR Collisions</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
>                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-rovr-collisions" class="internal xref">ROVR Collisions</a></p>
1382,1383c1417,1418
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.6">
<                 <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-implementation-attacks" class="xref">Implementation Attacks</a><a href="#section-toc.1-1.7.2.6.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
>                 <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="auto internal xref">7.6</a>.  <a href="#name-implementation-attacks" class="internal xref">Implementation Attacks</a></p>
1385,1386c1420,1421
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.7">
<                 <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-cross-algorithm-and-cross-p" class="xref">Cross-Algorithm and Cross-Protocol Attacks</a><a href="#section-toc.1-1.7.2.7.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
>                 <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="auto internal xref">7.7</a>.  <a href="#name-cross-algorithm-and-cross-p" class="internal xref">Cross-Algorithm and Cross-Protocol Attacks</a></p>
1388,1389c1423,1424
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.8">
<                 <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-public-key-validation" class="xref">Public Key Validation</a><a href="#section-toc.1-1.7.2.8.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
>                 <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="auto internal xref">7.8</a>.  <a href="#name-public-key-validation" class="internal xref">Public Key Validation</a></p>
1391,1392c1426,1427
<               <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.9">
<                 <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-correlating-registrations" class="xref">Correlating Registrations</a><a href="#section-toc.1-1.7.2.9.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
>                 <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="auto internal xref">7.9</a>.  <a href="#name-correlating-registrations" class="internal xref">Correlating Registrations</a></p>
1396,1400c1431,1435
<           <li class="ulEmpty toc compact" id="section-toc.1-1.8">
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.1">
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-cga-message-type" class="xref">CGA Message Type</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cga-message-type" class="internal xref">CGA Message Type</a></p>
1402,1403c1437,1438
<               <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.2">
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-crypto-type-subregistry" class="xref">Crypto-Type Subregistry</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-crypto-type-subregistry" class="internal xref">Crypto-Type Subregistry</a></p>
1405,1406c1440,1441
<               <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.3">
<                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-ipv6-nd-option-types" class="xref">IPv6 ND Option Types</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
>                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-ipv6-nd-option-types" class="internal xref">IPv6 ND Option Types</a></p>
1408,1409c1443,1444
<               <li class="ulEmpty toc compact" id="section-toc.1-1.8.2.4">
<                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-new-6lowpan-capability-bit" class="xref">New 6LoWPAN Capability Bit</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
>                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-new-6lowpan-capability-bit" class="internal xref">New 6LoWPAN Capability Bit</a></p>
1413,1417c1448,1452
<           <li class="ulEmpty toc compact" id="section-toc.1-1.9">
<             <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
<                 <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
>             <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
>                 <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1419,1420c1454,1455
<               <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
<                 <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
>                 <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1424,1425c1459,1460
<           <li class="ulEmpty toc compact" id="section-toc.1-1.10">
<             <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-requirements-addressed-in-t" class="xref">Requirements Addressed in This Document</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
>             <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-requirements-addressed-in-t" class="internal xref">Requirements Addressed in This Document</a></p>
1427,1434c1462,1469
<           <li class="ulEmpty toc compact" id="section-toc.1-1.11">
<             <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-representation-conventions" class="xref">Representation Conventions</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
< <ul class="ulEmpty toc compact">
< <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.1">
<                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-signature-schemes" class="xref">Signature Schemes</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
< </li>
<               <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.2">
<                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-representation-of-ecdsa-sig" class="xref">Representation of ECDSA Signatures</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
>             <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-representation-conventions" class="internal xref">Representation Conventions</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
>                 <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-signature-schemes" class="internal xref">Signature Schemes</a></p>
> </li>
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
>                 <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-representation-of-ecdsa-sig" class="internal xref">Representation of ECDSA Signatures</a></p>
1436,1437c1471,1472
<               <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.3">
<                 <p id="section-toc.1-1.11.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-representation-of-public-ke" class="xref">Representation of Public Keys Used with ECDSA</a><a href="#section-toc.1-1.11.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
>                 <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-representation-of-public-ke" class="internal xref">Representation of Public Keys Used with ECDSA</a></p>
1439,1440c1474,1475
<               <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.4">
<                 <p id="section-toc.1-1.11.2.4.1"><a href="#section-b.4" class="xref">B.4</a>.  <a href="#name-alternative-representations" class="xref">Alternative Representations of Curve25519</a><a href="#section-toc.1-1.11.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
>                 <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-B.4" class="auto internal xref">B.4</a>.  <a href="#name-alternative-representations" class="internal xref">Alternative Representations of Curve25519</a></p>
1442,1443c1477,1478
<               <li class="ulEmpty toc compact" id="section-toc.1-1.11.2.5">
<                 <p id="section-toc.1-1.11.2.5.1"><a href="#section-b.5" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.11.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.5">
>                 <p id="section-toc.1-1.11.2.5.1"><a href="#appendix-B.5" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
1447,1448c1482,1483
<           <li class="ulEmpty toc compact" id="section-toc.1-1.12">
<             <p id="section-toc.1-1.12.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
>             <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
1459c1494
<      Neighbor Discovery optimizations for 6LoWPAN networks (aka 6LoWPAN ND) <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> adapts the original IPv6 Neighbor Discovery protocols defined in <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> and <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span> for constrained
---
>      Neighbor Discovery optimizations for 6LoWPAN networks (aka 6LoWPAN ND) <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> adapts the original IPv6 Neighbor Discovery protocols defined in <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> and <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span> for constrained
1463,1464c1498,1499
<      The registration mechanism in "Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)" <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> prevents the use of an address if that address
<      is already registered in the subnet (first come, first served). In order to validate address ownership, "Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery" <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines a Registration Ownership Verifier (ROVR) field. <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> enables a 6LR and 6LBR to validate the association between the Registered Address of a node and its ROVR. The ROVR can be derived from the link-layer address of the device (using the 64-bit Extended Unique Identifier (EUI-64) address format specified by IEEE). However, the EUI-64 can be spoofed; therefore, any node connected to the subnet and aware of a registered-address-to-ROVR mapping could effectively fake the ROVR. This would allow an attacker to steal the address and redirect traffic for that address. <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> defines an Extended Address Registration Option (EARO) that transports alternate forms of ROVRs and is a prerequisite for this specification.<a href="#section-1-2" class="pilcrow">¶</a></p>
---
>      The registration mechanism in "Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)" <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> prevents the use of an address if that address
>      is already registered in the subnet (first come, first served). In order to validate address ownership, "Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery" <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> defines a Registration Ownership Verifier (ROVR) field. <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> enables a 6LR and 6LBR to validate the association between the Registered Address of a node and its ROVR. The ROVR can be derived from the link-layer address of the device (using the 64-bit Extended Unique Identifier (EUI-64) address format specified by IEEE). However, the EUI-64 can be spoofed; therefore, any node connected to the subnet and aware of a registered-address-to-ROVR mapping could effectively fake the ROVR. This would allow an attacker to steal the address and redirect traffic for that address. <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> defines an Extended Address Registration Option (EARO) that transports alternate forms of ROVRs and is a prerequisite for this specification.<a href="#section-1-2" class="pilcrow">¶</a></p>
1469c1504
<    The protected address registration protocol proposed in this document provides the same conceptual benefit as Source Address Validation Improvement (SAVI) <span>[<a href="#RFC7039" class="xref">RFC7039</a>]</span> in that only the owner of an IPv6 address may source packets with that address. As opposed to <span>[<a href="#RFC7039" class="xref">RFC7039</a>]</span>, which relies on snooping protocols, the protection provided by this document is based on a state that is installed and maintained in the network by the owner of the address. With this specification, a 6LN may use a 6LR for forwarding an IPv6 packet if and only if it has registered the address used as the source of the packet with that 6LR.<a href="#section-1-4" class="pilcrow">¶</a></p>
---
>    The protected address registration protocol proposed in this document provides the same conceptual benefit as Source Address Validation Improvement (SAVI) <span>[<a href="#RFC7039" class="cite xref">RFC7039</a>]</span> in that only the owner of an IPv6 address may source packets with that address. As opposed to <span>[<a href="#RFC7039" class="cite xref">RFC7039</a>]</span>, which relies on snooping protocols, the protection provided by this document is based on a state that is installed and maintained in the network by the owner of the address. With this specification, a 6LN may use a 6LR for forwarding an IPv6 packet if and only if it has registered the address used as the source of the packet with that 6LR.<a href="#section-1-4" class="pilcrow">¶</a></p>
1472c1507
<    With the 6LoWPAN adaptation layer in <span>[<a href="#RFC4944" class="xref">RFC4944</a>]</span> and <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span>, a
---
>    With the 6LoWPAN adaptation layer in <span>[<a href="#RFC4944" class="cite xref">RFC4944</a>]</span> and <span>[<a href="#RFC6282" class="cite xref">RFC6282</a>]</span>, a
1475c1510
<    from a Layer 2 (L2) address. Such compression is incompatible with "SEcure Neighbor Discovery (SEND") <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> and "Cryptographically Generated Addresses (CGAs)" <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span>, since they derive the IID from cryptographic keys. This specification, on the other hand, separates the IID generation from cryptographic computations and can enable better compression.<a href="#section-1-5" class="pilcrow">¶</a></p>
---
>    from a Layer 2 (L2) address. Such compression is incompatible with "SEcure Neighbor Discovery (SEND") <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> and "Cryptographically Generated Addresses (CGAs)" <span>[<a href="#RFC3972" class="cite xref">RFC3972</a>]</span>, since they derive the IID from cryptographic keys. This specification, on the other hand, separates the IID generation from cryptographic computations and can enable better compression.<a href="#section-1-5" class="pilcrow">¶</a></p>
1489c1524
<     described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> 
---
>     described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> 
1501c1536
< <li class="normal" id="section-2.2-2.1"> "SEcure Neighbor Discovery (SEND)" <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>,<a href="#section-2.2-2.1" class="pilcrow">¶</a>
---
> <li class="normal" id="section-2.2-2.1"> "SEcure Neighbor Discovery (SEND)" <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>,<a href="#section-2.2-2.1" class="pilcrow">¶</a>
1503c1538
<           <li class="normal" id="section-2.2-2.2"> "Cryptographically Generated Addresses (CGA)" <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span>,<a href="#section-2.2-2.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-2.2-2.2"> "Cryptographically Generated Addresses (CGA)" <span>[<a href="#RFC3972" class="cite xref">RFC3972</a>]</span>,<a href="#section-2.2-2.2" class="pilcrow">¶</a>
1505c1540
<           <li class="normal" id="section-2.2-2.3"> "Neighbor Discovery for IP version 6 (IPv6)" <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span> ,<a href="#section-2.2-2.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-2.2-2.3"> "Neighbor Discovery for IP version 6 (IPv6)" <span>[<a href="#RFC4861" class="cite xref">RFC4861</a>]</span> ,<a href="#section-2.2-2.3" class="pilcrow">¶</a>
1507c1542
<           <li class="normal" id="section-2.2-2.4"> "IPv6 Stateless Address Autoconfiguration" <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span>, and<a href="#section-2.2-2.4" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-2.2-2.4"> "IPv6 Stateless Address Autoconfiguration" <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>, and<a href="#section-2.2-2.4" class="pilcrow">¶</a>
1509c1544
<           <li class="normal" id="section-2.2-2.5"> "IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals" <span>[<a href="#RFC4919" class="xref">RFC4919</a>]</span>.<a href="#section-2.2-2.5" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-2.2-2.5"> "IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals" <span>[<a href="#RFC4919" class="cite xref">RFC4919</a>]</span>.<a href="#section-2.2-2.5" class="pilcrow">¶</a>
1520c1555
< <span class="break"></span><dl class="dlParallel dlCompact" id="section-2.3-2">
---
> <span class="break"></span><dl class="dlCompact dlParallel" id="section-2.3-2">
1638c1673
<        <span><a href="https://www.rfc-editor.org/rfc/rfc8505#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8505" class="xref">RFC8505</a>]</span> introduces the ROVR that is used to detect and reject duplicate registrations in the DAD process. The ROVR is a generic object that is designed for both backward compatibility and the capability to introduce new computation methods in the future. Using a Crypto-ID per this specification is the <span class="bcp14">RECOMMENDED</span> method. <a href="#sec-col" class="xref">Section 7.5</a> discusses collisions when heterogeneous methods to compute the ROVR field coexist inside a network.<a href="#section-3-1" class="pilcrow">¶</a></p>
---
>        <span><a href="https://rfc-editor.org/rfc/rfc8505#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> introduces the ROVR that is used to detect and reject duplicate registrations in the DAD process. The ROVR is a generic object that is designed for both backward compatibility and the capability to introduce new computation methods in the future. Using a Crypto-ID per this specification is the <span class="bcp14">RECOMMENDED</span> method. <a href="#sec-col" class="auto internal xref">Section 7.5</a> discusses collisions when heterogeneous methods to compute the ROVR field coexist inside a network.<a href="#section-3-1" class="pilcrow">¶</a></p>
1640c1675
<         This specification introduces a new identifier called a Crypto-ID that is transported in the ROVR field and used to indirectly prove the ownership of an address that is being registered by means of <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. The
---
>         This specification introduces a new identifier called a Crypto-ID that is transported in the ROVR field and used to indirectly prove the ownership of an address that is being registered by means of <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>. The
1643,1644c1678,1679
<         The overall mechanism requires the support of Elliptic Curve Cryptography (ECC) and a hash function as detailed in <a href="#ndpso-generation" class="xref">Section 6.2</a>. To enable the verification of the proof, the Registering Node needs to supply certain parameters including a nonce and a signature that will demonstrate that the node possesses the private key corresponding to the public key used to build the Crypto-ID.<a href="#section-3-3" class="pilcrow">¶</a></p>
< <p id="section-3-4"> The elliptic curves and the hash functions listed in <a href="#cryptotypetable" class="xref">Table 1</a> in <a href="#cryptotypereg" class="xref">Section 8.2</a> can
---
>         The overall mechanism requires the support of Elliptic Curve Cryptography (ECC) and a hash function as detailed in <a href="#ndpso-generation" class="auto internal xref">Section 6.2</a>. To enable the verification of the proof, the Registering Node needs to supply certain parameters including a nonce and a signature that will demonstrate that the node possesses the private key corresponding to the public key used to build the Crypto-ID.<a href="#section-3-3" class="pilcrow">¶</a></p>
> <p id="section-3-4"> The elliptic curves and the hash functions listed in <a href="#cryptotypetable" class="auto internal xref">Table 1</a> in <a href="#cryptotypereg" class="auto internal xref">Section 8.2</a> can
1646,1647c1681,1682
<     to the corresponding IANA registry. The cryptographic algorithms used (including the curve and the representation conventions) are signaled by the Crypto-Type field in a new IPv6 ND Crypto-ID Parameters Option (CIPO) (see <a href="#cryptoidopt" class="xref">Section 4.3</a>) that contains the parameters that are necessary for address validation.
<     A new NDP Signature Option (<a href="#ndpso" class="xref">Section 4.4</a>) is also specified in this document to carry the resulting signature. A Nonce Option <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> is added in the NA(EARO) that is used to request the validation, and all three options are needed in the NS(EARO) that provides the validation.<a href="#section-3-4" class="pilcrow">¶</a></p>
---
>     to the corresponding IANA registry. The cryptographic algorithms used (including the curve and the representation conventions) are signaled by the Crypto-Type field in a new IPv6 ND Crypto-ID Parameters Option (CIPO) (see <a href="#cryptoidopt" class="auto internal xref">Section 4.3</a>) that contains the parameters that are necessary for address validation.
>     A new NDP Signature Option (<a href="#ndpso" class="auto internal xref">Section 4.4</a>) is also specified in this document to carry the resulting signature. A Nonce Option <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> is added in the NA(EARO) that is used to request the validation, and all three options are needed in the NS(EARO) that provides the validation.<a href="#section-3-4" class="pilcrow">¶</a></p>
1668c1703
<    <li id="section-4.1-4.1">The hash function used internally by the signature scheme and indicated by the Crypto-Type (see <a href="#cryptotypetable" class="xref">Table 1</a> in <a href="#cryptotypereg" class="xref">Section 8.2</a>)
---
>    <li id="section-4.1-4.1">The hash function used internally by the signature scheme and indicated by the Crypto-Type (see <a href="#cryptotypetable" class="auto internal xref">Table 1</a> in <a href="#cryptotypereg" class="auto internal xref">Section 8.2</a>)
1675c1710
<    At the time of this writing, a minimal size for the Crypto-ID of 128 bits is <span class="bcp14">RECOMMENDED</span> unless backward compatibility is needed <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> (in which case it is at least 64 bits). The size of the Crypto-ID is likely to increase in the future.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
---
>    At the time of this writing, a minimal size for the Crypto-ID of 128 bits is <span class="bcp14">RECOMMENDED</span> unless backward compatibility is needed <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> (in which case it is at least 64 bits). The size of the Crypto-ID is likely to increase in the future.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
1687c1722
<           <div class="artwork art-text alignLeft" id="section-4.2-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-4.2-2.1">
1714c1749
<       Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and copied in the "EARO Length"
---
>       Defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> and copied in the "EARO Length"
1720c1755
<       Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-3.6" class="pilcrow">¶</a>
---
>       Defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4.2-3.6" class="pilcrow">¶</a>
1725c1760
<       Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-3.8" class="pilcrow">¶</a>
---
>       Defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4.2-3.8" class="pilcrow">¶</a>
1740c1775
<      Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-3.14" class="pilcrow">¶</a>
---
>      Defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4.2-3.14" class="pilcrow">¶</a>
1745c1780
<      Defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-3.16" class="pilcrow">¶</a>
---
>      Defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4.2-3.16" class="pilcrow">¶</a>
1756c1791
<  "Validation Failed", which are defined in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
---
>  "Validation Failed", which are defined in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
1770c1805
<     In order to provide cryptographic agility <span>[<a href="#RFC7696" class="xref">BCP201</a>]</span>, this specification supports different elliptic-curve-based signature schemes,
---
>     In order to provide cryptographic agility <span>[<a href="#RFC7696" class="cite xref">BCP201</a>]</span>, this specification supports different elliptic-curve-based signature schemes,
1774c1809
<     The ECDSA256 signature scheme, which uses ECDSA with the NIST P-256 curve <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> and the hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> internally,
---
>     The ECDSA256 signature scheme, which uses ECDSA with the NIST P-256 curve <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> and the hash function SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span> internally,
1778,1779c1813,1814
<     The Ed25519 signature scheme, which uses the Pure Edwards-Curve Digital Signature Algorithm (PureEdDSA) <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> with the twisted Edwards curve Edwards25519
<  <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> and the hash function SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> internally, <span class="bcp14">MAY</span> be supported as an alternative.<a href="#section-4.3-3.2" class="pilcrow">¶</a>
---
>     The Ed25519 signature scheme, which uses the Pure Edwards-Curve Digital Signature Algorithm (PureEdDSA) <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> with the twisted Edwards curve Edwards25519
>  <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span> and the hash function SHA-512 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span> internally, <span class="bcp14">MAY</span> be supported as an alternative.<a href="#section-4.3-3.2" class="pilcrow">¶</a>
1782,1783c1817,1818
<     The ECDSA25519 signature scheme, which uses ECDSA <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> with the Weierstrass curve Wei25519 (see <a href="#curves" class="xref">Appendix B.4</a>) and the hash function
<  SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> internally, <span class="bcp14">MAY</span> also be supported.<a href="#section-4.3-3.3" class="pilcrow">¶</a>
---
>     The ECDSA25519 signature scheme, which uses ECDSA <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> with the Weierstrass curve Wei25519 (see <a href="#curves" class="auto internal xref">Appendix B.4</a>) and the hash function
>  SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span> internally, <span class="bcp14">MAY</span> also be supported.<a href="#section-4.3-3.3" class="pilcrow">¶</a>
1791c1826
<           <div class="artwork art-text alignLeft" id="section-4.3-5.1">
---
>           <div class="alignLeft art-text artwork" id="section-4.3-5.1">
1819c1854
<        IANA has assigned value 39; see <a href="#nexndopt" class="xref">Table 2</a>.<a href="#section-4.3-6.2" class="pilcrow">¶</a>
---
>        IANA has assigned value 39; see <a href="#nexndopt" class="auto internal xref">Table 2</a>.<a href="#section-4.3-6.2" class="pilcrow">¶</a>
1835c1870
<  The valid values with this document are provided in <a href="#cryptotypetable" class="xref">Table 1</a>.<a href="#section-4.3-6.8" class="pilcrow">¶</a>
---
>  The valid values with this document are provided in <a href="#cryptotypetable" class="auto internal xref">Table 1</a>.<a href="#section-4.3-6.8" class="pilcrow">¶</a>
1842c1877
<         (see <a href="#cryptotypereg" class="xref">Section 8.2</a>).<a href="#section-4.3-6.10" class="pilcrow">¶</a>
---
>         (see <a href="#cryptotypereg" class="auto internal xref">Section 8.2</a>).<a href="#section-4.3-6.10" class="pilcrow">¶</a>
1867c1902
<  consume excessive amounts of program memory. This specification enables the use of the same hash function SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> for two of the three supported ECC-based signature schemes.
---
>  consume excessive amounts of program memory. This specification enables the use of the same hash function SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span> for two of the three supported ECC-based signature schemes.
1870,1872c1905,1907
<  <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span> provides information
<  on how to represent Montgomery curves and (twisted) Edwards curves as curves in short-Weierstrass form, and it illustrates how this can be used to implement elliptic curve computations using existing implementations that already provide, e.g., ECDSA and ECDH using NIST <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> prime curves. For more details on representation conventions, refer to
<  <a href="#reprconv" class="xref">Appendix B</a>.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
---
>  <span>[<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span> provides information
>  on how to represent Montgomery curves and (twisted) Edwards curves as curves in short-Weierstrass form, and it illustrates how this can be used to implement elliptic curve computations using existing implementations that already provide, e.g., ECDSA and ECDH using NIST <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> prime curves. For more details on representation conventions, refer to
>  <a href="#reprconv" class="auto internal xref">Appendix B</a>.<a href="#section-4.3-8" class="pilcrow">¶</a></p>
1881c1916
<  This specification defines the NDP Signature Option (NDPSO). The NDPSO carries the signature that proves the ownership of the Crypto-ID and validates the address being registered. The format of the NDPSO is illustrated in <a href="#ndpso-fig" class="xref">Figure 3</a>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
---
>  This specification defines the NDP Signature Option (NDPSO). The NDPSO carries the signature that proves the ownership of the Crypto-ID and validates the address being registered. The format of the NDPSO is illustrated in <a href="#ndpso-fig" class="auto internal xref">Figure 3</a>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
1883c1918
<     As opposed to the RSA Signature Option (RSAO) defined in <span><a href="https://www.rfc-editor.org/rfc/rfc3971#section-5.2" class="relref">Section 5.2</a> of SEND [<a href="#RFC3971" class="xref">RFC3971</a>]</span>, the NDPSO does not have a key hash field. Instead, the leftmost 128 bits of the ROVR field in the EARO are used as hash to retrieve the CIPO that contains the key material used for signature verification, left-padded if needed.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
---
>     As opposed to the RSA Signature Option (RSAO) defined in <span><a href="https://rfc-editor.org/rfc/rfc3971#section-5.2" class="relref">Section 5.2</a> of SEND [<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>, the NDPSO does not have a key hash field. Instead, the leftmost 128 bits of the ROVR field in the EARO are used as hash to retrieve the CIPO that contains the key material used for signature verification, left-padded if needed.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
1892c1927
<           <div class="artwork art-text alignLeft" id="section-4.4-6.1">
---
>           <div class="alignLeft art-text artwork" id="section-4.4-6.1">
1920c1955
<        IANA has assigned value 40; see <a href="#nexndopt" class="xref">Table 2</a>.<a href="#section-4.4-7.2" class="pilcrow">¶</a>
---
>        IANA has assigned value 40; see <a href="#nexndopt" class="auto internal xref">Table 2</a>.<a href="#section-4.4-7.2" class="pilcrow">¶</a>
1945,1946c1980,1981
<        A variable-length field containing the digital signature. The length and computation of the digital signature both depend on the Crypto-Type, which is found in the associated CIPO; see <a href="#reprconv" class="xref">Appendix B</a>.
<         For the values of the Crypto-Type defined in this specification, and for future values of the Crypto-Type unless specified otherwise, the signature is computed as detailed in <a href="#ndpso-generation" class="xref">Section 6.2</a>.<a href="#section-4.4-7.12" class="pilcrow">¶</a>
---
>        A variable-length field containing the digital signature. The length and computation of the digital signature both depend on the Crypto-Type, which is found in the associated CIPO; see <a href="#reprconv" class="auto internal xref">Appendix B</a>.
>         For the values of the Crypto-Type defined in this specification, and for future values of the Crypto-Type unless specified otherwise, the signature is computed as detailed in <a href="#ndpso-generation" class="auto internal xref">Section 6.2</a>.<a href="#section-4.4-7.12" class="pilcrow">¶</a>
1964c1999
<  as defined by <span>[<a href="#RFC7400" class="xref">RFC7400</a>]</span>, for use by the 6LR and 6LBR in IPv6 ND RA messages.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
---
>  as defined by <span>[<a href="#RFC7400" class="cite xref">RFC7400</a>]</span>, for use by the 6LR and 6LBR in IPv6 ND RA messages.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
1967c2002
<           <div class="artwork art-text alignLeft" id="section-4.5-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-4.5-2.1">
2001c2036
<       The scope of the protocol specified here is a 6LoWPAN LLN, typically a stub network connected to a larger IP network via a border router called a 6LBR per <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. A 6LBR has sufficient capability to satisfy the needs of DAD.<a href="#section-5-1" class="pilcrow">¶</a></p>
---
>       The scope of the protocol specified here is a 6LoWPAN LLN, typically a stub network connected to a larger IP network via a border router called a 6LBR per <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>. A 6LBR has sufficient capability to satisfy the needs of DAD.<a href="#section-5-1" class="pilcrow">¶</a></p>
2003c2038
<       The 6LBR maintains registration state for all devices in its attached LLN.  Together with the first-hop router (the 6LR), the 6LBR assures uniqueness and grants ownership of an IPv6 address before it can be used in the LLN. This is in contrast to a traditional network that relies on IPv6 address autoconfiguration <span>[<a href="#RFC4862" class="xref">RFC4862</a>]</span>, where there is no guarantee of ownership from the network, and each IPv6 Neighbor Discovery packet must be individually secured <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
---
>       The 6LBR maintains registration state for all devices in its attached LLN.  Together with the first-hop router (the 6LR), the 6LBR assures uniqueness and grants ownership of an IPv6 address before it can be used in the LLN. This is in contrast to a traditional network that relies on IPv6 address autoconfiguration <span>[<a href="#RFC4862" class="cite xref">RFC4862</a>]</span>, where there is no guarantee of ownership from the network, and each IPv6 Neighbor Discovery packet must be individually secured <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>.<a href="#section-5-2" class="pilcrow">¶</a></p>
2006c2041
<         <div class="artwork art-text alignLeft" id="section-5-3.1">
---
>         <div class="alignLeft art-text artwork" id="section-5-3.1">
2064c2099
<      A 6LN registers to a 6LR that is one hop away from it with the "C" flag set in the EARO, indicating that the ROVR field contains a Crypto-ID. The Target Address in the NS message indicates the IPv6 address that the 6LN is trying to register <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. The on-link (local) protocol interactions are shown in <a href="#Dynamic-fig" class="xref">Figure 6</a>. If the 6LR does not have a state with the 6LN that is consistent with the NS(EARO), then it replies with a challenge NA(EARO, status=Validation Requested) that contains a Nonce Option (shown as NonceLR in <a href="#Dynamic-fig" class="xref">Figure 6</a>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
---
>      A 6LN registers to a 6LR that is one hop away from it with the "C" flag set in the EARO, indicating that the ROVR field contains a Crypto-ID. The Target Address in the NS message indicates the IPv6 address that the 6LN is trying to register <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>. The on-link (local) protocol interactions are shown in <a href="#Dynamic-fig" class="auto internal xref">Figure 6</a>. If the 6LR does not have a state with the 6LN that is consistent with the NS(EARO), then it replies with a challenge NA(EARO, status=Validation Requested) that contains a Nonce Option (shown as NonceLR in <a href="#Dynamic-fig" class="auto internal xref">Figure 6</a>).<a href="#section-6.1-1" class="pilcrow">¶</a></p>
2067c2102
<           <div class="artwork art-text alignLeft" id="section-6.1-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-6.1-2.1">
2100c2135
<         The Nonce Option contains a nonce value that, to the extent  possible for the implementation, was never used before. This specification inherits the idea from <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> that the nonce is a random value. Ideally, an implementation uses an unpredictable cryptographically random value <span>[<a href="#RFC4086" class="xref">BCP106</a>]</span>. But that may be impractical in some LLN scenarios with resource-constrained devices.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
---
>         The Nonce Option contains a nonce value that, to the extent  possible for the implementation, was never used before. This specification inherits the idea from <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> that the nonce is a random value. Ideally, an implementation uses an unpredictable cryptographically random value <span>[<a href="#RFC4086" class="cite xref">BCP106</a>]</span>. But that may be impractical in some LLN scenarios with resource-constrained devices.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
2103c2138
<      The 6LN replies to the challenge with an NS(EARO) that includes the Nonce Option (shown as NonceLN in <a href="#Dynamic-fig" class="xref">Figure 6</a>), the CIPO (<a href="#cryptoidopt" class="xref">Section 4.3</a>), and the NDPSO containing the signature. Both nonces are included in the signed material. This provides a "contributory behavior" that results in better security even when the nonces of one party are not generated as specified.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
---
>      The 6LN replies to the challenge with an NS(EARO) that includes the Nonce Option (shown as NonceLN in <a href="#Dynamic-fig" class="auto internal xref">Figure 6</a>), the CIPO (<a href="#cryptoidopt" class="auto internal xref">Section 4.3</a>), and the NDPSO containing the signature. Both nonces are included in the signed material. This provides a "contributory behavior" that results in better security even when the nonces of one party are not generated as specified.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
2110c2145
<             Upon receiving a first NA(EARO) with a status code of "Validation Requested" from a 6LR, the Registering Node <span class="bcp14">SHOULD</span> retry its registration with a CIPO (<a href="#cryptoidopt" class="xref">Section 4.3</a>) that contains all the necessary material for building the Crypto-ID, the NonceLN that it generated, and the NDP Signature Option (<a href="#ndpso" class="xref">Section 4.4</a>) that proves its ownership of the Crypto-ID and intent of registering the Target Address. In subsequent revalidation with the same 6LR, the 6LN <span class="bcp14">MAY</span> try to omit the CIPO to save bandwidth, with the expectation that the 6LR saved it. If the validation fails and it gets challenged again, then it <span class="bcp14">SHOULD</span> add the CIPO again.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
---
>             Upon receiving a first NA(EARO) with a status code of "Validation Requested" from a 6LR, the Registering Node <span class="bcp14">SHOULD</span> retry its registration with a CIPO (<a href="#cryptoidopt" class="auto internal xref">Section 4.3</a>) that contains all the necessary material for building the Crypto-ID, the NonceLN that it generated, and the NDP Signature Option (<a href="#ndpso" class="auto internal xref">Section 4.4</a>) that proves its ownership of the Crypto-ID and intent of registering the Target Address. In subsequent revalidation with the same 6LR, the 6LN <span class="bcp14">MAY</span> try to omit the CIPO to save bandwidth, with the expectation that the 6LR saved it. If the validation fails and it gets challenged again, then it <span class="bcp14">SHOULD</span> add the CIPO again.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
2131,2132c2166,2167
<   (see <a href="#cryptotypetable" class="xref">Table 1</a> in
<   <a href="#cryptotypereg" class="xref">Section 8.2</a>) chosen by the 6LN as follows:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
---
>   (see <a href="#cryptotypetable" class="auto internal xref">Table 1</a> in
>   <a href="#cryptotypereg" class="auto internal xref">Section 8.2</a>) chosen by the 6LN as follows:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
2137,2138c2172,2173
<          <li id="section-6.2-2.1.2.1">The 128-bit Message Type tag <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span> (in network byte order).
<                 For this specification, the tag is given in <a href="#cgam" class="xref">Section 8.1</a>.
---
>          <li id="section-6.2-2.1.2.1">The 128-bit Message Type tag <span>[<a href="#RFC3972" class="cite xref">RFC3972</a>]</span> (in network byte order).
>                 For this specification, the tag is given in <a href="#cgam" class="auto internal xref">Section 8.1</a>.
2147c2182
<  nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.4" class="pilcrow">¶</a>
---
>  nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.4" class="pilcrow">¶</a>
2150c2185
<  byte order). The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.5" class="pilcrow">¶</a>
---
>  byte order). The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>.<a href="#section-6.2-2.1.2.5" class="pilcrow">¶</a>
2169c2204
<                 <li id="section-6.2-5.1.2.1">The 128-bit Message Type tag given in <a href="#cgam" class="xref">Section 8.1</a> (in network byte order).<a href="#section-6.2-5.1.2.1" class="pilcrow">¶</a>
---
>                 <li id="section-6.2-5.1.2.1">The 128-bit Message Type tag given in <a href="#cgam" class="auto internal xref">Section 8.1</a> (in network byte order).<a href="#section-6.2-5.1.2.1" class="pilcrow">¶</a>
2176c2211
<  at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.4" class="pilcrow">¶</a>
---
>  at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.4" class="pilcrow">¶</a>
2179c2214
<  order) in the NS message. The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.5" class="pilcrow">¶</a>
---
>  order) in the NS message. The nonce is at least 6 bytes long as defined in <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span>.<a href="#section-6.2-5.1.2.5" class="pilcrow">¶</a>
2200c2235
<      A new 6LN that joins the network autoconfigures an address and performs an initial registration to a neighboring 6LR with an NS message that carries an EARO <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
---
>      A new 6LN that joins the network autoconfigures an address and performs an initial registration to a neighboring 6LR with an NS message that carries an EARO <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
2202c2237
<      In a multi-hop 6LoWPAN, the registration with Crypto-ID is propagated to 6LBR as shown in <a href="#figReg" class="xref">Figure 7</a>, which illustrates the
---
>      In a multi-hop 6LoWPAN, the registration with Crypto-ID is propagated to 6LBR as shown in <a href="#figReg" class="auto internal xref">Figure 7</a>, which illustrates the
2204c2239
<     <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span>.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
---
>     <span>[<a href="#RFC8929" class="cite xref">RFC8929</a>]</span>.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
2207c2242
<           <div class="artwork art-text alignLeft" id="section-6.3-3.1">
---
>           <div class="alignLeft art-text artwork" id="section-6.3-3.1">
2236c2271
<      The 6LR and the 6LBR communicate using ICMPv6 EDAR and EDAC messages <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> as shown in <a href="#figReg" class="xref">Figure 7</a>.
---
>      The 6LR and the 6LBR communicate using ICMPv6 EDAR and EDAC messages <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> as shown in <a href="#figReg" class="auto internal xref">Figure 7</a>.
2260c2295
<         Observations regarding the following threats to the local network in <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> also apply to this specification.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
---
>         Observations regarding the following threats to the local network in <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> also apply to this specification.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
2264c2299
<          Threats in <span><a href="https://www.rfc-editor.org/rfc/rfc3971#section-9.2.1" class="relref">Section 9.2.1</a> of [<a href="#RFC3971" class="xref">RFC3971</a>]</span> apply. AP-ND counters the threats on NS(EARO) messages by requiring that the NDPSO and CIPO be present in these solicitations.<a href="#section-7.2-2.2" class="pilcrow">¶</a>
---
>          Threats in <span><a href="https://rfc-editor.org/rfc/rfc3971#section-9.2.1" class="relref">Section 9.2.1</a> of [<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> apply. AP-ND counters the threats on NS(EARO) messages by requiring that the NDPSO and CIPO be present in these solicitations.<a href="#section-7.2-2.2" class="pilcrow">¶</a>
2269c2304
<         Inside the LLN, duplicate addresses are sorted out using the ROVR. A different ROVR for the same Registered Address entails a rejection of the second registration <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span>. DADs coming from the backbone network are not forwarded over the LLN to provide some protection against DoS attacks inside the resource-constrained part of the network. However, the EARO is present in the NS/NA messages exchanged over the backbone network. This protects against misinterpreting node movement as a duplication and enables the Backbone Routers to determine which subnet has the most recent registration <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> and is thus the best candidate to validate the registration <span>[<a href="#RFC8929" class="xref">RFC8929</a>]</span>.<a href="#section-7.2-2.4" class="pilcrow">¶</a>
---
>         Inside the LLN, duplicate addresses are sorted out using the ROVR. A different ROVR for the same Registered Address entails a rejection of the second registration <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span>. DADs coming from the backbone network are not forwarded over the LLN to provide some protection against DoS attacks inside the resource-constrained part of the network. However, the EARO is present in the NS/NA messages exchanged over the backbone network. This protects against misinterpreting node movement as a duplication and enables the Backbone Routers to determine which subnet has the most recent registration <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> and is thus the best candidate to validate the registration <span>[<a href="#RFC8929" class="cite xref">RFC8929</a>]</span>.<a href="#section-7.2-2.4" class="pilcrow">¶</a>
2295c2330
<  <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span> <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> also
---
>  <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span> <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> also
2298c2333
<             Secure ND <span>[<a href="#RFC3971" class="xref">RFC3971</a>]</span> forces the IPv6 address to be cryptographic since it integrates the CGA as the IID in the IPv6 address. In contrast, this specification saves about 1 KB in every NS/NA message. Also, this specification separates the cryptographic identifier from the registered IPv6 address so that a node can have more than one IPv6 address protected by the same cryptographic identifier.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
---
>             Secure ND <span>[<a href="#RFC3971" class="cite xref">RFC3971</a>]</span> forces the IPv6 address to be cryptographic since it integrates the CGA as the IID in the IPv6 address. In contrast, this specification saves about 1 KB in every NS/NA message. Also, this specification separates the cryptographic identifier from the registered IPv6 address so that a node can have more than one IPv6 address protected by the same cryptographic identifier.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
2300c2335
<             With this specification, the 6LN can freely form its IPv6 address(es) in any fashion, thereby enabling either 6LoWPAN compression for IPv6 addresses that are derived from L2 addresses or temporary addresses that cannot be compressed, e.g., formed pseudorandomly and released in relatively short cycles for privacy reasons <span>[<a href="#RFC8064" class="xref">RFC8064</a>]</span><span>[<a href="#RFC8065" class="xref">RFC8065</a>]</span>.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
---
>             With this specification, the 6LN can freely form its IPv6 address(es) in any fashion, thereby enabling either 6LoWPAN compression for IPv6 addresses that are derived from L2 addresses or temporary addresses that cannot be compressed, e.g., formed pseudorandomly and released in relatively short cycles for privacy reasons <span>[<a href="#RFC8064" class="cite xref">RFC8064</a>]</span><span>[<a href="#RFC8065" class="cite xref">RFC8065</a>]</span>.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
2302c2337
<             This specification provides added protection for addresses that are obtained following due procedure <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> but does not constrain the way the addresses are formed or the number of addresses that are used in parallel by a same entity. An attacker may still perform a DoS attack against the registry at the 6LR or 6LBR or attempt to deplete the pool of available addresses at L2 or L3.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
---
>             This specification provides added protection for addresses that are obtained following due procedure <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> but does not constrain the way the addresses are formed or the number of addresses that are used in parallel by a same entity. An attacker may still perform a DoS attack against the registry at the 6LR or 6LBR or attempt to deplete the pool of available addresses at L2 or L3.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
2331,2332c2366,2367
< <p id="section-7.6-1"> The signature schemes referenced in this specification comply with NIST <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> or Crypto Forum Research Group (CFRG) standards <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and offer strong algorithmic security at roughly a 128-bit security level. These signature schemes use elliptic curves that either were specifically designed with exception-free and constant-time arithmetic in mind <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> or have extensive implementation experience of resistance
<  to timing attacks <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
---
> <p id="section-7.6-1"> The signature schemes referenced in this specification comply with NIST <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> or Crypto Forum Research Group (CFRG) standards <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span> and offer strong algorithmic security at roughly a 128-bit security level. These signature schemes use elliptic curves that either were specifically designed with exception-free and constant-time arithmetic in mind <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span> or have extensive implementation experience of resistance
>  to timing attacks <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
2335c2370
<  there are micro-architectural side channel attacks that implementors should be aware of <span>[<a href="#breaking-ed25519" class="xref">breaking-ed25519</a>]</span>.
---
>  there are micro-architectural side channel attacks that implementors should be aware of <span>[<a href="#breaking-ed25519" class="cite xref">breaking-ed25519</a>]</span>.
2348c2383
< <p id="section-7.7-3"> ECDSA shall be used strictly as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. In particular, each signing operation of ECDSA <span class="bcp14">MUST</span> use randomly generated ephemeral private keys and <span class="bcp14">MUST NOT</span> reuse the ephemeral private key k across signing operations. This precludes the use of deterministic ECDSA without a random input for the determination of k, which is deemed dangerous for the intended applications this document aims to serve.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
---
> <p id="section-7.7-3"> ECDSA shall be used strictly as specified in <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>. In particular, each signing operation of ECDSA <span class="bcp14">MUST</span> use randomly generated ephemeral private keys and <span class="bcp14">MUST NOT</span> reuse the ephemeral private key k across signing operations. This precludes the use of deterministic ECDSA without a random input for the determination of k, which is deemed dangerous for the intended applications this document aims to serve.<a href="#section-7.7-3" class="pilcrow">¶</a></p>
2358c2393
<  that this point is not in the small subgroup (see <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span>); for points used with the signature scheme
---
>  that this point is not in the small subgroup (see <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span>); for points used with the signature scheme
2360c2395
<  "full public key validation" (again, see <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span>).<a href="#section-7.8-2" class="pilcrow">¶</a></p>
---
>  "full public key validation" (again, see <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span>).<a href="#section-7.8-2" class="pilcrow">¶</a></p>
2367c2402
<           The ROVR field in the EARO introduced in <span>[<a href="#RFC8505" class="xref">RFC8505</a>]</span> extends the EUI-64 field of the ARO defined in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. One of the drawbacks of using an EUI-64 as ROVR is that an attacker that is aware of the registrations can correlate traffic for the same 6LN across multiple addresses. <span><a href="https://www.rfc-editor.org/rfc/rfc8505#section-3" class="relref">Section 3</a> of [<a href="#RFC8505" class="xref">RFC8505</a>]</span> indicates that the ROVR and the address being registered are decoupled. A 6LN may use the same ROVR for multiple registrations or a different ROVR per registration, and the IID must not be derived from the ROVR. In theory, different 6LNs could use the same ROVR as long as they do not attempt to register the same address.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
---
>           The ROVR field in the EARO introduced in <span>[<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> extends the EUI-64 field of the ARO defined in <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>. One of the drawbacks of using an EUI-64 as ROVR is that an attacker that is aware of the registrations can correlate traffic for the same 6LN across multiple addresses. <span><a href="https://rfc-editor.org/rfc/rfc8505#section-3" class="relref">Section 3</a> of [<a href="#RFC8505" class="cite xref">RFC8505</a>]</span> indicates that the ROVR and the address being registered are decoupled. A 6LN may use the same ROVR for multiple registrations or a different ROVR per registration, and the IID must not be derived from the ROVR. In theory, different 6LNs could use the same ROVR as long as they do not attempt to register the same address.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
2384c2419
< Cryptographically Generated Addresses (CGA) Message Type Name Space created by <span>[<a href="#RFC3972" class="xref">RFC3972</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
---
> Cryptographically Generated Addresses (CGA) Message Type Name Space created by <span>[<a href="#RFC3972" class="cite xref">RFC3972</a>]</span>.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
2398c2433
<  <a href="#cryptotypetable" class="xref">Table 1</a>, which together specify a signature scheme. Detailed explanations are provided in <a href="#reprconv" class="xref">Appendix B</a>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
---
>  <a href="#cryptotypetable" class="auto internal xref">Table 1</a>, which together specify a signature scheme. Detailed explanations are provided in <a href="#reprconv" class="auto internal xref">Appendix B</a>.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
2417c2452
<               <td class="text-center" rowspan="1" colspan="1"> NIST P-256 <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> NIST P-256 <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>
2419c2454
<               <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
2421c2456
<               <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> Curve25519 <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>
2426c2461
<               <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>
2428c2463
<               <td class="text-center" rowspan="1" colspan="1"> SHA-512 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> SHA-512 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>
2430c2465
<               <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> SHA-256 <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>
2435c2470
<               <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>
2437c2472
<               <td class="text-center" rowspan="1" colspan="1"> Ed25519 <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> Ed25519 <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>
2439c2474
<               <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> ECDSA <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>
2444,2445c2479,2480
<               <td class="text-center" rowspan="1" colspan="1"> Weierstrass, (un)compressed, MSB/msb-order, <span>[<a href="#SEC1" class="xref">SEC1</a>]</span> </td>
<               <td class="text-center" rowspan="1" colspan="1"> Edwards, compressed, LSB/lsb-order, <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> Weierstrass, (un)compressed, MSB/msb-order, <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span> </td>
>               <td class="text-center" rowspan="1" colspan="1"> Edwards, compressed, LSB/lsb-order, <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>
2447c2482
<               <td class="text-center" rowspan="1" colspan="1"> Weierstrass, (un)compressed, MSB/msb-order, <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span>
---
>               <td class="text-center" rowspan="1" colspan="1"> Weierstrass, (un)compressed, MSB/msb-order, <span>[<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span>
2474c2509
<     Assignment of values for new Crypto-Type <span class="bcp14">MUST</span> be done through IANA with either "Specification Required" or "IESG Approval" as defined in <span><a href="#RFC8126" class="xref">BCP 26</a> [<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
---
>     Assignment of values for new Crypto-Type <span class="bcp14">MUST</span> be done through IANA with either "Specification Required" or "IESG Approval" as defined in <span><a href="#RFC8126" class="internal xref">BCP 26</a> [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
2519c2554
<      "6LoWPAN Capability Bits" created for <span>[<a href="#RFC7400" class="xref">RFC7400</a>]</span>
---
>      "6LoWPAN Capability Bits" created for <span>[<a href="#RFC7400" class="cite xref">RFC7400</a>]</span>
2564c2599
< <span class="refAuthor">Arkko, J., Ed.</span><span class="refAuthor">, Kempf, J.</span><span class="refAuthor">, Zill, B.</span><span class="refAuthor">, and P. Nikander</span>, <span class="refTitle">"SEcure Neighbor Discovery (SEND)"</span>, <span class="seriesInfo">RFC 3971</span>, <span class="seriesInfo">DOI 10.17487/RFC3971</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3971">https://www.rfc-editor.org/info/rfc3971</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Arkko, J., Ed.</span>, <span class="refAuthor">Kempf, J.</span>, <span class="refAuthor">Zill, B.</span>, and <span class="refAuthor">P. Nikander</span>, <span class="refTitle">"SEcure Neighbor Discovery (SEND)"</span>, <span class="seriesInfo">RFC 3971</span>, <span class="seriesInfo">DOI 10.17487/RFC3971</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3971">https://www.rfc-editor.org/info/rfc3971</a>&gt;</span>. </dd>
2568c2603
< <span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
2572c2607
< <span class="refAuthor">Shelby, Z., Ed.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, and C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Shelby, Z., Ed.</span>, <span class="refAuthor">Chakrabarti, S.</span>, <span class="refAuthor">Nordmark, E.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Neighbor Discovery Optimization for IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs)"</span>, <span class="seriesInfo">RFC 6775</span>, <span class="seriesInfo">DOI 10.17487/RFC6775</span>, <time datetime="2012-11" class="refDate">November 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6775">https://www.rfc-editor.org/info/rfc6775</a>&gt;</span>. </dd>
2580c2615
< <span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
2584c2619
< <span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
2592c2627
< <span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Chakrabarti, S.</span><span class="refAuthor">, and C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Chakrabarti, S.</span>, and <span class="refAuthor">C. Perkins</span>, <span class="refTitle">"Registration Extensions for IPv6 over Low-Power Wireless Personal Area Network (6LoWPAN) Neighbor Discovery"</span>, <span class="seriesInfo">RFC 8505</span>, <span class="seriesInfo">DOI 10.17487/RFC8505</span>, <time datetime="2018-11" class="refDate">November 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8505">https://www.rfc-editor.org/info/rfc8505</a>&gt;</span>. </dd>
2607c2642
< <span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
2615c2650
< <span class="refAuthor">Samwel, N.</span><span class="refAuthor">, Batina, L.</span><span class="refAuthor">, Bertoni, G.</span><span class="refAuthor">, Daemen, J.</span><span class="refAuthor">, and R. Susella</span>, <span class="refTitle">"Breaking Ed25519 in WolfSSL"</span>, <span class="refContent">Topics in Cryptology - CT-RSA, pp. 1-20</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1">https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Samwel, N.</span>, <span class="refAuthor">Batina, L.</span>, <span class="refAuthor">Bertoni, G.</span>, <span class="refAuthor">Daemen, J.</span>, and <span class="refAuthor">R. Susella</span>, <span class="refTitle">"Breaking Ed25519 in WolfSSL"</span>, <span class="refContent">Topics in Cryptology - CT-RSA, pp. 1-20</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1">https://link.springer.com/chapter/10.1007/978-3-319-76953-0_1</a>&gt;</span>. </dd>
2627c2662
< <span class="refAuthor">Narten, T.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Narten, T.</span>, <span class="refAuthor">Nordmark, E.</span>, <span class="refAuthor">Simpson, W.</span>, and <span class="refAuthor">H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
2631c2666
< <span class="refAuthor">Thomson, S.</span><span class="refAuthor">, Narten, T.</span><span class="refAuthor">, and T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Narten, T.</span>, and <span class="refAuthor">T. Jinmei</span>, <span class="refTitle">"IPv6 Stateless Address Autoconfiguration"</span>, <span class="seriesInfo">RFC 4862</span>, <span class="seriesInfo">DOI 10.17487/RFC4862</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4862">https://www.rfc-editor.org/info/rfc4862</a>&gt;</span>. </dd>
2635c2670
< <span class="refAuthor">Kushalnagar, N.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">C. Schumacher</span>, <span class="refTitle">"IPv6 over Low-Power Wireless Personal Area Networks (6LoWPANs): Overview, Assumptions, Problem Statement, and Goals"</span>, <span class="seriesInfo">RFC 4919</span>, <span class="seriesInfo">DOI 10.17487/RFC4919</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4919">https://www.rfc-editor.org/info/rfc4919</a>&gt;</span>. </dd>
2639c2674
< <span class="refAuthor">Montenegro, G.</span><span class="refAuthor">, Kushalnagar, N.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, and D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
2643c2678
< <span class="refAuthor">Hui, J., Ed.</span><span class="refAuthor"> and P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
2647c2682
< <span class="refAuthor">Wu, J.</span><span class="refAuthor">, Bi, J.</span><span class="refAuthor">, Bagnulo, M.</span><span class="refAuthor">, Baker, F.</span><span class="refAuthor">, and C. Vogt, Ed.</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Framework"</span>, <span class="seriesInfo">RFC 7039</span>, <span class="seriesInfo">DOI 10.17487/RFC7039</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7039">https://www.rfc-editor.org/info/rfc7039</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Wu, J.</span>, <span class="refAuthor">Bi, J.</span>, <span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">C. Vogt, Ed.</span>, <span class="refTitle">"Source Address Validation Improvement (SAVI) Framework"</span>, <span class="seriesInfo">RFC 7039</span>, <span class="seriesInfo">DOI 10.17487/RFC7039</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7039">https://www.rfc-editor.org/info/rfc7039</a>&gt;</span>. </dd>
2655c2690
< <span class="refAuthor">Gont, F.</span><span class="refAuthor">, Cooper, A.</span><span class="refAuthor">, Thaler, D.</span><span class="refAuthor">, and W. Liu</span>, <span class="refTitle">"Recommendation on Stable IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 8064</span>, <span class="seriesInfo">DOI 10.17487/RFC8064</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8064">https://www.rfc-editor.org/info/rfc8064</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Cooper, A.</span>, <span class="refAuthor">Thaler, D.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Recommendation on Stable IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 8064</span>, <span class="seriesInfo">DOI 10.17487/RFC8064</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8064">https://www.rfc-editor.org/info/rfc8064</a>&gt;</span>. </dd>
2663c2698
< <span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
2667c2702
< <span class="refAuthor">Thubert, P., Ed.</span><span class="refAuthor">, Perkins, C.E.</span><span class="refAuthor">, and E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Thubert, P., Ed.</span>, <span class="refAuthor">Perkins, C.E.</span>, and <span class="refAuthor">E. Levy-Abegnoli</span>, <span class="refTitle">"IPv6 Backbone Router"</span>, <span class="seriesInfo">RFC 8929</span>, <span class="seriesInfo">DOI 10.17487/RFC8929</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8929">https://www.rfc-editor.org/info/rfc8929</a>&gt;</span>. </dd>
2673c2708
< <section id="section-appendix.a">
---
> <section id="appendix-A">
2675c2710
< <a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-addressed-in-t" class="section-name selfRef">Requirements Addressed in This Document</a>
---
> <a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-requirements-addressed-in-t" class="section-name selfRef">Requirements Addressed in This Document</a>
2677,2678c2712,2713
< <p id="section-appendix.a-1">
<       In this section, the requirements of a secure Neighbor Discovery protocol for LLNs are stated.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
---
> <p id="appendix-A-1">
>       In this section, the requirements of a secure Neighbor Discovery protocol for LLNs are stated.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
2680,2681c2715,2716
< <li class="normal" id="section-appendix.a-2.1">
<        The protocol <span class="bcp14">MUST</span> be based on the Neighbor Discovery Optimization for the LLN protocol defined in <span>[<a href="#RFC6775" class="xref">RFC6775</a>]</span>. RFC 6775 utilizes optimizations such as host-initiated interactions for sleeping resource-constrained hosts and the elimination of multicast address resolution.<a href="#section-appendix.a-2.1" class="pilcrow">¶</a>
---
> <li class="normal" id="appendix-A-2.1">
>        The protocol <span class="bcp14">MUST</span> be based on the Neighbor Discovery Optimization for the LLN protocol defined in <span>[<a href="#RFC6775" class="cite xref">RFC6775</a>]</span>. RFC 6775 utilizes optimizations such as host-initiated interactions for sleeping resource-constrained hosts and the elimination of multicast address resolution.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
2683,2684c2718,2719
<         <li class="normal" id="section-appendix.a-2.2">
<         New options to be added to Neighbor Solicitation messages <span class="bcp14">MUST</span> lead to small packet sizes, especially compared with existing protocols such as SEND. Smaller packet sizes facilitate low-power transmission by resource-constrained nodes on lossy links.<a href="#section-appendix.a-2.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-A-2.2">
>         New options to be added to Neighbor Solicitation messages <span class="bcp14">MUST</span> lead to small packet sizes, especially compared with existing protocols such as SEND. Smaller packet sizes facilitate low-power transmission by resource-constrained nodes on lossy links.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
2686,2687c2721,2722
<         <li class="normal" id="section-appendix.a-2.3">
<         The registration mechanism <span class="bcp14">SHOULD</span> be extensible to other LLN links and not be limited to IEEE 802.15.4 only. LLN links for which a 6lo "IPv6 over foo" specification exist, as well as low-power Wi-Fi, <span class="bcp14">SHOULD</span> be supported.<a href="#section-appendix.a-2.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-A-2.3">
>         The registration mechanism <span class="bcp14">SHOULD</span> be extensible to other LLN links and not be limited to IEEE 802.15.4 only. LLN links for which a 6lo "IPv6 over foo" specification exist, as well as low-power Wi-Fi, <span class="bcp14">SHOULD</span> be supported.<a href="#appendix-A-2.3" class="pilcrow">¶</a>
2689,2690c2724,2725
<         <li class="normal" id="section-appendix.a-2.4">
<         As part of this protocol, a mechanism to compute a unique identifier should be provided with the capability to form a Link Local Address that <span class="bcp14">SHOULD</span> be unique at least within the LLN connected to a 6LBR.<a href="#section-appendix.a-2.4" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-A-2.4">
>         As part of this protocol, a mechanism to compute a unique identifier should be provided with the capability to form a Link Local Address that <span class="bcp14">SHOULD</span> be unique at least within the LLN connected to a 6LBR.<a href="#appendix-A-2.4" class="pilcrow">¶</a>
2692c2727
<         <li class="normal" id="section-appendix.a-2.5">
---
>         <li class="normal" id="appendix-A-2.5">
2694c2729
<         unique identifier.<a href="#section-appendix.a-2.5" class="pilcrow">¶</a>
---
>         unique identifier.<a href="#appendix-A-2.5" class="pilcrow">¶</a>
2696,2697c2731,2732
<         <li class="normal" id="section-appendix.a-2.6">
<         The Neighbor Discovery should specify the formation of a site-local address that follows the security recommendations from <span>[<a href="#RFC7217" class="xref">RFC7217</a>]</span>.<a href="#section-appendix.a-2.6" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-A-2.6">
>         The Neighbor Discovery should specify the formation of a site-local address that follows the security recommendations from <span>[<a href="#RFC7217" class="cite xref">RFC7217</a>]</span>.<a href="#appendix-A-2.6" class="pilcrow">¶</a>
2703c2738
< <section id="section-appendix.b">
---
> <section id="appendix-B">
2705c2740
< <a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-representation-conventions" class="section-name selfRef">Representation Conventions</a>
---
> <a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-representation-conventions" class="section-name selfRef">Representation Conventions</a>
2707,2717c2742,2752
< <section id="section-b.1">
<         <h2 id="name-signature-schemes">
< <a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-signature-schemes" class="section-name selfRef">Signature Schemes</a>
<         </h2>
< <p id="section-b.1-1"> The signature scheme ECDSA256 corresponding to Crypto-Type 0 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, instantiated with the NIST prime curve P-256,
<  as specified in Appendix D.1.2 of <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this NIST curve are
<  represented as points of a short-Weierstrass curve (see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>) and are encoded as octet strings in most-significant-bit first (msb) and
<  most-significant-byte first (MSB) order. The signature itself consists of two integers (r and s), which are each encoded as fixed-size octet strings in MSB and msb order. For further details, see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> for ECDSA, see <a href="#weirepr" class="xref">Appendix B.3</a> for the encoding of public keys, and see
<         <a href="#bitrepr" class="xref">Appendix B.2</a> for signature encoding.<a href="#section-b.1-1" class="pilcrow">¶</a></p>
< <p id="section-b.1-2"> The signature scheme Ed25519 corresponding to Crypto-Type 1 is EdDSA, as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, instantiated with the Montgomery curve Curve25519, as
<  specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, and the hash function SHA-512, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this Montgomery curve are
---
> <section id="appendix-B.1">
>         <h3 id="name-signature-schemes">
> <a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-signature-schemes" class="section-name selfRef">Signature Schemes</a>
>         </h3>
> <p id="appendix-B.1-1"> The signature scheme ECDSA256 corresponding to Crypto-Type 0 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>, instantiated with the NIST prime curve P-256,
>  as specified in Appendix D.1.2 of <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>, where points of this NIST curve are
>  represented as points of a short-Weierstrass curve (see <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>) and are encoded as octet strings in most-significant-bit first (msb) and
>  most-significant-byte first (MSB) order. The signature itself consists of two integers (r and s), which are each encoded as fixed-size octet strings in MSB and msb order. For further details, see <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> for ECDSA, see <a href="#weirepr" class="auto internal xref">Appendix B.3</a> for the encoding of public keys, and see
>         <a href="#bitrepr" class="auto internal xref">Appendix B.2</a> for signature encoding.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
> <p id="appendix-B.1-2"> The signature scheme Ed25519 corresponding to Crypto-Type 1 is EdDSA, as specified in <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>, instantiated with the Montgomery curve Curve25519, as
>  specified in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>, and the hash function SHA-512, as specified in <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>, where points of this Montgomery curve are
2719c2754
<  curve Edwards25519 (see <a href="#curves" class="xref">Appendix B.4</a>) and are
---
>  curve Edwards25519 (see <a href="#curves" class="auto internal xref">Appendix B.4</a>) and are
2723,2726c2758,2761
<  specification of pure Ed25519 in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-b.1-2" class="pilcrow">¶</a></p>
< <p id="section-b.1-3"> The signature scheme ECDSA25519 corresponding to Crypto-Type 2 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, instantiated with the Montgomery curve
<  Curve25519, as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, where points of this Montgomery
<  curve are represented as points of the corresponding short-Weierstrass curve Wei25519 (see <a href="#curves" class="xref">Appendix B.4</a>) and are encoded as octet strings in
---
>  specification of pure Ed25519 in <span>[<a href="#RFC8032" class="cite xref">RFC8032</a>]</span>.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
> <p id="appendix-B.1-3"> The signature scheme ECDSA25519 corresponding to Crypto-Type 2 is ECDSA, as specified in <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>, instantiated with the Montgomery curve
>  Curve25519, as specified in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>, and the hash function SHA-256, as specified in <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>, where points of this Montgomery
>  curve are represented as points of the corresponding short-Weierstrass curve Wei25519 (see <a href="#curves" class="auto internal xref">Appendix B.4</a>) and are encoded as octet strings in
2728,2729c2763,2764
<  octet strings in MSB and msb order. For further details, see <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span> for ECDSA, see <a href="#weirepr" class="xref">Appendix B.3</a> for the encoding of
<  public keys, and see <a href="#bitrepr" class="xref">Appendix B.2</a> for signature encoding.<a href="#section-b.1-3" class="pilcrow">¶</a></p>
---
>  octet strings in MSB and msb order. For further details, see <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span> for ECDSA, see <a href="#weirepr" class="auto internal xref">Appendix B.3</a> for the encoding of
>  public keys, and see <a href="#bitrepr" class="auto internal xref">Appendix B.2</a> for signature encoding.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
2732,2737c2767,2772
< <section id="section-b.2">
<         <h2 id="name-representation-of-ecdsa-sig">
< <a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-representation-of-ecdsa-sig" class="section-name selfRef">Representation of ECDSA Signatures</a>
<         </h2>
< <p id="section-b.2-1"> With ECDSA, each signature is an ordered pair (r, s) of integers <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, where each integer is represented as a 32-octet string according to the
<  FieldElement-to-OctetString conversion rules in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span> and where the ordered pair of integers is represented as the right concatenation of these representation
---
> <section id="appendix-B.2">
>         <h3 id="name-representation-of-ecdsa-sig">
> <a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-representation-of-ecdsa-sig" class="section-name selfRef">Representation of ECDSA Signatures</a>
>         </h3>
> <p id="appendix-B.2-1"> With ECDSA, each signature is an ordered pair (r, s) of integers <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>, where each integer is represented as a 32-octet string according to the
>  FieldElement-to-OctetString conversion rules in <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span> and where the ordered pair of integers is represented as the right concatenation of these representation
2739c2774
<  string (each a 32-octet string) as the integers r and s, respectively, using the OctetString-to-FieldElement conversion rules in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>. In both cases, the
---
>  string (each a 32-octet string) as the integers r and s, respectively, using the OctetString-to-FieldElement conversion rules in <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>. In both cases, the
2741c2776
<     <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span>.)<a href="#section-b.2-1" class="pilcrow">¶</a></p>
---
>     <span><a href="https://tools.ietf.org/html/draft-ietf-lwig-curve-representations-14#appendix-B.1" class="relref">Appendix B.1</a> of [<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span>.)<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
2745,2752c2780,2787
< <section id="section-b.3">
<         <h2 id="name-representation-of-public-ke">
< <a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-representation-of-public-ke" class="section-name selfRef">Representation of Public Keys Used with ECDSA</a>
<         </h2>
< <p id="section-b.3-1"> ECDSA is specified to be used with elliptic curves in short-Weierstrass form. Each point of such a curve is represented as an octet string using the Elliptic-Curve-Point-to-Octet-String
<         conversion rules in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>, where point compression may be enabled (which is indicated by the leftmost octet of this representation). The inverse
<  operation converts an octet string to a point of this curve using the Octet-String-to-Elliptic-Curve-Point conversion rules in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>, whereby the point is rejected
<  if this is the so-called point at infinity. (This is the case if the input to this inverse operation is an octet string of length 1.)<a href="#section-b.3-1" class="pilcrow">¶</a></p>
---
> <section id="appendix-B.3">
>         <h3 id="name-representation-of-public-ke">
> <a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-representation-of-public-ke" class="section-name selfRef">Representation of Public Keys Used with ECDSA</a>
>         </h3>
> <p id="appendix-B.3-1"> ECDSA is specified to be used with elliptic curves in short-Weierstrass form. Each point of such a curve is represented as an octet string using the Elliptic-Curve-Point-to-Octet-String
>         conversion rules in <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>, where point compression may be enabled (which is indicated by the leftmost octet of this representation). The inverse
>  operation converts an octet string to a point of this curve using the Octet-String-to-Elliptic-Curve-Point conversion rules in <span>[<a href="#SEC1" class="cite xref">SEC1</a>]</span>, whereby the point is rejected
>  if this is the so-called point at infinity. (This is the case if the input to this inverse operation is an octet string of length 1.)<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
2756,2760c2791,2795
< <section id="section-b.4">
<         <h2 id="name-alternative-representations">
< <a href="#section-b.4" class="section-number selfRef">B.4. </a><a href="#name-alternative-representations" class="section-name selfRef">Alternative Representations of Curve25519</a>
<         </h2>
< <p id="section-b.4-1"> The elliptic curve Curve25519, as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, is a so-called Montgomery curve. Each point of this curve can also be represented as a point
---
> <section id="appendix-B.4">
>         <h3 id="name-alternative-representations">
> <a href="#appendix-B.4" class="section-number selfRef">B.4. </a><a href="#name-alternative-representations" class="section-name selfRef">Alternative Representations of Curve25519</a>
>         </h3>
> <p id="appendix-B.4-1"> The elliptic curve Curve25519, as specified in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>, is a so-called Montgomery curve. Each point of this curve can also be represented as a point
2763,2768c2798,2803
<  curve Curve25519 and of the twisted Edwards curve Edwards25519 are as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>; the domain parameters of the elliptic curve Wei25519 in
<  short-Weierstrass form comply with Section 6.1.1 of <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. For further details on these curves and on the coordinate transformations referenced above, see
<  <span>[<a href="#I-D.ietf-lwig-curve-representations" class="xref">CURVE-REPR</a>]</span>.<a href="#section-b.4-1" class="pilcrow">¶</a></p>
< <p id="section-b.4-2"> General parameters (for all curve models):<a href="#section-b.4-2" class="pilcrow">¶</a></p>
< <div id="section-b.4-3">
< <pre class="sourcecode">
---
>  curve Curve25519 and of the twisted Edwards curve Edwards25519 are as specified in <span>[<a href="#RFC7748" class="cite xref">RFC7748</a>]</span>; the domain parameters of the elliptic curve Wei25519 in
>  short-Weierstrass form comply with Section 6.1.1 of <span>[<a href="#FIPS186-4" class="cite xref">FIPS186-4</a>]</span>. For further details on these curves and on the coordinate transformations referenced above, see
>  <span>[<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">CURVE-REPR</a>]</span>.<a href="#appendix-B.4-1" class="pilcrow">¶</a></p>
> <p id="appendix-B.4-2"> General parameters (for all curve models):<a href="#appendix-B.4-2" class="pilcrow">¶</a></p>
> <div class="sourcecode" id="appendix-B.4-3">
> <pre>
2777c2812
< </pre><a href="#section-b.4-3" class="pilcrow">¶</a>
---
> </pre><a href="#appendix-B.4-3" class="pilcrow">¶</a>
2779,2781c2814,2816
< <p id="section-b.4-4"> Montgomery curve-specific parameters (for Curve25519):<a href="#section-b.4-4" class="pilcrow">¶</a></p>
< <div id="section-b.4-5">
< <pre class="sourcecode">
---
> <p id="appendix-B.4-4"> Montgomery curve-specific parameters (for Curve25519):<a href="#appendix-B.4-4" class="pilcrow">¶</a></p>
> <div class="sourcecode" id="appendix-B.4-5">
> <pre>
2790c2825
< </pre><a href="#section-b.4-5" class="pilcrow">¶</a>
---
> </pre><a href="#appendix-B.4-5" class="pilcrow">¶</a>
2792,2794c2827,2829
< <p id="section-b.4-6"> Twisted Edwards curve-specific parameters (for Edwards25519):<a href="#section-b.4-6" class="pilcrow">¶</a></p>
< <div id="section-b.4-7">
< <pre class="sourcecode">
---
> <p id="appendix-B.4-6"> Twisted Edwards curve-specific parameters (for Edwards25519):<a href="#appendix-B.4-6" class="pilcrow">¶</a></p>
> <div class="sourcecode" id="appendix-B.4-7">
> <pre>
2811c2846
< </pre><a href="#section-b.4-7" class="pilcrow">¶</a>
---
> </pre><a href="#appendix-B.4-7" class="pilcrow">¶</a>
2813,2815c2848,2850
< <p id="section-b.4-8"> Weierstrass curve-specific parameters (for Wei25519):<a href="#section-b.4-8" class="pilcrow">¶</a></p>
< <div id="section-b.4-9">
< <pre class="sourcecode">
---
> <p id="appendix-B.4-8"> Weierstrass curve-specific parameters (for Wei25519):<a href="#appendix-B.4-8" class="pilcrow">¶</a></p>
> <div class="sourcecode" id="appendix-B.4-9">
> <pre>
2836c2871
< </pre><a href="#section-b.4-9" class="pilcrow">¶</a>
---
> </pre><a href="#appendix-B.4-9" class="pilcrow">¶</a>
2840,2841c2875,2876
< <section id="section-b.5">
<         <h2 id="name-acknowledgments">
---
> <section id="appendix-B.5">
>         <h3 id="name-acknowledgments">
2843,2844c2878,2879
<         </h2>
< <p id="section-b.5-1">
---
>         </h3>
> <p id="appendix-B.5-1">
2850c2885
<      supported us along the whole process.<a href="#section-b.5-1" class="pilcrow">¶</a></p>
---
>      supported us along the whole process.<a href="#appendix-B.5-1" class="pilcrow">¶</a></p>
2855c2890
< <section id="section-appendix.c">
---
> <section id="appendix-C">
