22c22
< <meta content="xml2rfc 2.41.0" name="generator">
---
> <meta content="xml2rfc 3.18.2" name="generator">
29c29,45
< <link href="rfc8684.xml" rel="alternate" type="application/rfc+xml">
---
> <!-- Generator version information:
>   xml2rfc 3.18.2
>     Python 3.11.6
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 4.9.3
>     platformdirs 4.0.0
>     pycountry 22.3.5
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.12
> -->
> <link href="rfc/rfc8684.xml" rel="alternate" type="application/rfc+xml">
39c55
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
48a65,70
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
51d72
<   width: extend-to-zoom;
66c87
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
68a90
>   overflow-wrap: break-word;
154a177,185
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
169,172d199
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
173a201
>   border: none;
196a225,227
> ul.ulBare, li.ulBare {
>   margin-left: 0em !important;
> }
238c269,270
< a[href].selfRef {
---
> a[href].selfRef,
> .iref + a[href].internal {
248c280
< tt, code, pre, code {
---
> tt, code, pre {
250c282
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
289a322,324
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
379a415,420
> /* Fix PDF info block run off issue */
> @media print {
>   #identifiers dd {
>     float: none;
>   }
> }
481c522
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
621d661
< 
643a684,686
>   .breakable pre {
>     break-inside: auto;
>   }
711c754
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
811c854
< tt, code, pre, code {
---
> tt, code, pre {
816c859
< pre.sourcecode,
---
> .sourcecode pre,
852c895
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
930,935d972
< /* Avoid wrapping of URLs in references */
< @media screen {
<   .references a {
<     white-space: nowrap;
<   }
< }
1039a1077
>   .artwork > pre,
1054c1092
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1060a1099,1101
> tr {
>   break-inside: avoid;
> }
1068a1110,1211
> /* Add support for keepWithNext */
> .keepWithNext {
>   break-after: avoid-page;
>   break-after: avoid-page;
> }
> /* Add support for keepWithPrevious */
> .keepWithPrevious {
>   break-before: avoid-page;
> }
> /* Change the approach to avoiding breaks inside artwork etc. */
> figure, pre, table, .artwork, .sourcecode  {
>   break-before: auto;
>   break-after: auto;
> }
> /* Avoid breaks between <dt> and <dd> */
> dl {
>   break-before: auto;
>   break-inside: auto;
> }
> dt {
>   break-before: auto;
>   break-after: avoid-page;
> }
> dd {
>   break-before: avoid-page;
>   break-after: auto;
>   orphans: 3;
>   widows: 3
> }
> span.break, dd.break {
>   margin-bottom: 0;
>   min-height: 0;
>   break-before: auto;
>   break-inside: auto;
>   break-after: auto;
> }
> /* Undo break-before ToC */
> @media print {
>   #toc {
>     break-before: auto;
>   }
> }
> /* Text in compact lists should not get extra bottom margin space,
>    since that would makes the list not compact */
> ul.compact p, .ulCompact p,
> ol.compact p, .olCompact p {
>  margin: 0;
> }
> /* But the list as a whole needs the extra space at the end */
> section ul.compact,
> section .ulCompact,
> section ol.compact,
> section .olCompact {
>   margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
> }
> /* The tt and code background above interferes with for instance table cell
>    backgrounds.  Changed to something a bit more selective. */
> tt, code {
>   background-color: transparent;
> }
> p tt, p code, li tt, li code {
>   background-color: #f8f8f8;
> }
> /* Tweak the pre margin -- 0px doesn't come out well */
> pre {
>    margin-top: 0.5px;
> }
> /* Tweak the compact list text */
> ul.compact, .ulCompact,
> ol.compact, .olCompact,
> dl.compact, .dlCompact {
>   line-height: normal;
> }
> /* Don't add top margin for nested lists */
> li > ul, li > ol, li > dl,
> dd > ul, dd > ol, dd > dl,
> dl > dd > dl {
>   margin-top: initial;
> }
> /* Elements that should not be rendered on the same line as a <dt> */
> /* This should match the element list in writer.text.TextWriter.render_dl() */
> dd > div.artwork:first-child,
> dd > aside:first-child,
> dd > figure:first-child,
> dd > ol:first-child,
> dd > div.sourcecode:first-child,
> dd > table:first-child,
> dd > ul:first-child {
>   clear: left;
> }
> /* fix for weird browser behaviour when <dd/> is empty */
> dt+dd:empty::before{
>   content: "\00a0";
> }
> /* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
> li > p {
>   margin-bottom: 0.5em
> }
> /* Don't let p margin spill out from inside list items */
> li > p:last-of-type:only-child {
>   margin-bottom: 0;
> }
1070a1214
> <link href="https://datatracker.ietf.org/doc/draft-ietf-mptcp-rfc6824bis-18" rel="prev">
1073c1217
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-mptcp-rfc6824bis-18" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1075,1076c1219,1220
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1189,1197c1333,1341
< <nav class="toc"><ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.1">
<             <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
<                 <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-design-assumptions" class="xref">Design Assumptions</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
< </li>
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
<                 <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-multipath-tcp-in-the-networ" class="xref">Multipath TCP in the Networking Stack</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
---
> <nav class="toc"><ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
>                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-design-assumptions" class="internal xref">Design Assumptions</a></p>
> </li>
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
>                 <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-multipath-tcp-in-the-networ" class="internal xref">Multipath TCP in the Networking Stack</a></p>
1199,1200c1343,1344
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.3">
<                 <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
>                 <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
1202,1203c1346,1347
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.4">
<                 <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-mptcp-concept" class="xref">MPTCP Concept</a><a href="#section-toc.1-1.1.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
>                 <p id="section-toc.1-1.1.2.4.1" class="keepWithNext"><a href="#section-1.4" class="auto internal xref">1.4</a>.  <a href="#name-mptcp-concept" class="internal xref">MPTCP Concept</a></p>
1205,1206c1349,1350
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.5">
<                 <p id="section-toc.1-1.1.2.5.1"><a href="#section-1.5" class="xref">1.5</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.1.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.5">
>                 <p id="section-toc.1-1.1.2.5.1" class="keepWithNext"><a href="#section-1.5" class="auto internal xref">1.5</a>.  <a href="#name-requirements-language" class="internal xref">Requirements Language</a></p>
1210,1214c1354,1358
< <li class="toc ulEmpty" id="section-toc.1-1.2">
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-operation-overview" class="xref">Operation Overview</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
<                 <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-initiating-an-mptcp-connect" class="xref">Initiating an MPTCP Connection</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
>             <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-operation-overview" class="internal xref">Operation Overview</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
>                 <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-initiating-an-mptcp-connect" class="internal xref">Initiating an MPTCP Connection</a></p>
1216,1217c1360,1361
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
<                 <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-associating-a-new-subflow-w" class="xref">Associating a New Subflow with an Existing MPTCP Connection</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
>                 <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-associating-a-new-subflow-w" class="internal xref">Associating a New Subflow with an Existing MPTCP Connection</a></p>
1219,1220c1363,1364
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
<                 <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-informing-the-other-host-ab" class="xref">Informing the Other Host about Another Potential Address</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
>                 <p id="section-toc.1-1.2.2.3.1" class="keepWithNext"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-informing-the-other-host-ab" class="internal xref">Informing the Other Host about Another Potential Address</a></p>
1222,1223c1366,1367
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
<                 <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-data-transfer-using-mptcp" class="xref">Data Transfer Using MPTCP</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
>                 <p id="section-toc.1-1.2.2.4.1" class="keepWithNext"><a href="#section-2.4" class="auto internal xref">2.4</a>.  <a href="#name-data-transfer-using-mptcp" class="internal xref">Data Transfer Using MPTCP</a></p>
1225,1226c1369,1370
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.5">
<                 <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-requesting-a-change-in-a-pa" class="xref">Requesting a Change in a Path's Priority</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
>                 <p id="section-toc.1-1.2.2.5.1" class="keepWithNext"><a href="#section-2.5" class="auto internal xref">2.5</a>.  <a href="#name-requesting-a-change-in-a-pa" class="internal xref">Requesting a Change in a Path's Priority</a></p>
1228,1229c1372,1373
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.6">
<                 <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-closing-an-mptcp-connection" class="xref">Closing an MPTCP Connection</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
>                 <p id="section-toc.1-1.2.2.6.1" class="keepWithNext"><a href="#section-2.6" class="auto internal xref">2.6</a>.  <a href="#name-closing-an-mptcp-connection" class="internal xref">Closing an MPTCP Connection</a></p>
1231,1232c1375,1376
< <li class="toc ulEmpty" id="section-toc.1-1.2.2.7">
<                 <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-notable-features" class="xref">Notable Features</a><a href="#section-toc.1-1.2.2.7.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
>                 <p id="section-toc.1-1.2.2.7.1" class="keepWithNext"><a href="#section-2.7" class="auto internal xref">2.7</a>.  <a href="#name-notable-features" class="internal xref">Notable Features</a></p>
1236,1240c1380,1384
< <li class="toc ulEmpty" id="section-toc.1-1.3">
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-mptcp-operations-an-overvie" class="xref">MPTCP Operations: An Overview</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
<                 <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-connection-initiation" class="xref">Connection Initiation</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
>             <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-mptcp-operations-an-overvie" class="internal xref">MPTCP Operations: An Overview</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
>                 <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-connection-initiation" class="internal xref">Connection Initiation</a></p>
1242,1243c1386,1387
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
<                 <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-starting-a-new-subflow" class="xref">Starting a New Subflow</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
>                 <p id="section-toc.1-1.3.2.2.1" class="keepWithNext"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-starting-a-new-subflow" class="internal xref">Starting a New Subflow</a></p>
1245,1249c1389,1393
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
<                 <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-mptcp-operation-and-data-tr" class="xref">MPTCP Operation and Data Transfer</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.1">
<                     <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-data-sequence-mapping" class="xref">Data Sequence Mapping</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
>                 <p id="section-toc.1-1.3.2.3.1" class="keepWithNext"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-mptcp-operation-and-data-tr" class="internal xref">MPTCP Operation and Data Transfer</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
>                     <p id="section-toc.1-1.3.2.3.2.1.1" class="keepWithNext"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-data-sequence-mapping" class="internal xref">Data Sequence Mapping</a></p>
1251,1252c1395,1396
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.2">
<                     <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-data-acknowledgments" class="xref">Data Acknowledgments</a><a href="#section-toc.1-1.3.2.3.2.2.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
>                     <p id="section-toc.1-1.3.2.3.2.2.1" class="keepWithNext"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-data-acknowledgments" class="internal xref">Data Acknowledgments</a></p>
1254,1255c1398,1399
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.3">
<                     <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-closing-a-connection" class="xref">Closing a Connection</a><a href="#section-toc.1-1.3.2.3.2.3.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
>                     <p id="section-toc.1-1.3.2.3.2.3.1" class="keepWithNext"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-closing-a-connection" class="internal xref">Closing a Connection</a></p>
1257,1258c1401,1402
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.4">
<                     <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-receiver-considerations" class="xref">Receiver Considerations</a><a href="#section-toc.1-1.3.2.3.2.4.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
>                     <p id="section-toc.1-1.3.2.3.2.4.1" class="keepWithNext"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-receiver-considerations" class="internal xref">Receiver Considerations</a></p>
1260,1261c1404,1405
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.5">
<                     <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-sender-considerations" class="xref">Sender Considerations</a><a href="#section-toc.1-1.3.2.3.2.5.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
>                     <p id="section-toc.1-1.3.2.3.2.5.1" class="keepWithNext"><a href="#section-3.3.5" class="auto internal xref">3.3.5</a>.  <a href="#name-sender-considerations" class="internal xref">Sender Considerations</a></p>
1263,1264c1407,1408
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.6">
<                     <p id="section-toc.1-1.3.2.3.2.6.1"><a href="#section-3.3.6" class="xref">3.3.6</a>.  <a href="#name-reliability-and-retransmiss" class="xref">Reliability and Retransmissions</a><a href="#section-toc.1-1.3.2.3.2.6.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
>                     <p id="section-toc.1-1.3.2.3.2.6.1" class="keepWithNext"><a href="#section-3.3.6" class="auto internal xref">3.3.6</a>.  <a href="#name-reliability-and-retransmiss" class="internal xref">Reliability and Retransmissions</a></p>
1266,1267c1410,1411
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.7">
<                     <p id="section-toc.1-1.3.2.3.2.7.1"><a href="#section-3.3.7" class="xref">3.3.7</a>.  <a href="#name-congestion-control-consider" class="xref">Congestion Control Considerations</a><a href="#section-toc.1-1.3.2.3.2.7.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.7">
>                     <p id="section-toc.1-1.3.2.3.2.7.1" class="keepWithNext"><a href="#section-3.3.7" class="auto internal xref">3.3.7</a>.  <a href="#name-congestion-control-consider" class="internal xref">Congestion Control Considerations</a></p>
1269,1270c1413,1414
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.8">
<                     <p id="section-toc.1-1.3.2.3.2.8.1"><a href="#section-3.3.8" class="xref">3.3.8</a>.  <a href="#name-subflow-policy" class="xref">Subflow Policy</a><a href="#section-toc.1-1.3.2.3.2.8.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.8">
>                     <p id="section-toc.1-1.3.2.3.2.8.1" class="keepWithNext"><a href="#section-3.3.8" class="auto internal xref">3.3.8</a>.  <a href="#name-subflow-policy" class="internal xref">Subflow Policy</a></p>
1274,1278c1418,1422
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
<                 <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-address-knowledge-exchange-" class="xref">Address Knowledge Exchange (Path Management)</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.1">
<                     <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-address-advertisement" class="xref">Address Advertisement</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
>                 <p id="section-toc.1-1.3.2.4.1" class="keepWithNext"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-address-knowledge-exchange-" class="internal xref">Address Knowledge Exchange (Path Management)</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
>                     <p id="section-toc.1-1.3.2.4.2.1.1" class="keepWithNext"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-address-advertisement" class="internal xref">Address Advertisement</a></p>
1280,1281c1424,1425
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.2">
<                     <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-remove-address" class="xref">Remove Address</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
>                     <p id="section-toc.1-1.3.2.4.2.2.1" class="keepWithNext"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-remove-address" class="internal xref">Remove Address</a></p>
1285,1286c1429,1430
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
<                 <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-fast-close" class="xref">Fast Close</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
>                 <p id="section-toc.1-1.3.2.5.1" class="keepWithNext"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-fast-close" class="internal xref">Fast Close</a></p>
1288,1289c1432,1433
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.6">
<                 <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-subflow-reset" class="xref">Subflow Reset</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
>                 <p id="section-toc.1-1.3.2.6.1" class="keepWithNext"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-subflow-reset" class="internal xref">Subflow Reset</a></p>
1291,1292c1435,1436
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.7">
<                 <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-fallback" class="xref">Fallback</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
>                 <p id="section-toc.1-1.3.2.7.1" class="keepWithNext"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-fallback" class="internal xref">Fallback</a></p>
1294,1295c1438,1439
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.8">
<                 <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-error-handling" class="xref">Error Handling</a><a href="#section-toc.1-1.3.2.8.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
>                 <p id="section-toc.1-1.3.2.8.1" class="keepWithNext"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-error-handling" class="internal xref">Error Handling</a></p>
1297,1301c1441,1445
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.9">
<                 <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-heuristics" class="xref">Heuristics</a><a href="#section-toc.1-1.3.2.9.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.9.2.1">
<                     <p id="section-toc.1-1.3.2.9.2.1.1"><a href="#section-3.9.1" class="xref">3.9.1</a>.  <a href="#name-port-usage" class="xref">Port Usage</a><a href="#section-toc.1-1.3.2.9.2.1.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9">
>                 <p id="section-toc.1-1.3.2.9.1" class="keepWithNext"><a href="#section-3.9" class="auto internal xref">3.9</a>.  <a href="#name-heuristics" class="internal xref">Heuristics</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.1">
>                     <p id="section-toc.1-1.3.2.9.2.1.1" class="keepWithNext"><a href="#section-3.9.1" class="auto internal xref">3.9.1</a>.  <a href="#name-port-usage" class="internal xref">Port Usage</a></p>
1303,1304c1447,1448
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.9.2.2">
<                     <p id="section-toc.1-1.3.2.9.2.2.1"><a href="#section-3.9.2" class="xref">3.9.2</a>.  <a href="#name-delayed-subflow-start-and-s" class="xref">Delayed Subflow Start and Subflow Symmetry</a><a href="#section-toc.1-1.3.2.9.2.2.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.2">
>                     <p id="section-toc.1-1.3.2.9.2.2.1" class="keepWithNext"><a href="#section-3.9.2" class="auto internal xref">3.9.2</a>.  <a href="#name-delayed-subflow-start-and-s" class="internal xref">Delayed Subflow Start and Subflow Symmetry</a></p>
1306,1307c1450,1451
< <li class="toc ulEmpty" id="section-toc.1-1.3.2.9.2.3">
<                     <p id="section-toc.1-1.3.2.9.2.3.1"><a href="#section-3.9.3" class="xref">3.9.3</a>.  <a href="#name-failure-handling" class="xref">Failure Handling</a><a href="#section-toc.1-1.3.2.9.2.3.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.9.2.3">
>                     <p id="section-toc.1-1.3.2.9.2.3.1" class="keepWithNext"><a href="#section-3.9.3" class="auto internal xref">3.9.3</a>.  <a href="#name-failure-handling" class="internal xref">Failure Handling</a></p>
1313,1314c1457,1458
< <li class="toc ulEmpty" id="section-toc.1-1.4">
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-semantic-issues" class="xref">Semantic Issues</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
>             <p id="section-toc.1-1.4.1" class="keepWithNext"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-semantic-issues" class="internal xref">Semantic Issues</a></p>
1316,1317c1460,1461
< <li class="toc ulEmpty" id="section-toc.1-1.5">
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
>             <p id="section-toc.1-1.5.1" class="keepWithNext"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1319,1320c1463,1464
< <li class="toc ulEmpty" id="section-toc.1-1.6">
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-interactions-with-middlebox" class="xref">Interactions with Middleboxes</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
>             <p id="section-toc.1-1.6.1" class="keepWithNext"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-interactions-with-middlebox" class="internal xref">Interactions with Middleboxes</a></p>
1322,1326c1466,1470
< <li class="toc ulEmpty" id="section-toc.1-1.7">
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-tcp-option-kind-numbers" class="xref">TCP Option Kind Numbers</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
>             <p id="section-toc.1-1.7.1" class="keepWithNext"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
>                 <p id="section-toc.1-1.7.2.1.1" class="keepWithNext"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-tcp-option-kind-numbers" class="internal xref">TCP Option Kind Numbers</a></p>
1328,1329c1472,1473
< <li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
<                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-mptcp-option-subtypes" class="xref">MPTCP Option Subtypes</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
>                 <p id="section-toc.1-1.7.2.2.1" class="keepWithNext"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-mptcp-option-subtypes" class="internal xref">MPTCP Option Subtypes</a></p>
1331,1332c1475,1476
< <li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
<                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-mptcp-handshake-algorithms" class="xref">MPTCP Handshake Algorithms</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
>                 <p id="section-toc.1-1.7.2.3.1" class="keepWithNext"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-mptcp-handshake-algorithms" class="internal xref">MPTCP Handshake Algorithms</a></p>
1334,1335c1478,1479
< <li class="toc ulEmpty" id="section-toc.1-1.7.2.4">
<                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-mp_tcprst-reason-codes" class="xref">MP_TCPRST Reason Codes</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
>                 <p id="section-toc.1-1.7.2.4.1" class="keepWithNext"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-mp_tcprst-reason-codes" class="internal xref">MP_TCPRST Reason Codes</a></p>
1339,1343c1483,1487
< <li class="toc ulEmpty" id="section-toc.1-1.8">
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
>             <p id="section-toc.1-1.8.1" class="keepWithNext"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-references" class="internal xref">References</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
>                 <p id="section-toc.1-1.8.2.1.1" class="keepWithNext"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1345,1346c1489,1490
< <li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
>                 <p id="section-toc.1-1.8.2.2.1" class="keepWithNext"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1350,1351c1494,1495
< <li class="toc ulEmpty" id="section-toc.1-1.9">
<             <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-notes-on-use-of-tcp-options" class="xref">Notes on Use of TCP Options</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
>             <p id="section-toc.1-1.9.1" class="keepWithNext"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-notes-on-use-of-tcp-options" class="internal xref">Notes on Use of TCP Options</a></p>
1353,1357c1497,1501
< <li class="toc ulEmpty" id="section-toc.1-1.10">
<             <p id="section-toc.1-1.10.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-tcp-fast-open-and-mptcp" class="xref">TCP Fast Open and MPTCP</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.10.2.1">
<                 <p id="section-toc.1-1.10.2.1.1"><a href="#section-b.1" class="xref">B.1</a>.  <a href="#name-tfo-cookie-request-with-mpt" class="xref">TFO Cookie Request with MPTCP</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
>             <p id="section-toc.1-1.10.1" class="keepWithNext"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-tcp-fast-open-and-mptcp" class="internal xref">TCP Fast Open and MPTCP</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
>                 <p id="section-toc.1-1.10.2.1.1" class="keepWithNext"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-tfo-cookie-request-with-mpt" class="internal xref">TFO Cookie Request with MPTCP</a></p>
1359,1360c1503,1504
< <li class="toc ulEmpty" id="section-toc.1-1.10.2.2">
<                 <p id="section-toc.1-1.10.2.2.1"><a href="#section-b.2" class="xref">B.2</a>.  <a href="#name-data-sequence-mapping-under" class="xref">Data Sequence Mapping under TFO</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
>                 <p id="section-toc.1-1.10.2.2.1" class="keepWithNext"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-data-sequence-mapping-under" class="internal xref">Data Sequence Mapping under TFO</a></p>
1362,1363c1506,1507
< <li class="toc ulEmpty" id="section-toc.1-1.10.2.3">
<                 <p id="section-toc.1-1.10.2.3.1"><a href="#section-b.3" class="xref">B.3</a>.  <a href="#name-connection-establishment-ex" class="xref">Connection Establishment Examples</a><a href="#section-toc.1-1.10.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
>                 <p id="section-toc.1-1.10.2.3.1" class="keepWithNext"><a href="#appendix-B.3" class="auto internal xref">B.3</a>.  <a href="#name-connection-establishment-ex" class="internal xref">Connection Establishment Examples</a></p>
1367,1374c1511,1518
< <li class="toc ulEmpty" id="section-toc.1-1.11">
<             <p id="section-toc.1-1.11.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-control-blocks" class="xref">Control Blocks</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.1">
<                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-c.1" class="xref">C.1</a>.  <a href="#name-mptcp-control-block" class="xref">MPTCP Control Block</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.1.2.1">
<                     <p id="section-toc.1-1.11.2.1.2.1.1"><a href="#section-c.1.1" class="xref">C.1.1</a>.  <a href="#name-authentication-and-metadata" class="xref">Authentication and Metadata</a><a href="#section-toc.1-1.11.2.1.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
>             <p id="section-toc.1-1.11.1" class="keepWithNext"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-control-blocks" class="internal xref">Control Blocks</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
>                 <p id="section-toc.1-1.11.2.1.1" class="keepWithNext"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-mptcp-control-block" class="internal xref">MPTCP Control Block</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.1">
>                     <p id="section-toc.1-1.11.2.1.2.1.1" class="keepWithNext"><a href="#appendix-C.1.1" class="auto internal xref">C.1.1</a>.  <a href="#name-authentication-and-metadata" class="internal xref">Authentication and Metadata</a></p>
1376,1377c1520,1521
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.1.2.2">
<                     <p id="section-toc.1-1.11.2.1.2.2.1"><a href="#section-c.1.2" class="xref">C.1.2</a>.  <a href="#name-sending-side" class="xref">Sending Side</a><a href="#section-toc.1-1.11.2.1.2.2.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.2">
>                     <p id="section-toc.1-1.11.2.1.2.2.1" class="keepWithNext"><a href="#appendix-C.1.2" class="auto internal xref">C.1.2</a>.  <a href="#name-sending-side" class="internal xref">Sending Side</a></p>
1379,1380c1523,1524
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.1.2.3">
<                     <p id="section-toc.1-1.11.2.1.2.3.1"><a href="#section-c.1.3" class="xref">C.1.3</a>.  <a href="#name-receiving-side" class="xref">Receiving Side</a><a href="#section-toc.1-1.11.2.1.2.3.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1.2.3">
>                     <p id="section-toc.1-1.11.2.1.2.3.1" class="keepWithNext"><a href="#appendix-C.1.3" class="auto internal xref">C.1.3</a>.  <a href="#name-receiving-side" class="internal xref">Receiving Side</a></p>
1384,1388c1528,1532
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.2">
<                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-c.2" class="xref">C.2</a>.  <a href="#name-tcp-control-blocks" class="xref">TCP Control Blocks</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.2.2.1">
<                     <p id="section-toc.1-1.11.2.2.2.1.1"><a href="#section-c.2.1" class="xref">C.2.1</a>.  <a href="#name-sending-side-2" class="xref">Sending Side</a><a href="#section-toc.1-1.11.2.2.2.1.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
>                 <p id="section-toc.1-1.11.2.2.1" class="keepWithNext"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-tcp-control-blocks" class="internal xref">TCP Control Blocks</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.1">
>                     <p id="section-toc.1-1.11.2.2.2.1.1" class="keepWithNext"><a href="#appendix-C.2.1" class="auto internal xref">C.2.1</a>.  <a href="#name-sending-side-2" class="internal xref">Sending Side</a></p>
1390,1391c1534,1535
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.2.2.2">
<                     <p id="section-toc.1-1.11.2.2.2.2.1"><a href="#section-c.2.2" class="xref">C.2.2</a>.  <a href="#name-receiving-side-2" class="xref">Receiving Side</a><a href="#section-toc.1-1.11.2.2.2.2.1" class="pilcrow">¶</a></p>
---
>                   <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2.2.2">
>                     <p id="section-toc.1-1.11.2.2.2.2.1" class="keepWithNext"><a href="#appendix-C.2.2" class="auto internal xref">C.2.2</a>.  <a href="#name-receiving-side-2" class="internal xref">Receiving Side</a></p>
1397,1398c1541,1542
< <li class="toc ulEmpty" id="section-toc.1-1.12">
<             <p id="section-toc.1-1.12.1"><a href="#section-appendix.d" class="xref">Appendix D</a>.  <a href="#name-finite-state-machine" class="xref">Finite State Machine</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
>             <p id="section-toc.1-1.12.1" class="keepWithNext"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-finite-state-machine" class="internal xref">Finite State Machine</a></p>
1400,1401c1544,1545
< <li class="toc ulEmpty" id="section-toc.1-1.13">
<             <p id="section-toc.1-1.13.1"><a href="#section-appendix.e" class="xref">Appendix E</a>.  <a href="#name-changes-from-rfc-6824" class="xref">Changes from RFC 6824</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
>             <p id="section-toc.1-1.13.1" class="keepWithNext"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-changes-from-rfc-6824" class="internal xref">Changes from RFC 6824</a></p>
1403,1404c1547,1548
< <li class="toc ulEmpty" id="section-toc.1-1.14">
<             <p id="section-toc.1-1.14.1"><a href="#section-appendix.f" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
>             <p id="section-toc.1-1.14.1" class="keepWithNext"><a href="#appendix-F" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
1406,1407c1550,1551
< <li class="toc ulEmpty" id="section-toc.1-1.15">
<             <p id="section-toc.1-1.15.1"><a href="#section-appendix.g" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
>             <p id="section-toc.1-1.15.1" class="keepWithNext"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
1418c1562
< <p id="section-1-1">Multipath TCP (MPTCP) is a set of extensions to regular TCP <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span> to provide a Multipath TCP service <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span>, which enables a transport connection to operate across multiple paths
---
> <p id="section-1-1">Multipath TCP (MPTCP) is a set of extensions to regular TCP <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span> to provide a Multipath TCP service <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span>, which enables a transport connection to operate across multiple paths
1423,1425c1567,1569
< <ul>
< <li id="section-1-2.1">
<           <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span> (MPTCP architecture), which
---
> <ul class="normal">
> <li class="normal" id="section-1-2.1">
>           <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span> (MPTCP architecture), which
1429,1430c1573,1574
< <li id="section-1-2.2">
<           <span>[<a href="#RFC6356" class="xref">RFC6356</a>]</span> (congestion control), which presents a safe congestion control algorithm for coupling the behavior of the multiple paths in order to "do no harm" to other network users.<a href="#section-1-2.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-1-2.2">
>           <span>[<a href="#RFC6356" class="cite xref">RFC6356</a>]</span> (congestion control), which presents a safe congestion control algorithm for coupling the behavior of the multiple paths in order to "do no harm" to other network users.<a href="#section-1-2.2" class="pilcrow">¶</a>
1432,1433c1576,1577
< <li id="section-1-2.3">
<           <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span> (application considerations), which discusses what impact MPTCP will have on applications, what applications will want to do with MPTCP, and as a consequence of these factors, what API extensions an MPTCP implementation should present.<a href="#section-1-2.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-1-2.3">
>           <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span> (application considerations), which discusses what impact MPTCP will have on applications, what applications will want to do with MPTCP, and as a consequence of these factors, what API extensions an MPTCP implementation should present.<a href="#section-1-2.3" class="pilcrow">¶</a>
1438c1582
<       Multipath TCP <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>. This document specifies MPTCP v1, which is not backward compatible with MPTCP v0. This document additionally defines version negotiation procedures for implementations that support both versions.<a href="#section-1-3" class="pilcrow">¶</a></p>
---
>       Multipath TCP <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>. This document specifies MPTCP v1, which is not backward compatible with MPTCP v0. This document additionally defines version negotiation procedures for implementations that support both versions.<a href="#section-1-3" class="pilcrow">¶</a></p>
1446,1447c1590,1591
< <ul>
< <li id="section-1.1-2.1">It must be backward compatible with current, regular TCP, to increase its chances of deployment.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-1.1-2.1">It must be backward compatible with current, regular TCP, to increase its chances of deployment.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
1449c1593
< <li id="section-1.1-2.2">It can be assumed that one or both hosts are multihomed and multiaddressed.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-1.1-2.2">It can be assumed that one or both hosts are multihomed and multiaddressed.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
1458c1602
<         congestion control algorithm defined in <span>[<a href="#RFC6356" class="xref">RFC6356</a>]</span> ensures that the use of multiple paths does not act detrimentally.
---
>         congestion control algorithm defined in <span>[<a href="#RFC6356" class="cite xref">RFC6356</a>]</span> ensures that the use of multiple paths does not act detrimentally.
1461c1605
< Equal-Cost Multipath (ECMP) implementations <span>[<a href="#RFC2992" class="xref">RFC2992</a>]</span>), and so the MPTCP design also supports the use of
---
> Equal-Cost Multipath (ECMP) implementations <span>[<a href="#RFC2992" class="cite xref">RFC2992</a>]</span>), and so the MPTCP design also supports the use of
1463,1464c1607,1608
< <p id="section-1.1-4">There are three aspects to the backward compatibility listed above (discussed in more detail in <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span>):<a href="#section-1.1-4" class="pilcrow">¶</a></p>
< <dl class="dlParallel" id="section-1.1-5">
---
> <p id="section-1.1-4">There are three aspects to the backward compatibility listed above (discussed in more detail in <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span>):<a href="#section-1.1-4" class="pilcrow">¶</a></p>
> <span class="break"></span><dl class="dlParallel" id="section-1.1-5">
1470a1615
>           <dd class="break"></dd>
1473a1619
>           <dd class="break"></dd>
1476a1623
>         <dd class="break"></dd>
1478c1625
< <p id="section-1.1-6">The complementary application considerations document <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span> discusses the necessary features
---
> <p id="section-1.1-6">The complementary application considerations document <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span> discusses the necessary features
1480c1627
< <p id="section-1.1-7">Further discussion of the design constraints and associated design decisions is given in the MPTCP architecture document <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span> and in <span>[<a href="#howhard" class="xref">howhard</a>]</span>.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
---
> <p id="section-1.1-7">Further discussion of the design constraints and associated design decisions is given in the MPTCP architecture document <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span> and in <span>[<a href="#howhard" class="cite xref">howhard</a>]</span>.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
1489c1636
< layers. It is a set of additional features on top of standard TCP; <a href="#fig_arch" class="xref">Figure 1</a> illustrates 
---
> layers. It is a set of additional features on top of standard TCP; <a href="#fig_arch" class="auto internal xref">Figure 1</a> illustrates 
1491c1638
< of its interactions with applications is given in <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
---
> of its interactions with applications is given in <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
1494c1641
<           <div class="artwork art-text alignLeft" id="section-1.2-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-1.2-2.1">
1517c1664
< <dl class="dlParallel" id="section-1.3-2">
---
> <span class="break"></span><dl class="dlParallel" id="section-1.3-2">
1520a1668
>           <dd class="break"></dd>
1523a1672
>           <dd class="break"></dd>
1526a1676
>           <dd class="break"></dd>
1529a1680
>           <dd class="break"></dd>
1532a1684
>           <dd class="break"></dd>
1535a1688
>         <dd class="break"></dd>
1538c1691
<         In addition to these terms, note that MPTCP's interpretation of, and effect on, regular single-path TCP semantics are discussed in <a href="#sec_semantics" class="xref">Section 4</a>.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
---
>         In addition to these terms, note that MPTCP's interpretation of, and effect on, regular single-path TCP semantics are discussed in <a href="#sec_semantics" class="auto internal xref">Section 4</a>.<a href="#section-1.3-3" class="pilcrow">¶</a></p>
1547,1548c1700,1701
< <a href="#fig_scenario" class="xref">Figure 2</a>. A detailed description of how
< MPTCP operates is given in <a href="#sec_protocol" class="xref">Section 3</a>.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
---
> <a href="#fig_scenario" class="auto internal xref">Figure 2</a>. A detailed description of how
> MPTCP operates is given in <a href="#sec_protocol" class="auto internal xref">Section 3</a>.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
1551c1704
<           <div class="artwork art-text alignLeft" id="section-1.4-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-1.4-2.1">
1572,1574c1725,1727
< <ul>
< <li id="section-1.4-3.1">To a non-MPTCP-aware application, MPTCP will behave the same as normal TCP. Extended APIs could provide 
< additional control to MPTCP-aware applications <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span>. 
---
> <ul class="normal">
> <li class="normal" id="section-1.4-3.1">To a non-MPTCP-aware application, MPTCP will behave the same as normal TCP. Extended APIs could provide 
> additional control to MPTCP-aware applications <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span>. 
1578,1579c1731,1732
< <li id="section-1.4-3.2">An MPTCP connection begins similarly to a regular TCP connection. This is 
< illustrated in <a href="#fig_scenario" class="xref">Figure 2</a>, where an MPTCP connection is established between 
---
>           <li class="normal" id="section-1.4-3.2">An MPTCP connection begins similarly to a regular TCP connection. This is 
> illustrated in <a href="#fig_scenario" class="auto internal xref">Figure 2</a>, where an MPTCP connection is established between 
1582c1735
< <li id="section-1.4-3.3">If extra paths are available, additional TCP sessions (termed MPTCP "subflows") 
---
>           <li class="normal" id="section-1.4-3.3">If extra paths are available, additional TCP sessions (termed MPTCP "subflows") 
1588c1741
< <li id="section-1.4-3.4">MPTCP identifies multiple paths by the presence of multiple addresses 
---
>           <li class="normal" id="section-1.4-3.4">MPTCP identifies multiple paths by the presence of multiple addresses 
1594c1747
< <li id="section-1.4-3.5">The discovery and setup of additional subflows
---
>           <li class="normal" id="section-1.4-3.5">The discovery and setup of additional subflows
1599c1752
< <li id="section-1.4-3.6">MPTCP adds connection-level sequence numbers to allow the reassembly of 
---
>           <li class="normal" id="section-1.4-3.6">MPTCP adds connection-level sequence numbers to allow the reassembly of 
1602c1755
< <li id="section-1.4-3.7">Subflows are terminated as regular TCP connections, with a four‑way FIN
---
>           <li class="normal" id="section-1.4-3.7">Subflows are terminated as regular TCP connections, with a four‑way FIN
1618c1771
<     interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
---
>     interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as
1628c1781
< <p id="section-2-1">This section presents a single description of common MPTCP operation, with reference to the protocol operation. This is a high-level overview of the key functions; the full specification follows in <a href="#sec_protocol" class="xref">Section 3</a>. Extensibility and negotiated features are not discussed here. Considerable reference is made to symbolic names of MPTCP options throughout this section -- these are subtypes of the IANA‑assigned MPTCP option (see <a href="#IANA" class="xref">Section 7</a>), and their formats are defined in the detailed protocol specification provided in <a href="#sec_protocol" class="xref">Section 3</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
---
> <p id="section-2-1">This section presents a single description of common MPTCP operation, with reference to the protocol operation. This is a high-level overview of the key functions; the full specification follows in <a href="#sec_protocol" class="auto internal xref">Section 3</a>. Extensibility and negotiated features are not discussed here. Considerable reference is made to symbolic names of MPTCP options throughout this section -- these are subtypes of the IANA‑assigned MPTCP option (see <a href="#IANA" class="auto internal xref">Section 7</a>), and their formats are defined in the detailed protocol specification provided in <a href="#sec_protocol" class="auto internal xref">Section 3</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
1635,1636c1788,1789
< <p id="section-2.1-1">This is the same signaling as for initiating a normal TCP connection, but the SYN, SYN/ACK, and initial ACK (and data) packets also carry the MP_CAPABLE option. This option has a variable length and serves multiple purposes. Firstly, it verifies whether the remote host supports Multipath TCP; secondly, this option allows the hosts to exchange some information to authenticate the establishment of additional subflows. Further details are given in <a href="#sec_init" class="xref">Section 3.1</a>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.1-2">
---
> <p id="section-2.1-1">This is the same signaling as for initiating a normal TCP connection, but the SYN, SYN/ACK, and initial ACK (and data) packets also carry the MP_CAPABLE option. This option has a variable length and serves multiple purposes. Firstly, it verifies whether the remote host supports Multipath TCP; secondly, this option allows the hosts to exchange some information to authenticate the establishment of additional subflows. Further details are given in <a href="#sec_init" class="auto internal xref">Section 3.1</a>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.1-2">
1648c1801
< <div class="artwork art-text alignLeft" id="section-2.1-4">
---
> <div class="alignLeft art-text artwork" id="section-2.1-4">
1695,1696c1848,1849
<         Message Authentication Code (HMAC) is used for authentication. The HMAC uses the keys exchanged in the MP_CAPABLE handshake and the random numbers (nonces) exchanged in these MP_JOIN options. MP_JOIN also contains flags and an Address ID that can be used to refer to the source address without the sender needing to know if it has been changed by a NAT. Further details are given in <a href="#sec_join" class="xref">Section 3.2</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.2-3">
---
>         Message Authentication Code (HMAC) is used for authentication. The HMAC uses the keys exchanged in the MP_CAPABLE handshake and the random numbers (nonces) exchanged in these MP_JOIN options. MP_JOIN also contains flags and an Address ID that can be used to refer to the source address without the sender needing to know if it has been changed by a NAT. Further details are given in <a href="#sec_join" class="auto internal xref">Section 3.2</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.2-3">
1719,1720c1872,1873
<  -- for example, when a NAT prevents setup in one direction.  In the example below, Host A informs Host B about its alternative IP address⁠/port pair (IP#-A2). Host B may later send an MP_JOIN to this new address. The ADD_ADDR option contains an HMAC to authenticate the address as having been sent from the originator of the connection. The receiver of this option echoes it back to the client to indicate successful receipt. Further details are given in <a href="#sec_add_address" class="xref">Section 3.4.1</a>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.3-3">
---
>  -- for example, when a NAT prevents setup in one direction.  In the example below, Host A informs Host B about its alternative IP address⁠/port pair (IP#-A2). Host B may later send an MP_JOIN to this new address. The ADD_ADDR option contains an HMAC to authenticate the address as having been sent from the originator of the connection. The receiver of this option echoes it back to the client to indicate successful receipt. Further details are given in <a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.3-3">
1739,1740c1892,1893
<  Further details are given in <a href="#sec_remove_addr" class="xref">Section 3.4.2</a>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.3-5">
---
>  Further details are given in <a href="#sec_remove_addr" class="auto internal xref">Section 3.4.2</a>.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.3-5">
1755,1756c1908,1909
< <p id="section-2.4-4">Further details are given in <a href="#sec_generalop" class="xref">Section 3.3</a>.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.4-5">
---
> <p id="section-2.4-4">Further details are given in <a href="#sec_generalop" class="auto internal xref">Section 3.3</a>.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.4-5">
1770,1771c1923,1924
< <p id="section-2.5-1">Hosts can indicate at initial subflow setup whether they wish the subflow to be used as a regular or backup path -- a backup path only being used if there are no regular paths available. During a connection, Host A can request a change in the priority of a subflow through the MP_PRIO signal to Host B. Further details are given in <a href="#sec_policy" class="xref">Section 3.3.8</a>.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.5-2">
---
> <p id="section-2.5-1">Hosts can indicate at initial subflow setup whether they wish the subflow to be used as a regular or backup path -- a backup path only being used if there are no regular paths available. During a connection, Host A can request a change in the priority of a subflow through the MP_PRIO signal to Host B. Further details are given in <a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.5-2">
1783,1784c1936,1937
< <p id="section-2.6-2">When Host A wants to inform Host B that it has no more data to send, it signals this "Data FIN" as part of the DSS (see above). It has the same semantics and behavior as a regular TCP FIN, but at the connection level. Once all the data on the MPTCP connection has been successfully received, this message is acknowledged at the connection level with a Data ACK. Further details are given in <a href="#sec_close" class="xref">Section 3.3.3</a>.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.6-3">
---
> <p id="section-2.6-2">When Host A wants to inform Host B that it has no more data to send, it signals this "Data FIN" as part of the DSS (see above). It has the same semantics and behavior as a regular TCP FIN, but at the connection level. Once all the data on the MPTCP connection has been successfully received, this message is acknowledged at the connection level with a Data ACK. Further details are given in <a href="#sec_close" class="auto internal xref">Section 3.3.3</a>.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.6-3">
1799,1800c1952,1953
<  Both examples are shown in the following diagrams. Further details are given in <a href="#sec_fastclose" class="xref">Section 3.5</a>.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
< <div class="artwork art-text alignLeft" id="section-2.6-5">
---
>  Both examples are shown in the following diagrams. Further details are given in <a href="#sec_fastclose" class="auto internal xref">Section 3.5</a>.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
> <div class="alignLeft art-text artwork" id="section-2.6-5">
1825,1826c1978,1979
< <ul>
< <li id="section-2.7-2.1">To cope with NATs on the path, addresses are referred to by Address IDs, in case the IP packet's source 
---
> <ul class="normal">
> <li class="normal" id="section-2.7-2.1">To cope with NATs on the path, addresses are referred to by Address IDs, in case the IP packet's source 
1830,1831c1983,1984
< <li id="section-2.7-2.2">MPTCP falls back to ordinary TCP if MPTCP operation is not
<  possible -- for example, if one host is not MPTCP capable or if a middlebox alters the payload. This is discussed in <a href="#sec_fallback" class="xref">Section 3.7</a>.<a href="#section-2.7-2.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-2.7-2.2">MPTCP falls back to ordinary TCP if MPTCP operation is not
>  possible -- for example, if one host is not MPTCP capable or if a middlebox alters the payload. This is discussed in <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>.<a href="#section-2.7-2.2" class="pilcrow">¶</a>
1833c1986
< <li id="section-2.7-2.3">To address the threats identified in <span>[<a href="#RFC6181" class="xref">RFC6181</a>]</span>, the following steps are taken: keys are sent in
---
>           <li class="normal" id="section-2.7-2.3">To address the threats identified in <span>[<a href="#RFC6181" class="cite xref">RFC6181</a>]</span>, the following steps are taken: keys are sent in
1835,1836c1988,1989
<           with HMAC-SHA256 (<span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span> using
<           the algorithm in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>) using those keys; and standard
---
>           with HMAC-SHA256 (<span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span> using
>           the algorithm in <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>) using those keys; and standard
1838,1839c1991,1992
<           sequence numbers are in‑window <span>[<a href="#RFC5961" class="xref">RFC5961</a>]</span>).
<  Residual threats to MPTCP v0 were identified in <span>[<a href="#RFC7430" class="xref">RFC7430</a>]</span>, and those affecting the protocol (i.e., modifications to
---
>           sequence numbers are in‑window <span>[<a href="#RFC5961" class="cite xref">RFC5961</a>]</span>).
>  Residual threats to MPTCP v0 were identified in <span>[<a href="#RFC7430" class="cite xref">RFC7430</a>]</span>, and those affecting the protocol (i.e., modifications to
1841c1994
<  Further discussion of security can be found in <a href="#sec_security" class="xref">Section 5</a>.<a href="#section-2.7-2.3" class="pilcrow">¶</a>
---
>  Further discussion of security can be found in <a href="#sec_security" class="auto internal xref">Section 5</a>.<a href="#section-2.7-2.3" class="pilcrow">¶</a>
1854,1855c2007,2008
< <p id="section-3-2">All MPTCP operations are signaled using optional TCP header fields. A single TCP option number ("Kind") has been assigned by IANA for MPTCP (see <a href="#IANA" class="xref">Section 7</a>), and then individual messages will be determined by a "subtype", the values of which are also stored in an IANA registry (and are also listed in <a href="#IANA" class="xref">Section 7</a>). As with all TCP options, the Length field is specified in bytes and includes the 2 bytes of Kind and Length.<a href="#section-3-2" class="pilcrow">¶</a></p>
< <p id="section-3-3">Throughout this document, when reference is made to an MPTCP option by symbolic name, such as "MP_CAPABLE", this refers to a TCP option with the single MPTCP option type, and with the subtype value of the symbolic name as defined in <a href="#IANA" class="xref">Section 7</a>. This subtype is a 4-bit field -- the first 4 bits of the option payload, as shown in <a href="#fig_option" class="xref">Figure 3</a>. The MPTCP messages are defined in the following sections.<a href="#section-3-3" class="pilcrow">¶</a></p>
---
> <p id="section-3-2">All MPTCP operations are signaled using optional TCP header fields. A single TCP option number ("Kind") has been assigned by IANA for MPTCP (see <a href="#IANA" class="auto internal xref">Section 7</a>), and then individual messages will be determined by a "subtype", the values of which are also stored in an IANA registry (and are also listed in <a href="#IANA" class="auto internal xref">Section 7</a>). As with all TCP options, the Length field is specified in bytes and includes the 2 bytes of Kind and Length.<a href="#section-3-2" class="pilcrow">¶</a></p>
> <p id="section-3-3">Throughout this document, when reference is made to an MPTCP option by symbolic name, such as "MP_CAPABLE", this refers to a TCP option with the single MPTCP option type, and with the subtype value of the symbolic name as defined in <a href="#IANA" class="auto internal xref">Section 7</a>. This subtype is a 4-bit field -- the first 4 bits of the option payload, as shown in <a href="#fig_option" class="auto internal xref">Figure 3</a>. The MPTCP messages are defined in the following sections.<a href="#section-3-3" class="pilcrow">¶</a></p>
1858c2011
<         <div class="artwork art-text alignLeft" id="section-3-4.1">
---
>         <div class="alignLeft art-text artwork" id="section-3-4.1">
1881c2034
<       acknowledgment) <span>[<a href="#RFC2018" class="xref">RFC2018</a>]</span>) on a single
---
>       acknowledgment) <span>[<a href="#RFC2018" class="cite xref">RFC2018</a>]</span>) on a single
1885c2038
<       a lost segment <span>[<a href="#RFC5681" class="xref">RFC5681</a>]</span> in regular
---
>       a lost segment <span>[<a href="#RFC5681" class="cite xref">RFC5681</a>]</span> in regular
1891c2044
<       sequence number and acknowledgment number are within the window) <span class="bcp14">MUST</span> be undertaken before processing any MPTCP signals, as described in <span>[<a href="#RFC5961" class="xref">RFC5961</a>]</span>, and initial subflow sequence numbers <span class="bcp14">SHOULD</span> be generated according to the recommendations in <span>[<a href="#RFC6528" class="xref">RFC6528</a>]</span>.<a href="#section-3-7" class="pilcrow">¶</a></p>
---
>       sequence number and acknowledgment number are within the window) <span class="bcp14">MUST</span> be undertaken before processing any MPTCP signals, as described in <span>[<a href="#RFC5961" class="cite xref">RFC5961</a>]</span>, and initial subflow sequence numbers <span class="bcp14">SHOULD</span> be generated according to the recommendations in <span>[<a href="#RFC6528" class="cite xref">RFC6528</a>]</span>.<a href="#section-3-7" class="pilcrow">¶</a></p>
1900c2053
<         (<a href="#tcpm_capable" class="xref">Figure 4</a>). This option declares its
---
>         (<a href="#tcpm_capable" class="auto internal xref">Figure 4</a>). This option declares its
1905c2058
<           <div class="artwork art-text alignLeft" id="section-3.1-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.1-2.1">
1951c2104
<         MP_CAPABLE option is shown in <a href="#tcpm_capable" class="xref">Figure 4</a>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
---
>         MP_CAPABLE option is shown in <a href="#tcpm_capable" class="auto internal xref">Figure 4</a>.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
1953,1954c2106,2107
< <ul>
< <li id="section-3.1-6.1">SYN (A-&gt;B): only the first 4 octets (Length = 4).<a href="#section-3.1-6.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-3.1-6.1">SYN (A-&gt;B): only the first 4 octets (Length = 4).<a href="#section-3.1-6.1" class="pilcrow">¶</a>
1956c2109
< <li id="section-3.1-6.2">SYN/ACK (B-&gt;A): B's key for this connection (Length = 12).<a href="#section-3.1-6.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.1-6.2">SYN/ACK (B-&gt;A): B's key for this connection (Length = 12).<a href="#section-3.1-6.2" class="pilcrow">¶</a>
1958c2111
< <li id="section-3.1-6.3">ACK (no data) (A-&gt;B): A's key followed by B's key (Length = 20).<a href="#section-3.1-6.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.1-6.3">ACK (no data) (A-&gt;B): A's key followed by B's key (Length = 20).<a href="#section-3.1-6.3" class="pilcrow">¶</a>
1960c2113
< <li id="section-3.1-6.4">ACK (with first data) (A-&gt;B): A's key followed by B's key followed by Data-Level Length, and optional Checksum (Length = 22 or 24).<a href="#section-3.1-6.4" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.1-6.4">ACK (with first data) (A-&gt;B): A's key followed by B's key followed by Data-Level Length, and optional Checksum (Length = 22 or 24).<a href="#section-3.1-6.4" class="pilcrow">¶</a>
1964c2117
<         The contents of the option are determined by the SYN and ACK flags of the packet, along with the option's Length field. In <a href="#tcpm_capable" class="xref">Figure 4</a>, "Sender" and "Receiver" refer to the sender or receiver of the TCP packet (which can be either host).<a href="#section-3.1-7" class="pilcrow">¶</a></p>
---
>         The contents of the option are determined by the SYN and ACK flags of the packet, along with the option's Length field. In <a href="#tcpm_capable" class="auto internal xref">Figure 4</a>, "Sender" and "Receiver" refer to the sender or receiver of the TCP packet (which can be either host).<a href="#section-3.1-7" class="pilcrow">¶</a></p>
1971,1972c2124,2125
<         is the only time the key will be sent in the clear on the wire (unless "Fast Close" (<a href="#sec_fastclose" class="xref">Section 3.5</a>) is used); all future subflows will identify the connection using a 32-bit "token". This token is a cryptographic hash of this key. The algorithm for this process is dependent on the authentication algorithm selected; the method of selection is defined later in this section.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
< <p id="section-3.1-10">Upon reception of the initial SYN segment, a stateful server generates a random key and replies with a SYN/ACK. The key's method of generation is implementation specific. The key <span class="bcp14">MUST</span> be hard to guess, and it <span class="bcp14">MUST</span> be unique for the sending host across all its current MPTCP connections. Recommendations for generating random numbers for use in keys are given in <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>. Connections will be indexed at each host by the token (a one-way hash of the key). Therefore, an implementation will require a mapping from each token to the corresponding connection, and in turn to the keys for the connection.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
---
>         is the only time the key will be sent in the clear on the wire (unless "Fast Close" (<a href="#sec_fastclose" class="auto internal xref">Section 3.5</a>) is used); all future subflows will identify the connection using a 32-bit "token". This token is a cryptographic hash of this key. The algorithm for this process is dependent on the authentication algorithm selected; the method of selection is defined later in this section.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
> <p id="section-3.1-10">Upon reception of the initial SYN segment, a stateful server generates a random key and replies with a SYN/ACK. The key's method of generation is implementation specific. The key <span class="bcp14">MUST</span> be hard to guess, and it <span class="bcp14">MUST</span> be unique for the sending host across all its current MPTCP connections. Recommendations for generating random numbers for use in keys are given in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>. Connections will be indexed at each host by the token (a one-way hash of the key). Therefore, an implementation will require a mapping from each token to the corresponding connection, and in turn to the keys for the connection.<a href="#section-3.1-10" class="pilcrow">¶</a></p>
1980c2133
<         subflow handshake mechanism (<a href="#sec_join" class="xref">Section 3.2</a>) will ensure that new subflows only join the
---
>         subflow handshake mechanism (<a href="#sec_join" class="auto internal xref">Section 3.2</a>) will ensure that new subflows only join the
1992c2145
<         (similar to what is done for the TCP sequence number <span>[<a href="#RFC4987" class="xref">RFC4987</a>]</span>).
---
>         (similar to what is done for the TCP sequence number <span>[<a href="#RFC4987" class="cite xref">RFC4987</a>]</span>).
2002c2155
<         MPTCP Data Sequence Signal (DSS) option (<a href="#sec_generalop" class="xref">Section 3.3</a>) containing a DATA_ACK for the MP_CAPABLE (which is
---
>         MPTCP Data Sequence Signal (DSS) option (<a href="#sec_generalop" class="auto internal xref">Section 3.3</a>) containing a DATA_ACK for the MP_CAPABLE (which is
2007c2160
<         Data-Level Length and optional Checksum as shown in <a href="#tcpm_capable" class="xref">Figure 4</a>). If A does not immediately
---
>         Data-Level Length and optional Checksum as shown in <a href="#tcpm_capable" class="auto internal xref">Figure 4</a>). If A does not immediately
2032c2185
<         TCP, as documented in <a href="#sec_fallback" class="xref">Section 3.7</a>.
---
>         TCP, as documented in <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>.
2035c2188
<         the TCP options or by unexpected ACK numbers being present -- the host <span class="bcp14">MUST</span> stop using MPTCP and no longer include MPTCP options in future TCP packets. The other host will then also fall back to regular TCP using the fallback mechanism.  Note that new subflows <span class="bcp14">MUST NOT</span> be established (using the process documented in <a href="#sec_join" class="xref">Section 3.2</a>) until a DSS option has been successfully received across the path (as documented in <a href="#sec_generalop" class="xref">Section 3.3</a>).<a href="#section-3.1-17" class="pilcrow">¶</a></p>
---
>         the TCP options or by unexpected ACK numbers being present -- the host <span class="bcp14">MUST</span> stop using MPTCP and no longer include MPTCP options in future TCP packets. The other host will then also fall back to regular TCP using the fallback mechanism.  Note that new subflows <span class="bcp14">MUST NOT</span> be established (using the process documented in <a href="#sec_join" class="auto internal xref">Section 3.2</a>) until a DSS option has been successfully received across the path (as documented in <a href="#sec_generalop" class="auto internal xref">Section 3.3</a>).<a href="#section-3.1-17" class="pilcrow">¶</a></p>
2039c2192
<         the first octet in the MP_CAPABLE option (<a href="#tcpm_capable" class="xref">Figure 4</a>) define the MPTCP Option Subtype (see <a href="#IANA" class="xref">Section 7</a>; for MP_CAPABLE, this value is
---
>         the first octet in the MP_CAPABLE option (<a href="#tcpm_capable" class="auto internal xref">Figure 4</a>) define the MPTCP Option Subtype (see <a href="#IANA" class="auto internal xref">Section 7</a>; for MP_CAPABLE, this value is
2043c2196
< <dl class="dlParallel" id="section-3.1-20">
---
> <span class="break"></span><dl class="dlParallel" id="section-3.1-20">
2046a2200
>           <dd class="break"></dd>
2051a2206
>           <dd class="break"></dd>
2058a2214
>           <dd class="break"></dd>
2063c2219
<           of HMAC-SHA256 (as defined in <a href="#sec_join" class="xref">Section 3.2</a>).  An implementation that only supports this
---
>           of HMAC-SHA256 (as defined in <a href="#sec_join" class="auto internal xref">Section 3.2</a>).  An implementation that only supports this
2066a2223
>         <dd class="break"></dd>
2069c2226
< <p id="section-3.1-22">The selection of the authentication algorithm also impacts the algorithm used to generate the token and the IDSN. In this specification, with only the SHA-256 algorithm (bit "H") specified and selected, the token <span class="bcp14">MUST</span> be a truncated (most significant 32 bits) SHA-256 hash <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span> of the key. A different, 64-bit truncation (the least significant 64 bits) of the SHA-256 hash of the key <span class="bcp14">MUST</span> be used as the IDSN. Note that the key <span class="bcp14">MUST</span> be hashed in network byte order. Also note that the "least significant" bits <span class="bcp14">MUST</span> be the rightmost bits of the SHA-256 digest, as per <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>. Future specifications of the use of the crypto bits may choose to specify different algorithms for token and IDSN generation.<a href="#section-3.1-22" class="pilcrow">¶</a></p>
---
> <p id="section-3.1-22">The selection of the authentication algorithm also impacts the algorithm used to generate the token and the IDSN. In this specification, with only the SHA-256 algorithm (bit "H") specified and selected, the token <span class="bcp14">MUST</span> be a truncated (most significant 32 bits) SHA-256 hash <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span> of the key. A different, 64-bit truncation (the least significant 64 bits) of the SHA-256 hash of the key <span class="bcp14">MUST</span> be used as the IDSN. Note that the key <span class="bcp14">MUST</span> be hashed in network byte order. Also note that the "least significant" bits <span class="bcp14">MUST</span> be the rightmost bits of the SHA-256 digest, as per <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>. Future specifications of the use of the crypto bits may choose to specify different algorithms for token and IDSN generation.<a href="#section-3.1-22" class="pilcrow">¶</a></p>
2086c2243
<         subflows will use the MP_JOIN option (see <a href="#sec_join" class="xref">Section 3.2</a>) to join the existing connection.<a href="#section-3.1-25" class="pilcrow">¶</a></p>
---
>         subflows will use the MP_JOIN option (see <a href="#sec_join" class="auto internal xref">Section 3.2</a>) to join the existing connection.<a href="#section-3.1-25" class="pilcrow">¶</a></p>
2099c2256
<         <a href="#heuristics" class="xref">Section 3.9</a>).<a href="#section-3.1-26" class="pilcrow">¶</a></p>
---
>         <a href="#heuristics" class="auto internal xref">Section 3.9</a>).<a href="#section-3.1-26" class="pilcrow">¶</a></p>
2112c2269
<         <a href="#sec_fallback" class="xref">Section 3.7</a>.<a href="#section-3.1-27" class="pilcrow">¶</a></p>
---
>         <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>.<a href="#section-3.1-27" class="pilcrow">¶</a></p>
2123c2280
<         until the first data is sent (see <a href="#sec_generalop" class="xref">Section 3.3</a>).<a href="#section-3.1-28" class="pilcrow">¶</a></p>
---
>         until the first data is sent (see <a href="#sec_generalop" class="auto internal xref">Section 3.3</a>).<a href="#section-3.1-28" class="pilcrow">¶</a></p>
2136c2293
<         <a href="#sec_pm" class="xref">Section 3.4</a>. Using this knowledge, a host
---
>         <a href="#sec_pm" class="auto internal xref">Section 3.4</a>. Using this knowledge, a host
2141c2298
<         (see <a href="#heuristics" class="xref">Section 3.9</a> for heuristics).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
---
>         (see <a href="#heuristics" class="auto internal xref">Section 3.9</a> for heuristics).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
2146c2303
<         handshake (<a href="#sec_init" class="xref">Section 3.1</a>), and that handshake also
---
>         handshake (<a href="#sec_init" class="auto internal xref">Section 3.1</a>), and that handshake also
2153c2310
<         <a href="#tcpm_join" class="xref">Figure 5</a>, the initiator sends a token, random
---
>         <a href="#tcpm_join" class="auto internal xref">Figure 5</a>, the initiator sends a token, random
2157c2314
<           <div class="artwork art-text alignLeft" id="section-3.2-5.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.2-5.1">
2175c2332
<         in the initial MP_CAPABLE handshake (<a href="#sec_init" class="xref">Section 3.1</a>).  
---
>         in the initial MP_CAPABLE handshake (<a href="#sec_init" class="auto internal xref">Section 3.1</a>).  
2177c2334
<         option are generated by the SHA-256 algorithm <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, truncated to the most significant 32 bits.  The token
---
>         option are generated by the SHA-256 algorithm <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>, truncated to the most significant 32 bits.  The token
2182c2339
<         cryptographic handshake algorithm, as defined in <a href="#sec_init" class="xref">Section 3.1</a>.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
---
>         cryptographic handshake algorithm, as defined in <a href="#sec_init" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
2186c2343
<         generation of random numbers for this purpose are given in <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
---
>         generation of random numbers for this purpose are given in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
2192c2349
<         The Address ID allows address removal (<a href="#sec_remove_addr" class="xref">Section 3.4.2</a>) 
---
>         The Address ID allows address removal (<a href="#sec_remove_addr" class="auto internal xref">Section 3.4.2</a>) 
2196c2353
<         and address signaling (<a href="#sec_add_address" class="xref">Section 3.4.1</a>),          
---
>         and address signaling (<a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>),          
2215c2372
<  detail in <a href="#sec_policy" class="xref">Section 3.3.8</a>.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
---
>  detail in <a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
2220c2377
<         version of the option is shown in <a href="#tcpm_join2" class="xref">Figure 6</a>. If the token is unknown or the host wants to refuse subflow
---
>         version of the option is shown in <a href="#tcpm_join2" class="auto internal xref">Figure 6</a>. If the token is unknown or the host wants to refuse subflow
2224c2381
<         MP_TCPRST option (<a href="#sec_reset" class="xref">Section 3.6</a>) with an "MPTCP
---
>         MP_TCPRST option (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) with an "MPTCP
2233c2390
<           <div class="artwork art-text alignLeft" id="section-3.2-12.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.2-12.1">
2256,2257c2413,2414
<         specification defines that HMAC as defined in <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span>
<         is used, along with the SHA-256 hash algorithm <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>,
---
>         specification defines that HMAC as defined in <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span>
>         is used, along with the SHA-256 hash algorithm <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>,
2268c2425
<         <a href="#tcpm_join3" class="xref">Figure 7</a>. This data needs to be sent reliably,
---
>         <a href="#tcpm_join3" class="auto internal xref">Figure 7</a>. This data needs to be sent reliably,
2280c2437
<           <div class="artwork art-text alignLeft" id="section-3.2-15.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.2-15.1">
2305c2462
< <p id="section-3.2-17">These various MPTCP options fit together to enable authenticated subflow setup as illustrated in <a href="#fig_tokens" class="xref">Figure 8</a>.<a href="#section-3.2-17" class="pilcrow">¶</a></p>
---
> <p id="section-3.2-17">These various MPTCP options fit together to enable authenticated subflow setup as illustrated in <a href="#fig_tokens" class="auto internal xref">Figure 8</a>.<a href="#section-3.2-17" class="pilcrow">¶</a></p>
2308c2465
<           <div class="artwork art-text alignLeft" id="section-3.2-18.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.2-18.1">
2344c2501
<         (<a href="#sec_reset" class="xref">Section 3.6</a>) should be included.<a href="#section-3.2-19" class="pilcrow">¶</a></p>
---
>         (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) should be included.<a href="#section-3.2-19" class="pilcrow">¶</a></p>
2349c2506
<         (<a href="#sec_reset" class="xref">Section 3.6</a>) on this RST packet with the reason
---
>         (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) on this RST packet with the reason
2371c2528
<         between any pair of ports (but see <a href="#heuristics" class="xref">Section 3.9</a> for
---
>         between any pair of ports (but see <a href="#heuristics" class="auto internal xref">Section 3.9</a> for
2396c2553
< <p id="section-3.3-2">The Data Sequence Mapping and the Data ACK are signaled in the DSS option (<a href="#tcpm_dsn" class="xref">Figure 9</a>). Either or both can be signaled in one DSS, depending on the flags set. The Data Sequence Mapping defines how the sequence space on the subflow maps to the connection level, and the Data ACK acknowledges receipt of data at the connection level. These functions are described in more detail in the following two subsections.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
---
> <p id="section-3.3-2">The Data Sequence Mapping and the Data ACK are signaled in the DSS option (<a href="#tcpm_dsn" class="auto internal xref">Figure 9</a>). Either or both can be signaled in one DSS, depending on the flags set. The Data Sequence Mapping defines how the sequence space on the subflow maps to the connection level, and the Data ACK acknowledges receipt of data at the connection level. These functions are described in more detail in the following two subsections.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
2399c2556
<           <div class="artwork art-text alignLeft" id="section-3.3-3.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.3-3.1">
2420,2421c2577,2578
< <ul>
< <li id="section-3.3-5.1">A = Data ACK present<a href="#section-3.3-5.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-3.3-5.1">A = Data ACK present<a href="#section-3.3-5.1" class="pilcrow">¶</a>
2423c2580
< <li id="section-3.3-5.2">a = Data ACK is 8 octets (if not set, Data ACK is 4 octets)<a href="#section-3.3-5.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.3-5.2">a = Data ACK is 8 octets (if not set, Data ACK is 4 octets)<a href="#section-3.3-5.2" class="pilcrow">¶</a>
2425c2582
< <li id="section-3.3-5.3">M = Data Sequence Number (DSN), Subflow Sequence Number (SSN), Data-Level Length, and Checksum (if negotiated) present<a href="#section-3.3-5.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.3-5.3">M = Data Sequence Number (DSN), Subflow Sequence Number (SSN), Data-Level Length, and Checksum (if negotiated) present<a href="#section-3.3-5.3" class="pilcrow">¶</a>
2427c2584
< <li id="section-3.3-5.4">m = Data Sequence Number is 8 octets (if not set, DSN is 4 octets)<a href="#section-3.3-5.4" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.3-5.4">m = Data Sequence Number is 8 octets (if not set, DSN is 4 octets)<a href="#section-3.3-5.4" class="pilcrow">¶</a>
2435c2592
<         connection-level equivalent of the FIN flag in single-path TCP. A connection is not closed unless there has been a Data FIN exchange, an MP_FASTCLOSE (<a href="#sec_fastclose" class="xref">Section 3.5</a>) message, or an implementation-specific connection-level send timeout. The purpose of the Data FIN and the interactions between this flag, the subflow-level FIN flag, and the Data Sequence Mapping are described in <a href="#sec_close" class="xref">Section 3.3.3</a>.
---
>         connection-level equivalent of the FIN flag in single-path TCP. A connection is not closed unless there has been a Data FIN exchange, an MP_FASTCLOSE (<a href="#sec_fastclose" class="auto internal xref">Section 3.5</a>) message, or an implementation-specific connection-level send timeout. The purpose of the Data FIN and the interactions between this flag, the subflow-level FIN flag, and the Data Sequence Mapping are described in <a href="#sec_close" class="auto internal xref">Section 3.3.3</a>.
2439c2596
<         (see <a href="#sec_init" class="xref">Section 3.1</a>). The presence of the
---
>         (see <a href="#sec_init" class="auto internal xref">Section 3.1</a>). The presence of the
2443c2600
<         RST, as it is not behaving as negotiated. If a checksum is not present when its use has been negotiated, the receiver <span class="bcp14">MUST</span> close the subflow with a RST, as it is considered broken. In both cases, this RST <span class="bcp14">SHOULD</span> be accompanied by an MP_TCPRST option (<a href="#sec_reset" class="xref">Section 3.6</a>) with the reason code for an "MPTCP-specific error".<a href="#section-3.3-8" class="pilcrow">¶</a></p>
---
>         RST, as it is not behaving as negotiated. If a checksum is not present when its use has been negotiated, the receiver <span class="bcp14">MUST</span> close the subflow with a RST, as it is considered broken. In both cases, this RST <span class="bcp14">SHOULD</span> be accompanied by an MP_TCPRST option (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) with the reason code for an "MPTCP-specific error".<a href="#section-3.3-8" class="pilcrow">¶</a></p>
2449c2606
< <p id="section-3.3.1-1">The data stream as a whole can be reassembled through the use of the Data Sequence Mapping components of the DSS option (<a href="#tcpm_dsn" class="xref">Figure 9</a>), which define the 
---
> <p id="section-3.3.1-1">The data stream as a whole can be reassembled through the use of the Data Sequence Mapping components of the DSS option (<a href="#tcpm_dsn" class="auto internal xref">Figure 9</a>), which define the 
2453c2610
<           regular sequence numbers in the TCP header) are only relevant to the subflow. It is expected (but not mandated) that SACK <span>[<a href="#RFC2018" class="xref">RFC2018</a>]</span> will be used at the subflow level to improve efficiency.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
---
>           regular sequence numbers in the TCP header) are only relevant to the subflow. It is expected (but not mandated) that SACK <span>[<a href="#RFC2018" class="cite xref">RFC2018</a>]</span> will be used at the subflow level to improve efficiency.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
2461c2618
<           (PEPs) <span>[<a href="#RFC3135" class="xref">RFC3135</a>]</span>). It
---
>           (PEPs) <span>[<a href="#RFC3135" class="cite xref">RFC3135</a>]</span>). It
2466c2623
<           <a href="#sec_retransmit" class="xref">Section 3.3.6</a>). This would also
---
>           <a href="#sec_retransmit" class="auto internal xref">Section 3.3.6</a>). This would also
2483c2640
<           fallback to regular TCP, as documented in <a href="#sec_fallback" class="xref">Section 3.7</a>, since MPTCP can no longer
---
>           fallback to regular TCP, as documented in <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>, since MPTCP can no longer
2491c2648
< <p id="section-3.3.1-6">The checksum algorithm used is the standard TCP checksum <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>, operating over the data covered by this mapping, along with a pseudo‑header as shown in <a href="#fig_pseudo" class="xref">Figure 10</a>.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
---
> <p id="section-3.3.1-6">The checksum algorithm used is the standard TCP checksum <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span>, operating over the data covered by this mapping, along with a pseudo‑header as shown in <a href="#fig_pseudo" class="auto internal xref">Figure 10</a>.<a href="#section-3.3.1-6" class="pilcrow">¶</a></p>
2494c2651
<             <div class="artwork art-text alignLeft" id="section-3.3.1-7.1">
---
>             <div class="alignLeft art-text artwork" id="section-3.3.1-7.1">
2520c2677
<         (<a href="#sec_dataack" class="xref">Section 3.3.2</a>) because its data sequence
---
>         (<a href="#sec_dataack" class="auto internal xref">Section 3.3.2</a>) because its data sequence
2544c2701
<         (MSL) <span>[<a href="#RFC7323" class="xref">RFC7323</a>]</span>. The lengths of the DSNs used in these
---
>         (MSL) <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>. The lengths of the DSNs used in these
2558c2715
<         described in <a href="#sec_init" class="xref">Section 3.1</a>. This is also required in
---
>         described in <a href="#sec_init" class="auto internal xref">Section 3.1</a>. This is also required in
2574c2731
<         <a href="#sec_fallback" class="xref">Section 3.7</a>). This is achieved by setting
---
>         <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>). This is achieved by setting
2587c2744
<         the DSS option (<a href="#tcpm_dsn" class="xref">Figure 9</a>). The Data ACK
---
>         the DSS option (<a href="#tcpm_dsn" class="auto internal xref">Figure 9</a>). The Data ACK
2605c2762
<         <a href="#sec_rwin" class="xref">Section 3.3.4</a>, the receive window is shared by all
---
>         <a href="#sec_rwin" class="auto internal xref">Section 3.3.4</a>, the receive window is shared by all
2626c2783
<         MP_TCPRST (<a href="#sec_reset" class="xref">Section 3.6</a>) error code.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
---
>         MP_TCPRST (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) error code.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
2654c2811
<           option (<a href="#tcpm_dsn" class="xref">Figure 9</a>)
---
>           option (<a href="#tcpm_dsn" class="auto internal xref">Figure 9</a>)
2673c2830
<           <span class="bcp14">MAY</span> be closed with a RST with an MP_TCPRST (<a href="#sec_reset" class="xref">Section 3.6</a>) error code for "too much outstanding data".<a href="#section-3.3.3-7" class="pilcrow">¶</a></p>
---
>           <span class="bcp14">MAY</span> be closed with a RST with an MP_TCPRST (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) error code for "too much outstanding data".<a href="#section-3.3.3-7" class="pilcrow">¶</a></p>
2680c2837
<           TIME_WAIT states at both the subflow level and the connection level (see <a href="#app_fsm" class="xref">Appendix D</a>). This permits "break-before-make" scenarios where connectivity is lost on all subflows before a new one can be re‑established.<a href="#section-3.3.3-9" class="pilcrow">¶</a></p>
---
>           TIME_WAIT states at both the subflow level and the connection level (see <a href="#app_fsm" class="auto internal xref">Appendix D</a>). This permits "break-before-make" scenarios where connectivity is lost on all subflows before a new one can be re‑established.<a href="#section-3.3.3-9" class="pilcrow">¶</a></p>
2717c2874
<           retransmitted (see <a href="#sec_retransmit" class="xref">Section 3.3.6</a>). A tight
---
>           retransmitted (see <a href="#sec_retransmit" class="auto internal xref">Section 3.3.6</a>). A tight
2773c2930
< (as discussed in <a href="#sec_policy" class="xref">Section 3.3.8</a>). One can imagine aggressive connection-level retransmission policies where every packet lost at the subflow level is retransmitted on
---
> (as discussed in <a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>). One can imagine aggressive connection-level retransmission policies where every packet lost at the subflow level is retransmitted on
2788c2945
<           subflow is performing badly are triggered, this <span class="bcp14">MAY</span> lead to a host resetting the subflow with a RST. However, additional research is required to understand the heuristics of how and when to reset underperforming subflows. For example, a highly asymmetric path may be misdiagnosed as underperforming. A RST for this purpose <span class="bcp14">SHOULD</span> be accompanied by an "Unacceptable performance" MP_TCPRST option (<a href="#sec_reset" class="xref">Section 3.6</a>).<a href="#section-3.3.6-5" class="pilcrow">¶</a></p>
---
>           subflow is performing badly are triggered, this <span class="bcp14">MAY</span> lead to a host resetting the subflow with a RST. However, additional research is required to understand the heuristics of how and when to reset underperforming subflows. For example, a highly asymmetric path may be misdiagnosed as underperforming. A RST for this purpose <span class="bcp14">SHOULD</span> be accompanied by an "Unacceptable performance" MP_TCPRST option (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>).<a href="#section-3.3.6-5" class="pilcrow">¶</a></p>
2799c2956
< One algorithm for achieving this is presented in <span>[<a href="#RFC6356" class="xref">RFC6356</a>]</span>; 
---
> One algorithm for achieving this is presented in <span>[<a href="#RFC6356" class="cite xref">RFC6356</a>]</span>; 
2819c2976
< <p id="section-3.3.8-2">In the typical use case, where the goal is to maximize throughput, all available paths will be used simultaneously for data transfer, using coupled congestion control as described in <span>[<a href="#RFC6356" class="xref">RFC6356</a>]</span>. It is expected, however, that other use cases will appear.<a href="#section-3.3.8-2" class="pilcrow">¶</a></p>
---
> <p id="section-3.3.8-2">In the typical use case, where the goal is to maximize throughput, all available paths will be used simultaneously for data transfer, using coupled congestion control as described in <span>[<a href="#RFC6356" class="cite xref">RFC6356</a>]</span>. It is expected, however, that other use cases will appear.<a href="#section-3.3.8-2" class="pilcrow">¶</a></p>
2824c2981
< requirements such as these are discussed in detail in <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span>.<a href="#section-3.3.8-3" class="pilcrow">¶</a></p>
---
> requirements such as these are discussed in detail in <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span>.<a href="#section-3.3.8-3" class="pilcrow">¶</a></p>
2828c2985
< <p id="section-3.3.8-5">To enable this behavior, the MP_JOIN option (see <a href="#sec_join" class="xref">Section 3.2</a>) contains the "B" bit,
---
> <p id="section-3.3.8-5">To enable this behavior, the MP_JOIN option (see <a href="#sec_join" class="auto internal xref">Section 3.2</a>) contains the "B" bit,
2837c2994
<           in <a href="#tcpm_prio" class="xref">Figure 11</a>, can be used to
---
>           in <a href="#tcpm_prio" class="auto internal xref">Figure 11</a>, can be used to
2841c2998
<             <div class="artwork art-text alignLeft" id="section-3.3.8-7.1">
---
>             <div class="alignLeft art-text artwork" id="section-3.3.8-7.1">
2855c3012
<           with REMOVE_ADDR (<a href="#sec_remove_addr" class="xref">Section 3.4.2</a>) -- for example, to support make-before-break session continuity, where new subflows are added before the previously used subflows are closed.<a href="#section-3.3.8-8" class="pilcrow">¶</a></p>
---
>           with REMOVE_ADDR (<a href="#sec_remove_addr" class="auto internal xref">Section 3.4.2</a>) -- for example, to support make-before-break session continuity, where new subflows are added before the previously used subflows are closed.<a href="#section-3.3.8-8" class="pilcrow">¶</a></p>
2866c3023
< <p id="section-3.4-1">We use the term "path management" to refer to the exchange of information about additional paths between hosts, which in this design is managed by multiple addresses at hosts. For more details regarding the architectural thinking behind this design, see the MPTCP architecture document <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.4-1">We use the term "path management" to refer to the exchange of information about additional paths between hosts, which in this design is managed by multiple addresses at hosts. For more details regarding the architectural thinking behind this design, see the MPTCP architecture document <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
2871c3028
<         <a href="#sec_join" class="xref">Section 3.2</a>), where the initiator has an
---
>         <a href="#sec_join" class="auto internal xref">Section 3.2</a>), where the initiator has an
2883,2884c3040,3041
< <ul>
< <li id="section-3.4-4.1">An MPTCP connection is initially set up between address⁠/port A1 of Host A 
---
> <ul class="normal">
> <li class="normal" id="section-3.4-4.1">An MPTCP connection is initially set up between address⁠/port A1 of Host A 
2895,2896c3052,3053
< <li id="section-3.4-4.2">Simultaneously (or after a timeout), an ADD_ADDR option 
< (<a href="#sec_add_address" class="xref">Section 3.4.1</a>) is sent on an existing subflow, informing 
---
>           <li class="normal" id="section-3.4-4.2">Simultaneously (or after a timeout), an ADD_ADDR option 
> (<a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>) is sent on an existing subflow, informing 
2903c3060
< <li id="section-3.4-4.3">If subflow A2-B1 is successfully set up, Host B can use the Address ID in 
---
>           <li class="normal" id="section-3.4-4.3">If subflow A2-B1 is successfully set up, Host B can use the Address ID in 
2921c3078
< host can be reached (<a href="#tcpm_address" class="xref">Figure 12</a>). 
---
> host can be reached (<a href="#tcpm_address" class="auto internal xref">Figure 12</a>). 
2925c3082
<           checks, e.g., per <span>[<a href="#RFC5961" class="xref">RFC5961</a>]</span>, before
---
>           checks, e.g., per <span>[<a href="#RFC5961" class="cite xref">RFC5961</a>]</span>, before
2929c3086
<             <div class="artwork art-text alignLeft" id="section-3.4.1-2.1">
---
>             <div class="alignLeft art-text artwork" id="section-3.4.1-2.1">
2950c3107
< used to identify MP_JOIN options (see <a href="#sec_join" class="xref">Section 3.2</a>) relating to 
---
> used to identify MP_JOIN options (see <a href="#sec_join" class="auto internal xref">Section 3.2</a>) relating to 
2967c3124
< <p id="section-3.4.1-5">This option is shown in <a href="#tcpm_address" class="xref">Figure 12</a>. The illustration is sized for
---
> <p id="section-3.4.1-5">This option is shown in <a href="#tcpm_address" class="auto internal xref">Figure 12</a>. The illustration is sized for
2976c3133
<         on which the ADD_ADDR signal was sent; this is discussed in more detail in <a href="#heuristics" class="xref">Section 3.9</a>.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
---
>         on which the ADD_ADDR signal was sent; this is discussed in more detail in <a href="#heuristics" class="auto internal xref">Section 3.9</a>.<a href="#section-3.4.1-6" class="pilcrow">¶</a></p>
2978c3135
<         calculated in the same way as for MP_JOIN as described in <a href="#sec_join" class="xref">Section 3.2</a>. For this 
---
>         calculated in the same way as for MP_JOIN as described in <a href="#sec_join" class="auto internal xref">Section 3.2</a>. For this 
2980c3137
<         defined in <span>[<a href="#RFC2104" class="xref">RFC2104</a>]</span>, using the SHA-256 hash algorithm <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>.
---
>         defined in <span>[<a href="#RFC2104" class="cite xref">RFC2104</a>]</span>, using the SHA-256 hash algorithm <span>[<a href="#RFC6234" class="cite xref">RFC6234</a>]</span>.
3003c3160
<           one host may attempt to advertise private addresses <span>[<a href="#RFC1918" class="xref">RFC1918</a>]</span>. It is not desirable to prohibit
---
>           one host may attempt to advertise private addresses <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span>. It is not desirable to prohibit
3007c3164
<           to create a new subflow (<a href="#sec_join" class="xref">Section 3.2</a>)
---
>           to create a new subflow (<a href="#sec_join" class="auto internal xref">Section 3.2</a>)
3017c3174
<  Further security considerations around the issue of ADD_ADDR messages that accidentally misdirect, or maliciously direct, new MP_JOIN attempts are discussed in <a href="#sec_security" class="xref">Section 5</a>.<a href="#section-3.4.1-10" class="pilcrow">¶</a></p>
---
>  Further security considerations around the issue of ADD_ADDR messages that accidentally misdirect, or maliciously direct, new MP_JOIN attempts are discussed in <a href="#sec_security" class="auto internal xref">Section 5</a>.<a href="#section-3.4.1-10" class="pilcrow">¶</a></p>
3023,3024c3180,3181
< <p id="section-3.4.1-13">A host wishing to replace an existing Address ID <span class="bcp14">MUST</span> first remove the existing one (<a href="#sec_remove_addr" class="xref">Section 3.4.2</a>).<a href="#section-3.4.1-13" class="pilcrow">¶</a></p>
< <p id="section-3.4.1-14">During normal MPTCP operation, it is unlikely that there will be sufficient TCP option space for ADD_ADDR to be included along with those for data sequence numbering (<a href="#sec_dsn" class="xref">Section 3.3.1</a>). Therefore, it is expected that an MPTCP implementation will send the ADD_ADDR option on separate ACKs. As discussed earlier, however, an MPTCP implementation <span class="bcp14">MUST NOT</span> treat duplicate ACKs with any MPTCP option, with the exception of the DSS option, as indications of congestion <span>[<a href="#RFC5681" class="xref">RFC5681</a>]</span>, and an MPTCP implementation <span class="bcp14">SHOULD NOT</span> send more than two duplicate ACKs in a row for signaling purposes.<a href="#section-3.4.1-14" class="pilcrow">¶</a></p>
---
> <p id="section-3.4.1-13">A host wishing to replace an existing Address ID <span class="bcp14">MUST</span> first remove the existing one (<a href="#sec_remove_addr" class="auto internal xref">Section 3.4.2</a>).<a href="#section-3.4.1-13" class="pilcrow">¶</a></p>
> <p id="section-3.4.1-14">During normal MPTCP operation, it is unlikely that there will be sufficient TCP option space for ADD_ADDR to be included along with those for data sequence numbering (<a href="#sec_dsn" class="auto internal xref">Section 3.3.1</a>). Therefore, it is expected that an MPTCP implementation will send the ADD_ADDR option on separate ACKs. As discussed earlier, however, an MPTCP implementation <span class="bcp14">MUST NOT</span> treat duplicate ACKs with any MPTCP option, with the exception of the DSS option, as indications of congestion <span>[<a href="#RFC5681" class="cite xref">RFC5681</a>]</span>, and an MPTCP implementation <span class="bcp14">SHOULD NOT</span> send more than two duplicate ACKs in a row for signaling purposes.<a href="#section-3.4.1-14" class="pilcrow">¶</a></p>
3042c3199
<           (<a href="#tcpm_remove" class="xref">Figure 13</a>), which will remove a
---
>           (<a href="#tcpm_remove" class="auto internal xref">Figure 13</a>), which will remove a
3047c3204
<             <div class="artwork art-text alignLeft" id="section-3.4.2-3.1">
---
>             <div class="alignLeft art-text artwork" id="section-3.4.2-3.1">
3064c3221
<           <span>[<a href="#RFC1122" class="xref">RFC1122</a>]</span> on the path, and if a
---
>           <span>[<a href="#RFC1122" class="cite xref">RFC1122</a>]</span> on the path, and if a
3071c3228
<           <span class="bcp14">MAY</span> also use MP_PRIO (<a href="#sec_policy" class="xref">Section 3.3.8</a>) to request that a path no longer be used. Typical TCP validity tests on the subflow (e.g., ensuring
---
>           <span class="bcp14">MAY</span> also use MP_PRIO (<a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>) to request that a path no longer be used. Typical TCP validity tests on the subflow (e.g., ensuring
3081c3238
< <p id="section-3.4.2-7">A subflow that is still functioning <span class="bcp14">MUST</span> be closed with a FIN exchange as in regular TCP, rather than using this option. For more information, see <a href="#sec_close" class="xref">Section 3.3.3</a>.<a href="#section-3.4.2-7" class="pilcrow">¶</a></p>
---
> <p id="section-3.4.2-7">A subflow that is still functioning <span class="bcp14">MUST</span> be closed with a FIN exchange as in regular TCP, rather than using this option. For more information, see <a href="#sec_close" class="auto internal xref">Section 3.3.3</a>.<a href="#section-3.4.2-7" class="pilcrow">¶</a></p>
3103c3260
<         state <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span>. Nevertheless, implementations allow
---
>         state <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span>. Nevertheless, implementations allow
3106c3263
<         the MP_FASTCLOSE. This option is illustrated in <a href="#tcpm_fastclose" class="xref">Figure 14</a>.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
---
>         the MP_FASTCLOSE. This option is illustrated in <a href="#tcpm_fastclose" class="auto internal xref">Figure 14</a>.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
3109c3266
<           <div class="artwork art-text alignLeft" id="section-3.5-3.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.5-3.1">
3128,3129c3285,3286
< <ul>
< <li id="section-3.5-5.1">Option A (ACK): Host A sends an ACK containing the MP_FASTCLOSE
---
> <ul class="normal">
> <li class="normal" id="section-3.5-5.1">Option A (ACK): Host A sends an ACK containing the MP_FASTCLOSE
3135c3292
< <li id="section-3.5-5.2">Option R (RST): Host A sends a RST containing the MP_FASTCLOSE
---
>           <li class="normal" id="section-3.5-5.2">Option R (RST): Host A sends a RST containing the MP_FASTCLOSE
3143,3144c3300,3301
< <ul>
< <li id="section-3.5-7.1">Upon receipt of an ACK with MP_FASTCLOSE by Host B, containing the valid key, Host B answers
---
> <ul class="normal">
> <li class="normal" id="section-3.5-7.1">Upon receipt of an ACK with MP_FASTCLOSE by Host B, containing the valid key, Host B answers
3149c3306
< <li id="section-3.5-7.2">As soon as Host A has received the TCP RST on the remaining subflow, it
---
>           <li class="normal" id="section-3.5-7.2">As soon as Host A has received the TCP RST on the remaining subflow, it
3155c3312
< <li id="section-3.5-7.3">If Host A does not receive a TCP RST in reply to its MP_FASTCLOSE after one
---
>           <li class="normal" id="section-3.5-7.3">If Host A does not receive a TCP RST in reply to its MP_FASTCLOSE after one
3181c3338
<         <span class="bcp14">MAY</span> include the MP_TCPRST option (<a href="#tcpm_reset" class="xref">Figure 15</a>). The host <span class="bcp14">MAY</span> use this information to
---
>         <span class="bcp14">MAY</span> include the MP_TCPRST option (<a href="#tcpm_reset" class="auto internal xref">Figure 15</a>). The host <span class="bcp14">MAY</span> use this information to
3186c3343
<           <div class="artwork art-text alignLeft" id="section-3.6-2.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.6-2.1">
3222,3223c3379,3380
< <ul>
< <li id="section-3.6-6.1">Unspecified error (code 0x00).  This is the default error;
---
> <ul class="normal">
> <li class="normal" id="section-3.6-6.1">Unspecified error (code 0x00).  This is the default error;
3228c3385
< <li id="section-3.6-6.2">MPTCP-specific error (code 0x01).  An error has been detected in the 
---
>           <li class="normal" id="section-3.6-6.2">MPTCP-specific error (code 0x01).  An error has been detected in the 
3233c3390
< <li id="section-3.6-6.3">Lack of resources (code 0x02).  This code indicates that the
---
>           <li class="normal" id="section-3.6-6.3">Lack of resources (code 0x02).  This code indicates that the
3237c3394
< <li id="section-3.6-6.4">Administratively prohibited (code 0x03).  This code indicates that
---
>           <li class="normal" id="section-3.6-6.4">Administratively prohibited (code 0x03).  This code indicates that
3241c3398
< <li id="section-3.6-6.5">Too much outstanding data (code 0x04).  This code indicates that 
---
>           <li class="normal" id="section-3.6-6.5">Too much outstanding data (code 0x04).  This code indicates that 
3248c3405
< <li id="section-3.6-6.6">Unacceptable performance (code 0x05).  This code indicates that
---
>           <li class="normal" id="section-3.6-6.6">Unacceptable performance (code 0x05).  This code indicates that
3252c3409
< <li id="section-3.6-6.7">Middlebox interference (code 0x06).  Middlebox interference has
---
>           <li class="normal" id="section-3.6-6.7">Middlebox interference (code 0x06).  Middlebox interference has
3266c3423
<         middlebox modifications (see <a href="#sec_middleboxes" class="xref">Section 6</a>), but there are still some cases where a subflow
---
>         middlebox modifications (see <a href="#sec_middleboxes" class="auto internal xref">Section 6</a>), but there are still some cases where a subflow
3268c3425
< <p id="section-3.7-2">At the start of an MPTCP connection (i.e., the first subflow), it is important to ensure that the path is fully MPTCP capable and the necessary MPTCP options can reach each host. The handshake as described in <a href="#sec_init" class="xref">Section 3.1</a> <span class="bcp14">SHOULD</span> fall back to regular TCP if either of the SYN messages does not have the MPTCP options: this is the same, and desired, behavior in the case where a host is not MPTCP capable or the path does not support the MPTCP options. When attempting to join an existing MPTCP connection (<a href="#sec_join" class="xref">Section 3.2</a>), if a path is not MPTCP capable and the MPTCP options do not get through on the SYNs, the subflow will be closed according to the MP_JOIN logic.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
---
> <p id="section-3.7-2">At the start of an MPTCP connection (i.e., the first subflow), it is important to ensure that the path is fully MPTCP capable and the necessary MPTCP options can reach each host. The handshake as described in <a href="#sec_init" class="auto internal xref">Section 3.1</a> <span class="bcp14">SHOULD</span> fall back to regular TCP if either of the SYN messages does not have the MPTCP options: this is the same, and desired, behavior in the case where a host is not MPTCP capable or the path does not support the MPTCP options. When attempting to join an existing MPTCP connection (<a href="#sec_join" class="auto internal xref">Section 3.2</a>), if a path is not MPTCP capable and the MPTCP options do not get through on the SYNs, the subflow will be closed according to the MP_JOIN logic.<a href="#section-3.7-2" class="pilcrow">¶</a></p>
3273,3274c3430,3431
< <ul>
< <li id="section-3.7-4.1">A sender <span class="bcp14">MUST</span> include a DSS option with Data Sequence Mapping in every segment until one of the sent segments has been acknowledged with a DSS option containing a Data ACK. Upon reception of the acknowledgment, the sender has the confirmation that the DSS option passes in both directions and may choose to send fewer DSS options than once per segment.<a href="#section-3.7-4.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-3.7-4.1">A sender <span class="bcp14">MUST</span> include a DSS option with Data Sequence Mapping in every segment until one of the sent segments has been acknowledged with a DSS option containing a Data ACK. Upon reception of the acknowledgment, the sender has the confirmation that the DSS option passes in both directions and may choose to send fewer DSS options than once per segment.<a href="#section-3.7-4.1" class="pilcrow">¶</a>
3276,3277c3433,3434
< <li id="section-3.7-4.2">If, however, an ACK is received for data (not just for the SYN)
<         without a DSS option containing a Data ACK, the sender determines that the path is not MPTCP capable. In the case of this occurring on an additional subflow (i.e., one started with MP_JOIN), the host <span class="bcp14">MUST</span> close the subflow with a RST, which <span class="bcp14">SHOULD</span> contain an MP_TCPRST option (<a href="#sec_reset" class="xref">Section 3.6</a>) with a "Middlebox interference" reason code.<a href="#section-3.7-4.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.7-4.2">If, however, an ACK is received for data (not just for the SYN)
>         without a DSS option containing a Data ACK, the sender determines that the path is not MPTCP capable. In the case of this occurring on an additional subflow (i.e., one started with MP_JOIN), the host <span class="bcp14">MUST</span> close the subflow with a RST, which <span class="bcp14">SHOULD</span> contain an MP_TCPRST option (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) with a "Middlebox interference" reason code.<a href="#section-3.7-4.2" class="pilcrow">¶</a>
3279c3436
< <li id="section-3.7-4.3">In the case of such an ACK being received on the first subflow
---
>           <li class="normal" id="section-3.7-4.3">In the case of such an ACK being received on the first subflow
3284c3441
< <li id="section-3.7-4.4">If a subflow breaks during operation, e.g., if it is rerouted and
---
>           <li class="normal" id="section-3.7-4.4">If a subflow breaks during operation, e.g., if it is rerouted and
3291c3448
<         include the MP_TCPRST option (<a href="#sec_reset" class="xref">Section 3.6</a>) with a "Middlebox interference" reason code.<a href="#section-3.7-4.4" class="pilcrow">¶</a>
---
>         include the MP_TCPRST option (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) with a "Middlebox interference" reason code.<a href="#section-3.7-4.4" class="pilcrow">¶</a>
3298c3455
<         in <a href="#sec_generalop" class="xref">Section 3.3</a>, each portion of
---
>         in <a href="#sec_generalop" class="auto internal xref">Section 3.3</a>, each portion of
3318c3475
<         immediately closed with a RST that includes an MP_FAIL option (<a href="#tcpm_fallback" class="xref">Figure 16</a>), which defines the data sequence number at the start of the segment (defined by the Data Sequence Mapping) that had the checksum failure. Note that the MP_FAIL option requires the use of the full 64-bit sequence number, even if 32-bit sequence numbers are normally in use in the DSS signals on the path.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
---
>         immediately closed with a RST that includes an MP_FAIL option (<a href="#tcpm_fallback" class="auto internal xref">Figure 16</a>), which defines the data sequence number at the start of the segment (defined by the Data Sequence Mapping) that had the checksum failure. Note that the MP_FAIL option requires the use of the full 64-bit sequence number, even if 32-bit sequence numbers are normally in use in the DSS signals on the path.<a href="#section-3.7-8" class="pilcrow">¶</a></p>
3321c3478
<           <div class="artwork art-text alignLeft" id="section-3.7-9.1">
---
>           <div class="alignLeft art-text artwork" id="section-3.7-9.1">
3338c3495
<         Failed data <span class="bcp14">MUST NOT</span> be DATA_ACKed and so will be retransmitted on other subflows (<a href="#sec_retransmit" class="xref">Section 3.3.6</a>).<a href="#section-3.7-10" class="pilcrow">¶</a></p>
---
>         Failed data <span class="bcp14">MUST NOT</span> be DATA_ACKed and so will be retransmitted on other subflows (<a href="#sec_retransmit" class="auto internal xref">Section 3.3.6</a>).<a href="#section-3.7-10" class="pilcrow">¶</a></p>
3349c3506
< This infinite mapping will be a DSS option (<a href="#sec_generalop" class="xref">Section 3.3</a>)
---
> This infinite mapping will be a DSS option (<a href="#sec_generalop" class="auto internal xref">Section 3.3</a>)
3376c3533
< <p id="section-3.8-1">In addition to the fallback mechanism described above, the standard classes of TCP errors may need to be handled in an MPTCP‑specific way. Note that changing semantics -- such as the relevance of a RST -- are covered in <a href="#sec_semantics" class="xref">Section 4</a>. Where possible, we do not want to deviate from regular TCP behavior.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
---
> <p id="section-3.8-1">In addition to the fallback mechanism described above, the standard classes of TCP errors may need to be handled in an MPTCP‑specific way. Note that changing semantics -- such as the relevance of a RST -- are covered in <a href="#sec_semantics" class="auto internal xref">Section 4</a>. Where possible, we do not want to deviate from regular TCP behavior.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
3378,3379c3535,3536
< <ul>
< <li id="section-3.8-3.1">Unknown token in MP_JOIN (or HMAC failure in MP_JOIN ACK, or missing MP_JOIN in SYN/ACK response): send RST (analogous to TCP's behavior on an unknown port)<a href="#section-3.8-3.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-3.8-3.1">Unknown token in MP_JOIN (or HMAC failure in MP_JOIN ACK, or missing MP_JOIN in SYN/ACK response): send RST (analogous to TCP's behavior on an unknown port)<a href="#section-3.8-3.1" class="pilcrow">¶</a>
3381c3538
< <li id="section-3.8-3.2">DSN out of window (during normal operation): drop the data; do not send Data ACKs<a href="#section-3.8-3.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.8-3.2">DSN out of window (during normal operation): drop the data; do not send Data ACKs<a href="#section-3.8-3.2" class="pilcrow">¶</a>
3383c3540
< <li id="section-3.8-3.3">Remove request for unknown Address ID: silently ignore<a href="#section-3.8-3.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-3.8-3.3">Remove request for unknown Address ID: silently ignore<a href="#section-3.8-3.3" class="pilcrow">¶</a>
3398,3399c3555,3556
<         <a href="#sec_rwin" class="xref">3.3.4</a> and <a href="#sec_sender" class="xref">3.3.5</a>,
<         and retransmission is discussed in <a href="#sec_retransmit" class="xref">Section 3.3.6</a>.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
---
>         <a href="#sec_rwin" class="auto internal xref">3.3.4</a> and <a href="#sec_sender" class="auto internal xref">3.3.5</a>,
>         and retransmission is discussed in <a href="#sec_retransmit" class="auto internal xref">Section 3.3.6</a>.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
3418c3575
<           <a href="#sec_add_address" class="xref">Section 3.4.1</a>.  It is therefore feasible
---
>           <a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>.  It is therefore feasible
3422c3579
<           the network based on 5-tuples (e.g., some ECMP implementations <span>[<a href="#RFC2992" class="xref">RFC2992</a>]</span>).<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
---
>           the network based on 5-tuples (e.g., some ECMP implementations <span>[<a href="#RFC2992" class="cite xref">RFC2992</a>]</span>).<a href="#section-3.9.1-2" class="pilcrow">¶</a></p>
3476c3633
<           given in <a href="#sec_errors" class="xref">Section 3.8</a>. There are other failure cases, 
---
>           given in <a href="#sec_errors" class="auto internal xref">Section 3.8</a>. There are other failure cases, 
3478c3635
< <p id="section-3.9.3-2">For example, <a href="#sec_init" class="xref">Section 3.1</a> suggests that a host <span class="bcp14">SHOULD</span>
---
> <p id="section-3.9.3-2">For example, <a href="#sec_init" class="auto internal xref">Section 3.1</a> suggests that a host <span class="bcp14">SHOULD</span>
3486c3643
<           <a href="#sec_errors" class="xref">Section 3.8</a> specifies that an incorrect handshake <span class="bcp14">MUST</span>
---
>           <a href="#sec_errors" class="auto internal xref">Section 3.8</a> specifies that an incorrect handshake <span class="bcp14">MUST</span>
3516c3673
< <dl class="dlParallel" id="section-4-2">
---
> <span class="break"></span><dl class="dlParallel" id="section-4-2">
3528a3686
>         <dd class="break"></dd>
3537a3696
>         <dd class="break"></dd>
3544a3704
>         <dd class="break"></dd>
3560a3721
>         <dd class="break"></dd>
3566a3728
>         <dd class="break"></dd>
3572a3735
>         <dd class="break"></dd>
3583a3747
>         <dd class="break"></dd>
3592c3756
<             <span>[<a href="#RFC6897" class="xref">RFC6897</a>]</span>.<a href="#section-4-2.16" class="pilcrow">¶</a>
---
>             <span>[<a href="#RFC6897" class="cite xref">RFC6897</a>]</span>.<a href="#section-4-2.16" class="pilcrow">¶</a>
3593a3758
>       <dd class="break"></dd>
3602c3767
< <p id="section-5-1">As identified in <span>[<a href="#RFC6181" class="xref">RFC6181</a>]</span>, the
---
> <p id="section-5-1">As identified in <span>[<a href="#RFC6181" class="cite xref">RFC6181</a>]</span>, the
3604c3769
<       new classes of threats. In order to prevent these threats, <span>[<a href="#RFC6182" class="xref">RFC6182</a>]</span> presents a set of requirements for a security
---
>       new classes of threats. In order to prevent these threats, <span>[<a href="#RFC6182" class="cite xref">RFC6182</a>]</span> presents a set of requirements for a security
3608,3609c3773,3774
< <ul>
< <li id="section-5-2.1">Provide a mechanism to confirm that the parties in a subflow
---
> <ul class="normal">
> <li class="normal" id="section-5-2.1">Provide a mechanism to confirm that the parties in a subflow
3612c3777
< <li id="section-5-2.2">Provide verification that the peer can receive traffic at a new address before using it as part of a connection.<a href="#section-5-2.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-5-2.2">Provide verification that the peer can receive traffic at a new address before using it as part of a connection.<a href="#section-5-2.2" class="pilcrow">¶</a>
3614c3779
< <li id="section-5-2.3">Provide replay protection, i.e., ensure that a request to add⁠/remove a subflow is "fresh".<a href="#section-5-2.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-5-2.3">Provide replay protection, i.e., ensure that a request to add⁠/remove a subflow is "fresh".<a href="#section-5-2.3" class="pilcrow">¶</a>
3619c3784
<       algorithm, as documented in Sections <a href="#sec_init" class="xref">3.1</a> and <a href="#sec_join" class="xref">3.2</a>.<a href="#section-5-3" class="pilcrow">¶</a></p>
---
>       algorithm, as documented in Sections <a href="#sec_init" class="auto internal xref">3.1</a> and <a href="#sec_join" class="auto internal xref">3.2</a>.<a href="#section-5-3" class="pilcrow">¶</a></p>
3622c3787
<       again over the network (unless used in the Fast Close mechanism (<a href="#sec_fastclose" class="xref">Section 3.5</a>)).  To ease demultiplexing
---
>       again over the network (unless used in the Fast Close mechanism (<a href="#sec_fastclose" class="auto internal xref">Section 3.5</a>)).  To ease demultiplexing
3631c3796
<       single-use random numbers (nonces) at both ends -- this ensures that the HMAC will never be the same on two handshakes. Guidance on generating random numbers suitable for use as keys is given in <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> and discussed in <a href="#sec_init" class="xref">Section 3.1</a>. The nonces are valid for the lifetime of the TCP connection attempt. HMAC is also used to secure the ADD_ADDR option, due to the threats identified in <span>[<a href="#RFC7430" class="xref">RFC7430</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
---
>       single-use random numbers (nonces) at both ends -- this ensures that the HMAC will never be the same on two handshakes. Guidance on generating random numbers suitable for use as keys is given in <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> and discussed in <a href="#sec_init" class="auto internal xref">Section 3.1</a>. The nonces are valid for the lifetime of the TCP connection attempt. HMAC is also used to secure the ADD_ADDR option, due to the threats identified in <span>[<a href="#RFC7430" class="cite xref">RFC7430</a>]</span>.<a href="#section-5-4" class="pilcrow">¶</a></p>
3633,3634c3798,3799
<       to negotiate the use of a particular algorithm allows the deployment of additional crypto mechanisms in the future.  This negotiation would nevertheless be susceptible to a bid-down attack by an on-path active attacker who could modify the crypto capability bits in the response from the receiver to use a less secure crypto mechanism. The security mechanism presented in this document should therefore protect against all forms of flooding and hijacking attacks discussed in <span>[<a href="#RFC6181" class="xref">RFC6181</a>]</span>.<a href="#section-5-5" class="pilcrow">¶</a></p>
< <p id="section-5-6">The version negotiation specified in <a href="#sec_init" class="xref">Section 3.1</a>, if differing MPTCP versions shared a common
---
>       to negotiate the use of a particular algorithm allows the deployment of additional crypto mechanisms in the future.  This negotiation would nevertheless be susceptible to a bid-down attack by an on-path active attacker who could modify the crypto capability bits in the response from the receiver to use a less secure crypto mechanism. The security mechanism presented in this document should therefore protect against all forms of flooding and hijacking attacks discussed in <span>[<a href="#RFC6181" class="cite xref">RFC6181</a>]</span>.<a href="#section-5-5" class="pilcrow">¶</a></p>
> <p id="section-5-6">The version negotiation specified in <a href="#sec_init" class="auto internal xref">Section 3.1</a>, if differing MPTCP versions shared a common
3639c3804
<  Note that an on-path attacker would have access to the raw data, negating any other TCP-level security mechanisms. As also noted in <a href="#app_changelog" class="xref">Appendix E</a>, this document specifies the removal of the AddrID field <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span> in the MP_PRIO option (<a href="#sec_policy" class="xref">Section 3.3.8</a>).
---
>  Note that an on-path attacker would have access to the raw data, negating any other TCP-level security mechanisms. As also noted in <a href="#app_changelog" class="auto internal xref">Appendix E</a>, this document specifies the removal of the AddrID field <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span> in the MP_PRIO option (<a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>).
3646c3811
< <p id="section-5-8">As discussed in <a href="#sec_add_address" class="xref">Section 3.4.1</a>, a host may advertise its private addresses, but these might point to different hosts in the receiver's network. The MP_JOIN handshake (<a href="#sec_join" class="xref">Section 3.2</a>) will ensure that this does not succeed in setting up a subflow to the incorrect host. However, it could still create unwanted TCP handshake traffic. This feature of MPTCP could be a target for denial-of-service exploits, with malicious participants in MPTCP connections encouraging the recipient to target other hosts in the network. Therefore, implementations should consider heuristics (<a href="#heuristics" class="xref">Section 3.9</a>) at both the sender and receiver to reduce the impact of this.<a href="#section-5-8" class="pilcrow">¶</a></p>
---
> <p id="section-5-8">As discussed in <a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>, a host may advertise its private addresses, but these might point to different hosts in the receiver's network. The MP_JOIN handshake (<a href="#sec_join" class="auto internal xref">Section 3.2</a>) will ensure that this does not succeed in setting up a subflow to the incorrect host. However, it could still create unwanted TCP handshake traffic. This feature of MPTCP could be a target for denial-of-service exploits, with malicious participants in MPTCP connections encouraging the recipient to target other hosts in the network. Therefore, implementations should consider heuristics (<a href="#heuristics" class="auto internal xref">Section 3.9</a>) at both the sender and receiver to reduce the impact of this.<a href="#section-5-8" class="pilcrow">¶</a></p>
3648c3813
< <p id="section-5-10">A small security risk could theoretically exist with key reuse, but in order to accomplish a replay attack, both the sender and receiver keys, and the sender and receiver random numbers, in the MP_JOIN handshake (<a href="#sec_join" class="xref">Section 3.2</a>) would have to match.<a href="#section-5-10" class="pilcrow">¶</a></p>
---
> <p id="section-5-10">A small security risk could theoretically exist with key reuse, but in order to accomplish a replay attack, both the sender and receiver keys, and the sender and receiver random numbers, in the MP_JOIN handshake (<a href="#sec_join" class="auto internal xref">Section 3.2</a>) would have to match.<a href="#section-5-10" class="pilcrow">¶</a></p>
3651c3816
<       threat analysis document <span>[<a href="#RFC6181" class="xref">RFC6181</a>]</span>, since attacks
---
>       threat analysis document <span>[<a href="#RFC6181" class="cite xref">RFC6181</a>]</span>, since attacks
3656,3657c3821,3822
< <ul>
< <li id="section-5-13.1">defining a new MPTCP cryptographic algorithm, as negotiated in
---
> <ul class="normal">
> <li class="normal" id="section-5-13.1">defining a new MPTCP cryptographic algorithm, as negotiated in
3664c3829
< <li id="section-5-13.2">defining how to secure data transfer with MPTCP, while not changing the signaling part of the protocol.<a href="#section-5-13.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-5-13.2">defining how to secure data transfer with MPTCP, while not changing the signaling part of the protocol.<a href="#section-5-13.2" class="pilcrow">¶</a>
3666c3831
< <li id="section-5-13.3">defining security that requires more option space, perhaps in
---
>         <li class="normal" id="section-5-13.3">defining security that requires more option space, perhaps in
3668c3833
<         option space (such as those surveyed in <span>[<a href="#I-D.ananth-tcpm-tcpoptext" class="xref">TCPLO</a>]</span>), or perhaps
---
>         option space (such as those surveyed in <span>[<a href="#I-D.ananth-tcpm-tcpoptext" class="cite xref">TCPLO</a>]</span>), or perhaps
3672c3837
< <li id="section-5-13.4">revisiting the working group's decision to exclusively use TCP
---
>         <li class="normal" id="section-5-13.4">revisiting the working group's decision to exclusively use TCP
3678,3679c3843,3844
< <ul>
< <li id="section-5-15.1">available flags in MP_CAPABLE (<a href="#tcpm_capable" class="xref">Figure 4</a>).<a href="#section-5-15.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-5-15.1">available flags in MP_CAPABLE (<a href="#tcpm_capable" class="auto internal xref">Figure 4</a>).<a href="#section-5-15.1" class="pilcrow">¶</a>
3681c3846
< <li id="section-5-15.2">available subtypes in the MPTCP option (<a href="#fig_option" class="xref">Figure 3</a>).<a href="#section-5-15.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-5-15.2">available subtypes in the MPTCP option (<a href="#fig_option" class="auto internal xref">Figure 3</a>).<a href="#section-5-15.2" class="pilcrow">¶</a>
3683c3848
< <li id="section-5-15.3">the Version field in MP_CAPABLE (<a href="#tcpm_capable" class="xref">Figure 4</a>).<a href="#section-5-15.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-5-15.3">the Version field in MP_CAPABLE (<a href="#tcpm_capable" class="auto internal xref">Figure 4</a>).<a href="#section-5-15.3" class="pilcrow">¶</a>
3703,3704c3868,3869
< <p id="section-6-3">MPTCP uses a single new TCP option called "Kind", and all message types are defined by "subtype" values (see <a href="#IANA" class="xref">Section 7</a>). This should reduce the chances of only some types of MPTCP options being passed; instead, the key differing characteristics are different paths and the presence of the SYN flag.<a href="#section-6-3" class="pilcrow">¶</a></p>
< <p id="section-6-4">MPTCP SYN packets on the first subflow of a connection contain the MP_CAPABLE option (<a href="#sec_init" class="xref">Section 3.1</a>). If this is dropped, MPTCP <span class="bcp14">SHOULD</span> fall back to regular TCP. If packets with the MP_JOIN option (<a href="#sec_join" class="xref">Section 3.2</a>) are dropped, the paths will simply not be used.<a href="#section-6-4" class="pilcrow">¶</a></p>
---
> <p id="section-6-3">MPTCP uses a single new TCP option called "Kind", and all message types are defined by "subtype" values (see <a href="#IANA" class="auto internal xref">Section 7</a>). This should reduce the chances of only some types of MPTCP options being passed; instead, the key differing characteristics are different paths and the presence of the SYN flag.<a href="#section-6-3" class="pilcrow">¶</a></p>
> <p id="section-6-4">MPTCP SYN packets on the first subflow of a connection contain the MP_CAPABLE option (<a href="#sec_init" class="auto internal xref">Section 3.1</a>). If this is dropped, MPTCP <span class="bcp14">SHOULD</span> fall back to regular TCP. If packets with the MP_JOIN option (<a href="#sec_join" class="auto internal xref">Section 3.2</a>) are dropped, the paths will simply not be used.<a href="#section-6-4" class="pilcrow">¶</a></p>
3708c3873
<       fall back to regular TCP, as illustrated in <a href="#fig_syn" class="xref">Figure 17</a> and discussed in <a href="#sec_init" class="xref">Section 3.1</a>.<a href="#section-6-5" class="pilcrow">¶</a></p>
---
>       fall back to regular TCP, as illustrated in <a href="#fig_syn" class="auto internal xref">Figure 17</a> and discussed in <a href="#sec_init" class="auto internal xref">Section 3.1</a>.<a href="#section-6-5" class="pilcrow">¶</a></p>
3711c3876
<         <div class="artwork art-text alignLeft" id="section-6-6.1">
---
>         <div class="alignLeft art-text artwork" id="section-6-6.1">
3745,3746c3910,3911
<       in <a href="#sec_fallback" class="xref">Section 3.7</a>.
<         If only some MPTCP options are stripped, behavior is not deterministic. If some Data Sequence Mappings are lost, the connection can continue so long as mappings exist for the subflow-level data (e.g., if multiple maps have been sent that reinforce each other). If some subflow-level space is left unmapped, however, the subflow is treated as broken and is closed, using the process described in <a href="#sec_fallback" class="xref">Section 3.7</a>. MPTCP should survive with a loss of some Data ACKs, but performance will degrade as the fraction of stripped options increases.
---
>       in <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>.
>         If only some MPTCP options are stripped, behavior is not deterministic. If some Data Sequence Mappings are lost, the connection can continue so long as mappings exist for the subflow-level data (e.g., if multiple maps have been sent that reinforce each other). If some subflow-level space is left unmapped, however, the subflow is treated as broken and is closed, using the process described in <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>. MPTCP should survive with a loss of some Data ACKs, but performance will degrade as the fraction of stripped options increases.
3752,3753c3917,3918
< <ul>
< <li id="section-6-11.1">NATs (Network Address (and port) Translators) <span>[<a href="#RFC3022" class="xref">RFC3022</a>]</span> change the source address (and
---
> <ul class="normal">
> <li class="normal" id="section-6-11.1">NATs (Network Address (and port) Translators) <span>[<a href="#RFC3022" class="cite xref">RFC3022</a>]</span> change the source address (and
3756c3921
<     and the handshake mechanism ensures that connection attempts to private addresses <span>[<a href="#RFC1918" class="xref">RFC1918</a>]</span>, since they are authenticated, will only set up subflows to the correct hosts.
---
>     and the handshake mechanism ensures that connection attempts to private addresses <span>[<a href="#RFC1918" class="cite xref">RFC1918</a>]</span>, since they are authenticated, will only set up subflows to the correct hosts.
3759c3924
< <li id="section-6-11.2">Performance Enhancing Proxies (PEPs) <span>[<a href="#RFC3135" class="xref">RFC3135</a>]</span> might proactively ACK data to increase performance. MPTCP, however, relies on accurate congestion control signals from the end host, and non‑MPTCP-aware PEPs will not be able to provide such signals. MPTCP will, therefore, fall back to single-path TCP or close the problematic subflow (see <a href="#sec_fallback" class="xref">Section 3.7</a>).<a href="#section-6-11.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-6-11.2">Performance Enhancing Proxies (PEPs) <span>[<a href="#RFC3135" class="cite xref">RFC3135</a>]</span> might proactively ACK data to increase performance. MPTCP, however, relies on accurate congestion control signals from the end host, and non‑MPTCP-aware PEPs will not be able to provide such signals. MPTCP will, therefore, fall back to single-path TCP or close the problematic subflow (see <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>).<a href="#section-6-11.2" class="pilcrow">¶</a>
3761c3926
< <li id="section-6-11.3">Traffic normalizers <span>[<a href="#norm" class="xref">norm</a>]</span> may not
---
>         <li class="normal" id="section-6-11.3">Traffic normalizers <span>[<a href="#norm" class="cite xref">norm</a>]</span> may not
3765c3930
< <li id="section-6-11.4">Firewalls <span>[<a href="#RFC2979" class="xref">RFC2979</a>]</span> might perform
---
>         <li class="normal" id="section-6-11.4">Firewalls <span>[<a href="#RFC2979" class="cite xref">RFC2979</a>]</span> might perform
3771c3936
< <li id="section-6-11.5">Intrusion Detection Systems / Intrusion Prevention Systems (IDSs⁠/IPSs) observe packet streams for patterns and content that could threaten a network. MPTCP may require the
---
>         <li class="normal" id="section-6-11.5">Intrusion Detection Systems / Intrusion Prevention Systems (IDSs⁠/IPSs) observe packet streams for patterns and content that could threaten a network. MPTCP may require the
3774c3939
< <li id="section-6-11.6">Application-level middleboxes such as content-aware firewalls may
---
>         <li class="normal" id="section-6-11.6">Application-level middleboxes such as content-aware firewalls may
3784,3785c3949,3950
< <ul>
< <li id="section-6-13.1">TCP options may be removed, or packets with unknown options dropped, by many classes of middleboxes. It is intended
---
> <ul class="normal">
> <li class="normal" id="section-6-13.1">TCP options may be removed, or packets with unknown options dropped, by many classes of middleboxes. It is intended
3789c3954
< <li id="section-6-13.2">Segmentation/coalescing (e.g., TCP segmentation offloading) might copy options between packets and might
---
>         <li class="normal" id="section-6-13.2">Segmentation/coalescing (e.g., TCP segmentation offloading) might copy options between packets and might
3793c3958
< <li id="section-6-13.3">The receive window may be shrunk by some middleboxes at the
---
>         <li class="normal" id="section-6-13.3">The receive window may be shrunk by some middleboxes at the
3805c3970
< <p id="section-7-1">This document obsoletes <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>. As such, IANA has updated
---
> <p id="section-7-1">This document obsoletes <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>. As such, IANA has updated
3815c3980
<       for Multipath TCP, as shown in <a href="#table_tcpo" class="xref">Table 1</a>:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
---
>       for Multipath TCP, as shown in <a href="#table_tcpo" class="auto internal xref">Table 1</a>:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
3849c4014
<         registry was defined in <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>. Since <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span> is an
---
>         registry was defined in <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>. Since <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span> is an
3851c4016
<         entries have occurred beyond those pointing to <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>, IANA has
---
>         entries have occurred beyond those pointing to <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>, IANA has
3853c4018
<         <a href="#table_iana" class="xref">Table 2</a> and with the following
---
>         <a href="#table_iana" class="auto internal xref">Table 2</a> and with the following
3855c4020
< <p id="section-7.2-2">Note: This registry specifies the MPTCP Option Subtypes for MPTCP v1, which obsoletes the Experimental MPTCP v0. For the MPTCP v0 subtypes, please refer to <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
---
> <p id="section-7.2-2">Note: This registry specifies the MPTCP Option Subtypes for MPTCP v1, which obsoletes the Experimental MPTCP v0. For the MPTCP v0 subtypes, please refer to <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
3875c4040
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="xref">Section 3.1</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="auto internal xref">Section 3.1</a>
3882c4047
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_join" class="xref">Section 3.2</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_join" class="auto internal xref">Section 3.2</a>
3889c4054
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_generalop" class="xref">Section 3.3</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_generalop" class="auto internal xref">Section 3.3</a>
3896c4061
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_add_address" class="xref">Section 3.4.1</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>
3903c4068
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_remove_addr" class="xref">Section 3.4.2</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_remove_addr" class="auto internal xref">Section 3.4.2</a>
3910c4075
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_policy" class="xref">Section 3.3.8</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>
3917c4082
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_fallback" class="xref">Section 3.7</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_fallback" class="auto internal xref">Section 3.7</a>
3924c4089
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_fastclose" class="xref">Section 3.5</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_fastclose" class="auto internal xref">Section 3.5</a>
3931c4096
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
3943c4108
< <p id="section-7.2-4">Values 0x9 through 0xe are currently unassigned. Option 0xf is reserved for use by private experiments. Its use may be formalized in a future specification. Future assignments in this registry are to be defined by Standards Action as defined by <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.  Assignments consist of the MPTCP subtype's symbolic name, its associated value, and a reference to its specification.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
---
> <p id="section-7.2-4">Values 0x9 through 0xe are currently unassigned. Option 0xf is reserved for use by private experiments. Its use may be formalized in a future specification. Future assignments in this registry are to be defined by Standards Action as defined by <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.  Assignments consist of the MPTCP subtype's symbolic name, its associated value, and a reference to its specification.<a href="#section-7.2-4" class="pilcrow">¶</a></p>
3953c4118
<         in <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>. Since <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span> is an Experimental RFC and not
---
>         in <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>. Since <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span> is an Experimental RFC and not
3955c4120
<         beyond those pointing to <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>, IANA has replaced
---
>         beyond those pointing to <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>, IANA has replaced
3957,3958c4122,4123
<  <a href="#table_crypto" class="xref">Table 3</a> and with the following explanatory note.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
< <p id="section-7.3-2">Note: This registry specifies the MPTCP Handshake Algorithms for MPTCP v1, which obsoletes the Experimental MPTCP v0. For the MPTCP v0 subtypes, please refer to <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
---
>  <a href="#table_crypto" class="auto internal xref">Table 3</a> and with the following explanatory note.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
> <p id="section-7.3-2">Note: This registry specifies the MPTCP Handshake Algorithms for MPTCP v1, which obsoletes the Experimental MPTCP v0. For the MPTCP v0 subtypes, please refer to <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>.<a href="#section-7.3-2" class="pilcrow">¶</a></p>
3976c4141
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="xref">Section 3.1</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="auto internal xref">Section 3.1</a>
3982c4147
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="xref">Section 3.1</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="auto internal xref">Section 3.1</a>
3988c4153
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="xref">Section 3.1</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_init" class="auto internal xref">Section 3.1</a>
3999c4164
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_join" class="xref">Section 3.2</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_join" class="auto internal xref">Section 3.2</a>
4007c4172
<       <a href="#sec_init" class="xref">Section 3.1</a> for more information.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
---
>       <a href="#sec_init" class="auto internal xref">Section 3.1</a> for more information.<a href="#section-7.3-4" class="pilcrow">¶</a></p>
4009c4174
<       to be defined by Standards Action as defined by <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.
---
>       to be defined by Standards Action as defined by <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>.
4021c4186
<         Parameters" registry, based on the reason code in the MP_TCPRST (<a href="#sec_reset" class="xref">Section 3.6</a>) message. Initial values for this registry are given in <a href="#table_rstcodes" class="xref">Table 4</a>; future assignments are to be defined by Specification Required as defined by <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Assignments consist of the value of the code, a short description of its meaning, and a reference to its specification. The maximum value is 0xff.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
---
>         Parameters" registry, based on the reason code in the MP_TCPRST (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>) message. Initial values for this registry are given in <a href="#table_rstcodes" class="auto internal xref">Table 4</a>; future assignments are to be defined by Specification Required as defined by <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Assignments consist of the value of the code, a short description of its meaning, and a reference to its specification. The maximum value is 0xff.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
4039c4204
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4045c4210
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4051c4216
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4057c4222
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4063c4228
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4069c4234
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4075c4240
<               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="xref">Section 3.6</a>
---
>               <td class="text-center" rowspan="1" colspan="1">RFC 8684, <a href="#sec_reset" class="auto internal xref">Section 3.6</a>
4081c4246
< <p id="section-7.4-3">As guidance to the designated expert <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>, assignments should not normally be refused unless
---
> <p id="section-7.4-3">As guidance to the designated expert <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, assignments should not normally be refused unless
4099c4264,4265
< <span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4102c4268,4269
< <span class="refAuthor">Krawczyk, H.</span><span class="refAuthor">, Bellare, M.</span><span class="refAuthor">, and R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Krawczyk, H.</span>, <span class="refAuthor">Bellare, M.</span>, and <span class="refAuthor">R. Canetti</span>, <span class="refTitle">"HMAC: Keyed-Hashing for Message Authentication"</span>, <span class="seriesInfo">RFC 2104</span>, <span class="seriesInfo">DOI 10.17487/RFC2104</span>, <time datetime="1997-02" class="refDate">February 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2104">https://www.rfc-editor.org/info/rfc2104</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4105c4272,4273
< <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4108c4276,4277
< <span class="refAuthor">Ramaiah, A.</span><span class="refAuthor">, Stewart, R.</span><span class="refAuthor">, and M. Dalal</span>, <span class="refTitle">"Improving TCP's Robustness to Blind In-Window Attacks"</span>, <span class="seriesInfo">RFC 5961</span>, <span class="seriesInfo">DOI 10.17487/RFC5961</span>, <time datetime="2010-08">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5961">https://www.rfc-editor.org/info/rfc5961</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Ramaiah, A.</span>, <span class="refAuthor">Stewart, R.</span>, and <span class="refAuthor">M. Dalal</span>, <span class="refTitle">"Improving TCP's Robustness to Blind In-Window Attacks"</span>, <span class="seriesInfo">RFC 5961</span>, <span class="seriesInfo">DOI 10.17487/RFC5961</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5961">https://www.rfc-editor.org/info/rfc5961</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4111c4280,4281
< <span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor"> and T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4114c4284,4285
< <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4124c4295,4296
< <span class="refAuthor">Bonaventure, O.</span><span class="refAuthor"> and S. Seo</span>, <span class="refTitle">"Multipath TCP Deployments"</span>, <span class="seriesInfo">IETF Journal 2016</span>, <time datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.ietfjournal.org/multipath-tcp-deployments/">https://www.ietfjournal.org/multipath-tcp-deployments/</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bonaventure, O.</span> and <span class="refAuthor">S. Seo</span>, <span class="refTitle">"Multipath TCP Deployments"</span>, <span class="seriesInfo">IETF Journal 2016</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.ietfjournal.org/multipath-tcp-deployments/">https://www.ietfjournal.org/multipath-tcp-deployments/</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4127c4299,4300
< <span class="refAuthor">Raiciu, C.</span><span class="refAuthor">, Paasch, C.</span><span class="refAuthor">, Barre, S.</span><span class="refAuthor">, Ford, A.</span><span class="refAuthor">, Honda, M.</span><span class="refAuthor">, Duchene, F.</span><span class="refAuthor">, Bonaventure, O.</span><span class="refAuthor">, and M. Handley</span>, <span class="refTitle">"How Hard Can It Be? Designing and Implementing a Deployable Multipath TCP"</span>, <span class="seriesInfo">Usenix Symposium on Networked Systems Design and Implementation 2012</span>, <time datetime="2012-04">April 2012</time>, <span>&lt;<a href="https://www.usenix.org/conference/nsdi12/technical-sessions/presentation/raiciu">https://www.usenix.org/conference/nsdi12/technical-sessions/presentation/raiciu</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Paasch, C.</span>, <span class="refAuthor">Barre, S.</span>, <span class="refAuthor">Ford, A.</span>, <span class="refAuthor">Honda, M.</span>, <span class="refAuthor">Duchene, F.</span>, <span class="refAuthor">Bonaventure, O.</span>, and <span class="refAuthor">M. Handley</span>, <span class="refTitle">"How Hard Can It Be? Designing and Implementing a Deployable Multipath TCP"</span>, <span class="seriesInfo">Usenix Symposium on Networked Systems Design and Implementation 2012</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.usenix.org/conference/nsdi12/technical-sessions/presentation/raiciu">https://www.usenix.org/conference/nsdi12/technical-sessions/presentation/raiciu</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4130c4303,4304
< <span class="refAuthor">Handley, M.</span><span class="refAuthor">, Paxson, V.</span><span class="refAuthor">, and C. Kreibich</span>, <span class="refTitle">"Network Intrusion Detection: Evasion, Traffic Normalization, and End-to-End Protocol Semantics"</span>, <span class="seriesInfo">Usenix Security Symposium 2001</span>, <time datetime="2001-08">August 2001</time>, <span>&lt;<a href="https://www.usenix.org/legacy/events/sec01/full_papers/handley/handley.pdf">https://www.usenix.org/legacy/events/sec01/full_papers/handley/handley.pdf</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Paxson, V.</span>, and <span class="refAuthor">C. Kreibich</span>, <span class="refTitle">"Network Intrusion Detection: Evasion, Traffic Normalization, and End-to-End Protocol Semantics"</span>, <span class="seriesInfo">Usenix Security Symposium 2001</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="https://www.usenix.org/legacy/events/sec01/full_papers/handley/handley.pdf">https://www.usenix.org/legacy/events/sec01/full_papers/handley/handley.pdf</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4133c4307,4308
< <span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Braden, R., Ed.</span>, <span class="refTitle">"Requirements for Internet Hosts - Communication Layers"</span>, <span class="seriesInfo">STD 3</span>, <span class="seriesInfo">RFC 1122</span>, <span class="seriesInfo">DOI 10.17487/RFC1122</span>, <time datetime="1989-10" class="refDate">October 1989</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1122">https://www.rfc-editor.org/info/rfc1122</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4136c4311,4312
< <span class="refAuthor">Rekhter, Y.</span><span class="refAuthor">, Moskowitz, B.</span><span class="refAuthor">, Karrenberg, D.</span><span class="refAuthor">, de Groot, G. J.</span><span class="refAuthor">, and E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Rekhter, Y.</span>, <span class="refAuthor">Moskowitz, B.</span>, <span class="refAuthor">Karrenberg, D.</span>, <span class="refAuthor">de Groot, G. J.</span>, and <span class="refAuthor">E. Lear</span>, <span class="refTitle">"Address Allocation for Private Internets"</span>, <span class="seriesInfo">BCP 5</span>, <span class="seriesInfo">RFC 1918</span>, <span class="seriesInfo">DOI 10.17487/RFC1918</span>, <time datetime="1996-02" class="refDate">February 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1918">https://www.rfc-editor.org/info/rfc1918</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4139c4315,4316
< <span class="refAuthor">Mathis, M.</span><span class="refAuthor">, Mahdavi, J.</span><span class="refAuthor">, Floyd, S.</span><span class="refAuthor">, and A. Romanow</span>, <span class="refTitle">"TCP Selective Acknowledgment Options"</span>, <span class="seriesInfo">RFC 2018</span>, <span class="seriesInfo">DOI 10.17487/RFC2018</span>, <time datetime="1996-10">October 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2018">https://www.rfc-editor.org/info/rfc2018</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Mathis, M.</span>, <span class="refAuthor">Mahdavi, J.</span>, <span class="refAuthor">Floyd, S.</span>, and <span class="refAuthor">A. Romanow</span>, <span class="refTitle">"TCP Selective Acknowledgment Options"</span>, <span class="seriesInfo">RFC 2018</span>, <span class="seriesInfo">DOI 10.17487/RFC2018</span>, <time datetime="1996-10" class="refDate">October 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2018">https://www.rfc-editor.org/info/rfc2018</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4142c4319,4320
< <span class="refAuthor">Freed, N.</span>, <span class="refTitle">"Behavior of and Requirements for Internet Firewalls"</span>, <span class="seriesInfo">RFC 2979</span>, <span class="seriesInfo">DOI 10.17487/RFC2979</span>, <time datetime="2000-10">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2979">https://www.rfc-editor.org/info/rfc2979</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Freed, N.</span>, <span class="refTitle">"Behavior of and Requirements for Internet Firewalls"</span>, <span class="seriesInfo">RFC 2979</span>, <span class="seriesInfo">DOI 10.17487/RFC2979</span>, <time datetime="2000-10" class="refDate">October 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2979">https://www.rfc-editor.org/info/rfc2979</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4145c4323,4324
< <span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"Analysis of an Equal-Cost Multi-Path Algorithm"</span>, <span class="seriesInfo">RFC 2992</span>, <span class="seriesInfo">DOI 10.17487/RFC2992</span>, <time datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2992">https://www.rfc-editor.org/info/rfc2992</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Hopps, C.</span>, <span class="refTitle">"Analysis of an Equal-Cost Multi-Path Algorithm"</span>, <span class="seriesInfo">RFC 2992</span>, <span class="seriesInfo">DOI 10.17487/RFC2992</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2992">https://www.rfc-editor.org/info/rfc2992</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4148c4327,4328
< <span class="refAuthor">Srisuresh, P.</span><span class="refAuthor"> and K. Egevang</span>, <span class="refTitle">"Traditional IP Network Address Translator (Traditional NAT)"</span>, <span class="seriesInfo">RFC 3022</span>, <span class="seriesInfo">DOI 10.17487/RFC3022</span>, <time datetime="2001-01">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3022">https://www.rfc-editor.org/info/rfc3022</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Srisuresh, P.</span> and <span class="refAuthor">K. Egevang</span>, <span class="refTitle">"Traditional IP Network Address Translator (Traditional NAT)"</span>, <span class="seriesInfo">RFC 3022</span>, <span class="seriesInfo">DOI 10.17487/RFC3022</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3022">https://www.rfc-editor.org/info/rfc3022</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4151c4331,4332
< <span class="refAuthor">Border, J.</span><span class="refAuthor">, Kojo, M.</span><span class="refAuthor">, Griner, J.</span><span class="refAuthor">, Montenegro, G.</span><span class="refAuthor">, and Z. Shelby</span>, <span class="refTitle">"Performance Enhancing Proxies Intended to Mitigate Link-Related Degradations"</span>, <span class="seriesInfo">RFC 3135</span>, <span class="seriesInfo">DOI 10.17487/RFC3135</span>, <time datetime="2001-06">June 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3135">https://www.rfc-editor.org/info/rfc3135</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Border, J.</span>, <span class="refAuthor">Kojo, M.</span>, <span class="refAuthor">Griner, J.</span>, <span class="refAuthor">Montenegro, G.</span>, and <span class="refAuthor">Z. Shelby</span>, <span class="refTitle">"Performance Enhancing Proxies Intended to Mitigate Link-Related Degradations"</span>, <span class="seriesInfo">RFC 3135</span>, <span class="seriesInfo">DOI 10.17487/RFC3135</span>, <time datetime="2001-06" class="refDate">June 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3135">https://www.rfc-editor.org/info/rfc3135</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4154c4335,4336
< <span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4157c4339,4340
< <span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time datetime="2007-08">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eddy, W.</span>, <span class="refTitle">"TCP SYN Flooding Attacks and Common Mitigations"</span>, <span class="seriesInfo">RFC 4987</span>, <span class="seriesInfo">DOI 10.17487/RFC4987</span>, <time datetime="2007-08" class="refDate">August 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4987">https://www.rfc-editor.org/info/rfc4987</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4160c4343,4344
< <span class="refAuthor">Allman, M.</span><span class="refAuthor">, Paxson, V.</span><span class="refAuthor">, and E. Blanton</span>, <span class="refTitle">"TCP Congestion Control"</span>, <span class="seriesInfo">RFC 5681</span>, <span class="seriesInfo">DOI 10.17487/RFC5681</span>, <time datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5681">https://www.rfc-editor.org/info/rfc5681</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Allman, M.</span>, <span class="refAuthor">Paxson, V.</span>, and <span class="refAuthor">E. Blanton</span>, <span class="refTitle">"TCP Congestion Control"</span>, <span class="seriesInfo">RFC 5681</span>, <span class="seriesInfo">DOI 10.17487/RFC5681</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5681">https://www.rfc-editor.org/info/rfc5681</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4163c4347,4348
< <span class="refAuthor">Bagnulo, M.</span>, <span class="refTitle">"Threat Analysis for TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 6181</span>, <span class="seriesInfo">DOI 10.17487/RFC6181</span>, <time datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6181">https://www.rfc-editor.org/info/rfc6181</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bagnulo, M.</span>, <span class="refTitle">"Threat Analysis for TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 6181</span>, <span class="seriesInfo">DOI 10.17487/RFC6181</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6181">https://www.rfc-editor.org/info/rfc6181</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4166c4351,4352
< <span class="refAuthor">Ford, A.</span><span class="refAuthor">, Raiciu, C.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, Barre, S.</span><span class="refAuthor">, and J. Iyengar</span>, <span class="refTitle">"Architectural Guidelines for Multipath TCP Development"</span>, <span class="seriesInfo">RFC 6182</span>, <span class="seriesInfo">DOI 10.17487/RFC6182</span>, <time datetime="2011-03">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6182">https://www.rfc-editor.org/info/rfc6182</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Ford, A.</span>, <span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Handley, M.</span>, <span class="refAuthor">Barre, S.</span>, and <span class="refAuthor">J. Iyengar</span>, <span class="refTitle">"Architectural Guidelines for Multipath TCP Development"</span>, <span class="seriesInfo">RFC 6182</span>, <span class="seriesInfo">DOI 10.17487/RFC6182</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6182">https://www.rfc-editor.org/info/rfc6182</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4169c4355,4356
< <span class="refAuthor">Raiciu, C.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, and D. Wischik</span>, <span class="refTitle">"Coupled Congestion Control for Multipath Transport Protocols"</span>, <span class="seriesInfo">RFC 6356</span>, <span class="seriesInfo">DOI 10.17487/RFC6356</span>, <time datetime="2011-10">October 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6356">https://www.rfc-editor.org/info/rfc6356</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">D. Wischik</span>, <span class="refTitle">"Coupled Congestion Control for Multipath Transport Protocols"</span>, <span class="seriesInfo">RFC 6356</span>, <span class="seriesInfo">DOI 10.17487/RFC6356</span>, <time datetime="2011-10" class="refDate">October 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6356">https://www.rfc-editor.org/info/rfc6356</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4172c4359,4360
< <span class="refAuthor">Gont, F.</span><span class="refAuthor"> and S. Bellovin</span>, <span class="refTitle">"Defending against Sequence Number Attacks"</span>, <span class="seriesInfo">RFC 6528</span>, <span class="seriesInfo">DOI 10.17487/RFC6528</span>, <time datetime="2012-02">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6528">https://www.rfc-editor.org/info/rfc6528</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Gont, F.</span> and <span class="refAuthor">S. Bellovin</span>, <span class="refTitle">"Defending against Sequence Number Attacks"</span>, <span class="seriesInfo">RFC 6528</span>, <span class="seriesInfo">DOI 10.17487/RFC6528</span>, <time datetime="2012-02" class="refDate">February 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6528">https://www.rfc-editor.org/info/rfc6528</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4175c4363,4364
< <span class="refAuthor">Ford, A.</span><span class="refAuthor">, Raiciu, C.</span><span class="refAuthor">, Handley, M.</span><span class="refAuthor">, and O. Bonaventure</span>, <span class="refTitle">"TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 6824</span>, <span class="seriesInfo">DOI 10.17487/RFC6824</span>, <time datetime="2013-01">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6824">https://www.rfc-editor.org/info/rfc6824</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Ford, A.</span>, <span class="refAuthor">Raiciu, C.</span>, <span class="refAuthor">Handley, M.</span>, and <span class="refAuthor">O. Bonaventure</span>, <span class="refTitle">"TCP Extensions for Multipath Operation with Multiple Addresses"</span>, <span class="seriesInfo">RFC 6824</span>, <span class="seriesInfo">DOI 10.17487/RFC6824</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6824">https://www.rfc-editor.org/info/rfc6824</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4178c4367,4368
< <span class="refAuthor">Scharf, M.</span><span class="refAuthor"> and A. Ford</span>, <span class="refTitle">"Multipath TCP (MPTCP) Application Interface Considerations"</span>, <span class="seriesInfo">RFC 6897</span>, <span class="seriesInfo">DOI 10.17487/RFC6897</span>, <time datetime="2013-03">March 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6897">https://www.rfc-editor.org/info/rfc6897</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Scharf, M.</span> and <span class="refAuthor">A. Ford</span>, <span class="refTitle">"Multipath TCP (MPTCP) Application Interface Considerations"</span>, <span class="seriesInfo">RFC 6897</span>, <span class="seriesInfo">DOI 10.17487/RFC6897</span>, <time datetime="2013-03" class="refDate">March 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6897">https://www.rfc-editor.org/info/rfc6897</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4181c4371,4372
< <span class="refAuthor">Borman, D.</span><span class="refAuthor">, Braden, B.</span><span class="refAuthor">, Jacobson, V.</span><span class="refAuthor">, and R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time datetime="2014-09">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Borman, D.</span>, <span class="refAuthor">Braden, B.</span>, <span class="refAuthor">Jacobson, V.</span>, and <span class="refAuthor">R. Scheffenegger, Ed.</span>, <span class="refTitle">"TCP Extensions for High Performance"</span>, <span class="seriesInfo">RFC 7323</span>, <span class="seriesInfo">DOI 10.17487/RFC7323</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7323">https://www.rfc-editor.org/info/rfc7323</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4184c4375,4376
< <span class="refAuthor">Cheng, Y.</span><span class="refAuthor">, Chu, J.</span><span class="refAuthor">, Radhakrishnan, S.</span><span class="refAuthor">, and A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time datetime="2014-12">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Cheng, Y.</span>, <span class="refAuthor">Chu, J.</span>, <span class="refAuthor">Radhakrishnan, S.</span>, and <span class="refAuthor">A. Jain</span>, <span class="refTitle">"TCP Fast Open"</span>, <span class="seriesInfo">RFC 7413</span>, <span class="seriesInfo">DOI 10.17487/RFC7413</span>, <time datetime="2014-12" class="refDate">December 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7413">https://www.rfc-editor.org/info/rfc7413</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4187c4379,4380
< <span class="refAuthor">Bagnulo, M.</span><span class="refAuthor">, Paasch, C.</span><span class="refAuthor">, Gont, F.</span><span class="refAuthor">, Bonaventure, O.</span><span class="refAuthor">, and C. Raiciu</span>, <span class="refTitle">"Analysis of Residual Threats and Possible Fixes for Multipath TCP (MPTCP)"</span>, <span class="seriesInfo">RFC 7430</span>, <span class="seriesInfo">DOI 10.17487/RFC7430</span>, <time datetime="2015-07">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7430">https://www.rfc-editor.org/info/rfc7430</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bagnulo, M.</span>, <span class="refAuthor">Paasch, C.</span>, <span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Bonaventure, O.</span>, and <span class="refAuthor">C. Raiciu</span>, <span class="refTitle">"Analysis of Residual Threats and Possible Fixes for Multipath TCP (MPTCP)"</span>, <span class="seriesInfo">RFC 7430</span>, <span class="seriesInfo">DOI 10.17487/RFC7430</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7430">https://www.rfc-editor.org/info/rfc7430</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4190c4383,4384
< <span class="refAuthor">Bonaventure, O.</span><span class="refAuthor">, Paasch, C.</span><span class="refAuthor">, and G. Detal</span>, <span class="refTitle">"Use Cases and Operational Experience with Multipath TCP"</span>, <span class="seriesInfo">RFC 8041</span>, <span class="seriesInfo">DOI 10.17487/RFC8041</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8041">https://www.rfc-editor.org/info/rfc8041</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bonaventure, O.</span>, <span class="refAuthor">Paasch, C.</span>, and <span class="refAuthor">G. Detal</span>, <span class="refTitle">"Use Cases and Operational Experience with Multipath TCP"</span>, <span class="seriesInfo">RFC 8041</span>, <span class="seriesInfo">DOI 10.17487/RFC8041</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8041">https://www.rfc-editor.org/info/rfc8041</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4193c4387,4388
< <span class="refAuthor">Cotton, M.</span><span class="refAuthor">, Leiba, B.</span><span class="refAuthor">, and T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4196c4391,4392
< <span class="refAuthor">Ramaiah, A.</span>, <span class="refTitle">"TCP option space extension"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ananth-tcpm-tcpoptext-00</span>, <time datetime="2012-03-26">26 March 2012</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ananth-tcpm-tcpoptext-00">https://tools.ietf.org/html/draft-ananth-tcpm-tcpoptext-00</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Ramaiah, A.</span>, <span class="refTitle">"TCP option space extension"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ananth-tcpm-tcpoptext-00</span>, <time datetime="2012-03-26" class="refDate">26 March 2012</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ananth-tcpm-tcpoptext-00">https://tools.ietf.org/html/draft-ananth-tcpm-tcpoptext-00</a>&gt;</span>. </dd>
> <dd class="break"></dd>
4201c4397
< <section id="section-appendix.a">
---
> <section id="appendix-A">
4203c4399
< <a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-notes-on-use-of-tcp-options" class="section-name selfRef">Notes on Use of TCP Options</a>
---
> <a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-notes-on-use-of-tcp-options" class="section-name selfRef">Notes on Use of TCP Options</a>
4205,4206c4401,4402
< <p id="section-appendix.a-1">The TCP option space is limited due to the length of the Data Offset field in the TCP header (4 bits), which defines the TCP header length in 32-bit words. With the standard TCP header being 20 bytes, this leaves a maximum of 40 bytes for options, and many of these may already be used by options such as timestamp and SACK.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-2">We performed a brief study on the commonly used TCP options in SYN,
---
> <p id="appendix-A-1">The TCP option space is limited due to the length of the Data Offset field in the TCP header (4 bits), which defines the TCP header length in 32-bit words. With the standard TCP header being 20 bytes, this leaves a maximum of 40 bytes for options, and many of these may already be used by options such as timestamp and SACK.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
> <p id="appendix-A-2">We performed a brief study on the commonly used TCP options in SYN,
4208,4209c4404,4405
<  to fit all the options discussed in this document.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-3">SYN packets typically include the following options: Maximum Segment Size (MSS) (4 bytes),
---
>  to fit all the options discussed in this document.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
> <p id="appendix-A-3">SYN packets typically include the following options: Maximum Segment Size (MSS) (4 bytes),
4217,4218c4413,4414
<       MP_CAPABLE (12 bytes) and MP_JOIN (12 or 16 bytes) will fit in this remaining space.<a href="#section-appendix.a-3" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-4">Note that due to the use of a 64-bit data-level sequence space, it is
---
>       MP_CAPABLE (12 bytes) and MP_JOIN (12 or 16 bytes) will fit in this remaining space.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
> <p id="appendix-A-4">Note that due to the use of a 64-bit data-level sequence space, it is
4221c4417
<       Against Wrapped Sequences (PAWS) mechanism, as described in <span>[<a href="#RFC7323" class="xref">RFC7323</a>]</span>), since the data-level sequence space has far less
---
>       Against Wrapped Sequences (PAWS) mechanism, as described in <span>[<a href="#RFC7323" class="cite xref">RFC7323</a>]</span>), since the data-level sequence space has far less
4223,4224c4419,4420
<       left for further study.<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-5">TCP data packets typically carry timestamp options in every packet,
---
>       left for further study.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
> <p id="appendix-A-5">TCP data packets typically carry timestamp options in every packet,
4229,4232c4425,4428
<       checksum is present. The maximum size of the DSS option is 28 bytes, so even that will fit in the available space. But unless a connection is both bidirectional and high-bandwidth, it is unlikely that all that option space will be required on each DSS option.<a href="#section-appendix.a-5" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-6">Within the DSS option, it is not necessary to include the Data Sequence Mapping and DATA_ACK in each packet, and in many cases it may be possible to alternate their presence (so long as the mapping covers the data being sent in the subsequent packet). It would also be possible to alternate between 4-byte and 8-byte sequence numbers in each option.<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-7">On subflow and connection setup, an MPTCP option is also set on the third packet (an ACK). These are 20 bytes (for MP_CAPABLE) and 24 bytes (for MP_JOIN), both of which will fit in the available option space.<a href="#section-appendix.a-7" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-8">Pure ACKs in TCP typically contain only timestamps (10 bytes). Here, Multipath TCP typically 
---
>       checksum is present. The maximum size of the DSS option is 28 bytes, so even that will fit in the available space. But unless a connection is both bidirectional and high-bandwidth, it is unlikely that all that option space will be required on each DSS option.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
> <p id="appendix-A-6">Within the DSS option, it is not necessary to include the Data Sequence Mapping and DATA_ACK in each packet, and in many cases it may be possible to alternate their presence (so long as the mapping covers the data being sent in the subsequent packet). It would also be possible to alternate between 4-byte and 8-byte sequence numbers in each option.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
> <p id="appendix-A-7">On subflow and connection setup, an MPTCP option is also set on the third packet (an ACK). These are 20 bytes (for MP_CAPABLE) and 24 bytes (for MP_JOIN), both of which will fit in the available option space.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
> <p id="appendix-A-8">Pure ACKs in TCP typically contain only timestamps (10 bytes). Here, Multipath TCP typically 
4239,4240c4435,4436
< then that path can also be used to transmit the new DATA_ACK).<a href="#section-appendix.a-8" class="pilcrow">¶</a></p>
< <p id="section-appendix.a-9">The ADD_ADDR option can be between 16 and 30 bytes, depending on
---
> then that path can also be used to transmit the new DATA_ACK).<a href="#appendix-A-8" class="pilcrow">¶</a></p>
> <p id="appendix-A-9">The ADD_ADDR option can be between 16 and 30 bytes, depending on
4246c4442
<       mandating that duplicate ACKs with MPTCP options not be taken as a signal of congestion.<a href="#section-appendix.a-9" class="pilcrow">¶</a></p>
---
>       mandating that duplicate ACKs with MPTCP options not be taken as a signal of congestion.<a href="#appendix-A-9" class="pilcrow">¶</a></p>
4250c4446
< <section id="section-appendix.b">
---
> <section id="appendix-B">
4252c4448
< <a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-tcp-fast-open-and-mptcp" class="section-name selfRef">TCP Fast Open and MPTCP</a>
---
> <a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-tcp-fast-open-and-mptcp" class="section-name selfRef">TCP Fast Open and MPTCP</a>
4254,4255c4450,4451
< <p id="section-appendix.b-1">TCP Fast Open (TFO) is an experimental TCP extension, described in
<       <span>[<a href="#RFC7413" class="xref">RFC7413</a>]</span>, which has been introduced to
---
> <p id="appendix-B-1">TCP Fast Open (TFO) is an experimental TCP extension, described in
>       <span>[<a href="#RFC7413" class="cite xref">RFC7413</a>]</span>, which has been introduced to
4261c4457
<       immediately with data after the SYN/ACK. <span>[<a href="#RFC7413" class="xref">RFC7413</a>]</span> secures
---
>       immediately with data after the SYN/ACK. <span>[<a href="#RFC7413" class="cite xref">RFC7413</a>]</span> secures
4263,4265c4459,4461
<       is negotiated in a preceding connection.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
< <p id="section-appendix.b-2">When using TFO in conjunction with MPTCP, there are two key
<         points to take into account, as detailed below.<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
---
>       is negotiated in a preceding connection.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
> <p id="appendix-B-2">When using TFO in conjunction with MPTCP, there are two key
>         points to take into account, as detailed below.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
4267,4272c4463,4468
< <section id="section-b.1">
<         <h2 id="name-tfo-cookie-request-with-mpt">
< <a href="#section-b.1" class="section-number selfRef">B.1. </a><a href="#name-tfo-cookie-request-with-mpt" class="section-name selfRef">TFO Cookie Request with MPTCP</a>
<         </h2>
< <p id="section-b.1-1">When a TFO initiator first connects to a listener, it cannot immediately
<           include data in the SYN for security reasons <span>[<a href="#RFC7413" class="xref">RFC7413</a>]</span>.
---
> <section id="appendix-B.1">
>         <h3 id="name-tfo-cookie-request-with-mpt">
> <a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-tfo-cookie-request-with-mpt" class="section-name selfRef">TFO Cookie Request with MPTCP</a>
>         </h3>
> <p id="appendix-B.1-1">When a TFO initiator first connects to a listener, it cannot immediately
>           include data in the SYN for security reasons <span>[<a href="#RFC7413" class="cite xref">RFC7413</a>]</span>.
4275,4279c4471,4475
<           of 2 bytes and 6-18 bytes, respectively (depending on the chosen cookie length).<a href="#section-b.1-1" class="pilcrow">¶</a></p>
< <p id="section-b.1-2">TFO and MPTCP can be combined, provided that the total length of all the
<           options does not exceed the maximum 40 bytes possible in TCP:<a href="#section-b.1-2" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-b.1-3.1">In the SYN: MPTCP uses a 4-byte MP_CAPABLE option. The sum
---
>           of 2 bytes and 6-18 bytes, respectively (depending on the chosen cookie length).<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
> <p id="appendix-B.1-2">TFO and MPTCP can be combined, provided that the total length of all the
>           options does not exceed the maximum 40 bytes possible in TCP:<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="appendix-B.1-3.1">In the SYN: MPTCP uses a 4-byte MP_CAPABLE option. The sum
4282c4478
<           there is enough space to combine the MP_CAPABLE with the TFO cookie request.<a href="#section-b.1-3.1" class="pilcrow">¶</a>
---
>           there is enough space to combine the MP_CAPABLE with the TFO cookie request.<a href="#appendix-B.1-3.1" class="pilcrow">¶</a>
4284c4480
< <li id="section-b.1-3.2">In the SYN + ACK: MPTCP uses a 12-byte MP_CAPABLE option, but
---
>           <li class="normal" id="appendix-B.1-3.2">In the SYN + ACK: MPTCP uses a 12-byte MP_CAPABLE option, but
4295c4491
<           outlined in <a href="#app_options" class="xref">Appendix A</a>).<a href="#section-b.1-3.2" class="pilcrow">¶</a>
---
>           outlined in <a href="#app_options" class="auto internal xref">Appendix A</a>).<a href="#appendix-B.1-3.2" class="pilcrow">¶</a>
4301,4305c4497,4501
< <section id="section-b.2">
<         <h2 id="name-data-sequence-mapping-under">
< <a href="#section-b.2" class="section-number selfRef">B.2. </a><a href="#name-data-sequence-mapping-under" class="section-name selfRef">Data Sequence Mapping under TFO</a>
<         </h2>
< <p id="section-b.2-1">In the TCP establishment phase, MPTCP uses a key exchange that is
---
> <section id="appendix-B.2">
>         <h3 id="name-data-sequence-mapping-under">
> <a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-data-sequence-mapping-under" class="section-name selfRef">Data Sequence Mapping under TFO</a>
>         </h3>
> <p id="appendix-B.2-1">In the TCP establishment phase, MPTCP uses a key exchange that is
4318,4319c4514,4515
<           way to detect this inconsistency, because the DSS checksum is not present.<a href="#section-b.2-1" class="pilcrow">¶</a></p>
< <p id="section-b.2-2">To solve this issue, the TFO data must not be considered part of the
---
>           way to detect this inconsistency, because the DSS checksum is not present.<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
> <p id="appendix-B.2-2">To solve this issue, the TFO data must not be considered part of the
4326c4522
<           initial subflow, before any attempt to create additional subflows.<a href="#section-b.2-2" class="pilcrow">¶</a></p>
---
>           initial subflow, before any attempt to create additional subflows.<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
4330,4338c4526,4534
< <section id="section-b.3">
<         <h2 id="name-connection-establishment-ex">
< <a href="#section-b.3" class="section-number selfRef">B.3. </a><a href="#name-connection-establishment-ex" class="section-name selfRef">Connection Establishment Examples</a>
<         </h2>
< <p id="section-b.3-1">A few examples of possible "TFO + MPTCP"
<           establishment scenarios are shown below.<a href="#section-b.3-1" class="pilcrow">¶</a></p>
< <p id="section-b.3-2">Before an initiator can send data together with the SYN, it must request
<           a cookie from the listener, as shown in <a href="#fig_tfocookie" class="xref">Figure 18</a>.  (Note:  The sequence number 
< and length are annotated in <a href="#fig_tfocookie" class="xref">Figure 18</a> as
---
> <section id="appendix-B.3">
>         <h3 id="name-connection-establishment-ex">
> <a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-connection-establishment-ex" class="section-name selfRef">Connection Establishment Examples</a>
>         </h3>
> <p id="appendix-B.3-1">A few examples of possible "TFO + MPTCP"
>           establishment scenarios are shown below.<a href="#appendix-B.3-1" class="pilcrow">¶</a></p>
> <p id="appendix-B.3-2">Before an initiator can send data together with the SYN, it must request
>           a cookie from the listener, as shown in <a href="#fig_tfocookie" class="auto internal xref">Figure 18</a>.  (Note:  The sequence number 
> and length are annotated in <a href="#fig_tfocookie" class="auto internal xref">Figure 18</a> as
4340c4536
<         (e.g., "S  0(20)" in <a href="#fig_tfodata" class="xref">Figure 19</a>).) This is done by simply combining the TFO and MPTCP options.<a href="#section-b.3-2" class="pilcrow">¶</a></p>
---
>         (e.g., "S  0(20)" in <a href="#fig_tfodata" class="auto internal xref">Figure 19</a>).) This is done by simply combining the TFO and MPTCP options.<a href="#appendix-B.3-2" class="pilcrow">¶</a></p>
4343c4539
<           <div class="artwork art-text alignLeft" id="section-b.3-3.1">
---
>           <div class="alignLeft art-text artwork" id="appendix-B.3-3.1">
4361,4362c4557,4558
< <p id="section-b.3-4">Once this is done, the received cookie can be used for TFO, as shown
<           in <a href="#fig_tfodata" class="xref">Figure 19</a>. In this example, the initiator first
---
> <p id="appendix-B.3-4">Once this is done, the received cookie can be used for TFO, as shown
>           in <a href="#fig_tfodata" class="auto internal xref">Figure 19</a>. In this example, the initiator first
4368c4564
<           number space, as explained in <a href="#tfodata" class="xref">Appendix B.2</a>.<a href="#section-b.3-4" class="pilcrow">¶</a></p>
---
>           number space, as explained in <a href="#tfodata" class="auto internal xref">Appendix B.2</a>.<a href="#appendix-B.3-4" class="pilcrow">¶</a></p>
4371c4567
<           <div class="artwork art-text alignLeft" id="section-b.3-5.1">
---
>           <div class="alignLeft art-text artwork" id="appendix-B.3-5.1">
4395c4591
< <p id="section-b.3-6">In <a href="#fig_tfofallback" class="xref">Figure 20</a>, the listener does not support TFO.  The initiator detects
---
> <p id="appendix-B.3-6">In <a href="#fig_tfofallback" class="auto internal xref">Figure 20</a>, the listener does not support TFO.  The initiator detects
4401c4597
<           establishment.<a href="#section-b.3-6" class="pilcrow">¶</a></p>
---
>           establishment.<a href="#appendix-B.3-6" class="pilcrow">¶</a></p>
4404c4600
<           <div class="artwork art-text alignLeft" id="section-b.3-7.1">
---
>           <div class="alignLeft art-text artwork" id="appendix-B.3-7.1">
4428,4429c4624,4625
< <p id="section-b.3-8">It is also possible that the listener acknowledges only part of the TFO
<           data, as illustrated in <a href="#fig_tfopartial" class="xref">Figure 21</a>. The
---
> <p id="appendix-B.3-8">It is also possible that the listener acknowledges only part of the TFO
>           data, as illustrated in <a href="#fig_tfopartial" class="auto internal xref">Figure 21</a>. The
4431c4627
<  DSS mapping.<a href="#section-b.3-8" class="pilcrow">¶</a></p>
---
>  DSS mapping.<a href="#appendix-B.3-8" class="pilcrow">¶</a></p>
4434c4630
<           <div class="artwork art-text alignLeft" id="section-b.3-9.1">
---
>           <div class="alignLeft art-text artwork" id="appendix-B.3-9.1">
4460c4656
< <section id="section-appendix.c">
---
> <section id="appendix-C">
4462c4658
< <a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-control-blocks" class="section-name selfRef">Control Blocks</a>
---
> <a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-control-blocks" class="section-name selfRef">Control Blocks</a>
4464c4660
< <p id="section-appendix.c-1">Conceptually, an MPTCP connection can be represented as an MPTCP protocol control
---
> <p id="appendix-C-1">Conceptually, an MPTCP connection can be represented as an MPTCP protocol control
4467,4468c4663,4664
< that correspond to the subflows that have been established.<a href="#section-appendix.c-1" class="pilcrow">¶</a></p>
< <p id="section-appendix.c-2">RFC 793 <span>[<a href="#RFC0793" class="xref">RFC0793</a>]</span> specifies several state variables. Whenever possible, we reuse
---
> that correspond to the subflows that have been established.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
> <p id="appendix-C-2">RFC 793 <span>[<a href="#RFC0793" class="cite xref">RFC0793</a>]</span> specifies several state variables. Whenever possible, we reuse
4470,4478c4666,4669
< maintained by MPTCP.<a href="#section-appendix.c-2" class="pilcrow">¶</a></p>
< <section id="section-c.1">
<         <h2 id="name-mptcp-control-block">
< <a href="#section-c.1" class="section-number selfRef">C.1. </a><a href="#name-mptcp-control-block" class="section-name selfRef">MPTCP Control Block</a>
<         </h2>
< <p id="section-c.1-1">The MPTCP control block contains the following variables per connection.<a href="#section-c.1-1" class="pilcrow">¶</a></p>
< <section id="section-c.1.1">
<           <h3 id="name-authentication-and-metadata">
< <a href="#section-c.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-authentication-and-metadata" class="section-name selfRef">Authentication and Metadata</a>
---
> maintained by MPTCP.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
> <section id="appendix-C.1">
>         <h3 id="name-mptcp-control-block">
> <a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-mptcp-control-block" class="section-name selfRef">MPTCP Control Block</a>
4480,4482c4671,4678
< <dl class="dlParallel" id="section-c.1.1-1">
<             <dt id="section-c.1.1-1.1">Local.Token (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.1-1.2"> This is the token chosen by the local host on
---
> <p id="appendix-C.1-1">The MPTCP control block contains the following variables per connection.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
> <section id="appendix-C.1.1">
>           <h4 id="name-authentication-and-metadata">
> <a href="#appendix-C.1.1" class="section-number selfRef">C.1.1. </a><a href="#name-authentication-and-metadata" class="section-name selfRef">Authentication and Metadata</a>
>           </h4>
> <span class="break"></span><dl class="dlParallel" id="appendix-C.1.1-1">
>             <dt id="appendix-C.1.1-1.1">Local.Token (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.1-1.2"> This is the token chosen by the local host on
4484c4680
< MPTCP connections and is generated from the local key.<a href="#section-c.1.1-1.2" class="pilcrow">¶</a>
---
> MPTCP connections and is generated from the local key.<a href="#appendix-C.1.1-1.2" class="pilcrow">¶</a>
4486,4488c4682,4685
< <dt id="section-c.1.1-1.3">Local.Key (64 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.1-1.4"> This is the key sent by the local host on this
< MPTCP connection.<a href="#section-c.1.1-1.4" class="pilcrow">¶</a>
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.1-1.3">Local.Key (64 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.1-1.4"> This is the key sent by the local host on this
> MPTCP connection.<a href="#appendix-C.1.1-1.4" class="pilcrow">¶</a>
4490,4492c4687,4690
< <dt id="section-c.1.1-1.5">Remote.Token (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.1-1.6"> This is the token chosen by the remote host on
< this MPTCP connection, generated from the remote key.<a href="#section-c.1.1-1.6" class="pilcrow">¶</a>
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.1-1.5">Remote.Token (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.1-1.6"> This is the token chosen by the remote host on
> this MPTCP connection, generated from the remote key.<a href="#appendix-C.1.1-1.6" class="pilcrow">¶</a>
4494,4496c4692,4695
< <dt id="section-c.1.1-1.7">Remote.Key (64 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.1-1.8"> This is the key chosen by the remote host on
< this MPTCP connection.<a href="#section-c.1.1-1.8" class="pilcrow">¶</a>
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.1-1.7">Remote.Key (64 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.1-1.8"> This is the key chosen by the remote host on
> this MPTCP connection.<a href="#appendix-C.1.1-1.8" class="pilcrow">¶</a>
4498,4499c4697,4699
< <dt id="section-c.1.1-1.9">MPTCP.Checksum (flag):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.1-1.10"> This flag is set to true if at least one of the 
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.1-1.9">MPTCP.Checksum (flag):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.1-1.10"> This flag is set to true if at least one of the 
4503c4703
< all DSS options.<a href="#section-c.1.1-1.10" class="pilcrow">¶</a>
---
> all DSS options.<a href="#appendix-C.1.1-1.10" class="pilcrow">¶</a>
4504a4705
>           <dd class="break"></dd>
4507,4513c4708,4714
< <section id="section-c.1.2">
<           <h3 id="name-sending-side">
< <a href="#section-c.1.2" class="section-number selfRef">C.1.2. </a><a href="#name-sending-side" class="section-name selfRef">Sending Side</a>
<           </h3>
< <dl class="dlParallel" id="section-c.1.2-1">
<             <dt id="section-c.1.2-1.1">SND.UNA (64 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.2-1.2"> This is the data sequence number of the next byte to be
---
> <section id="appendix-C.1.2">
>           <h4 id="name-sending-side">
> <a href="#appendix-C.1.2" class="section-number selfRef">C.1.2. </a><a href="#name-sending-side" class="section-name selfRef">Sending Side</a>
>           </h4>
> <span class="break"></span><dl class="dlParallel" id="appendix-C.1.2-1">
>             <dt id="appendix-C.1.2-1.1">SND.UNA (64 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.2-1.2"> This is the data sequence number of the next byte to be
4515c4716
< upon reception of a DSS option containing a DATA_ACK.<a href="#section-c.1.2-1.2" class="pilcrow">¶</a>
---
> upon reception of a DSS option containing a DATA_ACK.<a href="#appendix-C.1.2-1.2" class="pilcrow">¶</a>
4517,4519c4718,4721
< <dt id="section-c.1.2-1.3">SND.NXT (64 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.2-1.4"> This is the data sequence number of the next byte to be
< sent. SND.NXT is used to determine the value of the DSN in the DSS option.<a href="#section-c.1.2-1.4" class="pilcrow">¶</a>
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.2-1.3">SND.NXT (64 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.2-1.4"> This is the data sequence number of the next byte to be
> sent. SND.NXT is used to determine the value of the DSN in the DSS option.<a href="#appendix-C.1.2-1.4" class="pilcrow">¶</a>
4521,4522c4723,4725
< <dt id="section-c.1.2-1.5">SND.WND (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.2-1.6"> This is the send window.  32 bits if the features in RFC
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.2-1.5">SND.WND (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.2-1.6"> This is the send window.  32 bits if the features in RFC
4526c4729
< transmitted segment.<a href="#section-c.1.2-1.6" class="pilcrow">¶</a>
---
> transmitted segment.<a href="#appendix-C.1.2-1.6" class="pilcrow">¶</a>
4527a4731
>           <dd class="break"></dd>
4530,4536c4734,4740
< <section id="section-c.1.3">
<           <h3 id="name-receiving-side">
< <a href="#section-c.1.3" class="section-number selfRef">C.1.3. </a><a href="#name-receiving-side" class="section-name selfRef">Receiving Side</a>
<           </h3>
< <dl class="dlParallel" id="section-c.1.3-1">
<             <dt id="section-c.1.3-1.1">RCV.NXT (64 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.3-1.2"> This is the data sequence number of the next byte that
---
> <section id="appendix-C.1.3">
>           <h4 id="name-receiving-side">
> <a href="#appendix-C.1.3" class="section-number selfRef">C.1.3. </a><a href="#name-receiving-side" class="section-name selfRef">Receiving Side</a>
>           </h4>
> <span class="break"></span><dl class="dlParallel" id="appendix-C.1.3-1">
>             <dt id="appendix-C.1.3-1.1">RCV.NXT (64 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.3-1.2"> This is the data sequence number of the next byte that
4539c4743
< the DATA_ACK that is sent in the DSS option on all subflows.<a href="#section-c.1.3-1.2" class="pilcrow">¶</a>
---
> the DATA_ACK that is sent in the DSS option on all subflows.<a href="#appendix-C.1.3-1.2" class="pilcrow">¶</a>
4541,4543c4745,4748
< <dt id="section-c.1.3-1.3">RCV.WND (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.1.3-1.4"> This is the connection-level receive window, which is the
<             maximum of the RCV.WND on all the subflows.  32 bits if the features in RFC 7323 are used; 16 bits otherwise.<a href="#section-c.1.3-1.4" class="pilcrow">¶</a>
---
>             <dd class="break"></dd>
> <dt id="appendix-C.1.3-1.3">RCV.WND (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.1.3-1.4"> This is the connection-level receive window, which is the
>             maximum of the RCV.WND on all the subflows.  32 bits if the features in RFC 7323 are used; 16 bits otherwise.<a href="#appendix-C.1.3-1.4" class="pilcrow">¶</a>
4544a4750
>           <dd class="break"></dd>
4548,4560c4754,4756
< <section id="section-c.2">
<         <h2 id="name-tcp-control-blocks">
< <a href="#section-c.2" class="section-number selfRef">C.2. </a><a href="#name-tcp-control-blocks" class="section-name selfRef">TCP Control Blocks</a>
<         </h2>
< <p id="section-c.2-1">The MPTCP control block also contains a list of the TCP control blocks
< that are associated with the MPTCP connection.<a href="#section-c.2-1" class="pilcrow">¶</a></p>
< <p id="section-c.2-2">Note that the TCP control block on the TCP subflows does not contain the
< RCV.WND and SND.WND state variables, as these are maintained at the MPTCP
< connection level and not at the subflow level.<a href="#section-c.2-2" class="pilcrow">¶</a></p>
< <p id="section-c.2-3">Inside each TCP control block, the following state variables are defined.<a href="#section-c.2-3" class="pilcrow">¶</a></p>
< <section id="section-c.2.1">
<           <h3 id="name-sending-side-2">
< <a href="#section-c.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-sending-side-2" class="section-name selfRef">Sending Side</a>
---
> <section id="appendix-C.2">
>         <h3 id="name-tcp-control-blocks">
> <a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-tcp-control-blocks" class="section-name selfRef">TCP Control Blocks</a>
4562,4564c4758,4770
< <dl class="dlParallel" id="section-c.2.1-1">
<             <dt id="section-c.2.1-1.1">SND.UNA (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.2.1-1.2"> This is the sequence number of the next byte to be
---
> <p id="appendix-C.2-1">The MPTCP control block also contains a list of the TCP control blocks
> that are associated with the MPTCP connection.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
> <p id="appendix-C.2-2">Note that the TCP control block on the TCP subflows does not contain the
> RCV.WND and SND.WND state variables, as these are maintained at the MPTCP
> connection level and not at the subflow level.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
> <p id="appendix-C.2-3">Inside each TCP control block, the following state variables are defined.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
> <section id="appendix-C.2.1">
>           <h4 id="name-sending-side-2">
> <a href="#appendix-C.2.1" class="section-number selfRef">C.2.1. </a><a href="#name-sending-side-2" class="section-name selfRef">Sending Side</a>
>           </h4>
> <span class="break"></span><dl class="dlParallel" id="appendix-C.2.1-1">
>             <dt id="appendix-C.2.1-1.1">SND.UNA (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.2.1-1.2"> This is the sequence number of the next byte to be
4566c4772
< each TCP acknowledgment on the subflow.<a href="#section-c.2.1-1.2" class="pilcrow">¶</a>
---
> each TCP acknowledgment on the subflow.<a href="#appendix-C.2.1-1.2" class="pilcrow">¶</a>
4568,4569c4774,4776
< <dt id="section-c.2.1-1.3">SND.NXT (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.2.1-1.4"> This is the sequence number of the next byte to be
---
>             <dd class="break"></dd>
> <dt id="appendix-C.2.1-1.3">SND.NXT (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.2.1-1.4"> This is the sequence number of the next byte to be
4571c4778
< transmission of the next segment.<a href="#section-c.2.1-1.4" class="pilcrow">¶</a>
---
> transmission of the next segment.<a href="#appendix-C.2.1-1.4" class="pilcrow">¶</a>
4572a4780
>           <dd class="break"></dd>
4575,4581c4783,4789
< <section id="section-c.2.2">
<           <h3 id="name-receiving-side-2">
< <a href="#section-c.2.2" class="section-number selfRef">C.2.2. </a><a href="#name-receiving-side-2" class="section-name selfRef">Receiving Side</a>
<           </h3>
< <dl class="dlParallel" id="section-c.2.2-1">
<             <dt id="section-c.2.2-1.1">RCV.NXT (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.2.2-1.2"> This is the sequence number of the next byte that
---
> <section id="appendix-C.2.2">
>           <h4 id="name-receiving-side-2">
> <a href="#appendix-C.2.2" class="section-number selfRef">C.2.2. </a><a href="#name-receiving-side-2" class="section-name selfRef">Receiving Side</a>
>           </h4>
> <span class="break"></span><dl class="dlParallel" id="appendix-C.2.2-1">
>             <dt id="appendix-C.2.2-1.1">RCV.NXT (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.2.2-1.2"> This is the sequence number of the next byte that
4584c4792
< SEG.ACK field of the next segments transmitted on the subflow.<a href="#section-c.2.2-1.2" class="pilcrow">¶</a>
---
> SEG.ACK field of the next segments transmitted on the subflow.<a href="#appendix-C.2.2-1.2" class="pilcrow">¶</a>
4586,4587c4794,4796
< <dt id="section-c.2.2-1.3">RCV.WND (32 bits):</dt>
< <dd style="margin-left: 1.5em" id="section-c.2.2-1.4">This is the subflow-level receive window that is updated with
---
>             <dd class="break"></dd>
> <dt id="appendix-C.2.2-1.3">RCV.WND (32 bits):</dt>
>             <dd style="margin-left: 1.5em" id="appendix-C.2.2-1.4">This is the subflow-level receive window that is updated with
4589c4798
<             bits if the features in RFC 7323 are used; 16 bits otherwise.<a href="#section-c.2.2-1.4" class="pilcrow">¶</a>
---
>             bits if the features in RFC 7323 are used; 16 bits otherwise.<a href="#appendix-C.2.2-1.4" class="pilcrow">¶</a>
4590a4800
>           <dd class="break"></dd>
4597c4807
< <section id="section-appendix.d">
---
> <section id="appendix-D">
4599c4809
< <a href="#section-appendix.d" class="section-number selfRef">Appendix D. </a><a href="#name-finite-state-machine" class="section-name selfRef">Finite State Machine</a>
---
> <a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-finite-state-machine" class="section-name selfRef">Finite State Machine</a>
4601c4811
< <p id="section-appendix.d-1">The diagram in <a href="#fig_fsm" class="xref">Figure 22</a> shows the
---
> <p id="appendix-D-1">The diagram in <a href="#fig_fsm" class="auto internal xref">Figure 22</a> shows the
4604c4814
<       DFIN flag on a DATA_ACK) (1) interacts with subflow-level FINs and (2) permits break-before-make handover between subflows.<a href="#section-appendix.d-1" class="pilcrow">¶</a></p>
---
>       DFIN flag on a DATA_ACK) (1) interacts with subflow-level FINs and (2) permits break-before-make handover between subflows.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
4607c4817
<         <div class="artwork art-text alignLeft" id="section-appendix.d-2.1">
---
>         <div class="alignLeft art-text artwork" id="appendix-D-2.1">
4643c4853
< <section id="section-appendix.e">
---
> <section id="appendix-E">
4645c4855
< <a href="#section-appendix.e" class="section-number selfRef">Appendix E. </a><a href="#name-changes-from-rfc-6824" class="section-name selfRef">Changes from RFC 6824</a>
---
> <a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-changes-from-rfc-6824" class="section-name selfRef">Changes from RFC 6824</a>
4647,4654c4857,4864
< <p id="section-appendix.e-1">This appendix lists the key technical changes between <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>,
<       which specifies MPTCP v0; and this document, which obsoletes <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span> and specifies MPTCP v1. Note that this specification is not backward compatible with <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>.<a href="#section-appendix.e-1" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-appendix.e-2.1">This document incorporates lessons learned from the various implementations, deployments, and experiments gathered in the documents "Use Cases and Operational Experience with Multipath TCP" <span>[<a href="#RFC8041" class="xref">RFC8041</a>]</span> and the IETF Journal article "Multipath TCP Deployments" <span>[<a href="#deployments" class="xref">deployments</a>]</span>.<a href="#section-appendix.e-2.1" class="pilcrow">¶</a>
< </li>
< <li id="section-appendix.e-2.2">Connection initiation, through the exchange of the MP_CAPABLE
<         MPTCP option, is different from <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span>. The SYN no longer
<         includes the initiator's key, to allow the MP_CAPABLE option on the SYN to be shorter in length and to avoid duplicating the sending of keying material.<a href="#section-appendix.e-2.2" class="pilcrow">¶</a>
---
> <p id="appendix-E-1">This appendix lists the key technical changes between <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>,
>       which specifies MPTCP v0; and this document, which obsoletes <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span> and specifies MPTCP v1. Note that this specification is not backward compatible with <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="appendix-E-2.1">This document incorporates lessons learned from the various implementations, deployments, and experiments gathered in the documents "Use Cases and Operational Experience with Multipath TCP" <span>[<a href="#RFC8041" class="cite xref">RFC8041</a>]</span> and the IETF Journal article "Multipath TCP Deployments" <span>[<a href="#deployments" class="cite xref">deployments</a>]</span>.<a href="#appendix-E-2.1" class="pilcrow">¶</a>
> </li>
>         <li class="normal" id="appendix-E-2.2">Connection initiation, through the exchange of the MP_CAPABLE
>         MPTCP option, is different from <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span>. The SYN no longer
>         includes the initiator's key, to allow the MP_CAPABLE option on the SYN to be shorter in length and to avoid duplicating the sending of keying material.<a href="#appendix-E-2.2" class="pilcrow">¶</a>
4656c4866
< <li id="section-appendix.e-2.3">This also ensures reliable delivery of the key on the MP_CAPABLE
---
>         <li class="normal" id="appendix-E-2.3">This also ensures reliable delivery of the key on the MP_CAPABLE
4660c4870
<         will be repeated on the first data packet. If the other end is the first to send, then the presence of the DSS option implicitly confirms the receipt of the MP_CAPABLE.<a href="#section-appendix.e-2.3" class="pilcrow">¶</a>
---
>         will be repeated on the first data packet. If the other end is the first to send, then the presence of the DSS option implicitly confirms the receipt of the MP_CAPABLE.<a href="#appendix-E-2.3" class="pilcrow">¶</a>
4662c4872
< <li id="section-appendix.e-2.4">In the Flags field of MP_CAPABLE, "C" is now assigned to mean that
---
>         <li class="normal" id="appendix-E-2.4">In the Flags field of MP_CAPABLE, "C" is now assigned to mean that
4665c4875
<         in cases where the sender is behind a strict NAT.<a href="#section-appendix.e-2.4" class="pilcrow">¶</a>
---
>         in cases where the sender is behind a strict NAT.<a href="#appendix-E-2.4" class="pilcrow">¶</a>
4667c4877
< <li id="section-appendix.e-2.5">In the Flags field of MP_CAPABLE, "H" now indicates the use of HMAC-SHA256 (rather than HMAC-SHA1).<a href="#section-appendix.e-2.5" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.5">In the Flags field of MP_CAPABLE, "H" now indicates the use of HMAC-SHA256 (rather than HMAC-SHA1).<a href="#appendix-E-2.5" class="pilcrow">¶</a>
4669c4879
< <li id="section-appendix.e-2.6">Connection initiation also defines the procedure for version negotiation, for implementations that support both v0 <span>[<a href="#RFC6824" class="xref">RFC6824</a>]</span> and v1 (this document).<a href="#section-appendix.e-2.6" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.6">Connection initiation also defines the procedure for version negotiation, for implementations that support both v0 <span>[<a href="#RFC6824" class="cite xref">RFC6824</a>]</span> and v1 (this document).<a href="#appendix-E-2.6" class="pilcrow">¶</a>
4671c4881
< <li id="section-appendix.e-2.7">The HMAC-SHA256 (rather than HMAC-SHA1) algorithm is used, as it provides better security. It is used to generate the token in the MP_JOIN and ADD_ADDR messages and to set the IDSN.<a href="#section-appendix.e-2.7" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.7">The HMAC-SHA256 (rather than HMAC-SHA1) algorithm is used, as it provides better security. It is used to generate the token in the MP_JOIN and ADD_ADDR messages and to set the IDSN.<a href="#appendix-E-2.7" class="pilcrow">¶</a>
4673,4674c4883,4884
< <li id="section-appendix.e-2.8">A new subflow-level option exists to signal reasons for sending a
<         RST on a subflow (MP_TCPRST (<a href="#sec_reset" class="xref">Section 3.6</a>)); this can help an implementation decide whether to attempt later reconnection.<a href="#section-appendix.e-2.8" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.8">A new subflow-level option exists to signal reasons for sending a
>         RST on a subflow (MP_TCPRST (<a href="#sec_reset" class="auto internal xref">Section 3.6</a>)); this can help an implementation decide whether to attempt later reconnection.<a href="#appendix-E-2.8" class="pilcrow">¶</a>
4676c4886
< <li id="section-appendix.e-2.9">The MP_PRIO option (<a href="#sec_policy" class="xref">Section 3.3.8</a>),
---
>         <li class="normal" id="appendix-E-2.9">The MP_PRIO option (<a href="#sec_policy" class="auto internal xref">Section 3.3.8</a>),
4682c4892
<         does not include a token or other type of security mechanism.<a href="#section-appendix.e-2.9" class="pilcrow">¶</a>
---
>         does not include a token or other type of security mechanism.<a href="#appendix-E-2.9" class="pilcrow">¶</a>
4684c4894
< <li id="section-appendix.e-2.10">The ADD_ADDR option (<a href="#sec_add_address" class="xref">Section 3.4.1</a>), which is used to inform the other host about another potential address, is different in several ways. It now includes an HMAC of the added address, for enhanced security. In addition, reliability for the ADD_ADDR option has been added: the IPVer field is replaced with a flag field, and one flag is assigned ("E") that is used as an "echo" so a host can indicate that it has received the option.<a href="#section-appendix.e-2.10" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.10">The ADD_ADDR option (<a href="#sec_add_address" class="auto internal xref">Section 3.4.1</a>), which is used to inform the other host about another potential address, is different in several ways. It now includes an HMAC of the added address, for enhanced security. In addition, reliability for the ADD_ADDR option has been added: the IPVer field is replaced with a flag field, and one flag is assigned ("E") that is used as an "echo" so a host can indicate that it has received the option.<a href="#appendix-E-2.10" class="pilcrow">¶</a>
4686,4687c4896,4897
< <li id="section-appendix.e-2.11">This document describes an additional way of performing a Fast
<         Close -- by sending an MP_FASTCLOSE option on a RST on all subflows. This allows the host to tear down the subflows and the connection immediately.<a href="#section-appendix.e-2.11" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.11">This document describes an additional way of performing a Fast
>         Close -- by sending an MP_FASTCLOSE option on a RST on all subflows. This allows the host to tear down the subflows and the connection immediately.<a href="#appendix-E-2.11" class="pilcrow">¶</a>
4689,4690c4899,4900
< <li id="section-appendix.e-2.12">IANA has reserved the MPTCP option subtype of value 0xf for
<         Private Use (<a href="#IANA_subtypes" class="xref">Section 7.2</a>). This document doesn't define how to use that value.<a href="#section-appendix.e-2.12" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.12">IANA has reserved the MPTCP option subtype of value 0xf for
>         Private Use (<a href="#IANA_subtypes" class="auto internal xref">Section 7.2</a>). This document doesn't define how to use that value.<a href="#appendix-E-2.12" class="pilcrow">¶</a>
4692,4693c4902,4903
< <li id="section-appendix.e-2.13">This document adds a new appendix (<a href="#app_tfo" class="xref">Appendix B</a>), which discusses the usage of both MPTCP options
<         and TFO options on the same packet.<a href="#section-appendix.e-2.13" class="pilcrow">¶</a>
---
>         <li class="normal" id="appendix-E-2.13">This document adds a new appendix (<a href="#app_tfo" class="auto internal xref">Appendix B</a>), which discusses the usage of both MPTCP options
>         and TFO options on the same packet.<a href="#appendix-E-2.13" class="pilcrow">¶</a>
4699c4909
< <section id="section-appendix.f">
---
> <section id="appendix-F">
4703,4705c4913,4915
< <p id="section-appendix.f-1">The authors gratefully acknowledge significant input into this
<       document from <span class="contact-name">Sebastien Barre</span> and <span class="contact-name">Andrew McDonald</span>.<a href="#section-appendix.f-1" class="pilcrow">¶</a></p>
< <p id="section-appendix.f-2">The authors also wish to acknowledge reviews and contributions from
---
> <p id="appendix-F-1">The authors gratefully acknowledge significant input into this
>       document from <span class="contact-name">Sebastien Barre</span> and <span class="contact-name">Andrew McDonald</span>.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
> <p id="appendix-F-2">The authors also wish to acknowledge reviews and contributions from
4714c4924
<       <span class="contact-name">Eric Vyncke</span>, and <span class="contact-name">Ben Kaduk</span>.<a href="#section-appendix.f-2" class="pilcrow">¶</a></p>
---
>       <span class="contact-name">Eric Vyncke</span>, and <span class="contact-name">Ben Kaduk</span>.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
4718c4928
< <section id="section-appendix.g">
---
> <section id="appendix-G">
