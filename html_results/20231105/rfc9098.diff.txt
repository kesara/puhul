19c19
< <meta content="xml2rfc 3.9.1" name="generator">
---
> <meta content="xml2rfc 3.18.2" name="generator">
22,39c22,35
<   xml2rfc 3.9.1
<     Python 3.6.10
<     appdirs 1.4.4
<     ConfigArgParse 1.2.3
<     google-i18n-address 2.3.5
<     html5lib 1.0.1
<     intervaltree 3.0.2
<     Jinja2 2.11.2
<     kitchen 1.2.6
<     lxml 4.4.2
<     pycairo 1.19.0
<     pycountry 19.8.18
<     pyflakes 2.1.1
<     PyYAML 5.3.1
<     requests 2.22.0
<     setuptools 40.6.2
<     six 1.14.0
<     WeasyPrint 51
---
>   xml2rfc 3.18.2
>     Python 3.11.6
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 4.9.3
>     platformdirs 3.11.0
>     pycountry 22.3.5
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.9
41c37
< <link href="rfc9098.xml" rel="alternate" type="application/rfc+xml">
---
> <link href="rfc/rfc9098.xml" rel="alternate" type="application/rfc+xml">
51c47
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
60a57,62
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
63d64
<   width: extend-to-zoom;
78c79
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
80a82
>   overflow-wrap: break-word;
166a169,177
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
181,184d191
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
185a193
>   border: none;
253c261,262
< a[href].selfRef {
---
> a[href].selfRef,
> .iref + a[href].internal {
263c272
< tt, code, pre, code {
---
> tt, code, pre {
265c274
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
304a314,316
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
394a407,412
> /* Fix PDF info block run off issue */
> @media print {
>   #identifiers dd {
>     float: none;
>   }
> }
496c514
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
636d653
< 
658a676,678
>   .breakable pre {
>     break-inside: auto;
>   }
726c746
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
826c846
< tt, code, pre, code {
---
> tt, code, pre {
831c851
< pre.sourcecode,
---
> .sourcecode pre,
867c887
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
1048a1069
>   .artwork > pre,
1063c1084
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1069a1091,1093
> tr {
>   break-inside: avoid;
> }
1089c1113
<   break-before: avoid-page;
---
>   break-before: auto;
1120c1144
< /* Text in compact lists should not get extra bottim margin space,
---
> /* Text in compact lists should not get extra bottom margin space,
1145c1169
< /* Tweak the comact list text */
---
> /* Tweak the compact list text */
1163c1187
< dd > div:first-child > pre.sourcecode,
---
> dd > div.sourcecode:first-child,
1177c1201
< li > p:last-of-type {
---
> li > p:last-of-type:only-child {
1181a1206
> <link href="https://datatracker.ietf.org/doc/draft-ietf-v6ops-ipv6-ehs-packet-drops-08" rel="prev">
1184c1209
<   <link href="https://datatracker.ietf.org/doc/draft-ietf-v6ops-ipv6-ehs-packet-drops-08" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1186,1187c1211,1212
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1297,1317c1322,1342
< <nav class="toc"><ul class="compact ulEmpty ulBare toc">
< <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.1">
<             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
< </li>
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.2">
<             <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
< </li>
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.3">
<             <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-disclaimer" class="xref">Disclaimer</a></p>
< </li>
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.4">
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-background-information" class="xref">Background Information</a></p>
< </li>
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.5">
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-previous-work-on-ipv6-exten" class="xref">Previous Work on IPv6 Extension Headers</a></p>
< </li>
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6">
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-packet-forwarding-engine-co" class="xref">Packet-Forwarding Engine Constraints</a></p>
< <ul class="compact ulEmpty ulBare toc">
< <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.6.2.1">
<                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-recirculation" class="xref">Recirculation</a></p>
---
> <nav class="toc"><ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
>             <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
>             <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-disclaimer" class="internal xref">Disclaimer</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
>             <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-background-information" class="internal xref">Background Information</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
>             <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-previous-work-on-ipv6-exten" class="internal xref">Previous Work on IPv6 Extension Headers</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
>             <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-packet-forwarding-engine-co" class="internal xref">Packet-Forwarding Engine Constraints</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
>                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-recirculation" class="internal xref">Recirculation</a></p>
1321,1328c1346,1353
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7">
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-requirement-to-process-laye" class="xref">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</a></p>
< <ul class="compact ulEmpty ulBare toc">
< <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.1">
<                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-ecmp-and-hash-based-load-sh" class="xref">ECMP and Hash-Based Load Sharing</a></p>
< </li>
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.2">
<                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-enforcing-infrastructure-ac" class="xref">Enforcing Infrastructure ACLs</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
>             <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-requirement-to-process-laye" class="internal xref">Requirement to Process Layer 3 / Layer 4 Information in Intermediate Systems</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
>                 <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-ecmp-and-hash-based-load-sh" class="internal xref">ECMP and Hash-Based Load Sharing</a></p>
> </li>
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
>                 <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-enforcing-infrastructure-ac" class="internal xref">Enforcing Infrastructure ACLs</a></p>
1330,1331c1355,1356
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.3">
<                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-ddos-management-and-custome" class="xref">DDoS Management and Customer Requests for Filtering</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
>                 <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-ddos-management-and-custome" class="internal xref">DDoS Management and Customer Requests for Filtering</a></p>
1333,1334c1358,1359
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.4">
<                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-network-intrusion-detection" class="xref">Network Intrusion Detection and Prevention</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
>                 <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-network-intrusion-detection" class="internal xref">Network Intrusion Detection and Prevention</a></p>
1336,1337c1361,1362
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.7.2.5">
<                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-firewalling" class="xref">Firewalling</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
>                 <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="auto internal xref">7.5</a>.  <a href="#name-firewalling" class="internal xref">Firewalling</a></p>
1341,1345c1366,1370
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8">
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-operational-and-security-im" class="xref">Operational and Security Implications</a></p>
< <ul class="compact ulEmpty ulBare toc">
< <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.1">
<                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-inability-to-find-layer-4-i" class="xref">Inability to Find Layer 4 Information</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
>             <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-operational-and-security-im" class="internal xref">Operational and Security Implications</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
>                 <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-inability-to-find-layer-4-i" class="internal xref">Inability to Find Layer 4 Information</a></p>
1347,1348c1372,1373
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.2">
<                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-route-processor-protection" class="xref">Route-Processor Protection</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
>                 <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-route-processor-protection" class="internal xref">Route-Processor Protection</a></p>
1350,1351c1375,1376
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.3">
<                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="xref">8.3</a>.  <a href="#name-inability-to-perform-fine-g" class="xref">Inability to Perform Fine-Grained Filtering</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
>                 <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-inability-to-perform-fine-g" class="internal xref">Inability to Perform Fine-Grained Filtering</a></p>
1353,1354c1378,1379
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.8.2.4">
<                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="xref">8.4</a>.  <a href="#name-security-concerns-associate" class="xref">Security Concerns Associated with IPv6 Extension Headers</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
>                 <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-security-concerns-associate" class="internal xref">Security Concerns Associated with IPv6 Extension Headers</a></p>
1358,1359c1383,1384
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.9">
<             <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
>             <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
1361,1362c1386,1387
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.10">
<             <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
>             <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1364,1368c1389,1393
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11">
<             <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a></p>
< <ul class="compact ulEmpty ulBare toc">
< <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11.2.1">
<                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
>             <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
>                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1370,1371c1395,1396
<               <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.11.2.2">
<                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
>                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1375,1376c1400,1401
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.12">
<             <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
>             <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
1378,1379c1403,1404
<           <li class="compact ulEmpty ulBare toc" id="section-toc.1-1.13">
<             <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
>             <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
1394c1419
< <li class="normal" id="section-1-3.1">Raise awareness about the operational and security implications of IPv6 extension headers specified in <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> and present reasons why some networks resort to intentionally dropping packets containing IPv6 extension headers.<a href="#section-1-3.1" class="pilcrow">¶</a>
---
> <li class="normal" id="section-1-3.1">Raise awareness about the operational and security implications of IPv6 extension headers specified in <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> and present reasons why some networks resort to intentionally dropping packets containing IPv6 extension headers.<a href="#section-1-3.1" class="pilcrow">¶</a>
1402c1427
< <a href="#background" class="xref">Section 4</a> of this document provides background information about the IPv6 packet structure and associated implications. <a href="#previous-work" class="xref">Section 5</a> summarizes previous work that has been carried out in the area of IPv6 extension headers. <a href="#pfe-constraints" class="xref">Section 6</a> discusses packet-forwarding engine constraints in contemporary routers. <a href="#inability" class="xref">Section 7</a> discusses why intermediate systems may need to access Layer 4 information to make a forwarding decision. Finally, <a href="#operational-implications" class="xref">Section 8</a> discusses operational implications of IPv6 EHs.<a href="#section-1-4" class="pilcrow">¶</a></p>
---
> <a href="#background" class="auto internal xref">Section 4</a> of this document provides background information about the IPv6 packet structure and associated implications. <a href="#previous-work" class="auto internal xref">Section 5</a> summarizes previous work that has been carried out in the area of IPv6 extension headers. <a href="#pfe-constraints" class="auto internal xref">Section 6</a> discusses packet-forwarding engine constraints in contemporary routers. <a href="#inability" class="auto internal xref">Section 7</a> discusses why intermediate systems may need to access Layer 4 information to make a forwarding decision. Finally, <a href="#operational-implications" class="auto internal xref">Section 8</a> discusses operational implications of IPv6 EHs.<a href="#section-1-4" class="pilcrow">¶</a></p>
1435c1460
<         <div class="artwork art-text alignLeft" id="section-4-3.1">
---
>         <div class="alignLeft art-text artwork" id="section-4-3.1">
1460c1485
<         <div class="artwork art-text alignLeft" id="section-4-5.1">
---
>         <div class="alignLeft art-text artwork" id="section-4-5.1">
1484c1509
<           <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> requires the entire IPv6 header chain to be contained in the first fragment of a packet, therefore limiting the IPv6 header chain to the size of the path MTU.<a href="#section-4-7.1" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> requires the entire IPv6 header chain to be contained in the first fragment of a packet, therefore limiting the IPv6 header chain to the size of the path MTU.<a href="#section-4-7.1" class="pilcrow">¶</a>
1505c1530
<           <span>[<a href="#I-D.taylor-v6ops-fragdrop" class="xref">OPERATORS</a>]</span> discusses a rationale for which operators drop IPv6 fragments.<a href="#section-5-2.1" class="pilcrow">¶</a>
---
>           <span>[<a href="#I-D.taylor-v6ops-fragdrop" class="cite xref">OPERATORS</a>]</span> discusses a rationale for which operators drop IPv6 fragments.<a href="#section-5-2.1" class="pilcrow">¶</a>
1508c1533
<           <span>[<a href="#I-D.wkumari-long-headers" class="xref">HEADERS</a>]</span> discusses possible issues arising from "long" IPv6 header chains.<a href="#section-5-2.2" class="pilcrow">¶</a>
---
>           <span>[<a href="#I-D.wkumari-long-headers" class="cite xref">HEADERS</a>]</span> discusses possible issues arising from "long" IPv6 header chains.<a href="#section-5-2.2" class="pilcrow">¶</a>
1511c1536
<           <span>[<a href="#I-D.kampanakis-6man-ipv6-eh-parsing" class="xref">PARSING</a>]</span> describes how inconsistencies in the way IPv6 packets with extension headers are parsed by different implementations could result in evasion of security controls and presents guidelines for parsing IPv6 extension headers, with the goal of providing a common and consistent parsing methodology for IPv6 implementations.<a href="#section-5-2.3" class="pilcrow">¶</a>
---
>           <span>[<a href="#I-D.kampanakis-6man-ipv6-eh-parsing" class="cite xref">PARSING</a>]</span> describes how inconsistencies in the way IPv6 packets with extension headers are parsed by different implementations could result in evasion of security controls and presents guidelines for parsing IPv6 extension headers, with the goal of providing a common and consistent parsing methodology for IPv6 implementations.<a href="#section-5-2.3" class="pilcrow">¶</a>
1514c1539
<           <span>[<a href="#I-D.ietf-opsec-ipv6-eh-filtering" class="xref">IPV6-EH</a>]</span> analyzes the security implications of IPv6 EHs, as well as the operational implications of dropping packets that employ IPv6 EHs and associated options.<a href="#section-5-2.4" class="pilcrow">¶</a>
---
>           <span>[<a href="#I-D.ietf-opsec-ipv6-eh-filtering" class="cite xref">IPV6-EH</a>]</span> analyzes the security implications of IPv6 EHs, as well as the operational implications of dropping packets that employ IPv6 EHs and associated options.<a href="#section-5-2.4" class="pilcrow">¶</a>
1517c1542
<           <span>[<a href="#RFC7113" class="xref">RFC7113</a>]</span> discusses how some popular Router Advertisement Guard (RA-Guard) implementations are subject to evasion by means of IPv6 extension headers.<a href="#section-5-2.5" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC7113" class="cite xref">RFC7113</a>]</span> discusses how some popular Router Advertisement Guard (RA-Guard) implementations are subject to evasion by means of IPv6 extension headers.<a href="#section-5-2.5" class="pilcrow">¶</a>
1520c1545
<           <span>[<a href="#RFC8900" class="xref">RFC8900</a>]</span> analyzes the fragility introduced by IP fragmentation.<a href="#section-5-2.6" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC8900" class="cite xref">RFC8900</a>]</span> analyzes the fragility introduced by IP fragmentation.<a href="#section-5-2.6" class="pilcrow">¶</a>
1523c1548
< <p id="section-5-3">A number of recent RFCs have discussed issues related to IPv6 extension headers and have specified updates to RFC 2460 <span>[<a href="#RFC2460" class="xref">RFC2460</a>]</span> (an earlier version of the IPv6 standard). Many of these updates have now been incorporated into the current IPv6 core standard <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> or the IPv6 node requirements <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span>. Namely,<a href="#section-5-3" class="pilcrow">¶</a></p>
---
> <p id="section-5-3">A number of recent RFCs have discussed issues related to IPv6 extension headers and have specified updates to RFC 2460 <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span> (an earlier version of the IPv6 standard). Many of these updates have now been incorporated into the current IPv6 core standard <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> or the IPv6 node requirements <span>[<a href="#RFC8504" class="cite xref">RFC8504</a>]</span>. Namely,<a href="#section-5-3" class="pilcrow">¶</a></p>
1526c1551
<           <span>[<a href="#RFC5095" class="xref">RFC5095</a>]</span> discusses the security implications of Routing Header Type 0 (RHT0) and deprecates it.<a href="#section-5-4.1" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC5095" class="cite xref">RFC5095</a>]</span> discusses the security implications of Routing Header Type 0 (RHT0) and deprecates it.<a href="#section-5-4.1" class="pilcrow">¶</a>
1529c1554
<           <span>[<a href="#RFC5722" class="xref">RFC5722</a>]</span> analyzes the security implications of overlapping fragments and provides recommendations in this area.<a href="#section-5-4.2" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC5722" class="cite xref">RFC5722</a>]</span> analyzes the security implications of overlapping fragments and provides recommendations in this area.<a href="#section-5-4.2" class="pilcrow">¶</a>
1532c1557
<           <span>[<a href="#RFC7045" class="xref">RFC7045</a>]</span> clarifies how intermediate nodes should deal with IPv6 extension headers.<a href="#section-5-4.3" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC7045" class="cite xref">RFC7045</a>]</span> clarifies how intermediate nodes should deal with IPv6 extension headers.<a href="#section-5-4.3" class="pilcrow">¶</a>
1535c1560
<           <span>[<a href="#RFC7112" class="xref">RFC7112</a>]</span> discusses the issues arising in a specific fragmentation case where the IPv6 header chain is fragmented into two or more fragments and formally forbids such fragmentation.<a href="#section-5-4.4" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC7112" class="cite xref">RFC7112</a>]</span> discusses the issues arising in a specific fragmentation case where the IPv6 header chain is fragmented into two or more fragments and formally forbids such fragmentation.<a href="#section-5-4.4" class="pilcrow">¶</a>
1538c1563
<           <span>[<a href="#RFC6946" class="xref">RFC6946</a>]</span> discusses a flawed (but common) processing of the so-called IPv6 "atomic fragments" and specifies improved processing of such packets.<a href="#section-5-4.5" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC6946" class="cite xref">RFC6946</a>]</span> discusses a flawed (but common) processing of the so-called IPv6 "atomic fragments" and specifies improved processing of such packets.<a href="#section-5-4.5" class="pilcrow">¶</a>
1541c1566
<           <span>[<a href="#RFC8021" class="xref">RFC8021</a>]</span> deprecates the generation of IPv6 atomic fragments.<a href="#section-5-4.6" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC8021" class="cite xref">RFC8021</a>]</span> deprecates the generation of IPv6 atomic fragments.<a href="#section-5-4.6" class="pilcrow">¶</a>
1544c1569
<           <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> clarifies processing rules for packets with extension headers and also allows hosts to enforce limits on the number of options included in IPv6 EHs.<a href="#section-5-4.7" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC8504" class="cite xref">RFC8504</a>]</span> clarifies processing rules for packets with extension headers and also allows hosts to enforce limits on the number of options included in IPv6 EHs.<a href="#section-5-4.7" class="pilcrow">¶</a>
1547c1572
<           <span>[<a href="#RFC7739" class="xref">RFC7739</a>]</span> discusses the security implications of predictable fragment Identification values and provides recommendations for the generation of these values.<a href="#section-5-4.8" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC7739" class="cite xref">RFC7739</a>]</span> discusses the security implications of predictable fragment Identification values and provides recommendations for the generation of these values.<a href="#section-5-4.8" class="pilcrow">¶</a>
1550c1575
<           <span>[<a href="#RFC6980" class="xref">RFC6980</a>]</span> analyzes the security implications of employing IPv6 fragmentation with Neighbor Discovery for IPv6 and formally recommends against such usage.<a href="#section-5-4.9" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC6980" class="cite xref">RFC6980</a>]</span> analyzes the security implications of employing IPv6 fragmentation with Neighbor Discovery for IPv6 and formally recommends against such usage.<a href="#section-5-4.9" class="pilcrow">¶</a>
1553c1578
< <p id="section-5-5">Additionally, <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> has relaxed the requirement that "all nodes must examine and process the Hop-by-Hop Options header" from <span>[<a href="#RFC2460" class="xref">RFC2460</a>]</span>, by specifying that only nodes that have been explicitly configured to process the Hop-by-Hop Options header are required to do so.<a href="#section-5-5" class="pilcrow">¶</a></p>
---
> <p id="section-5-5">Additionally, <span>[<a href="#RFC8200" class="cite xref">RFC8200</a>]</span> has relaxed the requirement that "all nodes must examine and process the Hop-by-Hop Options header" from <span>[<a href="#RFC2460" class="cite xref">RFC2460</a>]</span>, by specifying that only nodes that have been explicitly configured to process the Hop-by-Hop Options header are required to do so.<a href="#section-5-5" class="pilcrow">¶</a></p>
1557c1582
<           <span>[<a href="#PMTUD-Blackholes" class="xref">PMTUD-Blackholes</a>]</span> and <span>[<a href="#Linkova-Gont-IEPG90" class="xref">Linkova-Gont-IEPG90</a>]</span> present some preliminary measurements regarding the extent to which packets containing IPv6 EHs are dropped in the public Internet.<a href="#section-5-7.1" class="pilcrow">¶</a>
---
>           <span>[<a href="#PMTUD-Blackholes" class="cite xref">PMTUD-Blackholes</a>]</span> and <span>[<a href="#Linkova-Gont-IEPG90" class="cite xref">Linkova-Gont-IEPG90</a>]</span> present some preliminary measurements regarding the extent to which packets containing IPv6 EHs are dropped in the public Internet.<a href="#section-5-7.1" class="pilcrow">¶</a>
1560c1585
<           <span>[<a href="#RFC7872" class="xref">RFC7872</a>]</span> presents more comprehensive results and documents the methodology used to obtain these results.<a href="#section-5-7.2" class="pilcrow">¶</a>
---
>           <span>[<a href="#RFC7872" class="cite xref">RFC7872</a>]</span> presents more comprehensive results and documents the methodology used to obtain these results.<a href="#section-5-7.2" class="pilcrow">¶</a>
1563c1588
<           <span>[<a href="#Huston-2017" class="xref">Huston-2017</a>]</span> and <span>[<a href="#Huston-2020" class="xref">Huston-2020</a>]</span> measure packet drops resulting from IPv6 fragmentation when communicating with DNS servers.<a href="#section-5-7.3" class="pilcrow">¶</a>
---
>           <span>[<a href="#Huston-2017" class="cite xref">Huston-2017</a>]</span> and <span>[<a href="#Huston-2020" class="cite xref">Huston-2020</a>]</span> measure packet drops resulting from IPv6 fragmentation when communicating with DNS servers.<a href="#section-5-7.3" class="pilcrow">¶</a>
1577c1602
< packets across their internal fabrics (see <span>[<a href="#IEPG94-Scudder" class="xref">IEPG94-Scudder</a>]</span> and <span>[<a href="#APNIC-Scudder" class="xref">APNIC-Scudder</a>]</span> for details).  One common method of handling next-hop lookups is to send a small portion of the
---
> packets across their internal fabrics (see <span>[<a href="#IEPG94-Scudder" class="cite xref">IEPG94-Scudder</a>]</span> and <span>[<a href="#APNIC-Scudder" class="cite xref">APNIC-Scudder</a>]</span> for details).  One common method of handling next-hop lookups is to send a small portion of the
1595c1620
< to the lookup engine, then the router will normally drop the packet. <a href="#inability" class="xref">Section 7</a> discusses some of the reasons for which a contemporary router might need to access Layer 4 information to make a forwarding decision.<a href="#section-6-3" class="pilcrow">¶</a></p>
---
> to the lookup engine, then the router will normally drop the packet. <a href="#inability" class="auto internal xref">Section 7</a> discusses some of the reasons for which a contemporary router might need to access Layer 4 information to make a forwarding decision.<a href="#section-6-3" class="pilcrow">¶</a></p>
1662,1663c1687,1688
< <p id="section-7.1-2">In the IPv6 world, flows are expected to be identified by means of the IPv6 "Flow Label" <span>[<a href="#RFC6437" class="xref">RFC6437</a>]</span>. Thus, ECMP and hash-based load sharing should be possible without the need to process the entire IPv6 header chain to obtain upper-layer information to identify flows. <span>[<a href="#RFC7098" class="xref">RFC7098</a>]</span> discusses how the IPv6 Flow Label can be used to enhance Layer 3/4 load distribution and balancing for large server farms.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
< <p id="section-7.1-3">Historically, many IPv6 implementations failed to set the Flow Label, and hash-based ECMP/load-sharing devices also did not employ the Flow Label for performing their task. While support of <span>[<a href="#RFC6437" class="xref">RFC6437</a>]</span> is currently widespread for current versions of all popular host implementations, there is still only marginal usage of the IPv6 Flow Label for ECMP and load balancing <span>[<a href="#Almeida-2020" class="xref">Almeida-2020</a>]</span>. A contributing factor could be the issues that have been found in host implementations and middleboxes <span>[<a href="#Jaeggli-2018" class="xref">Jaeggli-2018</a>]</span>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
---
> <p id="section-7.1-2">In the IPv6 world, flows are expected to be identified by means of the IPv6 "Flow Label" <span>[<a href="#RFC6437" class="cite xref">RFC6437</a>]</span>. Thus, ECMP and hash-based load sharing should be possible without the need to process the entire IPv6 header chain to obtain upper-layer information to identify flows. <span>[<a href="#RFC7098" class="cite xref">RFC7098</a>]</span> discusses how the IPv6 Flow Label can be used to enhance Layer 3/4 load distribution and balancing for large server farms.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
> <p id="section-7.1-3">Historically, many IPv6 implementations failed to set the Flow Label, and hash-based ECMP/load-sharing devices also did not employ the Flow Label for performing their task. While support of <span>[<a href="#RFC6437" class="cite xref">RFC6437</a>]</span> is currently widespread for current versions of all popular host implementations, there is still only marginal usage of the IPv6 Flow Label for ECMP and load balancing <span>[<a href="#Almeida-2020" class="cite xref">Almeida-2020</a>]</span>. A contributing factor could be the issues that have been found in host implementations and middleboxes <span>[<a href="#Jaeggli-2018" class="cite xref">Jaeggli-2018</a>]</span>.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
1665c1690
< Clearly, widespread support of <span>[<a href="#RFC6437" class="xref">RFC6437</a>]</span> would relieve intermediate systems from having to process the entire IPv6 header chain, making Flow Label-based ECMP and load sharing <span>[<a href="#RFC6438" class="xref">RFC6438</a>]</span> feasible.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
---
> Clearly, widespread support of <span>[<a href="#RFC6437" class="cite xref">RFC6437</a>]</span> would relieve intermediate systems from having to process the entire IPv6 header chain, making Flow Label-based ECMP and load sharing <span>[<a href="#RFC6438" class="cite xref">RFC6438</a>]</span> feasible.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
1702c1727
< to a network edge is often automated using BGP Flowspec <span>[<a href="#RFC8955" class="xref">RFC8955</a>]</span> <span>[<a href="#RFC8956" class="xref">RFC8956</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
---
> to a network edge is often automated using BGP Flowspec <span>[<a href="#RFC8955" class="cite xref">RFC8955</a>]</span> <span>[<a href="#RFC8956" class="cite xref">RFC8956</a>]</span>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
1706c1731
< source-based remote triggered black hole <span>[<a href="#RFC5635" class="xref">RFC5635</a>]</span>
---
> source-based remote triggered black hole <span>[<a href="#RFC5635" class="cite xref">RFC5635</a>]</span>
1727c1752
<           <li class="normal" id="section-7.4-4.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a href="#nmap" class="xref">nmap</a>]</span>).<a href="#section-7.4-4.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-7.4-4.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a href="#nmap" class="cite xref">nmap</a>]</span>).<a href="#section-7.4-4.3" class="pilcrow">¶</a>
1739c1764
< <p id="section-7.5-2">As with a NIDS or IPS (<a href="#nids" class="xref">Section 7.4</a>), use of IPv6 extension headers can represent a challenge to network firewalls, since:<a href="#section-7.5-2" class="pilcrow">¶</a></p>
---
> <p id="section-7.5-2">As with a NIDS or IPS (<a href="#nids" class="auto internal xref">Section 7.4</a>), use of IPv6 extension headers can represent a challenge to network firewalls, since:<a href="#section-7.5-2" class="pilcrow">¶</a></p>
1741c1766
< <li class="normal" id="section-7.5-3.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it, as outlined in <span>[<a href="#Zack-FW-Benchmark" class="xref">Zack-FW-Benchmark</a>]</span>.<a href="#section-7.5-3.1" class="pilcrow">¶</a>
---
> <li class="normal" id="section-7.5-3.1">Extension headers increase the complexity of resulting traffic and the associated work and system requirements to process it, as outlined in <span>[<a href="#Zack-FW-Benchmark" class="cite xref">Zack-FW-Benchmark</a>]</span>.<a href="#section-7.5-3.1" class="pilcrow">¶</a>
1745c1770
<           <li class="normal" id="section-7.5-3.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a href="#nmap" class="xref">nmap</a>]</span>).<a href="#section-7.5-3.3" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-7.5-3.3">Use of IPv6 fragmentation requires a stateful fragment-reassembly operation, even for decoy traffic employing forged source addresses (see, e.g., <span>[<a href="#nmap" class="cite xref">nmap</a>]</span>).<a href="#section-7.5-3.3" class="pilcrow">¶</a>
1753c1778
< <p id="section-7.5-6">Note that although the data presented in <span>[<a href="#Zack-FW-Benchmark" class="xref">Zack-FW-Benchmark</a>]</span> was several years old at the time of publication of this document, many contemporary firewalls use comparable hardware and software architectures; consequently, the conclusions of this benchmark are still relevant, despite its age.<a href="#section-7.5-6" class="pilcrow">¶</a></p>
---
> <p id="section-7.5-6">Note that although the data presented in <span>[<a href="#Zack-FW-Benchmark" class="cite xref">Zack-FW-Benchmark</a>]</span> was several years old at the time of publication of this document, many contemporary firewalls use comparable hardware and software architectures; consequently, the conclusions of this benchmark are still relevant, despite its age.<a href="#section-7.5-6" class="pilcrow">¶</a></p>
1768c1793
< <p id="section-8.1-1">As discussed in <a href="#inability" class="xref">Section 7</a>, intermediate systems that need to find the Layer 4 header must process the entire IPv6 header chain.  When such devices are unable to obtain the required information, the forwarding device has the option to drop the packet unconditionally, forward the packet unconditionally, or process the packet outside the normal forwarding path.  Forwarding packets unconditionally will usually allow for the circumvention of security controls (see, e.g., <a href="#firewalls" class="xref">Section 7.5</a>), while processing packets outside of the normal forwarding path will usually open the door to Denial-of-Service (DoS) attacks (see, e.g., <a href="#pfe-constraints" class="xref">Section 6</a>). Thus, in these scenarios, devices often simply resort to dropping such packets unconditionally.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
---
> <p id="section-8.1-1">As discussed in <a href="#inability" class="auto internal xref">Section 7</a>, intermediate systems that need to find the Layer 4 header must process the entire IPv6 header chain.  When such devices are unable to obtain the required information, the forwarding device has the option to drop the packet unconditionally, forward the packet unconditionally, or process the packet outside the normal forwarding path.  Forwarding packets unconditionally will usually allow for the circumvention of security controls (see, e.g., <a href="#firewalls" class="auto internal xref">Section 7.5</a>), while processing packets outside of the normal forwarding path will usually open the door to Denial-of-Service (DoS) attacks (see, e.g., <a href="#pfe-constraints" class="auto internal xref">Section 6</a>). Thus, in these scenarios, devices often simply resort to dropping such packets unconditionally.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
1782c1807
< <p id="section-8.2-2">The Hop-by-Hop Options header has been particularly challenging since, in most circumstances, the corresponding packet is punted to the control plane for processing. As a result, many operators drop IPv6 packets containing this extension header <span>[<a href="#RFC7872" class="xref">RFC7872</a>]</span>. <span>[<a href="#RFC6192" class="xref">RFC6192</a>]</span> provides advice regarding protection of a router's control plane.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
---
> <p id="section-8.2-2">The Hop-by-Hop Options header has been particularly challenging since, in most circumstances, the corresponding packet is punted to the control plane for processing. As a result, many operators drop IPv6 packets containing this extension header <span>[<a href="#RFC7872" class="cite xref">RFC7872</a>]</span>. <span>[<a href="#RFC6192" class="cite xref">RFC6192</a>]</span> provides advice regarding protection of a router's control plane.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
1809,1810c1834,1835
< <p id="section-8.4-3">Unlike IPv4 packets where the upper-layer protocol can be trivially found by means of the IHL field of the IPv4 header, the structure of IPv6 packets is more flexible and complex.  This can represent a challenge for devices that need to find this information, since locating upper-layer protocol information requires that all IPv6 extension headers be examined. In turn, this presents implementation difficulties, since some packet-filtering mechanisms that require upper-layer information (even if just the upper-layer protocol type) can be trivially circumvented by inserting IPv6 extension headers between the main IPv6 header and the upper-layer protocol header. <span>[<a href="#RFC7113" class="xref">RFC7113</a>]</span> describes this issue for the RA-Guard case, but the same techniques could be employed to circumvent other IPv6 firewall and packet-filtering mechanisms.  Additionally, implementation inconsistencies in packet-forwarding engines can result in evasion of security controls <span>[<a href="#I-D.kampanakis-6man-ipv6-eh-parsing" class="xref">PARSING</a>]</span> <span>[<a href="#Atlasis2014" class="xref">Atlasis2014</a>]</span> <span>[<a href="#BH-EU-2014" class="xref">BH-EU-2014</a>]</span>.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
< <p id="section-8.4-4">Sometimes, packets with IPv6 extension headers can impact throughput performance on intermediate systems. Unless appropriate mitigations are put in place (e.g., packet dropping and/or rate limiting), an attacker could simply send a large amount of IPv6 traffic employing IPv6 extension headers with the purpose of performing a DoS attack (see Sections <a href="#recirculation" class="xref">6.1</a> and <a href="#operational-implications" class="xref">8</a> for further details). The extent to which performance is affected on these devices is implementation dependent.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
---
> <p id="section-8.4-3">Unlike IPv4 packets where the upper-layer protocol can be trivially found by means of the IHL field of the IPv4 header, the structure of IPv6 packets is more flexible and complex.  This can represent a challenge for devices that need to find this information, since locating upper-layer protocol information requires that all IPv6 extension headers be examined. In turn, this presents implementation difficulties, since some packet-filtering mechanisms that require upper-layer information (even if just the upper-layer protocol type) can be trivially circumvented by inserting IPv6 extension headers between the main IPv6 header and the upper-layer protocol header. <span>[<a href="#RFC7113" class="cite xref">RFC7113</a>]</span> describes this issue for the RA-Guard case, but the same techniques could be employed to circumvent other IPv6 firewall and packet-filtering mechanisms.  Additionally, implementation inconsistencies in packet-forwarding engines can result in evasion of security controls <span>[<a href="#I-D.kampanakis-6man-ipv6-eh-parsing" class="cite xref">PARSING</a>]</span> <span>[<a href="#Atlasis2014" class="cite xref">Atlasis2014</a>]</span> <span>[<a href="#BH-EU-2014" class="cite xref">BH-EU-2014</a>]</span>.<a href="#section-8.4-3" class="pilcrow">¶</a></p>
> <p id="section-8.4-4">Sometimes, packets with IPv6 extension headers can impact throughput performance on intermediate systems. Unless appropriate mitigations are put in place (e.g., packet dropping and/or rate limiting), an attacker could simply send a large amount of IPv6 traffic employing IPv6 extension headers with the purpose of performing a DoS attack (see Sections <a href="#recirculation" class="auto internal xref">6.1</a> and <a href="#operational-implications" class="auto internal xref">8</a> for further details). The extent to which performance is affected on these devices is implementation dependent.<a href="#section-8.4-4" class="pilcrow">¶</a></p>
1814c1839
< In the most trivial case, a packet that includes a Hop-by-Hop Options header might go through the slow forwarding path, to be processed by the router's CPU. Alternatively, a router configured to enforce an ACL based on upper-layer information (e.g., upper-layer protocol type or TCP Destination Port) may need to process the entire IPv6 header chain in order to find the required information, thereby causing the packet to be processed in the slow path <span>[<a href="#Cisco-EH-Cons" class="xref">Cisco-EH-Cons</a>]</span>. We note that, for obvious reasons, the aforementioned performance issues can affect devices such as firewalls, NIDSs, etc. <span>[<a href="#Zack-FW-Benchmark" class="xref">Zack-FW-Benchmark</a>]</span>.<a href="#section-8.4-5.2" class="pilcrow">¶</a></p>
---
> In the most trivial case, a packet that includes a Hop-by-Hop Options header might go through the slow forwarding path, to be processed by the router's CPU. Alternatively, a router configured to enforce an ACL based on upper-layer information (e.g., upper-layer protocol type or TCP Destination Port) may need to process the entire IPv6 header chain in order to find the required information, thereby causing the packet to be processed in the slow path <span>[<a href="#Cisco-EH-Cons" class="cite xref">Cisco-EH-Cons</a>]</span>. We note that, for obvious reasons, the aforementioned performance issues can affect devices such as firewalls, NIDSs, etc. <span>[<a href="#Zack-FW-Benchmark" class="cite xref">Zack-FW-Benchmark</a>]</span>.<a href="#section-8.4-5.2" class="pilcrow">¶</a></p>
1816,1817c1841,1842
< <p id="section-8.4-6">IPv6 implementations, like all other software, tend to mature with time and wide-scale deployment. While the IPv6 protocol itself has existed for over 20 years, serious bugs related to IPv6 extension header processing continue to be discovered (see, e.g., <span>[<a href="#Cisco-Frag" class="xref">Cisco-Frag</a>]</span>, <span>[<a href="#Microsoft-SA" class="xref">Microsoft-SA</a>]</span>, and <span>[<a href="#FreeBSD-SA" class="xref">FreeBSD-SA</a>]</span>).  Because there is currently little operational reliance on IPv6 extension headers, the corresponding code paths are rarely exercised, and there is the potential for bugs that still remain to be discovered in some implementations.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
< <p id="section-8.4-7">The IPv6 Fragment Header is employed for the fragmentation and reassembly of IPv6 packets. While many of the security implications of the fragmentation/reassembly mechanism are known from the IPv4 world, several related issues have crept into IPv6 implementations. These range from DoS attacks to information leakages, as discussed in <span>[<a href="#RFC7739" class="xref">RFC7739</a>]</span>, <span>[<a href="#Bonica-NANOG58" class="xref">Bonica-NANOG58</a>]</span>, and <span>[<a href="#Atlasis2012" class="xref">Atlasis2012</a>]</span>.<a href="#section-8.4-7" class="pilcrow">¶</a></p>
---
> <p id="section-8.4-6">IPv6 implementations, like all other software, tend to mature with time and wide-scale deployment. While the IPv6 protocol itself has existed for over 20 years, serious bugs related to IPv6 extension header processing continue to be discovered (see, e.g., <span>[<a href="#Cisco-Frag" class="cite xref">Cisco-Frag</a>]</span>, <span>[<a href="#Microsoft-SA" class="cite xref">Microsoft-SA</a>]</span>, and <span>[<a href="#FreeBSD-SA" class="cite xref">FreeBSD-SA</a>]</span>).  Because there is currently little operational reliance on IPv6 extension headers, the corresponding code paths are rarely exercised, and there is the potential for bugs that still remain to be discovered in some implementations.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
> <p id="section-8.4-7">The IPv6 Fragment Header is employed for the fragmentation and reassembly of IPv6 packets. While many of the security implications of the fragmentation/reassembly mechanism are known from the IPv4 world, several related issues have crept into IPv6 implementations. These range from DoS attacks to information leakages, as discussed in <span>[<a href="#RFC7739" class="cite xref">RFC7739</a>]</span>, <span>[<a href="#Bonica-NANOG58" class="cite xref">Bonica-NANOG58</a>]</span>, and <span>[<a href="#Atlasis2012" class="cite xref">Atlasis2012</a>]</span>.<a href="#section-8.4-7" class="pilcrow">¶</a></p>
1834c1859
< <p id="section-10-1">The security implications of IPv6 extension headers are discussed in <a href="#security-implications" class="xref">Section 8.4</a>.  This document does not introduce any new security issues.<a href="#section-10-1" class="pilcrow">¶</a></p>
---
> <p id="section-10-1">The security implications of IPv6 extension headers are discussed in <a href="#security-implications" class="auto internal xref">Section 8.4</a>.  This document does not introduce any new security issues.<a href="#section-10-1" class="pilcrow">¶</a></p>
