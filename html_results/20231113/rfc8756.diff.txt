18c18
< <meta content="xml2rfc 2.41.0" name="generator">
---
> <meta content="xml2rfc 3.18.2" name="generator">
25c25,41
< <link href="rfc8756.xml" rel="alternate" type="application/rfc+xml">
---
> <!-- Generator version information:
>   xml2rfc 3.18.2
>     Python 3.11.6
>     ConfigArgParse 1.7
>     google-i18n-address 3.1.0
>     intervaltree 3.1.0
>     Jinja2 3.1.2
>     lxml 4.9.3
>     platformdirs 4.0.0
>     pycountry 22.3.5
>     PyYAML 6.0.1
>     requests 2.31.0
>     setuptools 65.5.0
>     six 1.16.0
>     wcwidth 0.2.9
> -->
> <link href="rfc/rfc8756.xml" rel="alternate" type="application/rfc+xml">
35c51
<   commented changes found necssary during the development of the v3
---
>   commented changes found necessary during the development of the v3
44a61,66
> :root {
>   --font-sans: 'Noto Sans', Arial, Helvetica, sans-serif;
>   --font-serif: 'Noto Serif', 'Times', 'Times New Roman', serif;
>   --font-mono: 'Roboto Mono', Courier, 'Courier New', monospace;
> }
> 
47d68
<   width: extend-to-zoom;
62c83
<   font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
---
>   font-family: var(--font-sans);
64a86
>   overflow-wrap: break-word;
150a173,181
> svg[font-family~="serif" i], svg [font-family~="serif" i] {
>   font-family: var(--font-serif);
> }
> svg[font-family~="sans-serif" i], svg [font-family~="sans-serif" i] {
>   font-family: var(--font-sans);
> }
> svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
>   font-family: var(--font-mono);
> }
165,168d195
<   border: none;
<   /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
<      support flexbox yet.
<   */
169a197
>   border: none;
192a221,223
> ul.ulBare, li.ulBare {
>   margin-left: 0em !important;
> }
234c265,266
< a[href].selfRef {
---
> a[href].selfRef,
> .iref + a[href].internal {
244c276
< tt, code, pre, code {
---
> tt, code, pre {
246c278
<   font-family: 'Roboto Mono', monospace;
---
>   font-family: var(--font-mono);
285a318,320
> blockquote > *:last-child {
>   margin-bottom: 0;
> }
375a411,416
> /* Fix PDF info block run off issue */
> @media print {
>   #identifiers dd {
>     float: none;
>   }
> }
477c518
<   font-family: "Noto Sans",Arial,Helvetica,sans-serif;
---
>   font-family: var(--font-sans);
617d657
< 
639a680,682
>   .breakable pre {
>     break-inside: auto;
>   }
707c750
<   /* The follwing is commented out here, but set appropriately by in code, as
---
>   /* The following is commented out here, but set appropriately by in code, as
807c850
< tt, code, pre, code {
---
> tt, code, pre {
812c855
< pre.sourcecode,
---
> .sourcecode pre,
848c891
< /* Make the alternative author contact informatio look less like just another
---
> /* Make the alternative author contact information look less like just another
926,931d968
< /* Avoid wrapping of URLs in references */
< @media screen {
<   .references a {
<     white-space: nowrap;
<   }
< }
1035a1073
>   .artwork > pre,
1050c1088
< and increase the contrast between border and odd row background sligthtly */
---
> and increase the contrast between border and odd row background slightly */
1056a1095,1097
> tr {
>   break-inside: avoid;
> }
1064a1106,1207
> /* Add support for keepWithNext */
> .keepWithNext {
>   break-after: avoid-page;
>   break-after: avoid-page;
> }
> /* Add support for keepWithPrevious */
> .keepWithPrevious {
>   break-before: avoid-page;
> }
> /* Change the approach to avoiding breaks inside artwork etc. */
> figure, pre, table, .artwork, .sourcecode  {
>   break-before: auto;
>   break-after: auto;
> }
> /* Avoid breaks between <dt> and <dd> */
> dl {
>   break-before: auto;
>   break-inside: auto;
> }
> dt {
>   break-before: auto;
>   break-after: avoid-page;
> }
> dd {
>   break-before: avoid-page;
>   break-after: auto;
>   orphans: 3;
>   widows: 3
> }
> span.break, dd.break {
>   margin-bottom: 0;
>   min-height: 0;
>   break-before: auto;
>   break-inside: auto;
>   break-after: auto;
> }
> /* Undo break-before ToC */
> @media print {
>   #toc {
>     break-before: auto;
>   }
> }
> /* Text in compact lists should not get extra bottom margin space,
>    since that would makes the list not compact */
> ul.compact p, .ulCompact p,
> ol.compact p, .olCompact p {
>  margin: 0;
> }
> /* But the list as a whole needs the extra space at the end */
> section ul.compact,
> section .ulCompact,
> section ol.compact,
> section .olCompact {
>   margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
> }
> /* The tt and code background above interferes with for instance table cell
>    backgrounds.  Changed to something a bit more selective. */
> tt, code {
>   background-color: transparent;
> }
> p tt, p code, li tt, li code {
>   background-color: #f8f8f8;
> }
> /* Tweak the pre margin -- 0px doesn't come out well */
> pre {
>    margin-top: 0.5px;
> }
> /* Tweak the compact list text */
> ul.compact, .ulCompact,
> ol.compact, .olCompact,
> dl.compact, .dlCompact {
>   line-height: normal;
> }
> /* Don't add top margin for nested lists */
> li > ul, li > ol, li > dl,
> dd > ul, dd > ol, dd > dl,
> dl > dd > dl {
>   margin-top: initial;
> }
> /* Elements that should not be rendered on the same line as a <dt> */
> /* This should match the element list in writer.text.TextWriter.render_dl() */
> dd > div.artwork:first-child,
> dd > aside:first-child,
> dd > figure:first-child,
> dd > ol:first-child,
> dd > div.sourcecode:first-child,
> dd > table:first-child,
> dd > ul:first-child {
>   clear: left;
> }
> /* fix for weird browser behaviour when <dd/> is empty */
> dt+dd:empty::before{
>   content: "\00a0";
> }
> /* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
> li > p {
>   margin-bottom: 0.5em
> }
> /* Don't let p margin spill out from inside list items */
> li > p:last-of-type:only-child {
>   margin-bottom: 0;
> }
1066a1210
> <link href="https://datatracker.ietf.org/doc/draft-jenkins-cnsa-cmc-profile-05" rel="prev">
1069c1213
<   <link href="https://datatracker.ietf.org/doc/draft-jenkins-cnsa-cmc-profile-05" rel="prev">
---
>   <script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
1071,1072c1215,1216
< <body>
< <script src="https://www.rfc-editor.org/js/metadata.min.js"></script>
---
> <body class="xml2rfc">
> <script src="metadata.min.js"></script>
1164,1169c1308,1313
< <nav class="toc"><ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.1">
<             <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
<                 <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
---
> <nav class="toc"><ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
>             <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
>                 <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
1173,1174c1317,1318
< <li class="toc ulEmpty" id="section-toc.1-1.2">
<             <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-the-commercial-national-sec" class="xref">The Commercial National Security Algorithm Suite</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
>             <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-the-commercial-national-sec" class="internal xref">The Commercial National Security Algorithm Suite</a></p>
1176,1177c1320,1321
< <li class="toc ulEmpty" id="section-toc.1-1.3">
<             <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-requirements-and-assumption" class="xref">Requirements and Assumptions</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
>             <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-requirements-and-assumption" class="internal xref">Requirements and Assumptions</a></p>
1179,1183c1323,1327
< <li class="toc ulEmpty" id="section-toc.1-1.4">
<             <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-client-requirements-generat" class="xref">Client Requirements: Generating PKI Requests</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
<                 <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-tagged-certification-reques" class="xref">Tagged Certification Request</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
>             <p id="section-toc.1-1.4.1" class="keepWithNext"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-client-requirements-generat" class="internal xref">Client Requirements: Generating PKI Requests</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
>                 <p id="section-toc.1-1.4.2.1.1" class="keepWithNext"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-tagged-certification-reques" class="internal xref">Tagged Certification Request</a></p>
1185,1186c1329,1330
< <li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
<                 <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-certificate-request-message" class="xref">Certificate Request Message</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
>                 <p id="section-toc.1-1.4.2.2.1" class="keepWithNext"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-certificate-request-message" class="internal xref">Certificate Request Message</a></p>
1190,1194c1334,1338
< <li class="toc ulEmpty" id="section-toc.1-1.5">
<             <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-ra-requirements" class="xref">RA Requirements</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
<                 <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ra-processing-of-requests" class="xref">RA Processing of Requests</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
>             <p id="section-toc.1-1.5.1" class="keepWithNext"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-ra-requirements" class="internal xref">RA Requirements</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
>                 <p id="section-toc.1-1.5.2.1.1" class="keepWithNext"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-ra-processing-of-requests" class="internal xref">RA Processing of Requests</a></p>
1196,1197c1340,1341
< <li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
<                 <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ra-generated-pki-requests" class="xref">RA-Generated PKI Requests</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
>                 <p id="section-toc.1-1.5.2.2.1" class="keepWithNext"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-ra-generated-pki-requests" class="internal xref">RA-Generated PKI Requests</a></p>
1199,1200c1343,1344
< <li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
<                 <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ra-generated-pki-responses" class="xref">RA-Generated PKI Responses</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
>                 <p id="section-toc.1-1.5.2.3.1" class="keepWithNext"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-ra-generated-pki-responses" class="internal xref">RA-Generated PKI Responses</a></p>
1204,1208c1348,1352
< <li class="toc ulEmpty" id="section-toc.1-1.6">
<             <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-ca-requirements" class="xref">CA Requirements</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
<                 <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ca-processing-of-pki-reques" class="xref">CA Processing of PKI Requests</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
>             <p id="section-toc.1-1.6.1" class="keepWithNext"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-ca-requirements" class="internal xref">CA Requirements</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
>                 <p id="section-toc.1-1.6.2.1.1" class="keepWithNext"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-ca-processing-of-pki-reques" class="internal xref">CA Processing of PKI Requests</a></p>
1210,1211c1354,1355
< <li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
<                 <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-ca-generated-pki-responses" class="xref">CA-Generated PKI Responses</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
>                 <p id="section-toc.1-1.6.2.2.1" class="keepWithNext"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-ca-generated-pki-responses" class="internal xref">CA-Generated PKI Responses</a></p>
1215,1216c1359,1360
< <li class="toc ulEmpty" id="section-toc.1-1.7">
<             <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-client-requirements-process" class="xref">Client Requirements: Processing PKI Responses</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
>             <p id="section-toc.1-1.7.1" class="keepWithNext"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-client-requirements-process" class="internal xref">Client Requirements: Processing PKI Responses</a></p>
1218,1219c1362,1363
< <li class="toc ulEmpty" id="section-toc.1-1.8">
<             <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-shared-secrets" class="xref">Shared-Secrets</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
>             <p id="section-toc.1-1.8.1" class="keepWithNext"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-shared-secrets" class="internal xref">Shared-Secrets</a></p>
1221,1222c1365,1366
< <li class="toc ulEmpty" id="section-toc.1-1.9">
<             <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
>             <p id="section-toc.1-1.9.1" class="keepWithNext"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
1224,1231c1368,1375
< <li class="toc ulEmpty" id="section-toc.1-1.10">
<             <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
< </li>
< <li class="toc ulEmpty" id="section-toc.1-1.11">
<             <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.1">
<                 <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
>             <p id="section-toc.1-1.10.1" class="keepWithNext"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
> </li>
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
>             <p id="section-toc.1-1.11.1" class="keepWithNext"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
>                 <p id="section-toc.1-1.11.2.1.1" class="keepWithNext"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
1233,1234c1377,1378
< <li class="toc ulEmpty" id="section-toc.1-1.11.2.2">
<                 <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
>                 <p id="section-toc.1-1.11.2.2.1" class="keepWithNext"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
1238,1242c1382,1386
< <li class="toc ulEmpty" id="section-toc.1-1.12">
<             <p id="section-toc.1-1.12.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-scenarios" class="xref">Scenarios</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
< <ul class="toc ulEmpty">
< <li class="toc ulEmpty" id="section-toc.1-1.12.2.1">
<                 <p id="section-toc.1-1.12.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-initial-enrollment" class="xref">Initial Enrollment</a><a href="#section-toc.1-1.12.2.1.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
>             <p id="section-toc.1-1.12.1" class="keepWithNext"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-scenarios" class="internal xref">Scenarios</a></p>
> <ul class="compact toc ulBare ulEmpty">
> <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
>                 <p id="section-toc.1-1.12.2.1.1" class="keepWithNext"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-initial-enrollment" class="internal xref">Initial Enrollment</a></p>
1244,1245c1388,1389
< <li class="toc ulEmpty" id="section-toc.1-1.12.2.2">
<                 <p id="section-toc.1-1.12.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-rekey" class="xref">Rekey</a><a href="#section-toc.1-1.12.2.2.1" class="pilcrow">¶</a></p>
---
>               <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
>                 <p id="section-toc.1-1.12.2.2.1" class="keepWithNext"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-rekey" class="internal xref">Rekey</a></p>
1249,1250c1393,1394
< <li class="toc ulEmpty" id="section-toc.1-1.13">
<             <p id="section-toc.1-1.13.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
---
>           <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
>             <p id="section-toc.1-1.13.1" class="keepWithNext"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
1261,1262c1405,1406
< <p id="section-1-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol to comply with the United States National Security Agency's Commercial National Security Algorithm (CNSA) Suite <span>[<a href="#CNSA" class="xref">CNSA</a>]</span>. The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems <span>[<a href="#SP80059" class="xref">SP80059</a>]</span>. It is also appropriate for all other US Government systems that process high-value information. It is made publicly available for use by developers and operators of these and any other system deployments.<a href="#section-1-1" class="pilcrow">¶</a></p>
< <p id="section-1-2">This document does not define any new cryptographic algorithm suites; instead, it defines a CNSA-compliant profile of CMC. CMC is defined in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, and <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span> and is updated by <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. This document profiles CMC to manage X.509 public key certificates in compliance with the CNSA Suite Certificate and Certificate Revocation List (CRL) profile <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>. This document specifically focuses on defining CMC interactions for both the initial enrollment and rekey of CNSA Suite public key certificates between a client and a Certification Authority (CA).  One or more Registration Authorities (RAs) may act as intermediaries between the client and the CA.  This profile may be further tailored by specific communities to meet their needs.  Specific communities will also define certificate policies that implementations need to comply with.<a href="#section-1-2" class="pilcrow">¶</a></p>
---
> <p id="section-1-1">This document specifies a profile of the Certificate Management over CMS (CMC) protocol to comply with the United States National Security Agency's Commercial National Security Algorithm (CNSA) Suite <span>[<a href="#CNSA" class="cite xref">CNSA</a>]</span>. The profile applies to the capabilities, configuration, and operation of all components of US National Security Systems <span>[<a href="#SP80059" class="cite xref">SP80059</a>]</span>. It is also appropriate for all other US Government systems that process high-value information. It is made publicly available for use by developers and operators of these and any other system deployments.<a href="#section-1-1" class="pilcrow">¶</a></p>
> <p id="section-1-2">This document does not define any new cryptographic algorithm suites; instead, it defines a CNSA-compliant profile of CMC. CMC is defined in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="cite xref">RFC5273</a>]</span>, and <span>[<a href="#RFC5274" class="cite xref">RFC5274</a>]</span> and is updated by <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>. This document profiles CMC to manage X.509 public key certificates in compliance with the CNSA Suite Certificate and Certificate Revocation List (CRL) profile <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>. This document specifically focuses on defining CMC interactions for both the initial enrollment and rekey of CNSA Suite public key certificates between a client and a Certification Authority (CA).  One or more Registration Authorities (RAs) may act as intermediaries between the client and the CA.  This profile may be further tailored by specific communities to meet their needs.  Specific communities will also define certificate policies that implementations need to comply with.<a href="#section-1-2" class="pilcrow">¶</a></p>
1268,1269c1412,1413
< <p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
< <p id="section-1.1-2">The terminology in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-2.1" class="relref">Section 2.1</a></span> applies to this profile.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
---
> <p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
> <p id="section-1.1-2">The terminology in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-2.1" class="relref">Section 2.1</a></span> applies to this profile.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
1297c1441
<       Diffie-Hellman (ECDH) key pairs are on the P-384 curve.  FIPS 186-4 <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>, Appendix B.4 provides useful guidance for elliptic curve key pair generation that <span class="bcp14">SHOULD</span> be followed by systems that conform to this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
---
>       Diffie-Hellman (ECDH) key pairs are on the P-384 curve.  FIPS 186-4 <span>[<a href="#FIPS186" class="cite xref">FIPS186</a>]</span>, Appendix B.4 provides useful guidance for elliptic curve key pair generation that <span class="bcp14">SHOULD</span> be followed by systems that conform to this document.<a href="#section-3-1" class="pilcrow">¶</a></p>
1299,1302c1443,1446
< <p id="section-3-3">RSA signature key pairs used in CNSA Suite-compliant implementations are either RSA-3072 or RSA-4096. The RSA exponent e <span class="bcp14">MUST</span> satisfy 2<sup>16</sup> &lt; e &lt; 2<sup>256</sup> and be odd per <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
< <p id="section-3-4">It is recognized that, while the vast majority of RSA signatures are currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA signature scheme for new applications is RSASSA-PSS.  CNSA Suite-compliant X.509 certificates will be issued in accordance with <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>, and while those certificates must be signed and validated using RSASSA-PKCS1-v1_5, the subject's private key can be used to generate signatures of either signing scheme.  Where use of RSASSA-PSS is indicated in this document, the following parameters apply:<a href="#section-3-4" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-3-5.1">The hash algorithm <span class="bcp14">MUST</span> be id-sha384 as defined in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>;<a href="#section-3-5.1" class="pilcrow">¶</a>
---
> <p id="section-3-3">RSA signature key pairs used in CNSA Suite-compliant implementations are either RSA-3072 or RSA-4096. The RSA exponent e <span class="bcp14">MUST</span> satisfy 2<sup>16</sup> &lt; e &lt; 2<sup>256</sup> and be odd per <span>[<a href="#FIPS186" class="cite xref">FIPS186</a>]</span>.<a href="#section-3-3" class="pilcrow">¶</a></p>
> <p id="section-3-4">It is recognized that, while the vast majority of RSA signatures are currently made using the RSASSA-PKCS1-v1_5 algorithm, the preferred RSA signature scheme for new applications is RSASSA-PSS.  CNSA Suite-compliant X.509 certificates will be issued in accordance with <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>, and while those certificates must be signed and validated using RSASSA-PKCS1-v1_5, the subject's private key can be used to generate signatures of either signing scheme.  Where use of RSASSA-PSS is indicated in this document, the following parameters apply:<a href="#section-3-4" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-3-5.1">The hash algorithm <span class="bcp14">MUST</span> be id-sha384 as defined in <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>;<a href="#section-3-5.1" class="pilcrow">¶</a>
1304c1448
< <li id="section-3-5.2">The mask generation function <span class="bcp14">MUST</span> use the algorithm identifier mfg1SHA384Identifier as defined in <span>[<a href="#RFC4055" class="xref">RFC4055</a>]</span>;<a href="#section-3-5.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-3-5.2">The mask generation function <span class="bcp14">MUST</span> use the algorithm identifier mfg1SHA384Identifier as defined in <span>[<a href="#RFC4055" class="cite xref">RFC4055</a>]</span>;<a href="#section-3-5.2" class="pilcrow">¶</a>
1306c1450
< <li id="section-3-5.3">The salt length <span class="bcp14">MUST</span> be 48 octets; and<a href="#section-3-5.3" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-3-5.3">The salt length <span class="bcp14">MUST</span> be 48 octets; and<a href="#section-3-5.3" class="pilcrow">¶</a>
1308c1452
< <li id="section-3-5.4">The trailerField <span class="bcp14">MUST</span> have value 1.<a href="#section-3-5.4" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-3-5.4">The trailerField <span class="bcp14">MUST</span> have value 1.<a href="#section-3-5.4" class="pilcrow">¶</a>
1314c1458
<       communicated with the signature, as required by <span><a href="https://www.rfc-editor.org/rfc/rfc4056#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC4056" class="xref">RFC4056</a>]</span>. Application developers are obliged to ensure that the chosen signature scheme is appropriate for the application and will be interoperable within the intended operating scope of the application.<a href="#section-3-6" class="pilcrow">¶</a></p>
---
>       communicated with the signature, as required by <span><a href="https://rfc-editor.org/rfc/rfc4056#section-2.2" class="relref">Section 2.2</a> of [<a href="#RFC4056" class="cite xref">RFC4056</a>]</span>. Application developers are obliged to ensure that the chosen signature scheme is appropriate for the application and will be interoperable within the intended operating scope of the application.<a href="#section-3-6" class="pilcrow">¶</a></p>
1316,1317c1460,1461
< <p id="section-3-8">All requirements in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span>, and <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span> apply, except where overridden by this profile.<a href="#section-3-8" class="pilcrow">¶</a></p>
< <p id="section-3-9">This profile was developed with the scenarios described in <a href="#scenarios" class="xref">Appendix A</a> in mind.  However, use of this profile is not limited to just those scenarios.<a href="#section-3-9" class="pilcrow">¶</a></p>
---
> <p id="section-3-8">All requirements in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="cite xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="cite xref">RFC5274</a>]</span>, and <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span> apply, except where overridden by this profile.<a href="#section-3-8" class="pilcrow">¶</a></p>
> <p id="section-3-9">This profile was developed with the scenarios described in <a href="#scenarios" class="auto internal xref">Appendix A</a> in mind.  However, use of this profile is not limited to just those scenarios.<a href="#section-3-9" class="pilcrow">¶</a></p>
1319c1463
< <p id="section-3-11">This profile uses the term "rekey" in the same manner as CMC does (defined in <span><a href="https://www.rfc-editor.org/rfc/rfc5272#section-2" class="relref">Section 2</a> of [<a href="#RFC5272" class="xref">RFC5272</a>]</span>).  The profile makes no specific statements about the ability to do "renewal" operations; however, the statements applicable to "rekey" should be applied to "renewal" as well.<a href="#section-3-11" class="pilcrow">¶</a></p>
---
> <p id="section-3-11">This profile uses the term "rekey" in the same manner as CMC does (defined in <span><a href="https://rfc-editor.org/rfc/rfc5272#section-2" class="relref">Section 2</a> of [<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>).  The profile makes no specific statements about the ability to do "renewal" operations; however, the statements applicable to "rekey" should be applied to "renewal" as well.<a href="#section-3-11" class="pilcrow">¶</a></p>
1330,1332c1474,1476
< <p id="section-4-2">The Full PKI Request <span class="bcp14">MUST</span> be used; it <span class="bcp14">MUST</span> be encapsulated in a SignedData; and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>. The PKIData content type defined in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> is used with the following additional requirements:<a href="#section-4-2" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-4-3.1">
---
> <p id="section-4-2">The Full PKI Request <span class="bcp14">MUST</span> be used; it <span class="bcp14">MUST</span> be encapsulated in a SignedData; and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>. The PKIData content type defined in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span> is used with the following additional requirements:<a href="#section-4-2" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-4-3.1">
1334,1335c1478,1479
< <ul>
< <li id="section-4-3.1.2.1">TransactionId and SenderNonce <span class="bcp14">SHOULD</span> be included. Other CMC controls <span class="bcp14">MAY</span> be included.<a href="#section-4-3.1.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4-3.1.2.1">TransactionId and SenderNonce <span class="bcp14">SHOULD</span> be included. Other CMC controls <span class="bcp14">MAY</span> be included.<a href="#section-4-3.1.2.1" class="pilcrow">¶</a>
1337c1481
< <li id="section-4-3.1.2.2">
---
>             <li class="normal" id="section-4-3.1.2.2">
1339,1340c1483,1484
< <ul>
< <li id="section-4-3.1.2.2.2.1">hashAlgId <span class="bcp14">MUST</span> be id-sha384 for all certification requests (algorithm OIDs are defined in <span>[<a href="#RFC5754" class="xref">RFC5754</a>]</span>).<a href="#section-4-3.1.2.2.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4-3.1.2.2.2.1">hashAlgId <span class="bcp14">MUST</span> be id-sha384 for all certification requests (algorithm OIDs are defined in <span>[<a href="#RFC5754" class="cite xref">RFC5754</a>]</span>).<a href="#section-4-3.1.2.2.2.1" class="pilcrow">¶</a>
1342,1343c1486,1487
< <li id="section-4-3.1.2.2.2.2">macAlgId <span class="bcp14">MUST</span> be HMAC-SHA384 (the Hashed
<  Message Authentication Code (HMAC) algorithm is defined in <span>[<a href="#RFC4231" class="xref">RFC4231</a>]</span>).<a href="#section-4-3.1.2.2.2.2" class="pilcrow">¶</a>
---
>                 <li class="normal" id="section-4-3.1.2.2.2.2">macAlgId <span class="bcp14">MUST</span> be HMAC-SHA384 (the Hashed
>  Message Authentication Code (HMAC) algorithm is defined in <span>[<a href="#RFC4231" class="cite xref">RFC4231</a>]</span>).<a href="#section-4-3.1.2.2.2.2" class="pilcrow">¶</a>
1347c1491
< <li id="section-4-3.1.2.3">If the subject name included in the certification request is NULL
---
>             <li class="normal" id="section-4-3.1.2.3">If the subject name included in the certification request is NULL
1351,1352c1495,1496
<      in the inner PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or
<      Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> request as described in Sections <a href="#tgd-cert-reqst" class="xref">4.1</a> and <a href="#cert-reqst-msg" class="xref">4.2</a>.<a href="#section-4-3.1.2.3" class="pilcrow">¶</a>
---
>      in the inner PKCS #10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or
>      Certificate Request Message Format (CRMF) <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> request as described in Sections <a href="#tgd-cert-reqst" class="auto internal xref">4.1</a> and <a href="#cert-reqst-msg" class="auto internal xref">4.2</a>.<a href="#section-4-3.1.2.3" class="pilcrow">¶</a>
1356c1500
< <li id="section-4-3.2">reqSequence <span class="bcp14">MUST</span> be present.  It <span class="bcp14">MUST</span> include at least one tcr (see <a href="#tgd-cert-reqst" class="xref">Section 4.1</a>) or crm (see <a href="#cert-reqst-msg" class="xref">Section 4.2</a>) TaggedRequest. Support for the orm choice is <span class="bcp14">OPTIONAL</span>.<a href="#section-4-3.2" class="pilcrow">¶</a>
---
>         <li class="normal" id="section-4-3.2">reqSequence <span class="bcp14">MUST</span> be present.  It <span class="bcp14">MUST</span> include at least one tcr (see <a href="#tgd-cert-reqst" class="auto internal xref">Section 4.1</a>) or crm (see <a href="#cert-reqst-msg" class="auto internal xref">Section 4.2</a>) TaggedRequest. Support for the orm choice is <span class="bcp14">OPTIONAL</span>.<a href="#section-4-3.2" class="pilcrow">¶</a>
1367,1370c1511,1514
< <p id="section-4.1-1">The reqSequence tcr choice conveys PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> syntax.  The CertificateRequest <span class="bcp14">MUST</span>
<  comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.1" class="relref">Section 3.2.1.2.1</a></span>, with the following additional requirements:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-4.1-2.1">
---
> <p id="section-4.1-1">The reqSequence tcr choice conveys PKCS #10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> syntax.  The CertificateRequest <span class="bcp14">MUST</span>
>  comply with <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.1" class="relref">Section 3.2.1.2.1</a></span>, with the following additional requirements:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-4.1-2.1">
1372,1373c1516,1517
< <ul>
< <li id="section-4.1-2.1.2.1">subjectPublicKeyInfo <span class="bcp14">MUST</span> be set as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4.1-2.1.2.1">subjectPublicKeyInfo <span class="bcp14">MUST</span> be set as defined in <span><a href="https://rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.1" class="pilcrow">¶</a>
1375c1519
< <li id="section-4.1-2.1.2.2">
---
>               <li class="normal" id="section-4.1-2.1.2.2">
1377,1378c1521,1522
< <ul>
< <li id="section-4.1-2.1.2.2.2.1">
---
> <ul class="normal">
> <li class="normal" id="section-4.1-2.1.2.2.2.1">
1380,1381c1524,1525
< <ul>
< <li id="section-4.1-2.1.2.2.2.1.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.2.2.1.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4.1-2.1.2.2.2.1.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-4.1-2.1.2.2.2.1.2.1" class="pilcrow">¶</a>
1383c1527
< <li id="section-4.1-2.1.2.2.2.1.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject field of the certificate being used to generate the signature is NULL.<a href="#section-4.1-2.1.2.2.2.1.2.2" class="pilcrow">¶</a>
---
>                       <li class="normal" id="section-4.1-2.1.2.2.2.1.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject field of the certificate being used to generate the signature is NULL.<a href="#section-4.1-2.1.2.2.2.1.2.2" class="pilcrow">¶</a>
1385c1529
< <li id="section-4.1-2.1.2.2.2.1.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.1-2.1.2.2.2.1.2.3" class="pilcrow">¶</a>
---
>                       <li class="normal" id="section-4.1-2.1.2.2.2.1.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.1-2.1.2.2.2.1.2.3" class="pilcrow">¶</a>
1389c1533
< <li id="section-4.1-2.1.2.2.2.2">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject field or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.1-2.1.2.2.2.2" class="pilcrow">¶</a>
---
>                   <li class="normal" id="section-4.1-2.1.2.2.2.2">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject field or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.1-2.1.2.2.2.2" class="pilcrow">¶</a>
1391c1535
< <li id="section-4.1-2.1.2.2.2.3">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests, as defined in <span>[<a href="#RFC5754" class="xref">RFC5754</a>]</span>; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384, as defined in <span>[<a href="#RFC4231" class="xref">RFC4231</a>]</span>.<a href="#section-4.1-2.1.2.2.2.3" class="pilcrow">¶</a>
---
>                   <li class="normal" id="section-4.1-2.1.2.2.2.3">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests, as defined in <span>[<a href="#RFC5754" class="cite xref">RFC5754</a>]</span>; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384, as defined in <span>[<a href="#RFC4231" class="cite xref">RFC4231</a>]</span>.<a href="#section-4.1-2.1.2.2.2.3" class="pilcrow">¶</a>
1395c1539
< <li id="section-4.1-2.1.2.3">signatureAlgorithm <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.<a href="#section-4.1-2.1.2.3" class="pilcrow">¶</a>
---
>               <li class="normal" id="section-4.1-2.1.2.3">signatureAlgorithm <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.<a href="#section-4.1-2.1.2.3" class="pilcrow">¶</a>
1397c1541
< <li id="section-4.1-2.1.2.4">signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertificationRequestInfo for both signature and key establishment certification requests.  The signature provides proof-of-possession of the private key to the CA.<a href="#section-4.1-2.1.2.4" class="pilcrow">¶</a>
---
>               <li class="normal" id="section-4.1-2.1.2.4">signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertificationRequestInfo for both signature and key establishment certification requests.  The signature provides proof-of-possession of the private key to the CA.<a href="#section-4.1-2.1.2.4" class="pilcrow">¶</a>
1410,1414c1554,1558
<  Format (CRMF) <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>
<  syntax.  The CertReqMsg <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-4.2-2.1">popo <span class="bcp14">MUST</span> be included using the signature (POPOSigningKey)
<    proof-of-possession choice and be set as defined in <span>[<a href="#RFC4211" class="xref">RFC4211</a>], <a href="https://www.rfc-editor.org/rfc/rfc4211#section-4.1" class="relref">Section 4.1</a></span> for both signature and key establishment certification requests. The POPOSigningKey poposkInput field <span class="bcp14">MUST</span> be omitted.  The POPOSigningKey algorithmIdentifier <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.  The signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertTemplate.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
---
>  Format (CRMF) <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>
>  syntax.  The CertReqMsg <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-4.2-2.1">popo <span class="bcp14">MUST</span> be included using the signature (POPOSigningKey)
>    proof-of-possession choice and be set as defined in <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>], <a href="https://rfc-editor.org/rfc/rfc4211#section-4.1" class="relref">Section 4.1</a></span> for both signature and key establishment certification requests. The POPOSigningKey poposkInput field <span class="bcp14">MUST</span> be omitted.  The POPOSigningKey algorithmIdentifier <span class="bcp14">MUST</span> be ecdsa-with-sha384 for P-384 certification requests and sha384WithRSAEncryption or id-RSASSA-PSS for RSA-3072 and RSA-4096 certification requests.  The signature <span class="bcp14">MUST</span> be generated using the private key corresponding to the public key in the CertTemplate.<a href="#section-4.2-2.1" class="pilcrow">¶</a>
1417,1420c1561,1564
< <p id="section-4.2-3">The CertTemplate <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-4.2-4.1">If version is included, it <span class="bcp14">MUST</span> be set to 2 as defined in
<    <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.1" class="pilcrow">¶</a>
---
> <p id="section-4.2-3">The CertTemplate <span class="bcp14">MUST</span> comply with <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-3.2.1.2.2" class="relref">Section 3.2.1.2.2</a></span>, with the following additional requirements:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-4.2-4.1">If version is included, it <span class="bcp14">MUST</span> be set to 2 as defined in
>    <span><a href="https://rfc-editor.org/rfc/rfc8603#section-5.3" class="relref">Section 5.3</a> of [<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-4.2-4.1" class="pilcrow">¶</a>
1422c1566
< <li id="section-4.2-4.2">publicKey <span class="bcp14">MUST</span> be set as defined in <span><a href="https://www.rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-4.2-4.2">publicKey <span class="bcp14">MUST</span> be set as defined in <span><a href="https://rfc-editor.org/rfc/rfc8603#section-5.4" class="relref">Section 5.4</a> of [<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-4.2-4.2" class="pilcrow">¶</a>
1424c1568
< <li id="section-4.2-4.3">
---
>           <li class="normal" id="section-4.2-4.3">
1426,1427c1570,1571
< <ul>
< <li id="section-4.2-4.3.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-4.2-4.3.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4.2-4.3.2.1">The keyUsage extension <span class="bcp14">MUST</span> be included, and it <span class="bcp14">MUST</span> be set as defined in <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-4.2-4.3.2.1" class="pilcrow">¶</a>
1429c1573
< <li id="section-4.2-4.3.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject name of the certificate being used to generate the signature is NULL.<a href="#section-4.2-4.3.2.2" class="pilcrow">¶</a>
---
>               <li class="normal" id="section-4.2-4.3.2.2">For rekey requests, the SubjectAltName extension <span class="bcp14">MUST</span> be included and set equal to the SubjectAltName of the certificate that is being used to sign the SignedData encapsulating the request (i.e., not the certificate being rekeyed) if the subject name of the certificate being used to generate the signature is NULL.<a href="#section-4.2-4.3.2.2" class="pilcrow">¶</a>
1431c1575
< <li id="section-4.2-4.3.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.2-4.3.2.3" class="pilcrow">¶</a>
---
>               <li class="normal" id="section-4.2-4.3.2.3">Other extension requests <span class="bcp14">MAY</span> be included as desired.<a href="#section-4.2-4.3.2.3" class="pilcrow">¶</a>
1435c1579
< <li id="section-4.2-4.4">
---
>           <li class="normal" id="section-4.2-4.4">
1437,1438c1581,1582
< <ul>
< <li id="section-4.2-4.4.2.1">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject name or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.2-4.4.2.1" class="pilcrow">¶</a>
---
> <ul class="normal">
> <li class="normal" id="section-4.2-4.4.2.1">The ChangeSubjectName attribute, as defined in <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>, <span class="bcp14">MUST</span> be included if the Full PKI Request encapsulating this Tagged Certification Request is being signed by a key for which a certificate currently exists and the existing certificate's subject name or SubjectAltName extension does not match the desired subject name or SubjectAltName extension of this certification request.<a href="#section-4.2-4.4.2.1" class="pilcrow">¶</a>
1440c1584
< <li id="section-4.2-4.4.2.2">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384 when keyGenAlgorithm is id-sha384.<a href="#section-4.2-4.4.2.2" class="pilcrow">¶</a>
---
>               <li class="normal" id="section-4.2-4.4.2.2">The POP Link Witness Version 2 attribute <span class="bcp14">MUST</span> be included if the request is being authenticated using a shared-secret and the subject name in the certification request is NULL or otherwise does not uniquely identify the end-entity.  In the POP Link Witness Version 2 attribute, keyGenAlgorithm <span class="bcp14">MUST</span> be id-sha384 for certification requests; macAlgorithm <span class="bcp14">MUST</span> be HMAC-SHA384 when keyGenAlgorithm is id-sha384.<a href="#section-4.2-4.4.2.2" class="pilcrow">¶</a>
1455c1599
<       intermediaries between clients and a CA as described in <span><a href="https://www.rfc-editor.org/rfc/rfc5272#section-7" class="relref">Section 7</a> of [<a href="#RFC5272" class="xref">RFC5272</a>]</span>.  In this section, the term "client" refers to the entity from which the RA received the PKI Request. This section is only applicable to RAs.<a href="#section-5-1" class="pilcrow">¶</a></p>
---
>       intermediaries between clients and a CA as described in <span><a href="https://rfc-editor.org/rfc/rfc5272#section-7" class="relref">Section 7</a> of [<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.  In this section, the term "client" refers to the entity from which the RA received the PKI Request. This section is only applicable to RAs.<a href="#section-5-1" class="pilcrow">¶</a></p>
1461,1463c1605,1607
< <p id="section-5.1-1">RAs conforming to this document <span class="bcp14">MUST</span> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in requests; if they are not, the RA <span class="bcp14">MUST</span> reject those requests.  The RA <span class="bcp14">SHOULD</span> return a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
< <p id="section-5.1-2">When processing end-entity-generated SignedData objects, RAs <span class="bcp14">MUST NOT</span> perform Cryptographic Message Syntax (CMS) Content Constraints (CCC) certificate extension processing <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
< <p id="section-5.1-3">Other RA processing is performed as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
---
> <p id="section-5.1-1">RAs conforming to this document <span class="bcp14">MUST</span> ensure that only the permitted signature, hash, and MAC algorithms described throughout this profile are used in requests; if they are not, the RA <span class="bcp14">MUST</span> reject those requests.  The RA <span class="bcp14">SHOULD</span> return a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
> <p id="section-5.1-2">When processing end-entity-generated SignedData objects, RAs <span class="bcp14">MUST NOT</span> perform Cryptographic Message Syntax (CMS) Content Constraints (CCC) certificate extension processing <span>[<a href="#RFC6010" class="cite xref">RFC6010</a>]</span>.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
> <p id="section-5.1-3">Other RA processing is performed as described in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
1471,1473c1615,1617
< <p id="section-5.2-1">RAs mediate the certificate request process by collecting client requests in batches. The RA <span class="bcp14">MUST</span> encapsulate client-generated PKI Requests in a new RA-signed PKI Request, it <span class="bcp14">MUST</span> create a Full PKI Request encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.  The PKIData content type complies with <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span> with the following additional requirements:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
< <ul>
< <li id="section-5.2-2.1">controlSequence <span class="bcp14">MUST</span> be present. It
---
> <p id="section-5.2-1">RAs mediate the certificate request process by collecting client requests in batches. The RA <span class="bcp14">MUST</span> encapsulate client-generated PKI Requests in a new RA-signed PKI Request, it <span class="bcp14">MUST</span> create a Full PKI Request encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>.  The PKIData content type complies with <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span> with the following additional requirements:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
> <ul class="normal">
> <li class="normal" id="section-5.2-2.1">controlSequence <span class="bcp14">MUST</span> be present. It
1478c1622
< <li id="section-5.2-2.2">cmsSequence <span class="bcp14">MUST</span> be present.  It contains the original, unmodified request(s) received from the client.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
---
>           <li class="normal" id="section-5.2-2.2">cmsSequence <span class="bcp14">MUST</span> be present.  It contains the original, unmodified request(s) received from the client.<a href="#section-5.2-2.2" class="pilcrow">¶</a>
1481,1482c1625,1626
< <div id="section-5.2-3">
< <pre class="sourcecode">
---
> <div class="sourcecode" id="section-5.2-3">
> <pre>
1500,1501c1644,1645
<  of the id-kp-cmcRA Extended Key Usage (EKU) from <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. The RA certificate <span class="bcp14">MAY</span> also include
<  the CCC certificate extension <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization
---
>  of the id-kp-cmcRA Extended Key Usage (EKU) from <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>. The RA certificate <span class="bcp14">MAY</span> also include
>  the CCC certificate extension <span>[<a href="#RFC6010" class="cite xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization
1534c1678
<  <span class="bcp14">SHOULD</span> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
---
>  <span class="bcp14">SHOULD</span> return a CMCStatusInfoV2 control with a CMCStatus of failed and a CMCFailInfo with the value of badAlg <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
1542c1686
< <p id="section-6.1-3">When processing end-entity-generated SignedData objects, CAs <span class="bcp14">MUST NOT</span> perform CCC certificate extension processing <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
---
> <p id="section-6.1-3">When processing end-entity-generated SignedData objects, CAs <span class="bcp14">MUST NOT</span> perform CCC certificate extension processing <span>[<a href="#RFC6010" class="cite xref">RFC6010</a>]</span>.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
1544c1688
<  attribute as described in <a href="#tgd-cert-reqst" class="xref">Section 4.1</a> or <a href="#cert-reqst-msg" class="xref">4.2</a>
---
>  attribute as described in <a href="#tgd-cert-reqst" class="auto internal xref">Section 4.1</a> or <a href="#cert-reqst-msg" class="auto internal xref">4.2</a>
1551c1695
< <p id="section-6.1-5">Other processing of PKIRequests is performed as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
---
> <p id="section-6.1-5">Other processing of PKIRequests is performed as described in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
1559,1562c1703,1706
< <p id="section-6.2-1">CAs send PKI Responses to both client-generated requests and RA-generated requests. If a Full PKI Response is returned in direct response to a client-generated request, it <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
< <p id="section-6.2-2">If the PKI Response is in response to an RA-generated PKI Request, then the above PKI Response is encapsulated in another CA-generated PKI Response.  That PKI Response <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.  The above PKI Response is placed in the encapsulating PKI Response cmsSequence field.  The other fields are as above with the addition of the batch response control in controlSequence.  The following illustrates a successful CA response to an RA-encapsulated PKI Request, both of which include Transaction IDs and Nonces:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
< <div id="section-6.2-3">
< <pre class="sourcecode">
---
> <p id="section-6.2-1">CAs send PKI Responses to both client-generated requests and RA-generated requests. If a Full PKI Response is returned in direct response to a client-generated request, it <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
> <p id="section-6.2-2">If the PKI Response is in response to an RA-generated PKI Request, then the above PKI Response is encapsulated in another CA-generated PKI Response.  That PKI Response <span class="bcp14">MUST</span> be encapsulated in a SignedData, and the SignedData <span class="bcp14">MUST</span> be constructed in accordance with <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>.  The above PKI Response is placed in the encapsulating PKI Response cmsSequence field.  The other fields are as above with the addition of the batch response control in controlSequence.  The following illustrates a successful CA response to an RA-encapsulated PKI Request, both of which include Transaction IDs and Nonces:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
> <div class="sourcecode" id="section-6.2-3">
> <pre>
1576c1720
< <p id="section-6.2-5">Authorization to sign Full PKI Responses <span class="bcp14">SHOULD</span> be indicated in the CA certificate by inclusion of the id-kp-cmcCA EKU from <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. The CA certificate <span class="bcp14">MAY</span> also include the CCC certificate extension <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization through inclusion of the CCC certificate extension alone. The CA certificate may also be authorized through local configuration.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
---
> <p id="section-6.2-5">Authorization to sign Full PKI Responses <span class="bcp14">SHOULD</span> be indicated in the CA certificate by inclusion of the id-kp-cmcCA EKU from <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>. The CA certificate <span class="bcp14">MAY</span> also include the CCC certificate extension <span>[<a href="#RFC6010" class="cite xref">RFC6010</a>]</span>, or it <span class="bcp14">MAY</span> indicate authorization through inclusion of the CCC certificate extension alone. The CA certificate may also be authorized through local configuration.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
1578c1722
< <p id="section-6.2-7">Signatures applied to individual certificates are as required in <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
---
> <p id="section-6.2-7">Signatures applied to individual certificates are as required in <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
1623,1625c1767,1769
< <p id="section-9-1">Protocol security considerations are found in <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span>, <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>, <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>, <span>[<a href="#RFC5272" class="xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="xref">RFC5274</a>]</span>, <span>[<a href="#RFC8603" class="xref">RFC8603</a>]</span>, and <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span>. When CCC is used to authorize RA and CA certificates, then the security considerations in <span>[<a href="#RFC6010" class="xref">RFC6010</a>]</span> also apply.  Algorithm security considerations are found in <span>[<a href="#RFC8755" class="xref">RFC8755</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
< <p id="section-9-2">Compliant with NIST Special Publication 800-57 <span>[<a href="#SP80057" class="xref">SP80057</a>]</span>, this profile defines proof-of-possession of a key establishment private key by performing a digital signature.  Except for one-time proof-of-possession, a single key pair <span class="bcp14">MUST NOT</span> be used for both signature and key establishment.<a href="#section-9-2" class="pilcrow">¶</a></p>
< <p id="section-9-3">This specification requires implementations to generate key pairs and other random values.  The use of inadequate pseudorandom number generators (PRNGs) can result in little or no security.  The generation of quality random numbers is difficult.  NIST Special Publication 800-90A <span>[<a href="#SP80090A" class="xref">SP80090A</a>]</span>, FIPS 186-3 <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>, and <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> offer random number generation guidance.<a href="#section-9-3" class="pilcrow">¶</a></p>
---
> <p id="section-9-1">Protocol security considerations are found in <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span>, <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>, <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>, <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>]</span>, <span>[<a href="#RFC5273" class="cite xref">RFC5273</a>]</span>, <span>[<a href="#RFC5274" class="cite xref">RFC5274</a>]</span>, <span>[<a href="#RFC8603" class="cite xref">RFC8603</a>]</span>, and <span>[<a href="#RFC6402" class="cite xref">RFC6402</a>]</span>. When CCC is used to authorize RA and CA certificates, then the security considerations in <span>[<a href="#RFC6010" class="cite xref">RFC6010</a>]</span> also apply.  Algorithm security considerations are found in <span>[<a href="#RFC8755" class="cite xref">RFC8755</a>]</span>.<a href="#section-9-1" class="pilcrow">¶</a></p>
> <p id="section-9-2">Compliant with NIST Special Publication 800-57 <span>[<a href="#SP80057" class="cite xref">SP80057</a>]</span>, this profile defines proof-of-possession of a key establishment private key by performing a digital signature.  Except for one-time proof-of-possession, a single key pair <span class="bcp14">MUST NOT</span> be used for both signature and key establishment.<a href="#section-9-2" class="pilcrow">¶</a></p>
> <p id="section-9-3">This specification requires implementations to generate key pairs and other random values.  The use of inadequate pseudorandom number generators (PRNGs) can result in little or no security.  The generation of quality random numbers is difficult.  NIST Special Publication 800-90A <span>[<a href="#SP80090A" class="cite xref">SP80090A</a>]</span>, FIPS 186-3 <span>[<a href="#FIPS186" class="cite xref">FIPS186</a>]</span>, and <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> offer random number generation guidance.<a href="#section-9-3" class="pilcrow">¶</a></p>
1651c1795,1796
< <span class="refAuthor">Committee on National Security Systems</span>, <span class="refTitle">"Use of Public Standards for Secure Information Sharing"</span>, <span class="seriesInfo">CNSS Policy 15</span>, <time datetime="2016-10">October 2016</time>, <span>&lt;<a href="https://www.cnss.gov/CNSS/issuances/Policies.cfm">https://www.cnss.gov/CNSS/issuances/Policies.cfm</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Committee on National Security Systems</span>, <span class="refTitle">"Use of Public Standards for Secure Information Sharing"</span>, <span class="seriesInfo">CNSS Policy 15</span>, <time datetime="2016-10" class="refDate">October 2016</time>, <span>&lt;<a href="https://www.cnss.gov/CNSS/issuances/Policies.cfm">https://www.cnss.gov/CNSS/issuances/Policies.cfm</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1654c1799,1800
< <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-4</span>, <span class="seriesInfo">FIPS PUB 186-4</span>, <time datetime="2013-07">July 2013</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>&gt;</span>. </dd>
---
> <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.186-4</span>, <span class="seriesInfo">FIPS PUB 186-4</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1657c1803,1804
< <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1660c1807,1808
< <span class="refAuthor">Nystrom, M.</span><span class="refAuthor"> and B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1663c1811,1812
< <span class="refAuthor">Schaad, J.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, and R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4055">https://www.rfc-editor.org/info/rfc4055</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span>, <span class="refAuthor">Kaliski, B.</span>, and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 4055</span>, <span class="seriesInfo">DOI 10.17487/RFC4055</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4055">https://www.rfc-editor.org/info/rfc4055</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1666c1815,1816
< <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 4056</span>, <span class="seriesInfo">DOI 10.17487/RFC4056</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4056">https://www.rfc-editor.org/info/rfc4056</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Use of the RSASSA-PSS Signature Algorithm in Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">RFC 4056</span>, <span class="seriesInfo">DOI 10.17487/RFC4056</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4056">https://www.rfc-editor.org/info/rfc4056</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1669c1819,1820
< <span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1672c1823,1824
< <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1675c1827,1828
< <span class="refAuthor">Nystrom, M.</span>, <span class="refTitle">"Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"</span>, <span class="seriesInfo">RFC 4231</span>, <span class="seriesInfo">DOI 10.17487/RFC4231</span>, <time datetime="2005-12">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4231">https://www.rfc-editor.org/info/rfc4231</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Nystrom, M.</span>, <span class="refTitle">"Identifiers and Test Vectors for HMAC-SHA-224, HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512"</span>, <span class="seriesInfo">RFC 4231</span>, <span class="seriesInfo">DOI 10.17487/RFC4231</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4231">https://www.rfc-editor.org/info/rfc4231</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1678c1831,1832
< <span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC)"</span>, <span class="seriesInfo">RFC 5272</span>, <span class="seriesInfo">DOI 10.17487/RFC5272</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5272">https://www.rfc-editor.org/info/rfc5272</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1681c1835,1836
< <span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC): Transport Protocols"</span>, <span class="seriesInfo">RFC 5273</span>, <span class="seriesInfo">DOI 10.17487/RFC5273</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5273">https://www.rfc-editor.org/info/rfc5273</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management over CMS (CMC): Transport Protocols"</span>, <span class="seriesInfo">RFC 5273</span>, <span class="seriesInfo">DOI 10.17487/RFC5273</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5273">https://www.rfc-editor.org/info/rfc5273</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1684c1839,1840
< <span class="refAuthor">Schaad, J.</span><span class="refAuthor"> and M. Myers</span>, <span class="refTitle">"Certificate Management Messages over CMS (CMC): Compliance Requirements"</span>, <span class="seriesInfo">RFC 5274</span>, <span class="seriesInfo">DOI 10.17487/RFC5274</span>, <time datetime="2008-06">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5274">https://www.rfc-editor.org/info/rfc5274</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">M. Myers</span>, <span class="refTitle">"Certificate Management Messages over CMS (CMC): Compliance Requirements"</span>, <span class="seriesInfo">RFC 5274</span>, <span class="seriesInfo">DOI 10.17487/RFC5274</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5274">https://www.rfc-editor.org/info/rfc5274</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1687c1843,1844
< <span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Using SHA2 Algorithms with Cryptographic Message Syntax"</span>, <span class="seriesInfo">RFC 5754</span>, <span class="seriesInfo">DOI 10.17487/RFC5754</span>, <time datetime="2010-01">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5754">https://www.rfc-editor.org/info/rfc5754</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Using SHA2 Algorithms with Cryptographic Message Syntax"</span>, <span class="seriesInfo">RFC 5754</span>, <span class="seriesInfo">DOI 10.17487/RFC5754</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5754">https://www.rfc-editor.org/info/rfc5754</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1690c1847,1848
< <span class="refAuthor">Housley, R.</span><span class="refAuthor">, Ashmore, S.</span><span class="refAuthor">, and C. Wallace</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS) Content Constraints Extension"</span>, <span class="seriesInfo">RFC 6010</span>, <span class="seriesInfo">DOI 10.17487/RFC6010</span>, <time datetime="2010-09">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6010">https://www.rfc-editor.org/info/rfc6010</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Housley, R.</span>, <span class="refAuthor">Ashmore, S.</span>, and <span class="refAuthor">C. Wallace</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS) Content Constraints Extension"</span>, <span class="seriesInfo">RFC 6010</span>, <span class="seriesInfo">DOI 10.17487/RFC6010</span>, <time datetime="2010-09" class="refDate">September 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6010">https://www.rfc-editor.org/info/rfc6010</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1693c1851,1852
< <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1696c1855,1856
< <span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1699c1859,1860
< <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1702c1863,1864
< <span class="refAuthor">Jenkins, M.</span><span class="refAuthor"> and L. Zieglar</span>, <span class="refTitle">"Commercial National Security Algorithm (CNSA) Suite Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 8603</span>, <span class="seriesInfo">DOI 10.17487/RFC8603</span>, <time datetime="2019-05">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8603">https://www.rfc-editor.org/info/rfc8603</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Jenkins, M.</span> and <span class="refAuthor">L. Zieglar</span>, <span class="refTitle">"Commercial National Security Algorithm (CNSA) Suite Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 8603</span>, <span class="seriesInfo">DOI 10.17487/RFC8603</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8603">https://www.rfc-editor.org/info/rfc8603</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1705c1867,1868
< <span class="refAuthor">Jenkins, M.</span>, <span class="refTitle">"Using Commercial National Security Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail Extensions"</span>, <span class="seriesInfo">RFC 8755</span>, <span class="seriesInfo">DOI 10.17487/RFC8755</span>, <time datetime="2020-03">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8755">https://www.rfc-editor.org/info/rfc8755</a>&gt;</span>. </dd>
---
> <span class="refAuthor">Jenkins, M.</span>, <span class="refTitle">"Using Commercial National Security Algorithm Suite Algorithms in Secure/Multipurpose Internet Mail Extensions"</span>, <span class="seriesInfo">RFC 8755</span>, <span class="seriesInfo">DOI 10.17487/RFC8755</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8755">https://www.rfc-editor.org/info/rfc8755</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1715c1878,1879
< <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Key Management, Part 1: General"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r4</span>, <span class="seriesInfo">Special Publication 800-57, Part 1,          Revision 4</span>, <time datetime="2016-01">January 2016</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-57pt1r4">http://doi.org/10.6028/NIST.SP.800-57pt1r4</a>&gt;</span>. </dd>
---
> <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Key Management, Part 1: General"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-57pt1r4</span>, <span class="seriesInfo">Special Publication 800-57, Part 1,          Revision 4</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-57pt1r4">http://doi.org/10.6028/NIST.SP.800-57pt1r4</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1718c1882,1883
< <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Guideline for Identifying an Information System as a National Security System"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-59</span>, <span class="seriesInfo">Special Publication 800-59</span>, <time datetime="2003-08">August 2003</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-59/final">https://csrc.nist.gov/publications/detail/sp/800-59/final</a>&gt;</span>. </dd>
---
> <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Guideline for Identifying an Information System as a National Security System"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-59</span>, <span class="seriesInfo">Special Publication 800-59</span>, <time datetime="2003-08" class="refDate">August 2003</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/sp/800-59/final">https://csrc.nist.gov/publications/detail/sp/800-59/final</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1721c1886,1887
< <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <span class="seriesInfo">Special Publication 800-90A Revision           1</span>, <time datetime="2015-06">June 2015</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-90Ar1">http://doi.org/10.6028/NIST.SP.800-90Ar1</a>&gt;</span>. </dd>
---
> <span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-90Ar1</span>, <span class="seriesInfo">Special Publication 800-90A Revision           1</span>, <time datetime="2015-06" class="refDate">June 2015</time>, <span>&lt;<a href="http://doi.org/10.6028/NIST.SP.800-90Ar1">http://doi.org/10.6028/NIST.SP.800-90Ar1</a>&gt;</span>. </dd>
> <dd class="break"></dd>
1726c1892
< <section id="section-appendix.a">
---
> <section id="appendix-A">
1728c1894
< <a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-scenarios" class="section-name selfRef">Scenarios</a>
---
> <a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-scenarios" class="section-name selfRef">Scenarios</a>
1730c1896
< <p id="section-appendix.a-1">This section illustrates several potential certificate enrollment and rekey scenarios supported by this profile.  This section does not intend to place any limits or restrictions on the use of CMC.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
---
> <p id="appendix-A-1">This section illustrates several potential certificate enrollment and rekey scenarios supported by this profile.  This section does not intend to place any limits or restrictions on the use of CMC.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
1732,1738c1898,1904
< <section id="section-a.1">
<         <h2 id="name-initial-enrollment">
< <a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-initial-enrollment" class="section-name selfRef">Initial Enrollment</a>
<         </h2>
< <p id="section-a.1-1">This section describes three scenarios for authenticating initial enrollment requests:<a href="#section-a.1-1" class="pilcrow">¶</a></p>
< <ol start="1" type="1" class="normal type-1" id="section-a.1-2">
<           <li id="section-a.1-2.1">Previously certified signature key-pair (e.g., Manufacturer Installed Certificate).<a href="#section-a.1-2.1" class="pilcrow">¶</a>
---
> <section id="appendix-A.1">
>         <h3 id="name-initial-enrollment">
> <a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-initial-enrollment" class="section-name selfRef">Initial Enrollment</a>
>         </h3>
> <p id="appendix-A.1-1">This section describes three scenarios for authenticating initial enrollment requests:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
> <ol start="1" type="1" class="normal type-1" id="appendix-A.1-2">
>           <li id="appendix-A.1-2.1">Previously certified signature key-pair (e.g., Manufacturer Installed Certificate).<a href="#appendix-A.1-2.1" class="pilcrow">¶</a>
1740c1906
< <li id="section-a.1-2.2">Shared-secret distributed securely out of band.<a href="#section-a.1-2.2" class="pilcrow">¶</a>
---
>           <li id="appendix-A.1-2.2">Shared-secret distributed securely out of band.<a href="#appendix-A.1-2.2" class="pilcrow">¶</a>
1742c1908
< <li id="section-a.1-2.3">RA authentication.<a href="#section-a.1-2.3" class="pilcrow">¶</a>
---
>           <li id="appendix-A.1-2.3">RA authentication.<a href="#appendix-A.1-2.3" class="pilcrow">¶</a>
1746,1750c1912,1916
< <section id="section-a.1.1">
<           <h3 id="name-previously-certified-signat">
< <a href="#section-a.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-previously-certified-signat" class="section-name selfRef">Previously Certified Signature Key-Pair</a>
<           </h3>
< <p id="section-a.1.1-1">In this scenario, the end-entity has a private signing key and a corresponding public key certificate obtained from a cryptographic module manufacturer recognized by the CA. The end-entity signs a Full PKI Request with the private key that corresponds to the subject public key of the previously installed signature certificate. The CA will verify the authorization of the previously installed certificate and issue an appropriate new certificate to the end-entity.<a href="#section-a.1.1-1" class="pilcrow">¶</a></p>
---
> <section id="appendix-A.1.1">
>           <h4 id="name-previously-certified-signat">
> <a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-previously-certified-signat" class="section-name selfRef">Previously Certified Signature Key-Pair</a>
>           </h4>
> <p id="appendix-A.1.1-1">In this scenario, the end-entity has a private signing key and a corresponding public key certificate obtained from a cryptographic module manufacturer recognized by the CA. The end-entity signs a Full PKI Request with the private key that corresponds to the subject public key of the previously installed signature certificate. The CA will verify the authorization of the previously installed certificate and issue an appropriate new certificate to the end-entity.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
1754,1758c1920,1924
< <section id="section-a.1.2">
<           <h3 id="name-shared-secret-distributed-s">
< <a href="#section-a.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-shared-secret-distributed-s" class="section-name selfRef">Shared-Secret Distributed Securely Out of Band</a>
<           </h3>
< <p id="section-a.1.2-1">In this scenario, the CA distributes a shared-secret out of band
---
> <section id="appendix-A.1.2">
>           <h4 id="name-shared-secret-distributed-s">
> <a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-shared-secret-distributed-s" class="section-name selfRef">Shared-Secret Distributed Securely Out of Band</a>
>           </h4>
> <p id="appendix-A.1.2-1">In this scenario, the CA distributes a shared-secret out of band
1765c1931
<    end-entity's enclosed PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span>
---
>    end-entity's enclosed PKCS #10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span>
1768,1770c1934,1936
<    as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-6.3.1.1" class="relref">Section 6.3.1.1</a></span> or the shared-secret/subject distinguished
<    name linking mechanism as described in <span>[<a href="#RFC5272" class="xref">RFC5272</a>], <a href="https://www.rfc-editor.org/rfc/rfc5272#section-6.3.2" class="relref">Section 6.3.2</a></span>.  The subject name in the
<    enclosed PKCS #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification
---
>    as described in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-6.3.1.1" class="relref">Section 6.3.1.1</a></span> or the shared-secret/subject distinguished
>    name linking mechanism as described in <span>[<a href="#RFC5272" class="cite xref">RFC5272</a>], <a href="https://rfc-editor.org/rfc/rfc5272#section-6.3.2" class="relref">Section 6.3.2</a></span>.  The subject name in the
>    enclosed PKCS #10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> certification
1772c1938
<    be used just to help identify the request (and the corresponding shared-secret) to the CA.<a href="#section-a.1.2-1" class="pilcrow">¶</a></p>
---
>    be used just to help identify the request (and the corresponding shared-secret) to the CA.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
1776,1780c1942,1946
< <section id="section-a.1.3">
<           <h3 id="name-ra-authentication">
< <a href="#section-a.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-ra-authentication" class="section-name selfRef">RA Authentication</a>
<           </h3>
< <p id="section-a.1.3-1">In this scenario, the end-entity does not automatically
---
> <section id="appendix-A.1.3">
>           <h4 id="name-ra-authentication">
> <a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-ra-authentication" class="section-name selfRef">RA Authentication</a>
>           </h4>
> <p id="appendix-A.1.3-1">In this scenario, the end-entity does not automatically
1786c1952
<    signs the request as described in <a href="#cert-reqst-msg" class="xref">Section 4.2</a>,
---
>    signs the request as described in <a href="#cert-reqst-msg" class="auto internal xref">Section 4.2</a>,
1788c1954
<    #10 <span>[<a href="#RFC2986" class="xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification request is not required to match the issued certificate; it may be used just to help identify the request to the RA and/or CA.<a href="#section-a.1.3-1" class="pilcrow">¶</a></p>
---
>    #10 <span>[<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or CRMF <span>[<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> certification request is not required to match the issued certificate; it may be used just to help identify the request to the RA and/or CA.<a href="#appendix-A.1.3-1" class="pilcrow">¶</a></p>
1794,1798c1960,1964
< <section id="section-a.2">
<         <h2 id="name-rekey">
< <a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-rekey" class="section-name selfRef">Rekey</a>
<         </h2>
< <p id="section-a.2-1">There are two scenarios to support the rekey of certificates that
---
> <section id="appendix-A.2">
>         <h3 id="name-rekey">
> <a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-rekey" class="section-name selfRef">Rekey</a>
>         </h3>
> <p id="appendix-A.2-1">There are two scenarios to support the rekey of certificates that
1801c1967
<  certificates. Typically, organizational policy will require certificates to be currently valid to be rekeyed, and it may require initial enrollment to be repeated when rekey is not possible.  However, some organizational policies might allow a grace period during which an expired certificate could be used to rekey.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
---
>  certificates. Typically, organizational policy will require certificates to be currently valid to be rekeyed, and it may require initial enrollment to be repeated when rekey is not possible.  However, some organizational policies might allow a grace period during which an expired certificate could be used to rekey.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
1803,1807c1969,1973
< <section id="section-a.2.1">
<           <h3 id="name-rekey-of-signature-certific">
< <a href="#section-a.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-rekey-of-signature-certific" class="section-name selfRef">Rekey of Signature Certificates</a>
<           </h3>
< <p id="section-a.2.1-1">When a signature certificate is rekeyed, the <span><a href="#RFC2986" class="xref">PKCS #10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> or <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> certification request message enclosed in the Full PKI Request will include the same subject name as the current signature certificate.  The Full PKI Request will be signed by the current private key corresponding to the current signature certificate.<a href="#section-a.2.1-1" class="pilcrow">¶</a></p>
---
> <section id="appendix-A.2.1">
>           <h4 id="name-rekey-of-signature-certific">
> <a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-rekey-of-signature-certific" class="section-name selfRef">Rekey of Signature Certificates</a>
>           </h4>
> <p id="appendix-A.2.1-1">When a signature certificate is rekeyed, the <span><a href="#RFC2986" class="internal xref">PKCS #10</a> [<a href="#RFC2986" class="cite xref">RFC2986</a>]</span> or <span><a href="#RFC4211" class="internal xref">CRMF</a> [<a href="#RFC4211" class="cite xref">RFC4211</a>]</span> certification request message enclosed in the Full PKI Request will include the same subject name as the current signature certificate.  The Full PKI Request will be signed by the current private key corresponding to the current signature certificate.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
1811,1815c1977,1981
< <section id="section-a.2.2">
<           <h3 id="name-rekey-of-key-establishment-">
< <a href="#section-a.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-rekey-of-key-establishment-" class="section-name selfRef">Rekey of Key Establishment Certificates</a>
<           </h3>
< <p id="section-a.2.2-1">When a key establishment certificate is rekeyed, the Full PKI Request will generally be signed by the current private key corresponding to the current signature certificate.  If there is no current signature certificate, one of the initial enrollment options in <a href="#init_enroll" class="xref">Appendix A.1</a> may be used.<a href="#section-a.2.2-1" class="pilcrow">¶</a></p>
---
> <section id="appendix-A.2.2">
>           <h4 id="name-rekey-of-key-establishment-">
> <a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-rekey-of-key-establishment-" class="section-name selfRef">Rekey of Key Establishment Certificates</a>
>           </h4>
> <p id="appendix-A.2.2-1">When a key establishment certificate is rekeyed, the Full PKI Request will generally be signed by the current private key corresponding to the current signature certificate.  If there is no current signature certificate, one of the initial enrollment options in <a href="#init_enroll" class="auto internal xref">Appendix A.1</a> may be used.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
1823c1989
< <section id="section-appendix.b">
---
> <section id="appendix-B">
